Unable to import mlperf_logging,  No module named 'mlperf_logging'
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0176,  0.0177, -0.0208, -0.0246,  0.0066,  0.0193, -0.0252,  0.0057,
         0.0205, -0.0117,  0.0049, -0.0034,  0.0153, -0.0208, -0.0065, -0.0093])
log path is written: /home/yz25672/dlrm_criteo_kaggle/
optimizer selected is  sgd
rank 0 ranking from least wide range to the widest range [19  5 24 16  8 22 12  7 17  1 21 14  0  4 13 18  6 10  9 25 15 23  3 11
 20  2]
Finished training it 1024/76743 of epoch 0, 137.20 ms/it, loss 0.548468
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([-0.0078,  0.0197, -0.0182,  0.0118, -0.0005, -0.0222, -0.0173,  0.0056,
        -0.0207, -0.0051,  0.0024,  0.0186,  0.0067, -0.0111,  0.0143,  0.0165])
log path is written: /home/yz25672/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 137.16 ms/it, loss 0.548416
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0080,  0.0047, -0.0259,  0.0046, -0.0154, -0.0241, -0.0200, -0.0131,
        -0.0196, -0.0116,  0.0214, -0.0080,  0.0086, -0.0205, -0.0257, -0.0008])
log path is written: /home/yz25672/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 137.33 ms/it, loss 0.546578
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yz25672/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0164, -0.0008, -0.0260, -0.0180, -0.0116,  0.0108,  0.0239, -0.0073,
         0.0026, -0.0247,  0.0224, -0.0229, -0.0064, -0.0064,  0.0072, -0.0101])
log path is written: /home/yz25672/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 137.54 ms/it, loss 0.548340
rank 0 ranking from least wide range to the widest range [ 5 12 19 24  7 17  0 14  6  1 16  4  8 22 18 21 10  9 25 11 15  3 23 20
 13  2]
Finished training it 2048/76743 of epoch 0, 128.71 ms/it, loss 0.519790
Finished training it 2048/76743 of epoch 0, 128.25 ms/it, loss 0.520043
Finished training it 2048/76743 of epoch 0, 128.44 ms/it, loss 0.517795
Finished training it 2048/76743 of epoch 0, 128.65 ms/it, loss 0.516787
rank 0 ranking from least wide range to the widest range [12  5  7  0 17 19  4 14  6  8 24 11 16 23 25  3  1 15 21 18 22  9  2 20
 10 13]
Finished training it 3072/76743 of epoch 0, 131.06 ms/it, loss 0.504553
Finished training it 3072/76743 of epoch 0, 131.07 ms/it, loss 0.507058
Finished training it 3072/76743 of epoch 0, 131.04 ms/it, loss 0.509893
Finished training it 3072/76743 of epoch 0, 131.07 ms/it, loss 0.509041
rank 0 ranking from least wide range to the widest range [12  0  5  7  4 19 17 14 21  6 24  9 16 11  8 25  3 15  1 23 10 20 22 18
  2 13]
Finished training it 4096/76743 of epoch 0, 137.63 ms/it, loss 0.506339
Finished training it 4096/76743 of epoch 0, 135.97 ms/it, loss 0.501435
Finished training it 4096/76743 of epoch 0, 133.77 ms/it, loss 0.504491
Finished training it 4096/76743 of epoch 0, 137.63 ms/it, loss 0.502170
rank 0 ranking from least wide range to the widest range [21  4  0  5  7 19 17 12 14  8  6 11 22 10  9 15 24 16 23  3 18 13  1  2
 20 25]
Finished training it 5120/76743 of epoch 0, 135.04 ms/it, loss 0.498610
Finished training it 5120/76743 of epoch 0, 135.03 ms/it, loss 0.499397
Finished training it 5120/76743 of epoch 0, 131.91 ms/it, loss 0.498731
Finished training it 5120/76743 of epoch 0, 134.88 ms/it, loss 0.500742
rank 0 ranking from least wide range to the widest range [ 5 21  7 19  4  0 17 12  8 15 14 22 16  9 24  2 13  6  3 20 18  1 11 10
 23 25]
Finished training it 6144/76743 of epoch 0, 131.58 ms/it, loss 0.493923
Finished training it 6144/76743 of epoch 0, 128.91 ms/it, loss 0.492781
Finished training it 6144/76743 of epoch 0, 130.88 ms/it, loss 0.497102
Finished training it 6144/76743 of epoch 0, 131.09 ms/it, loss 0.492681
rank 0 ranking from least wide range to the widest range [ 5 19 21  4 17  7  0 12  8 16 24 13  6 14 25 15  1  9 22  3  2 20 18 23
 11 10]
Finished training it 7168/76743 of epoch 0, 131.73 ms/it, loss 0.488973
Finished training it 7168/76743 of epoch 0, 131.32 ms/it, loss 0.488392
Finished training it 7168/76743 of epoch 0, 131.23 ms/it, loss 0.485981
Finished training it 7168/76743 of epoch 0, 129.46 ms/it, loss 0.486601
rank 0 ranking from least wide range to the widest range [ 5 21 17 19  7  8  4  0 12 13 14  3  9 20 22  2 16  6 15 23 18  1 11 24
 25 10]
Finished training it 8192/76743 of epoch 0, 131.12 ms/it, loss 0.484531
Finished training it 8192/76743 of epoch 0, 129.68 ms/it, loss 0.485598
Finished training it 8192/76743 of epoch 0, 131.33 ms/it, loss 0.489248
Finished training it 8192/76743 of epoch 0, 131.06 ms/it, loss 0.485751
rank 0 ranking from least wide range to the widest range [ 5 21 19  7  4 17  8 22  0 12  3 15 13  2 20 11 25  9 16 18 24  1 23 14
  6 10]
Finished training it 9216/76743 of epoch 0, 133.16 ms/it, loss 0.481699
Finished training it 9216/76743 of epoch 0, 131.75 ms/it, loss 0.480081
Finished training it 9216/76743 of epoch 0, 133.01 ms/it, loss 0.483445
Finished training it 9216/76743 of epoch 0, 132.96 ms/it, loss 0.480369
rank 0 ranking from least wide range to the widest range [21  5  4 17 19  7  8 15 12 13 22 23 18  3 11 16 20  6  2  9 24  0  1 14
 25 10]
Finished training it 10240/76743 of epoch 0, 126.14 ms/it, loss 0.483279
Finished training it 10240/76743 of epoch 0, 125.07 ms/it, loss 0.480521
Finished training it 10240/76743 of epoch 0, 126.75 ms/it, loss 0.480283
Finished training it 10240/76743 of epoch 0, 125.66 ms/it, loss 0.479657
Testing at - 10240/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2528651.0
get out
0 has test check 2528651.0 and sample count 3273728
 accuracy 77.241 %, best 77.241 %, roc auc score 0.7659, best 0.7659
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [21  8  5 19  4 17  7 16 22 18 24  0 15 12 13 25  6 11 20  1  3  2  9 23
 10 14]
Finished training it 11264/76743 of epoch 0, 131.83 ms/it, loss 0.478236
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2528824.0
get out
2 has test check 2528824.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 131.31 ms/it, loss 0.482016
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2529566.0
get out
1 has test check 2529566.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 131.38 ms/it, loss 0.481359
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2528891.0
get out
3 has test check 2528891.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 130.85 ms/it, loss 0.479668
Finished training it 12288/76743 of epoch 0, 131.93 ms/it, loss 0.479363
rank 0 ranking from least wide range to the widest range [19 21  5  4  0  7 17  8 22 24 16 18 25 13 11  6 15 12  9  2 20 23  3 14
  1 10]
Finished training it 12288/76743 of epoch 0, 132.40 ms/it, loss 0.478107
Finished training it 12288/76743 of epoch 0, 132.30 ms/it, loss 0.477900
Finished training it 12288/76743 of epoch 0, 132.23 ms/it, loss 0.477391
Finished training it 13312/76743 of epoch 0, 131.29 ms/it, loss 0.477079
rank 0 ranking from least wide range to the widest range [19 21  5  4  0  7  8 17 13 18  6 16 12 22 11 15 24  1 23  3 25  2 20 14
  9 10]
Finished training it 13312/76743 of epoch 0, 131.94 ms/it, loss 0.477742
Finished training it 13312/76743 of epoch 0, 131.68 ms/it, loss 0.477965
Finished training it 13312/76743 of epoch 0, 131.81 ms/it, loss 0.478629
Finished training it 14336/76743 of epoch 0, 132.58 ms/it, loss 0.474973
Finished training it 14336/76743 of epoch 0, 132.50 ms/it, loss 0.476138
rank 0 ranking from least wide range to the widest range [ 5 19  4 21  7 13 18  0  8 11 17 15 16 22 12 23  6  9  2  3 20 24  1 14
 25 10]
Finished training it 14336/76743 of epoch 0, 132.57 ms/it, loss 0.475107
Finished training it 14336/76743 of epoch 0, 132.10 ms/it, loss 0.475178
rank 0 ranking from least wide range to the widest range [19  0 18  4  5 21  7 22  8 16 17 13 24  6 12 23 11 15 25  3  2  1 10 20
  9 14]
Finished training it 15360/76743 of epoch 0, 131.83 ms/it, loss 0.474542
Finished training it 15360/76743 of epoch 0, 131.21 ms/it, loss 0.475927
Finished training it 15360/76743 of epoch 0, 131.54 ms/it, loss 0.473564
Finished training it 15360/76743 of epoch 0, 131.68 ms/it, loss 0.475034
rank 0 ranking from least wide range to the widest range [19  5  8 21  4  0 18 13  7 22 25 17 11 16  2 15  1 24  3 23 12  6  9 14
 20 10]
Finished training it 16384/76743 of epoch 0, 137.13 ms/it, loss 0.474546
Finished training it 16384/76743 of epoch 0, 136.96 ms/it, loss 0.472768
Finished training it 16384/76743 of epoch 0, 136.66 ms/it, loss 0.471652
Finished training it 16384/76743 of epoch 0, 137.17 ms/it, loss 0.470341
Finished training it 17408/76743 of epoch 0, 128.34 ms/it, loss 0.473268
Finished training it 17408/76743 of epoch 0, 128.66 ms/it, loss 0.469427
rank 0 ranking from least wide range to the widest range [ 0 21  5 19  7  4 18  8 22 13 17 16 23 15 24 11  6  2  1 12 14  3 10 20
  9 25]
Finished training it 17408/76743 of epoch 0, 128.67 ms/it, loss 0.470547
Finished training it 17408/76743 of epoch 0, 128.77 ms/it, loss 0.472404
rank 0 ranking from least wide range to the widest range [21 19  0  5  4 18 13  7 22 17  8 24 16  6 15 11 12  2 23 10  9  3 14  1
 25 20]
Finished training it 18432/76743 of epoch 0, 127.70 ms/it, loss 0.468369
Finished training it 18432/76743 of epoch 0, 127.27 ms/it, loss 0.468915
Finished training it 18432/76743 of epoch 0, 127.03 ms/it, loss 0.469208
Finished training it 18432/76743 of epoch 0, 127.22 ms/it, loss 0.469530
rank 0 ranking from least wide range to the widest range [21  8 19  5  7  4 18  0 13 24 16 22 17 15  6 23  1 11  2 12 10 25  3 14
  9 20]
Finished training it 19456/76743 of epoch 0, 126.65 ms/it, loss 0.469190
Finished training it 19456/76743 of epoch 0, 125.62 ms/it, loss 0.470380
Finished training it 19456/76743 of epoch 0, 125.94 ms/it, loss 0.468150
Finished training it 19456/76743 of epoch 0, 125.98 ms/it, loss 0.465412
rank 0 ranking from least wide range to the widest range [19 18  0  7 21  5 22 24 13  4  8 15 17 23  6 16  2  9 11 12  3 25  1 10
 14 20]
Finished training it 20480/76743 of epoch 0, 127.59 ms/it, loss 0.470054
Finished training it 20480/76743 of epoch 0, 127.11 ms/it, loss 0.470014
Finished training it 20480/76743 of epoch 0, 127.53 ms/it, loss 0.468746
Finished training it 20480/76743 of epoch 0, 127.43 ms/it, loss 0.467870
Testing at - 20480/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2539577.0
get out
0 has test check 2539577.0 and sample count 3273728
 accuracy 77.574 %, best 77.574 %, roc auc score 0.7785, best 0.7785
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2539539.0
get out
3 has test check 2539539.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 127.26 ms/it, loss 0.471049
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [19 21 18  0  7  4 22  5  8 24 17 15  6 13 11  2 16 23  1  3 12  9 25 10
 20 14]
Finished training it 21504/76743 of epoch 0, 128.02 ms/it, loss 0.471037
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2539676.0
get out
2 has test check 2539676.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 127.47 ms/it, loss 0.471404
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2539449.0
get out
1 has test check 2539449.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 127.63 ms/it, loss 0.468216
rank 0 ranking from least wide range to the widest range [ 0 21 19  7 17  5 15 18  4  6 22 13  8 23  2 11 24 12 16 10  3 20 14  9
  1 25]
Finished training it 22528/76743 of epoch 0, 128.10 ms/it, loss 0.469651
Finished training it 22528/76743 of epoch 0, 128.19 ms/it, loss 0.470356
Finished training it 22528/76743 of epoch 0, 127.78 ms/it, loss 0.466984
Finished training it 22528/76743 of epoch 0, 128.13 ms/it, loss 0.469180
rank 0 ranking from least wide range to the widest range [21  8 19 18  4  5 22 24  7  0 13 16 15 17  6 23  2 11  1  3 20 12 10 14
  9 25]
Finished training it 23552/76743 of epoch 0, 127.81 ms/it, loss 0.466848
Finished training it 23552/76743 of epoch 0, 127.15 ms/it, loss 0.469928
Finished training it 23552/76743 of epoch 0, 127.58 ms/it, loss 0.467875
Finished training it 23552/76743 of epoch 0, 127.47 ms/it, loss 0.465854
Finished training it 24576/76743 of epoch 0, 128.84 ms/it, loss 0.467821
rank 0 ranking from least wide range to the widest range [19  0 21  8 22 18 13  4 24 15  7 17  5 23  2  6 11 16  9  3 12  1 20 10
 14 25]
Finished training it 24576/76743 of epoch 0, 129.43 ms/it, loss 0.466930
Finished training it 24576/76743 of epoch 0, 129.18 ms/it, loss 0.467252
Finished training it 24576/76743 of epoch 0, 129.21 ms/it, loss 0.464482
rank 0 ranking from least wide range to the widest range [21 19  8  0 22  7 13  4 18 24 16  5 17 15  6  9 23  2 11 14 12 20  3 10
 25  1]
Finished training it 25600/76743 of epoch 0, 124.98 ms/it, loss 0.465727
Finished training it 25600/76743 of epoch 0, 124.64 ms/it, loss 0.467630
Finished training it 25600/76743 of epoch 0, 125.31 ms/it, loss 0.467640
Finished training it 25600/76743 of epoch 0, 125.85 ms/it, loss 0.469203
rank 0 ranking from least wide range to the widest range [21 19  8 13  0  4  5  7 22 24 16 18 17  2 23  6 11 15  1 25  3 20  9 12
 14 10]
Finished training it 26624/76743 of epoch 0, 128.29 ms/it, loss 0.465357
Finished training it 26624/76743 of epoch 0, 127.93 ms/it, loss 0.470002
Finished training it 26624/76743 of epoch 0, 128.62 ms/it, loss 0.468156
Finished training it 26624/76743 of epoch 0, 128.37 ms/it, loss 0.465241
rank 0 ranking from least wide range to the widest range [19 21 24 18 16  8  5  7  0 17  4 13 22  2  6 23 15 12  9  1 25 11 10 14
  3 20]
Finished training it 27648/76743 of epoch 0, 127.74 ms/it, loss 0.466901
Finished training it 27648/76743 of epoch 0, 127.47 ms/it, loss 0.466089
Finished training it 27648/76743 of epoch 0, 127.67 ms/it, loss 0.462072
Finished training it 27648/76743 of epoch 0, 127.64 ms/it, loss 0.466295
rank 0 ranking from least wide range to the widest range [19 21 24 18  0  8  4 22 17 13  5  7 16 15 25 23  6  2  1 11 20  9 12  3
 14 10]
Finished training it 28672/76743 of epoch 0, 127.57 ms/it, loss 0.464117
Finished training it 28672/76743 of epoch 0, 127.22 ms/it, loss 0.463750
Finished training it 28672/76743 of epoch 0, 126.83 ms/it, loss 0.466453
Finished training it 28672/76743 of epoch 0, 127.16 ms/it, loss 0.467423
rank 0 ranking from least wide range to the widest range [21  8 19 13  0 22  5 24 15 18  4  7 16 17  6  2 23 11  3  1 20  9 12 14
 10 25]
Finished training it 29696/76743 of epoch 0, 125.99 ms/it, loss 0.467487
Finished training it 29696/76743 of epoch 0, 125.60 ms/it, loss 0.467100
Finished training it 29696/76743 of epoch 0, 126.18 ms/it, loss 0.468122
Finished training it 29696/76743 of epoch 0, 126.01 ms/it, loss 0.463149
rank 0 ranking from least wide range to the widest range [19  0 18 21 13  5 17  6 23 15  8  4  7 24  2 16 22 11 12  9  1  3 20 10
 14 25]
Finished training it 30720/76743 of epoch 0, 126.40 ms/it, loss 0.466290
Finished training it 30720/76743 of epoch 0, 126.12 ms/it, loss 0.466497
Finished training it 30720/76743 of epoch 0, 126.41 ms/it, loss 0.467408
Finished training it 30720/76743 of epoch 0, 126.36 ms/it, loss 0.469412
Testing at - 30720/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2534211.0
get out
0 has test check 2534211.0 and sample count 3273728
 accuracy 77.411 %, best 77.574 %, roc auc score 0.7824, best 0.7824
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2534765.0
get out
3 has test check 2534765.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 128.85 ms/it, loss 0.464469
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2532700.0
get out
2 has test check 2532700.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 129.16 ms/it, loss 0.468674
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 8 21 19  4 18 16  0  7 24 22 13  5 15 17 23  2  6 11  1  3 20  9 12 25
 14 10]
Finished training it 31744/76743 of epoch 0, 129.63 ms/it, loss 0.464730
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2532728.0
get out
1 has test check 2532728.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 129.31 ms/it, loss 0.467854
rank 0 ranking from least wide range to the widest range [19 21 18  8  0 17 24 13  5 22 15 16  4  7  6  2 12 11 23  9  1 20 14 10
  3 25]
Finished training it 32768/76743 of epoch 0, 125.99 ms/it, loss 0.464242
Finished training it 32768/76743 of epoch 0, 125.47 ms/it, loss 0.465506
Finished training it 32768/76743 of epoch 0, 126.14 ms/it, loss 0.464977
Finished training it 32768/76743 of epoch 0, 125.79 ms/it, loss 0.463804
rank 0 ranking from least wide range to the widest range [ 0 19 21 24  8 17 13 15  7  4  6 16  5 23  2 18 22 11 20  1  3  9 14 12
 10 25]
Finished training it 33792/76743 of epoch 0, 127.85 ms/it, loss 0.465294
Finished training it 33792/76743 of epoch 0, 127.65 ms/it, loss 0.464179
Finished training it 33792/76743 of epoch 0, 127.84 ms/it, loss 0.466547
Finished training it 33792/76743 of epoch 0, 127.84 ms/it, loss 0.465648
Finished training it 34816/76743 of epoch 0, 128.39 ms/it, loss 0.466924
Finished training it 34816/76743 of epoch 0, 128.87 ms/it, loss 0.463669
rank 0 ranking from least wide range to the widest range [19 17  8  0 21 18  4  7 22 16 24  6 13  5  9 23 15 12  2  1 11 14  3 10
 25 20]
Finished training it 34816/76743 of epoch 0, 128.91 ms/it, loss 0.465222
Finished training it 34816/76743 of epoch 0, 128.90 ms/it, loss 0.464414
rank 0 ranking from least wide range to the widest range [19  8 17 21  0 18  4 13 16 22 24 23  5  7  6  1 15  2 11  3 14 20 12 25
  9 10]
Finished training it 35840/76743 of epoch 0, 127.41 ms/it, loss 0.465599
Finished training it 35840/76743 of epoch 0, 126.98 ms/it, loss 0.465518
Finished training it 35840/76743 of epoch 0, 127.42 ms/it, loss 0.461685
Finished training it 35840/76743 of epoch 0, 127.35 ms/it, loss 0.465869
Finished training it 36864/76743 of epoch 0, 127.90 ms/it, loss 0.461124
rank 0 ranking from least wide range to the widest range [19  8 21 17 18  4 22  5 24 15  7  0 13 16 23  6  2  3 11  1 20 12 14  9
 25 10]
Finished training it 36864/76743 of epoch 0, 128.34 ms/it, loss 0.462897
Finished training it 36864/76743 of epoch 0, 128.29 ms/it, loss 0.462338
Finished training it 36864/76743 of epoch 0, 128.61 ms/it, loss 0.463490
rank 0 ranking from least wide range to the widest range [21 17  8 19  7  4 15 16 13 23 18 22  6  1 24  2 11  0  5  3 12 20 14  9
 10 25]
Finished training it 37888/76743 of epoch 0, 124.74 ms/it, loss 0.462834
Finished training it 37888/76743 of epoch 0, 124.69 ms/it, loss 0.465649
Finished training it 37888/76743 of epoch 0, 124.35 ms/it, loss 0.463647
Finished training it 37888/76743 of epoch 0, 124.77 ms/it, loss 0.465058
rank 0 ranking from least wide range to the widest range [ 8 21 19 17 18 16  4 13  0 24 22  7  6 15 23  5 12  1  3  2  9 11 10 25
 20 14]
Finished training it 38912/76743 of epoch 0, 125.68 ms/it, loss 0.461283
Finished training it 38912/76743 of epoch 0, 125.17 ms/it, loss 0.463159
Finished training it 38912/76743 of epoch 0, 125.55 ms/it, loss 0.462989
Finished training it 38912/76743 of epoch 0, 125.56 ms/it, loss 0.461210
Finished training it 39936/76743 of epoch 0, 125.18 ms/it, loss 0.460548
rank 0 ranking from least wide range to the widest range [13  8 21 17 18 19  4 16  0 15  1 22 23  7  2 11  5  6 24  3 20  9 14 12
 10 25]
Finished training it 39936/76743 of epoch 0, 125.78 ms/it, loss 0.462336
Finished training it 39936/76743 of epoch 0, 125.61 ms/it, loss 0.462328
Finished training it 39936/76743 of epoch 0, 125.58 ms/it, loss 0.462493
Finished training it 40960/76743 of epoch 0, 125.38 ms/it, loss 0.463301
rank 0 ranking from least wide range to the widest range [19  8 17  0 18  4 21  1 22 13 23 16 24  7 15  6  2 11  5  3 12  9 14 20
 25 10]
Finished training it 40960/76743 of epoch 0, 125.77 ms/it, loss 0.460623
Finished training it 40960/76743 of epoch 0, 125.72 ms/it, loss 0.462906
Finished training it 40960/76743 of epoch 0, 125.91 ms/it, loss 0.465940
Testing at - 40960/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2554249.0
get out
0 has test check 2554249.0 and sample count 3273728
 accuracy 78.023 %, best 78.023 %, roc auc score 0.7855, best 0.7855
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2555115.0
get out
3 has test check 2555115.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 125.74 ms/it, loss 0.460419
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2554048.0
get out
2 has test check 2554048.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 126.16 ms/it, loss 0.464848
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2554461.0
get out
1 has test check 2554461.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 126.20 ms/it, loss 0.464494
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [21  8 19 13 24  0 17  7  4 23 15 18 22  1  5  6 16  2  3 11 25 20 12 14
  9 10]
Finished training it 41984/76743 of epoch 0, 125.98 ms/it, loss 0.461289
Finished training it 43008/76743 of epoch 0, 125.08 ms/it, loss 0.464014
Finished training it 43008/76743 of epoch 0, 125.74 ms/it, loss 0.464122
rank 0 ranking from least wide range to the widest range [21  8 19 18 17  0  7  4 13 15 23  1  2 24 22  3 11 16  5  6 20 14 12 25
  9 10]
Finished training it 43008/76743 of epoch 0, 125.37 ms/it, loss 0.460702
Finished training it 43008/76743 of epoch 0, 125.77 ms/it, loss 0.463009
rank 0 ranking from least wide range to the widest range [19 17 21  0  7 18  8  4 13 15 23 24  1  2 16  3  5 22 11  6  9 20 12 14
 25 10]
Finished training it 44032/76743 of epoch 0, 125.84 ms/it, loss 0.464443
Finished training it 44032/76743 of epoch 0, 125.43 ms/it, loss 0.463141
Finished training it 44032/76743 of epoch 0, 126.09 ms/it, loss 0.460517
Finished training it 44032/76743 of epoch 0, 126.40 ms/it, loss 0.462019
Finished training it 45056/76743 of epoch 0, 126.13 ms/it, loss 0.462728
rank 0 ranking from least wide range to the widest range [19  4 17 18  7 16 24  1 13 15 21  8  0  2  5 22 23  6 11  3 25 20 14  9
 12 10]
Finished training it 45056/76743 of epoch 0, 126.62 ms/it, loss 0.460401
Finished training it 45056/76743 of epoch 0, 126.55 ms/it, loss 0.461022
Finished training it 45056/76743 of epoch 0, 127.06 ms/it, loss 0.462940
rank 0 ranking from least wide range to the widest range [19  8 21 17 16  4 18  1 13  7 22 24  5 23 15  0  6  2  3 11 12  9 20 14
 25 10]
Finished training it 46080/76743 of epoch 0, 122.04 ms/it, loss 0.460639
Finished training it 46080/76743 of epoch 0, 121.50 ms/it, loss 0.464576
Finished training it 46080/76743 of epoch 0, 121.86 ms/it, loss 0.462116
Finished training it 46080/76743 of epoch 0, 122.10 ms/it, loss 0.463560
rank 0 ranking from least wide range to the widest range [17 21  4  8 13  7 19 23 16 15  2 18 24  1  6 11 22  3  0  5  9 12 14 20
 10 25]
Finished training it 47104/76743 of epoch 0, 123.54 ms/it, loss 0.465346
Finished training it 47104/76743 of epoch 0, 123.11 ms/it, loss 0.461487
Finished training it 47104/76743 of epoch 0, 123.79 ms/it, loss 0.460131
Finished training it 47104/76743 of epoch 0, 123.55 ms/it, loss 0.461785
Finished training it 48128/76743 of epoch 0, 120.20 ms/it, loss 0.460794
rank 0 ranking from least wide range to the widest range [ 8 21 19 18 24 16 17 15  4 13 23  2  0  1  7 11  5 22  3  6 20 12  9 14
 25 10]
Finished training it 48128/76743 of epoch 0, 120.86 ms/it, loss 0.462633
Finished training it 48128/76743 of epoch 0, 121.05 ms/it, loss 0.461943
Finished training it 48128/76743 of epoch 0, 120.54 ms/it, loss 0.458741
Finished training it 49152/76743 of epoch 0, 127.23 ms/it, loss 0.462341
rank 0 ranking from least wide range to the widest range [21  8  4 19  0 18  1 13  7 22  5 16 17 15  2 23 24 11  3  9  6 14 20 25
 12 10]
Finished training it 49152/76743 of epoch 0, 127.82 ms/it, loss 0.460858
Finished training it 49152/76743 of epoch 0, 127.52 ms/it, loss 0.461795
Finished training it 49152/76743 of epoch 0, 128.00 ms/it, loss 0.462194
Finished training it 50176/76743 of epoch 0, 122.01 ms/it, loss 0.463392
rank 0 ranking from least wide range to the widest range [19 21 18 13  4 17  0 24 23  8 15  1 22  2  5  7 11  3  6 16  9 14 12 20
 25 10]
Finished training it 50176/76743 of epoch 0, 123.12 ms/it, loss 0.465334
Finished training it 50176/76743 of epoch 0, 122.33 ms/it, loss 0.462041
Finished training it 50176/76743 of epoch 0, 122.62 ms/it, loss 0.463562
rank 0 ranking from least wide range to the widest range [19 24  0 21 17  4  8  7 15  2  5 23  3  6 18  1 11 16 13 22 12 25 20  9
 14 10]
Finished training it 51200/76743 of epoch 0, 125.25 ms/it, loss 0.463783
Finished training it 51200/76743 of epoch 0, 123.94 ms/it, loss 0.459126
Finished training it 51200/76743 of epoch 0, 124.43 ms/it, loss 0.460711
Finished training it 51200/76743 of epoch 0, 124.44 ms/it, loss 0.460024
Testing at - 51200/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2553199.0
get out
0 has test check 2553199.0 and sample count 3273728
 accuracy 77.991 %, best 78.023 %, roc auc score 0.7865, best 0.7865
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [17  4 18  8 16 23 19 13 21 15  2  3  6  1 11 24 12  5  0  7 22 14 20 10
  9 25]
Finished training it 52224/76743 of epoch 0, 126.19 ms/it, loss 0.460860
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2553152.0
get out
3 has test check 2553152.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 125.87 ms/it, loss 0.459372
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2553265.0
get out
2 has test check 2553265.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 126.88 ms/it, loss 0.461694
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2553156.0
get out
1 has test check 2553156.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 126.22 ms/it, loss 0.461577
rank 0 ranking from least wide range to the widest range [ 8 21 19 13 18  0 24 16 17 23  5 15  2  1 11  4  3 22  7  6 20  9 14 25
 12 10]
Finished training it 53248/76743 of epoch 0, 122.44 ms/it, loss 0.459486
Finished training it 53248/76743 of epoch 0, 121.95 ms/it, loss 0.463178
Finished training it 53248/76743 of epoch 0, 122.46 ms/it, loss 0.463183
Finished training it 53248/76743 of epoch 0, 122.69 ms/it, loss 0.461524
rank 0 ranking from least wide range to the widest range [ 4  8 21 18 17 23 19 13 15  2 22 24  0  7  3 11  5 16  1  9  6 20 14 12
 25 10]
Finished training it 54272/76743 of epoch 0, 127.46 ms/it, loss 0.461042
Finished training it 54272/76743 of epoch 0, 126.56 ms/it, loss 0.462154
Finished training it 54272/76743 of epoch 0, 126.82 ms/it, loss 0.457797
Finished training it 54272/76743 of epoch 0, 127.07 ms/it, loss 0.461244
Finished training it 55296/76743 of epoch 0, 129.34 ms/it, loss 0.458170
rank 0 ranking from least wide range to the widest range [19 13  1 21  8 16 15  0  4 24  2  7 23 17  5  3 22 11 18 20 25 14  6 12
  9 10]
Finished training it 55296/76743 of epoch 0, 129.67 ms/it, loss 0.461398
Finished training it 55296/76743 of epoch 0, 129.64 ms/it, loss 0.459694
Finished training it 55296/76743 of epoch 0, 129.76 ms/it, loss 0.460092
Finished training it 56320/76743 of epoch 0, 123.89 ms/it, loss 0.462902
Finished training it 56320/76743 of epoch 0, 124.09 ms/it, loss 0.459808
rank 0 ranking from least wide range to the widest range [ 8 23  4  0 21 19 17 18 13 15  2  5 22 16  1 24 11  7  3  6 20 12 25 14
 10  9]
Finished training it 56320/76743 of epoch 0, 124.36 ms/it, loss 0.461042
Finished training it 56320/76743 of epoch 0, 123.43 ms/it, loss 0.458884
rank 0 ranking from least wide range to the widest range [15 21 23  4  8  5 18 19  2  0 13 17  7 22 11  3 16  1 24 20 14  9  6 12
 25 10]
Finished training it 57344/76743 of epoch 0, 126.44 ms/it, loss 0.461550
Finished training it 57344/76743 of epoch 0, 126.52 ms/it, loss 0.458989
Finished training it 57344/76743 of epoch 0, 126.09 ms/it, loss 0.461002
Finished training it 57344/76743 of epoch 0, 126.58 ms/it, loss 0.462997
rank 0 ranking from least wide range to the widest range [21  8 19 18 16  4 13 24 17  1  7 23 15  2 22 25  3  5 11  0 20 12  6  9
 14 10]
Finished training it 58368/76743 of epoch 0, 126.35 ms/it, loss 0.458103
Finished training it 58368/76743 of epoch 0, 126.00 ms/it, loss 0.462308
Finished training it 58368/76743 of epoch 0, 126.43 ms/it, loss 0.463152
Finished training it 58368/76743 of epoch 0, 127.01 ms/it, loss 0.462000
rank 0 ranking from least wide range to the widest range [19  8 21 24 18 13 16 17 23  5  4  7  1 15  2  0 22  3  6 11 12 14 20  9
 25 10]
Finished training it 59392/76743 of epoch 0, 127.35 ms/it, loss 0.461779
Finished training it 59392/76743 of epoch 0, 126.93 ms/it, loss 0.459268
Finished training it 59392/76743 of epoch 0, 127.78 ms/it, loss 0.462006
Finished training it 59392/76743 of epoch 0, 127.77 ms/it, loss 0.457426
Finished training it 60416/76743 of epoch 0, 123.70 ms/it, loss 0.460990
Finished training it 60416/76743 of epoch 0, 124.12 ms/it, loss 0.461036
rank 0 ranking from least wide range to the widest range [ 8 21 18 22 16 13  4 19 17  2 24  5 15 23  0  1  3  6  7 11 12 20 25  9
 14 10]
Finished training it 60416/76743 of epoch 0, 123.77 ms/it, loss 0.457602
Finished training it 60416/76743 of epoch 0, 123.84 ms/it, loss 0.460142
rank 0 ranking from least wide range to the widest range [ 8 19 13  4 21 17  0  2 15  7 24 23 22  1 11  5  3 18 16 20  9 14 25  6
 12 10]
Finished training it 61440/76743 of epoch 0, 126.92 ms/it, loss 0.458651
Finished training it 61440/76743 of epoch 0, 126.92 ms/it, loss 0.458388
Finished training it 61440/76743 of epoch 0, 126.65 ms/it, loss 0.459594
Finished training it 61440/76743 of epoch 0, 126.95 ms/it, loss 0.461695
Testing at - 61440/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2560604.0
get out
0 has test check 2560604.0 and sample count 3273728
 accuracy 78.217 %, best 78.217 %, roc auc score 0.7883, best 0.7883
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2560641.0
get out
3 has test check 2560641.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 128.73 ms/it, loss 0.460837
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [21  8 19 13 24  4 16 18  7  1 22 23 17  5  2 15  0  6 11  3 20 12  9 25
 14 10]
Finished training it 62464/76743 of epoch 0, 129.12 ms/it, loss 0.458027
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2560528.0
get out
1 has test check 2560528.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 129.51 ms/it, loss 0.460986
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2560688.0
get out
2 has test check 2560688.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 128.93 ms/it, loss 0.461798
Finished training it 63488/76743 of epoch 0, 125.58 ms/it, loss 0.461130
rank 0 ranking from least wide range to the widest range [ 8 21 18 15 16 19 13 23  2  4 17  7  5  0 22 24  1  6  3 11 20 12 14  9
 25 10]
Finished training it 63488/76743 of epoch 0, 125.88 ms/it, loss 0.460828
Finished training it 63488/76743 of epoch 0, 126.26 ms/it, loss 0.460665
Finished training it 63488/76743 of epoch 0, 125.95 ms/it, loss 0.460524
Finished training it 64512/76743 of epoch 0, 126.62 ms/it, loss 0.460356
Finished training it 64512/76743 of epoch 0, 126.81 ms/it, loss 0.460645
Finished training it 64512/76743 of epoch 0, 126.85 ms/it, loss 0.462026
rank 0 ranking from least wide range to the widest range [ 8 21 17 23  1 18 24 19 22 15  2  4 13  3 16 11  0  7  5 20  6 12 25 14
 10  9]
Finished training it 64512/76743 of epoch 0, 126.92 ms/it, loss 0.459280
rank 0 ranking from least wide range to the widest range [21  8 16  4 17 22 15 23 13 18  1  2 19 24  5  3  7 11 20  6  0 12  9 25
 14 10]
Finished training it 65536/76743 of epoch 0, 126.08 ms/it, loss 0.460284
Finished training it 65536/76743 of epoch 0, 125.69 ms/it, loss 0.461504
Finished training it 65536/76743 of epoch 0, 126.03 ms/it, loss 0.459151
Finished training it 65536/76743 of epoch 0, 126.03 ms/it, loss 0.460243
rank 0 ranking from least wide range to the widest range [ 8 17 24 13 19 23 22 21 16  1 15  4  2  0  7 18  3  5 20 11 12  6 14 25
  9 10]
Finished training it 66560/76743 of epoch 0, 125.60 ms/it, loss 0.459561
Finished training it 66560/76743 of epoch 0, 126.05 ms/it, loss 0.459246
Finished training it 66560/76743 of epoch 0, 125.33 ms/it, loss 0.457793
Finished training it 66560/76743 of epoch 0, 125.65 ms/it, loss 0.461743
rank 0 ranking from least wide range to the widest range [21  8 24 19 17 18  0  1 13 15 16  2 23  4  3 22  5  7 11 20  9  6 12 25
 14 10]
Finished training it 67584/76743 of epoch 0, 122.79 ms/it, loss 0.459385
Finished training it 67584/76743 of epoch 0, 122.57 ms/it, loss 0.459079
Finished training it 67584/76743 of epoch 0, 123.29 ms/it, loss 0.460418
Finished training it 67584/76743 of epoch 0, 123.13 ms/it, loss 0.461024
rank 0 ranking from least wide range to the widest range [ 8 17 18 15 21 19 23  2  1  5 24 11 22 20  0 16  3  4 13  6  7 12 14 10
 25  9]
Finished training it 68608/76743 of epoch 0, 128.41 ms/it, loss 0.456861
Finished training it 68608/76743 of epoch 0, 128.01 ms/it, loss 0.460141
Finished training it 68608/76743 of epoch 0, 128.56 ms/it, loss 0.459681
Finished training it 68608/76743 of epoch 0, 128.37 ms/it, loss 0.461025
rank 0 ranking from least wide range to the widest range [ 8 21 18  0 23 15 17 19  4 22  2 13 24  7 16  1  3 20 11  5 12  6 14 25
  9 10]
Finished training it 69632/76743 of epoch 0, 126.51 ms/it, loss 0.458960
Finished training it 69632/76743 of epoch 0, 125.95 ms/it, loss 0.459275
Finished training it 69632/76743 of epoch 0, 126.30 ms/it, loss 0.461028
Finished training it 69632/76743 of epoch 0, 126.36 ms/it, loss 0.460002
Finished training it 70656/76743 of epoch 0, 123.84 ms/it, loss 0.459900
rank 0 ranking from least wide range to the widest range [21 15 17 18  0 19  1  8 24  2 23  7  4 13  5 20 22 16 11  3  6 12 25 14
  9 10]
Finished training it 70656/76743 of epoch 0, 124.40 ms/it, loss 0.462906
Finished training it 70656/76743 of epoch 0, 124.29 ms/it, loss 0.458695
Finished training it 70656/76743 of epoch 0, 124.08 ms/it, loss 0.458437
rank 0 ranking from least wide range to the widest range [ 8  1 21 16 23 17 22 15  4  5 18  2  0 13 19 24 20 11  3  7  6 12 14 25
 10  9]
Finished training it 71680/76743 of epoch 0, 124.88 ms/it, loss 0.459258
Finished training it 71680/76743 of epoch 0, 124.48 ms/it, loss 0.457397
Finished training it 71680/76743 of epoch 0, 125.45 ms/it, loss 0.459233
Finished training it 71680/76743 of epoch 0, 124.68 ms/it, loss 0.458710
Testing at - 71680/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2561802.0
get out
0 has test check 2561802.0 and sample count 3273728
 accuracy 78.253 %, best 78.253 %, roc auc score 0.7892, best 0.7892
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 8  1 21 15 17  4 23  2  0 22 16 19 24  7 18 20  3 13 11  5  6 14 12 25
  9 10]
Finished training it 72704/76743 of epoch 0, 128.08 ms/it, loss 0.456649
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2561503.0
get out
3 has test check 2561503.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 127.78 ms/it, loss 0.458464
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2561703.0
get out
2 has test check 2561703.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 128.22 ms/it, loss 0.457000
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2561415.0
get out
1 has test check 2561415.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 128.29 ms/it, loss 0.457249
rank 0 ranking from least wide range to the widest range [19  8  1 18 22 15  2 21  0 24 16 23 17  4 13 20 11  3  7  6 25  5 12 14
  9 10]
Finished training it 73728/76743 of epoch 0, 125.86 ms/it, loss 0.457209
Finished training it 73728/76743 of epoch 0, 125.49 ms/it, loss 0.457559
Finished training it 73728/76743 of epoch 0, 125.91 ms/it, loss 0.459261
Finished training it 73728/76743 of epoch 0, 125.96 ms/it, loss 0.460603
rank 0 ranking from least wide range to the widest range [18 15  2  1 23  8  0 17 24 21 22 11 20  3  7 16 19  5 13 12  4  6 14 25
 10  9]
Finished training it 74752/76743 of epoch 0, 130.26 ms/it, loss 0.457006
Finished training it 74752/76743 of epoch 0, 129.79 ms/it, loss 0.459806
Finished training it 74752/76743 of epoch 0, 130.23 ms/it, loss 0.459513
Finished training it 74752/76743 of epoch 0, 130.37 ms/it, loss 0.457490
Finished training it 75776/76743 of epoch 0, 126.08 ms/it, loss 0.455394
Finished training it 75776/76743 of epoch 0, 126.90 ms/it, loss 0.459110
rank 0 ranking from least wide range to the widest range [ 1  0 18 22 16 17 23 15  2  5  7  8 21 24 19  3 20 13  6  4 12 11 14 25
 10  9]
Finished training it 75776/76743 of epoch 0, 126.38 ms/it, loss 0.460122
Finished training it 75776/76743 of epoch 0, 126.58 ms/it, loss 0.459615
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 128.94 ms/it, loss 0.457787
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [ 0  8 21 18 22  1 17  4 23  2 15 19 16 24  5 20  3 11 13  6  7 12 25  9
 14 10]
Finished training it 1024/76743 of epoch 1, 129.67 ms/it, loss 0.460127
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 129.56 ms/it, loss 0.457374
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 129.49 ms/it, loss 0.455875
rank 0 ranking from least wide range to the widest range [ 8 21 18 16 22 13 24  0  1 19 15 17  7 23  2  5  4 11 20  3  6 12 25 14
  9 10]
Finished training it 2048/76743 of epoch 1, 127.85 ms/it, loss 0.459829
Finished training it 2048/76743 of epoch 1, 127.82 ms/it, loss 0.460498
Finished training it 2048/76743 of epoch 1, 127.83 ms/it, loss 0.458757
Finished training it 2048/76743 of epoch 1, 127.32 ms/it, loss 0.456529
rank 0 ranking from least wide range to the widest range [ 8 18 17 21 15 23 22  2  7 24 16 19  5 13  1  3  0 11  4 20  6 12 25 14
 10  9]
Finished training it 3072/76743 of epoch 1, 125.55 ms/it, loss 0.455392
Finished training it 3072/76743 of epoch 1, 124.86 ms/it, loss 0.456250
Finished training it 3072/76743 of epoch 1, 124.39 ms/it, loss 0.459296
Finished training it 3072/76743 of epoch 1, 125.04 ms/it, loss 0.459626
rank 0 ranking from least wide range to the widest range [ 8 21 18 22  1 16 23 15 19 17 24  0  2 13  7  3 20  6  5  4 11 12 25  9
 14 10]
Finished training it 4096/76743 of epoch 1, 124.96 ms/it, loss 0.459797
Finished training it 4096/76743 of epoch 1, 124.96 ms/it, loss 0.457816
Finished training it 4096/76743 of epoch 1, 124.97 ms/it, loss 0.457637
Finished training it 4096/76743 of epoch 1, 125.09 ms/it, loss 0.456273
rank 0 ranking from least wide range to the widest range [21 19 22 24 23 15  8  1 18  2  0  7 17 16  5  4  3 13 20 11  6 12 14 25
  9 10]
Finished training it 5120/76743 of epoch 1, 124.89 ms/it, loss 0.457544
Finished training it 5120/76743 of epoch 1, 124.93 ms/it, loss 0.458309
Finished training it 5120/76743 of epoch 1, 125.54 ms/it, loss 0.459256
Finished training it 5120/76743 of epoch 1, 124.62 ms/it, loss 0.458828
Finished training it 6144/76743 of epoch 1, 126.24 ms/it, loss 0.456300
Finished training it 6144/76743 of epoch 1, 126.56 ms/it, loss 0.457609
rank 0 ranking from least wide range to the widest range [ 8 18 15 21 22 23 13  2  5  1 19 24 16  0  7 17 20  3 11  4  6 12 25  9
 14 10]
Finished training it 6144/76743 of epoch 1, 126.55 ms/it, loss 0.458078
Finished training it 6144/76743 of epoch 1, 127.24 ms/it, loss 0.461670
Finished training it 7168/76743 of epoch 1, 124.06 ms/it, loss 0.456501
rank 0 ranking from least wide range to the widest range [21  1 24  0 17 18  7 16  8 15 22 13 23 19  2  4  5  3 11 20  6 12 25 14
  9 10]
Finished training it 7168/76743 of epoch 1, 124.46 ms/it, loss 0.458987
Finished training it 7168/76743 of epoch 1, 124.48 ms/it, loss 0.455140
Finished training it 7168/76743 of epoch 1, 124.52 ms/it, loss 0.457553
rank 0 ranking from least wide range to the widest range [15  0 18  2 17 23  8  5  1 21 13 22 11 20 16  7  6  3 19 24  4 12 14  9
 25 10]
Finished training it 8192/76743 of epoch 1, 125.77 ms/it, loss 0.457017
Finished training it 8192/76743 of epoch 1, 124.93 ms/it, loss 0.456001
Finished training it 8192/76743 of epoch 1, 125.94 ms/it, loss 0.462216
Finished training it 8192/76743 of epoch 1, 125.63 ms/it, loss 0.458516
rank 0 ranking from least wide range to the widest range [21  1 22 17 19 15  2 24  8  7 23 18 20  3  5 11 13  6 12 16  0  4  9 25
 14 10]
Finished training it 9216/76743 of epoch 1, 128.79 ms/it, loss 0.456987
Finished training it 9216/76743 of epoch 1, 129.64 ms/it, loss 0.455362
Finished training it 9216/76743 of epoch 1, 128.96 ms/it, loss 0.459100
Finished training it 9216/76743 of epoch 1, 128.55 ms/it, loss 0.455192
rank 0 ranking from least wide range to the widest range [17  8  0 23 21  2  1 15 18 16  7 22 24 13 20 11  3 12  6  5 19  4 25  9
 14 10]
Finished training it 10240/76743 of epoch 1, 123.31 ms/it, loss 0.459247
Finished training it 10240/76743 of epoch 1, 123.87 ms/it, loss 0.457706
Finished training it 10240/76743 of epoch 1, 122.86 ms/it, loss 0.456855
Finished training it 10240/76743 of epoch 1, 123.18 ms/it, loss 0.456567
Testing at - 10240/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2564425.0
get out
0 has test check 2564425.0 and sample count 3273728
 accuracy 78.333 %, best 78.333 %, roc auc score 0.7904, best 0.7904
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16  8 21 24 15 19 23  2  1  5 22  0 18 17 20 11  3 12  7  6 13  4 25  9
 10 14]
Finished training it 11264/76743 of epoch 1, 123.88 ms/it, loss 0.456378
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2564454.0
get out
3 has test check 2564454.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 123.54 ms/it, loss 0.458145
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2564253.0
get out
2 has test check 2564253.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 123.76 ms/it, loss 0.459325
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2564518.0
get out
1 has test check 2564518.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 123.82 ms/it, loss 0.459929
rank 0 ranking from least wide range to the widest range [ 8  0 21 17 22 24 16 19 15  1  2 23  5 13 11 20  3 12  7 18  6  4 25 14
  9 10]
Finished training it 12288/76743 of epoch 1, 127.25 ms/it, loss 0.456581
Finished training it 12288/76743 of epoch 1, 126.90 ms/it, loss 0.458467
Finished training it 12288/76743 of epoch 1, 127.19 ms/it, loss 0.456668
Finished training it 12288/76743 of epoch 1, 127.43 ms/it, loss 0.457099
Finished training it 13312/76743 of epoch 1, 125.61 ms/it, loss 0.457651
Finished training it 13312/76743 of epoch 1, 126.20 ms/it, loss 0.457899
rank 0 ranking from least wide range to the widest range [21 15  1  2  8 24 23 22 17 13 16  5 18 19 20  3  7 11  6  0 12  4 25  9
 14 10]
Finished training it 13312/76743 of epoch 1, 125.96 ms/it, loss 0.458972
Finished training it 13312/76743 of epoch 1, 125.99 ms/it, loss 0.459183
Finished training it 14336/76743 of epoch 1, 127.38 ms/it, loss 0.456516
Finished training it 14336/76743 of epoch 1, 127.86 ms/it, loss 0.457558
rank 0 ranking from least wide range to the widest range [18 15 22 21  2 23 13  1  8  5 17 16 11 19  0  3 20 24  7 12  6  9  4 25
 14 10]
Finished training it 14336/76743 of epoch 1, 127.79 ms/it, loss 0.457047
Finished training it 14336/76743 of epoch 1, 127.74 ms/it, loss 0.457306
rank 0 ranking from least wide range to the widest range [18  0 22 21  8 16 15 23 17  1  2 19 24  5 12  7 13 11  6 20  3  4 25 10
 14  9]
Finished training it 15360/76743 of epoch 1, 128.52 ms/it, loss 0.457475
Finished training it 15360/76743 of epoch 1, 127.84 ms/it, loss 0.459552
Finished training it 15360/76743 of epoch 1, 128.21 ms/it, loss 0.455771
Finished training it 15360/76743 of epoch 1, 128.66 ms/it, loss 0.458025
rank 0 ranking from least wide range to the widest range [17 18 15  8  1  2 21  0 13 23 22 11 20 24  3 16 19  5 12  7 25  6  9  4
 14 10]
Finished training it 16384/76743 of epoch 1, 129.20 ms/it, loss 0.458887
Finished training it 16384/76743 of epoch 1, 128.85 ms/it, loss 0.455001
Finished training it 16384/76743 of epoch 1, 129.27 ms/it, loss 0.457823
Finished training it 16384/76743 of epoch 1, 129.83 ms/it, loss 0.454247
rank 0 ranking from least wide range to the widest range [18  8 17  0 22  1 21 23 16 15  5  2 13 24  7 20 11  3 12 19  6  4 25 14
  9 10]
Finished training it 17408/76743 of epoch 1, 124.06 ms/it, loss 0.455404
Finished training it 17408/76743 of epoch 1, 123.91 ms/it, loss 0.458229
Finished training it 17408/76743 of epoch 1, 124.20 ms/it, loss 0.457931
Finished training it 17408/76743 of epoch 1, 124.00 ms/it, loss 0.454835
rank 0 ranking from least wide range to the widest range [19  8 24 21 17 16 18 22 15 13  5  0  2  1 23  7 12 20  3  4 11  6 25 10
  9 14]
Finished training it 18432/76743 of epoch 1, 126.00 ms/it, loss 0.454059
Finished training it 18432/76743 of epoch 1, 125.94 ms/it, loss 0.456018
Finished training it 18432/76743 of epoch 1, 125.93 ms/it, loss 0.454696
Finished training it 18432/76743 of epoch 1, 126.05 ms/it, loss 0.455129
rank 0 ranking from least wide range to the widest range [ 8 21 17 23 24  1 13 18  2 22 15 19 16  7  5  0  3 12 20 11  6  4 25 10
 14  9]
Finished training it 19456/76743 of epoch 1, 126.09 ms/it, loss 0.455252
Finished training it 19456/76743 of epoch 1, 125.70 ms/it, loss 0.456773
Finished training it 19456/76743 of epoch 1, 126.03 ms/it, loss 0.454032
Finished training it 19456/76743 of epoch 1, 126.27 ms/it, loss 0.451118
Finished training it 20480/76743 of epoch 1, 124.20 ms/it, loss 0.457283
rank 0 ranking from least wide range to the widest range [17 22  1 21 24  8 18 16 23 13  2  5 15  0 19  7  3 20 11  6 12  4 25  9
 10 14]
Finished training it 20480/76743 of epoch 1, 124.92 ms/it, loss 0.457517
Finished training it 20480/76743 of epoch 1, 124.59 ms/it, loss 0.455036
Finished training it 20480/76743 of epoch 1, 124.54 ms/it, loss 0.456135
Testing at - 20480/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2563125.0
get out
0 has test check 2563125.0 and sample count 3273728
 accuracy 78.294 %, best 78.333 %, roc auc score 0.7919, best 0.7919
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 8 15 17 19  1 22 21  2 23 24  0  5 18 16  7 20 11  3 13 12  6  4 25 10
  9 14]
Finished training it 21504/76743 of epoch 1, 127.55 ms/it, loss 0.458258
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2563327.0
get out
3 has test check 2563327.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 127.06 ms/it, loss 0.458464
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2563132.0
get out
2 has test check 2563132.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 128.19 ms/it, loss 0.458870
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2562671.0
get out
1 has test check 2562671.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 127.64 ms/it, loss 0.455371
Finished training it 22528/76743 of epoch 1, 126.50 ms/it, loss 0.458922
Finished training it 22528/76743 of epoch 1, 125.90 ms/it, loss 0.454861
Finished training it 22528/76743 of epoch 1, 126.22 ms/it, loss 0.457818
rank 0 ranking from least wide range to the widest range [17 22  0  8 15 23 21 16 13  5  2  7 19 12 24 18  6 20 11  3  4  1 25 14
 10  9]
Finished training it 22528/76743 of epoch 1, 126.31 ms/it, loss 0.457907
Finished training it 23552/76743 of epoch 1, 125.41 ms/it, loss 0.458776
Finished training it 23552/76743 of epoch 1, 125.86 ms/it, loss 0.456957
rank 0 ranking from least wide range to the widest range [ 8 21 16 17 22 24 18 23  1  7 13  4  5 15  2  0  3 20 19 11  6 12 25 10
 14  9]
Finished training it 23552/76743 of epoch 1, 125.81 ms/it, loss 0.455428
Finished training it 23552/76743 of epoch 1, 125.92 ms/it, loss 0.454805
Finished training it 24576/76743 of epoch 1, 123.51 ms/it, loss 0.456705
rank 0 ranking from least wide range to the widest range [ 8 17 22 21 23 15  0 13  2 24  1 19 18  5  7 20 11  3 16  6 12  4  9 25
 14 10]
Finished training it 24576/76743 of epoch 1, 123.83 ms/it, loss 0.456114
Finished training it 24576/76743 of epoch 1, 124.06 ms/it, loss 0.453120
Finished training it 24576/76743 of epoch 1, 123.99 ms/it, loss 0.455622
Finished training it 25600/76743 of epoch 1, 126.32 ms/it, loss 0.456215
Finished training it 25600/76743 of epoch 1, 126.70 ms/it, loss 0.458388
rank 0 ranking from least wide range to the widest range [ 8 22 21 17  7 16 23 13  2 15  5 24  1  4 20  3 19 11  6 18  0 12 25  9
 10 14]
Finished training it 25600/76743 of epoch 1, 126.68 ms/it, loss 0.454971
Finished training it 25600/76743 of epoch 1, 127.15 ms/it, loss 0.457330
rank 0 ranking from least wide range to the widest range [16 21 13 22 17  1  0 23  2  8 19  5 15  4  7 24 20  3 11 18  6 12 25 14
 10  9]
Finished training it 26624/76743 of epoch 1, 128.28 ms/it, loss 0.454739
Finished training it 26624/76743 of epoch 1, 127.89 ms/it, loss 0.459129
Finished training it 26624/76743 of epoch 1, 128.23 ms/it, loss 0.456587
Finished training it 26624/76743 of epoch 1, 128.47 ms/it, loss 0.454453
Finished training it 27648/76743 of epoch 1, 127.34 ms/it, loss 0.456206
rank 0 ranking from least wide range to the widest range [16  8 21 19  1 17 24 23  2  0  7 12 18 15  5 22  6 11  3 13 20  4 25  9
 10 14]
Finished training it 27648/76743 of epoch 1, 127.80 ms/it, loss 0.457047
Finished training it 27648/76743 of epoch 1, 128.03 ms/it, loss 0.452302
Finished training it 27648/76743 of epoch 1, 127.79 ms/it, loss 0.455603
rank 0 ranking from least wide range to the widest range [21 16 17 22 19 18 24  8 23  1 13  2  5 15  0  7  4 20 11  3  6 12 25 14
 10  9]
Finished training it 28672/76743 of epoch 1, 125.74 ms/it, loss 0.454479
Finished training it 28672/76743 of epoch 1, 125.34 ms/it, loss 0.456767
Finished training it 28672/76743 of epoch 1, 125.66 ms/it, loss 0.453799
Finished training it 28672/76743 of epoch 1, 125.65 ms/it, loss 0.457272
rank 0 ranking from least wide range to the widest range [ 8 21 13 15 22 16  2 23  0  1 17  5 24 11 20  3  7 19  6 18  4 12 25 10
  9 14]
Finished training it 29696/76743 of epoch 1, 128.73 ms/it, loss 0.457147
Finished training it 29696/76743 of epoch 1, 128.54 ms/it, loss 0.453021
Finished training it 29696/76743 of epoch 1, 129.18 ms/it, loss 0.458283
Finished training it 29696/76743 of epoch 1, 128.53 ms/it, loss 0.457696
rank 0 ranking from least wide range to the widest range [17 22 23  2 15  1  0 16 18 21  8 13 12 19  5  6 20  3 24 11  7  4 25  9
 10 14]
Finished training it 30720/76743 of epoch 1, 128.12 ms/it, loss 0.456247
Finished training it 30720/76743 of epoch 1, 127.75 ms/it, loss 0.456811
Finished training it 30720/76743 of epoch 1, 128.66 ms/it, loss 0.459259
Finished training it 30720/76743 of epoch 1, 128.23 ms/it, loss 0.457654
Testing at - 30720/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2553725.0
get out
0 has test check 2553725.0 and sample count 3273728
 accuracy 78.007 %, best 78.333 %, roc auc score 0.7918, best 0.7919
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 17  8  7 22 24  5  0  1 21 15 23 13  4  2 19 18 12  3 20 11  6 25  9
 10 14]
Finished training it 31744/76743 of epoch 1, 133.78 ms/it, loss 0.454615
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2553995.0
get out
3 has test check 2553995.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 133.34 ms/it, loss 0.455040
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2553615.0
get out
1 has test check 2553615.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 134.13 ms/it, loss 0.458760
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2553511.0
get out
2 has test check 2553511.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 130.13 ms/it, loss 0.459213
rank 0 ranking from least wide range to the widest range [17 24 16 21 18  0  8 22 19 13  1  2  5 15  7 23  6 11 12  4 20  3 25  9
 10 14]
Finished training it 32768/76743 of epoch 1, 126.17 ms/it, loss 0.454879
Finished training it 32768/76743 of epoch 1, 126.22 ms/it, loss 0.456445
Finished training it 32768/76743 of epoch 1, 126.45 ms/it, loss 0.454198
Finished training it 32768/76743 of epoch 1, 124.33 ms/it, loss 0.455623
rank 0 ranking from least wide range to the widest range [17 15  1  2 23 16 13 22 24  0  5  8  7  6 21 19 20 11  3 12  4 18 25 10
  9 14]
Finished training it 33792/76743 of epoch 1, 128.96 ms/it, loss 0.456274
Finished training it 33792/76743 of epoch 1, 128.97 ms/it, loss 0.455530
Finished training it 33792/76743 of epoch 1, 129.12 ms/it, loss 0.455978
Finished training it 33792/76743 of epoch 1, 127.22 ms/it, loss 0.457614
rank 0 ranking from least wide range to the widest range [17  8 16 22  0 21  5  1  4 19 13 18 23 24 12  2  7 15  6  3 20 11 25 10
  9 14]
Finished training it 34816/76743 of epoch 1, 128.97 ms/it, loss 0.456221
Finished training it 34816/76743 of epoch 1, 127.11 ms/it, loss 0.455189
Finished training it 34816/76743 of epoch 1, 128.77 ms/it, loss 0.455219
Finished training it 34816/76743 of epoch 1, 128.36 ms/it, loss 0.458212
Finished training it 35840/76743 of epoch 1, 130.93 ms/it, loss 0.458157
Finished training it 35840/76743 of epoch 1, 132.42 ms/it, loss 0.457456
rank 0 ranking from least wide range to the widest range [17  5 16  8 23 21 13  1  2 22 15 18 24  7 20  3  0  4 19  6 11 12 25 14
 10  9]
Finished training it 35840/76743 of epoch 1, 132.73 ms/it, loss 0.457456
Finished training it 35840/76743 of epoch 1, 132.63 ms/it, loss 0.453851
rank 0 ranking from least wide range to the widest range [17 22 21 23  8  5 15  2 16  1  7  0 24 18 19 20 11  4 13  6  3 12 25 10
 14  9]
Finished training it 36864/76743 of epoch 1, 131.30 ms/it, loss 0.455101
Finished training it 36864/76743 of epoch 1, 131.39 ms/it, loss 0.455361
Finished training it 36864/76743 of epoch 1, 129.55 ms/it, loss 0.453983
Finished training it 36864/76743 of epoch 1, 130.90 ms/it, loss 0.453042
rank 0 ranking from least wide range to the widest range [ 8 17 16 21  1 15 22  2 23 13  7  4  0 24 12  5 18 20  6 11  3 19 25 10
  9 14]
Finished training it 37888/76743 of epoch 1, 131.82 ms/it, loss 0.453982
Finished training it 37888/76743 of epoch 1, 130.95 ms/it, loss 0.455233
Finished training it 37888/76743 of epoch 1, 129.72 ms/it, loss 0.457434
Finished training it 37888/76743 of epoch 1, 131.30 ms/it, loss 0.456437
rank 0 ranking from least wide range to the widest range [17 16  8 13 22 19 24 21 23  7  0  2 18  5  1 12 15  6  4  3 20 11 25 10
  9 14]
Finished training it 38912/76743 of epoch 1, 130.36 ms/it, loss 0.453399
Finished training it 38912/76743 of epoch 1, 128.87 ms/it, loss 0.454886
Finished training it 38912/76743 of epoch 1, 130.13 ms/it, loss 0.455352
Finished training it 38912/76743 of epoch 1, 130.75 ms/it, loss 0.453279
rank 0 ranking from least wide range to the widest range [13  8 15 17 21 16  1  2 22  7  5 23 24 11  0 20  4  3  6 19 18 12 25  9
 14 10]
Finished training it 39936/76743 of epoch 1, 128.57 ms/it, loss 0.455214
Finished training it 39936/76743 of epoch 1, 127.72 ms/it, loss 0.455026
Finished training it 39936/76743 of epoch 1, 128.36 ms/it, loss 0.453156
Finished training it 39936/76743 of epoch 1, 128.40 ms/it, loss 0.454793
rank 0 ranking from least wide range to the widest range [17  8  1 22  7 21 16  0 19 23  5 24  2  4 13 15 20 11  6 12 18  3 25 14
 10  9]
Finished training it 40960/76743 of epoch 1, 131.86 ms/it, loss 0.453122
Finished training it 40960/76743 of epoch 1, 130.70 ms/it, loss 0.458224
Finished training it 40960/76743 of epoch 1, 131.50 ms/it, loss 0.455821
Finished training it 40960/76743 of epoch 1, 131.87 ms/it, loss 0.455408
Testing at - 40960/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567783.0
get out
0 has test check 2567783.0 and sample count 3273728
 accuracy 78.436 %, best 78.436 %, roc auc score 0.7930, best 0.7930
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 8 17 13  0  5 21 23 22 24 15  2  1 18 16  7 12 19  6  4 20 11  3 25 10
 14  9]
Finished training it 41984/76743 of epoch 1, 128.54 ms/it, loss 0.454062
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567822.0
get out
3 has test check 2567822.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 128.37 ms/it, loss 0.453573
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567789.0
get out
2 has test check 2567789.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 128.20 ms/it, loss 0.458150
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567722.0
get out
1 has test check 2567722.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 128.58 ms/it, loss 0.457292
rank 0 ranking from least wide range to the widest range [17  1 15  8 23  2  0 22 21 13  5  4 24 11  7 20 18  3 19 12 16  6 25 14
 10  9]
Finished training it 43008/76743 of epoch 1, 127.66 ms/it, loss 0.453840
Finished training it 43008/76743 of epoch 1, 127.00 ms/it, loss 0.457231
Finished training it 43008/76743 of epoch 1, 127.51 ms/it, loss 0.455604
Finished training it 43008/76743 of epoch 1, 127.23 ms/it, loss 0.456785
rank 0 ranking from least wide range to the widest range [21 17 15 23  2 18  1  8  5 13 24 16 11  7 20 22 12  3  0  6 19  4 25  9
 10 14]
Finished training it 44032/76743 of epoch 1, 128.04 ms/it, loss 0.456669
Finished training it 44032/76743 of epoch 1, 127.25 ms/it, loss 0.456108
Finished training it 44032/76743 of epoch 1, 127.53 ms/it, loss 0.454513
Finished training it 44032/76743 of epoch 1, 127.24 ms/it, loss 0.452956
rank 0 ranking from least wide range to the widest range [ 1 18 15  8 16 17  5 22  2 24  7 19 23 13 20  6 11  4  0 21 12  3 25  9
 14 10]
Finished training it 45056/76743 of epoch 1, 129.01 ms/it, loss 0.453653
Finished training it 45056/76743 of epoch 1, 129.17 ms/it, loss 0.454528
Finished training it 45056/76743 of epoch 1, 128.50 ms/it, loss 0.455544
Finished training it 45056/76743 of epoch 1, 128.44 ms/it, loss 0.455743
rank 0 ranking from least wide range to the widest range [17  8 16  1 23 13  2 21 15 24  7 12  5  4 22  0  6 20 19  3 11 18 25 10
  9 14]
Finished training it 46080/76743 of epoch 1, 127.80 ms/it, loss 0.453756
Finished training it 46080/76743 of epoch 1, 127.15 ms/it, loss 0.457619
Finished training it 46080/76743 of epoch 1, 127.04 ms/it, loss 0.456139
Finished training it 46080/76743 of epoch 1, 127.60 ms/it, loss 0.454716
rank 0 ranking from least wide range to the widest range [ 8 17  2 23 13 21 15  1 16  4  0  5  7 22 20 11 18 12  6 24  3 19 25  9
 10 14]
Finished training it 47104/76743 of epoch 1, 129.76 ms/it, loss 0.458243
Finished training it 47104/76743 of epoch 1, 129.73 ms/it, loss 0.452992
Finished training it 47104/76743 of epoch 1, 129.42 ms/it, loss 0.454243
Finished training it 47104/76743 of epoch 1, 129.88 ms/it, loss 0.454915
rank 0 ranking from least wide range to the widest range [ 8 21 16 17 24 15 22 23  1  2 13 18 19 11  6 20 12  5  0  3  7  4 25  9
 10 14]
Finished training it 48128/76743 of epoch 1, 128.60 ms/it, loss 0.455958
Finished training it 48128/76743 of epoch 1, 128.27 ms/it, loss 0.453913
Finished training it 48128/76743 of epoch 1, 128.93 ms/it, loss 0.451795
Finished training it 48128/76743 of epoch 1, 128.37 ms/it, loss 0.455486
Finished training it 49152/76743 of epoch 1, 126.69 ms/it, loss 0.454584
Finished training it 49152/76743 of epoch 1, 126.63 ms/it, loss 0.455849
rank 0 ranking from least wide range to the widest range [ 1 22 13 17  8 21 23 15 18  7  2  5 16  0 19  4 20 11 24  3  6 12 25  9
 14 10]
Finished training it 49152/76743 of epoch 1, 127.02 ms/it, loss 0.453945
Finished training it 49152/76743 of epoch 1, 127.05 ms/it, loss 0.455932
Finished training it 50176/76743 of epoch 1, 128.27 ms/it, loss 0.456061
Finished training it 50176/76743 of epoch 1, 128.72 ms/it, loss 0.456753
rank 0 ranking from least wide range to the widest range [22 13 17 23 21 24  2 15  8  5  1  0  7 18 19 20  4 11 16  3 12  6 25  9
 10 14]
Finished training it 50176/76743 of epoch 1, 128.56 ms/it, loss 0.458065
Finished training it 50176/76743 of epoch 1, 128.31 ms/it, loss 0.455299
rank 0 ranking from least wide range to the widest range [ 8 19 17  0 15 21  2 24  1 23 22 20 11  5 12  6  7 16 13  4  3 18 25 10
  9 14]
Finished training it 51200/76743 of epoch 1, 126.68 ms/it, loss 0.457064
Finished training it 51200/76743 of epoch 1, 126.58 ms/it, loss 0.453399
Finished training it 51200/76743 of epoch 1, 127.23 ms/it, loss 0.453835
Finished training it 51200/76743 of epoch 1, 126.67 ms/it, loss 0.452688
Testing at - 51200/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567528.0
get out
0 has test check 2567528.0 and sample count 3273728
 accuracy 78.428 %, best 78.436 %, roc auc score 0.7931, best 0.7931
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 8 16 17 15 23  4 22 13  2 21  1  0  7 12  6 20 11  5 24 18 19  3 25 10
  9 14]
Finished training it 52224/76743 of epoch 1, 128.17 ms/it, loss 0.454086
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567227.0
get out
1 has test check 2567227.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 127.89 ms/it, loss 0.454354
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2568020.0
get out
3 has test check 2568020.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 127.79 ms/it, loss 0.453173
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567385.0
get out
2 has test check 2567385.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 127.70 ms/it, loss 0.454538
rank 0 ranking from least wide range to the widest range [ 8 22 13  1 16 18 17 21 15  2 23  5 24 11 20  6  0 19  3  7  4 12 25 14
  9 10]
Finished training it 53248/76743 of epoch 1, 129.81 ms/it, loss 0.453638
Finished training it 53248/76743 of epoch 1, 129.61 ms/it, loss 0.457096
Finished training it 53248/76743 of epoch 1, 130.05 ms/it, loss 0.455527
Finished training it 53248/76743 of epoch 1, 129.47 ms/it, loss 0.457026
rank 0 ranking from least wide range to the widest range [ 8 15 21 22 13 17  1  5 23  0  2 18 16  7 19 12 24  4 11  6 20  3 25  9
 10 14]
Finished training it 54272/76743 of epoch 1, 126.55 ms/it, loss 0.454571
Finished training it 54272/76743 of epoch 1, 126.50 ms/it, loss 0.455850
Finished training it 54272/76743 of epoch 1, 126.12 ms/it, loss 0.452034
Finished training it 54272/76743 of epoch 1, 126.49 ms/it, loss 0.454896
Finished training it 55296/76743 of epoch 1, 129.00 ms/it, loss 0.451459
Finished training it 55296/76743 of epoch 1, 129.68 ms/it, loss 0.454359
Finished training it 55296/76743 of epoch 1, 129.07 ms/it, loss 0.452987
rank 0 ranking from least wide range to the widest range [ 8 16 15  1 13 17  2 21 23 22 19  0  5 20 11 24  7 12  4  3  6 18 25 10
 14  9]
Finished training it 55296/76743 of epoch 1, 129.37 ms/it, loss 0.455064
Finished training it 56320/76743 of epoch 1, 128.22 ms/it, loss 0.452157
Finished training it 56320/76743 of epoch 1, 127.89 ms/it, loss 0.456600
Finished training it 56320/76743 of epoch 1, 129.43 ms/it, loss 0.454128
rank 0 ranking from least wide range to the widest range [ 8 13  1  5 21 16 17  4 22 15 23  2 24 12 20  7 11  6 19 18  3  0 25 10
  9 14]
Finished training it 56320/76743 of epoch 1, 128.39 ms/it, loss 0.454857
rank 0 ranking from least wide range to the widest range [21 22 15  8  2 13 23 20 11 17  1 18 16  0 19  4  5  3  7 12 24  6 25  9
 14 10]
Finished training it 57344/76743 of epoch 1, 123.47 ms/it, loss 0.455139
Finished training it 57344/76743 of epoch 1, 123.45 ms/it, loss 0.453951
Finished training it 57344/76743 of epoch 1, 123.41 ms/it, loss 0.452512
Finished training it 57344/76743 of epoch 1, 123.43 ms/it, loss 0.456605
rank 0 ranking from least wide range to the widest range [ 8 16 13 21 15  1 19 24  4 22 17 23  0  2  5 18 11  7 12 20  3  6 25  9
 10 14]
Finished training it 58368/76743 of epoch 1, 128.15 ms/it, loss 0.452477
Finished training it 58368/76743 of epoch 1, 128.04 ms/it, loss 0.457111
Finished training it 58368/76743 of epoch 1, 127.82 ms/it, loss 0.455979
Finished training it 58368/76743 of epoch 1, 128.18 ms/it, loss 0.456141
Finished training it 59392/76743 of epoch 1, 125.94 ms/it, loss 0.454113
rank 0 ranking from least wide range to the widest range [ 8  1 22 16 17 15 24  2 23 13  0  5 21  7 19 18  6 20 11 12  3  4 25  9
 10 14]
Finished training it 59392/76743 of epoch 1, 126.45 ms/it, loss 0.455896
Finished training it 59392/76743 of epoch 1, 126.21 ms/it, loss 0.456005
Finished training it 59392/76743 of epoch 1, 126.14 ms/it, loss 0.451158
rank 0 ranking from least wide range to the widest range [16  8 21 13 18 22  2 17  5  4 24 23  1 15  0 12  7 19  6 20 11  3 25 10
  9 14]
Finished training it 60416/76743 of epoch 1, 126.85 ms/it, loss 0.451714
Finished training it 60416/76743 of epoch 1, 126.70 ms/it, loss 0.454537
Finished training it 60416/76743 of epoch 1, 126.59 ms/it, loss 0.455057
Finished training it 60416/76743 of epoch 1, 127.57 ms/it, loss 0.455376
rank 0 ranking from least wide range to the widest range [ 8 13 19  5 17 15  1 22  0  4 21  2  7 23 16 24 11 20 18  6  3 12 25  9
 14 10]
Finished training it 61440/76743 of epoch 1, 128.24 ms/it, loss 0.452897
Finished training it 61440/76743 of epoch 1, 127.94 ms/it, loss 0.454114
Finished training it 61440/76743 of epoch 1, 127.83 ms/it, loss 0.452870
Finished training it 61440/76743 of epoch 1, 128.59 ms/it, loss 0.456061
Testing at - 61440/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2569471.0
get out
0 has test check 2569471.0 and sample count 3273728
 accuracy 78.488 %, best 78.488 %, roc auc score 0.7939, best 0.7939
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 8 13 21  4 16 18 22  1  7  0  5 19 24 15 17 23 12  2  6 20 11  3 25  9
 10 14]
Finished training it 62464/76743 of epoch 1, 129.35 ms/it, loss 0.452292
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2569501.0
get out
3 has test check 2569501.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 128.72 ms/it, loss 0.455282
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2569479.0
get out
2 has test check 2569479.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 128.73 ms/it, loss 0.455773
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2569507.0
get out
1 has test check 2569507.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 129.35 ms/it, loss 0.455260
Finished training it 63488/76743 of epoch 1, 128.49 ms/it, loss 0.454693
rank 0 ranking from least wide range to the widest range [ 8 16 21 13  7 22 15 23  1 17 19 18  2  0  5 24  6 20  4 11  3 12 25  9
 10 14]
Finished training it 63488/76743 of epoch 1, 128.51 ms/it, loss 0.455043
Finished training it 63488/76743 of epoch 1, 128.09 ms/it, loss 0.454446
Finished training it 63488/76743 of epoch 1, 128.19 ms/it, loss 0.455401
rank 0 ranking from least wide range to the widest range [ 8  1 17  0 15 24 16 21 22 23 12  2 18 13  4 19 11 20  6  7  5  3 25 10
 14  9]
Finished training it 64512/76743 of epoch 1, 128.07 ms/it, loss 0.453716
Finished training it 64512/76743 of epoch 1, 127.67 ms/it, loss 0.455803
Finished training it 64512/76743 of epoch 1, 127.70 ms/it, loss 0.454960
Finished training it 64512/76743 of epoch 1, 128.52 ms/it, loss 0.456818
rank 0 ranking from least wide range to the widest range [16 22  8 15 21  4 13 24  2 19 23  1  5 17  7 18 11  6  0 20 12  3 25  9
 10 14]
Finished training it 65536/76743 of epoch 1, 128.39 ms/it, loss 0.454241
Finished training it 65536/76743 of epoch 1, 128.68 ms/it, loss 0.454729
Finished training it 65536/76743 of epoch 1, 128.05 ms/it, loss 0.454587
Finished training it 65536/76743 of epoch 1, 128.26 ms/it, loss 0.456434
Finished training it 66560/76743 of epoch 1, 127.89 ms/it, loss 0.457078
Finished training it 66560/76743 of epoch 1, 127.24 ms/it, loss 0.452716
rank 0 ranking from least wide range to the widest range [ 8 19 24 22 13 16 15  1 18  0 17 21  5  2 12  7 11 23  4  6 20  3 25 10
 14  9]
Finished training it 66560/76743 of epoch 1, 127.64 ms/it, loss 0.453725
Finished training it 66560/76743 of epoch 1, 127.18 ms/it, loss 0.453214
rank 0 ranking from least wide range to the widest range [ 8 21 24  1 13 22 15 23  2 16  5 18  0  7 12 19 11  6 17 20  3  4 25  9
 10 14]
Finished training it 67584/76743 of epoch 1, 129.47 ms/it, loss 0.453892
Finished training it 67584/76743 of epoch 1, 129.05 ms/it, loss 0.455550
Finished training it 67584/76743 of epoch 1, 129.21 ms/it, loss 0.453935
Finished training it 67584/76743 of epoch 1, 129.99 ms/it, loss 0.455181
rank 0 ranking from least wide range to the widest range [ 8 18  1  0 15  2 22 21 24 19 23 17 11 13  6 20 12 16  5  4  3  7 25 10
 14  9]
Finished training it 68608/76743 of epoch 1, 130.36 ms/it, loss 0.451420
Finished training it 68608/76743 of epoch 1, 130.26 ms/it, loss 0.456029
Finished training it 68608/76743 of epoch 1, 130.03 ms/it, loss 0.454995
Finished training it 68608/76743 of epoch 1, 130.43 ms/it, loss 0.454480
rank 0 ranking from least wide range to the widest range [21  8 15  1  0 13  2 23 22 18  4 24 17 20  5 11 12 16  6  7 19  3 25 10
 14  9]
Finished training it 69632/76743 of epoch 1, 128.12 ms/it, loss 0.453686
Finished training it 69632/76743 of epoch 1, 127.54 ms/it, loss 0.456290
Finished training it 69632/76743 of epoch 1, 128.00 ms/it, loss 0.454673
Finished training it 69632/76743 of epoch 1, 127.83 ms/it, loss 0.453896
rank 0 ranking from least wide range to the widest range [ 8 15  1  0 24 22 18 17 19 13  2  5 21 23 11  6 20 16  4 12  3  7 25 10
 14  9]
Finished training it 70656/76743 of epoch 1, 128.71 ms/it, loss 0.457694
Finished training it 70656/76743 of epoch 1, 128.60 ms/it, loss 0.453415
Finished training it 70656/76743 of epoch 1, 128.40 ms/it, loss 0.455219
Finished training it 70656/76743 of epoch 1, 128.25 ms/it, loss 0.453367
Finished training it 71680/76743 of epoch 1, 126.12 ms/it, loss 0.452249
rank 0 ranking from least wide range to the widest range [ 8  1 15 22 16  2 13  5 23  4 17 21 18 24 11 12  7 20  6 19  0  3 25 10
 14  9]
Finished training it 71680/76743 of epoch 1, 126.09 ms/it, loss 0.454259
Finished training it 71680/76743 of epoch 1, 125.99 ms/it, loss 0.454071
Finished training it 71680/76743 of epoch 1, 125.69 ms/it, loss 0.453369
Testing at - 71680/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2566647.0
get out
0 has test check 2566647.0 and sample count 3273728
 accuracy 78.401 %, best 78.488 %, roc auc score 0.7942, best 0.7942
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2566816.0
get out
1 has test check 2566816.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 128.67 ms/it, loss 0.452089
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2566785.0
get out
2 has test check 2566785.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 128.17 ms/it, loss 0.451643
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 8 15 22  0  1 16  4 21  2 23 13 24 19 17  5 18 11  7 20  3  6 25 12 14
 10  9]
Finished training it 72704/76743 of epoch 1, 128.67 ms/it, loss 0.451206
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2566787.0
get out
3 has test check 2566787.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 128.43 ms/it, loss 0.452726
rank 0 ranking from least wide range to the widest range [ 8 19 22  1 15  5 13  0  2 16 23 24 21 18 17 20  6  4 11  7 12 25  3 10
  9 14]
Finished training it 73728/76743 of epoch 1, 127.73 ms/it, loss 0.452452
Finished training it 73728/76743 of epoch 1, 128.25 ms/it, loss 0.455570
Finished training it 73728/76743 of epoch 1, 127.29 ms/it, loss 0.454433
Finished training it 73728/76743 of epoch 1, 127.53 ms/it, loss 0.452902
rank 0 ranking from least wide range to the widest range [15  1  2 23 24 18 17 22  0  8 16 11 20  5 12 19 21  6  4  3 13 25  7 10
 14  9]
Finished training it 74752/76743 of epoch 1, 129.53 ms/it, loss 0.451066
Finished training it 74752/76743 of epoch 1, 128.45 ms/it, loss 0.452173
Finished training it 74752/76743 of epoch 1, 128.69 ms/it, loss 0.454856
Finished training it 74752/76743 of epoch 1, 128.98 ms/it, loss 0.454100
rank 0 ranking from least wide range to the widest range [ 1 16 15 22 18  5  2 23 12 17  0  6  4 24 13 20  8 11 21 19  7 25  3 10
 14  9]
Finished training it 75776/76743 of epoch 1, 138.17 ms/it, loss 0.455085
Finished training it 75776/76743 of epoch 1, 136.51 ms/it, loss 0.453922
Finished training it 75776/76743 of epoch 1, 136.89 ms/it, loss 0.454022
Finished training it 75776/76743 of epoch 1, 136.60 ms/it, loss 0.450312
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 129.09 ms/it, loss 0.451336
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [ 8  4  1  0  5 23  2 16 22 19 15 24 21 18 17  6 20 12 11 25 13  3  7 10
  9 14]
Finished training it 1024/76743 of epoch 2, 129.80 ms/it, loss 0.455715
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 129.78 ms/it, loss 0.452567
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 129.20 ms/it, loss 0.453048
rank 0 ranking from least wide range to the widest range [ 8 18 13 16  0 22 24  5  1  7 21  4 17  2 19 15 12  6 23 11 20 25  3  9
 10 14]
Finished training it 2048/76743 of epoch 2, 126.53 ms/it, loss 0.455314
Finished training it 2048/76743 of epoch 2, 126.07 ms/it, loss 0.456328
Finished training it 2048/76743 of epoch 2, 126.22 ms/it, loss 0.452023
Finished training it 2048/76743 of epoch 2, 126.91 ms/it, loss 0.453997
Finished training it 3072/76743 of epoch 2, 128.84 ms/it, loss 0.455214
Finished training it 3072/76743 of epoch 2, 128.90 ms/it, loss 0.454509
rank 0 ranking from least wide range to the widest range [22 15 16  8 21  5  2  1 19 23  0 24 18 17  6 13 20 11 25  4  7 12  3 10
  9 14]
Finished training it 3072/76743 of epoch 2, 129.25 ms/it, loss 0.450668
Finished training it 3072/76743 of epoch 2, 129.46 ms/it, loss 0.451499
rank 0 ranking from least wide range to the widest range [ 8 16 15 22 21  0 23  2 19 17  1 13  6 18 24 20 11  5  4 12  7 25  3 10
  9 14]
Finished training it 4096/76743 of epoch 2, 126.86 ms/it, loss 0.455487
Finished training it 4096/76743 of epoch 2, 126.46 ms/it, loss 0.453344
Finished training it 4096/76743 of epoch 2, 126.36 ms/it, loss 0.451140
Finished training it 4096/76743 of epoch 2, 126.77 ms/it, loss 0.453170
Finished training it 5120/76743 of epoch 2, 127.13 ms/it, loss 0.454114
rank 0 ranking from least wide range to the widest range [22 15  5  1 21  0  2  8 23 16 24  4 19 18 20 12 17 11 13  6 25  3  7 10
  9 14]
Finished training it 5120/76743 of epoch 2, 127.48 ms/it, loss 0.452965
Finished training it 5120/76743 of epoch 2, 127.27 ms/it, loss 0.454688
Finished training it 5120/76743 of epoch 2, 126.77 ms/it, loss 0.454405
rank 0 ranking from least wide range to the widest range [22  5 18  8 15 13  1  0  2 24 16 17 23 21 19 12  7 11 25 20  6  3  4  9
 10 14]
Finished training it 6144/76743 of epoch 2, 129.33 ms/it, loss 0.453366
Finished training it 6144/76743 of epoch 2, 129.01 ms/it, loss 0.452891
Finished training it 6144/76743 of epoch 2, 129.65 ms/it, loss 0.456959
Finished training it 6144/76743 of epoch 2, 128.95 ms/it, loss 0.451775
Finished training it 7168/76743 of epoch 2, 129.35 ms/it, loss 0.452304
rank 0 ranking from least wide range to the widest range [ 1 15 16  8 21 17  0 13 24 22  7 12 23  2  5  4 19  6 25 18 20 11  3  9
 10 14]
Finished training it 7168/76743 of epoch 2, 129.73 ms/it, loss 0.454291
Finished training it 7168/76743 of epoch 2, 129.53 ms/it, loss 0.450903
Finished training it 7168/76743 of epoch 2, 129.99 ms/it, loss 0.453436
Finished training it 8192/76743 of epoch 2, 126.52 ms/it, loss 0.451722
Finished training it 8192/76743 of epoch 2, 126.79 ms/it, loss 0.453993
rank 0 ranking from least wide range to the widest range [15  5  2 16  1 23 22  6  0  8 13 11 18 20 21 12 17 25  3  4 19 24  7 10
  9 14]
Finished training it 8192/76743 of epoch 2, 126.88 ms/it, loss 0.452750
Finished training it 8192/76743 of epoch 2, 127.45 ms/it, loss 0.458679
Finished training it 9216/76743 of epoch 2, 129.35 ms/it, loss 0.450973
rank 0 ranking from least wide range to the widest range [22  1 15  2  8  5 23 12 19 17 24 21  6 16 18 20 13  7 11  0 25  3  4  9
 10 14]
Finished training it 9216/76743 of epoch 2, 129.59 ms/it, loss 0.453050
Finished training it 9216/76743 of epoch 2, 129.63 ms/it, loss 0.451261
Finished training it 9216/76743 of epoch 2, 129.81 ms/it, loss 0.455028
rank 0 ranking from least wide range to the widest range [ 8 16 22 15  1  2  0 13 12 23 17 18 24  4 20  7  6 11 21 19  5 25  3 10
  9 14]
Finished training it 10240/76743 of epoch 2, 129.34 ms/it, loss 0.454530
Finished training it 10240/76743 of epoch 2, 130.02 ms/it, loss 0.452782
Finished training it 10240/76743 of epoch 2, 129.10 ms/it, loss 0.453193
Finished training it 10240/76743 of epoch 2, 129.00 ms/it, loss 0.452680
Testing at - 10240/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570416.0
get out
0 has test check 2570416.0 and sample count 3273728
 accuracy 78.516 %, best 78.516 %, roc auc score 0.7949, best 0.7949
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16  8  5 15  1 19 24  2 21 23 22 12  0 11 20  6 13 18  7 25  4 17  3 10
  9 14]
Finished training it 11264/76743 of epoch 2, 131.39 ms/it, loss 0.452027
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570626.0
get out
3 has test check 2570626.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 131.00 ms/it, loss 0.453734
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570545.0
get out
2 has test check 2570545.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 131.00 ms/it, loss 0.455359
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570439.0
get out
1 has test check 2570439.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 131.80 ms/it, loss 0.455520
rank 0 ranking from least wide range to the widest range [16 22  8 15  5  0  1 24  2 17 12 21  6 11 23 19 20 13 25 18  4  3  7 10
 14  9]
Finished training it 12288/76743 of epoch 2, 129.10 ms/it, loss 0.452518
Finished training it 12288/76743 of epoch 2, 128.13 ms/it, loss 0.453955
Finished training it 12288/76743 of epoch 2, 128.72 ms/it, loss 0.452332
Finished training it 12288/76743 of epoch 2, 128.51 ms/it, loss 0.452707
rank 0 ranking from least wide range to the widest range [ 8 15  5 21  1 16  0  2 13 22 23 24 12  6 18 20 11 17 25 19  4  7  3 10
  9 14]
Finished training it 13312/76743 of epoch 2, 126.92 ms/it, loss 0.454396
Finished training it 13312/76743 of epoch 2, 126.82 ms/it, loss 0.452828
Finished training it 13312/76743 of epoch 2, 126.95 ms/it, loss 0.454670
Finished training it 13312/76743 of epoch 2, 126.90 ms/it, loss 0.453757
rank 0 ranking from least wide range to the widest range [22  5 13  1 15  8 16  2 18 21  0 12 23  6 11 17 19  7 20 25 24  3  4  9
 10 14]
Finished training it 14336/76743 of epoch 2, 135.70 ms/it, loss 0.452401
Finished training it 14336/76743 of epoch 2, 135.11 ms/it, loss 0.453047
Finished training it 14336/76743 of epoch 2, 135.26 ms/it, loss 0.452048
Finished training it 14336/76743 of epoch 2, 135.50 ms/it, loss 0.452946
rank 0 ranking from least wide range to the widest range [22  8  1 18 16 15  0 19  2  5 12 21 23 13 25  7  6 17  4 24 11 20  3 10
  9 14]
Finished training it 15360/76743 of epoch 2, 129.53 ms/it, loss 0.453570
Finished training it 15360/76743 of epoch 2, 129.44 ms/it, loss 0.454679
Finished training it 15360/76743 of epoch 2, 129.19 ms/it, loss 0.451652
Finished training it 15360/76743 of epoch 2, 130.14 ms/it, loss 0.453370
rank 0 ranking from least wide range to the widest range [ 0 15  8 13 18  5  2  1 22 23 16 12 11 20 25 19 17 21 24  6  7  4  3  9
 10 14]
Finished training it 16384/76743 of epoch 2, 128.01 ms/it, loss 0.454638
Finished training it 16384/76743 of epoch 2, 127.75 ms/it, loss 0.450971
Finished training it 16384/76743 of epoch 2, 127.56 ms/it, loss 0.453506
Finished training it 16384/76743 of epoch 2, 127.87 ms/it, loss 0.450947
Finished training it 17408/76743 of epoch 2, 125.96 ms/it, loss 0.453704
rank 0 ranking from least wide range to the widest range [ 8 22  1 18 15  0 13 17  5 16  2 21 23 12  4  6 25 11  7 24 20 19  3 10
 14  9]
Finished training it 17408/76743 of epoch 2, 126.19 ms/it, loss 0.451703
Finished training it 17408/76743 of epoch 2, 126.00 ms/it, loss 0.450330
Finished training it 17408/76743 of epoch 2, 126.10 ms/it, loss 0.453853
rank 0 ranking from least wide range to the widest range [ 8 22  0 16 19 21 24 13 15 18  5  2 23 12  1 20  6 11  7  4 25 17  3 10
  9 14]
Finished training it 18432/76743 of epoch 2, 127.48 ms/it, loss 0.449607
Finished training it 18432/76743 of epoch 2, 126.53 ms/it, loss 0.450388
Finished training it 18432/76743 of epoch 2, 126.69 ms/it, loss 0.451643
Finished training it 18432/76743 of epoch 2, 126.86 ms/it, loss 0.450390
rank 0 ranking from least wide range to the widest range [ 8 15  2  1 13 19  0  5 23 24 22 16 20 18 11  6 25 12 21  7  4 17  3 10
  9 14]
Finished training it 19456/76743 of epoch 2, 129.39 ms/it, loss 0.451302
Finished training it 19456/76743 of epoch 2, 128.87 ms/it, loss 0.446978
Finished training it 19456/76743 of epoch 2, 129.14 ms/it, loss 0.450049
Finished training it 19456/76743 of epoch 2, 128.93 ms/it, loss 0.452885
Finished training it 20480/76743 of epoch 2, 127.49 ms/it, loss 0.453323
rank 0 ranking from least wide range to the widest range [22  8 21  5  1 18 15  0 16 24 19  2 25 17 23 13  6 20  7 11  4 12  3 10
  9 14]
Finished training it 20480/76743 of epoch 2, 127.45 ms/it, loss 0.453692
Finished training it 20480/76743 of epoch 2, 127.30 ms/it, loss 0.451856
Finished training it 20480/76743 of epoch 2, 128.04 ms/it, loss 0.451638
Testing at - 20480/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570494.0
get out
0 has test check 2570494.0 and sample count 3273728
 accuracy 78.519 %, best 78.519 %, roc auc score 0.7956, best 0.7956
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570309.0
get out
2 has test check 2570309.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 127.51 ms/it, loss 0.455212
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [22 19  5 15  1 21 16  2  8  0 18 23  6 12 24  7 17 11 13 20 25  4  3 10
  9 14]
Finished training it 21504/76743 of epoch 2, 127.96 ms/it, loss 0.454749
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570463.0
get out
3 has test check 2570463.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 127.89 ms/it, loss 0.454815
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570577.0
get out
1 has test check 2570577.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 128.49 ms/it, loss 0.451903
rank 0 ranking from least wide range to the widest range [22  8 16  5 13 15  0 18 23 12  2 21 19 17 24  1  7  6 20 11 25  4  3 14
 10  9]
Finished training it 22528/76743 of epoch 2, 130.66 ms/it, loss 0.454304
Finished training it 22528/76743 of epoch 2, 130.65 ms/it, loss 0.454454
Finished training it 22528/76743 of epoch 2, 130.28 ms/it, loss 0.455377
Finished training it 22528/76743 of epoch 2, 130.50 ms/it, loss 0.451453
rank 0 ranking from least wide range to the widest range [ 8 16 22  5  1 18  0 15 23  2 13 21  6  4 20 24 12  7 25 17 11  3 19 10
 14  9]
Finished training it 23552/76743 of epoch 2, 126.72 ms/it, loss 0.452019
Finished training it 23552/76743 of epoch 2, 126.45 ms/it, loss 0.453170
Finished training it 23552/76743 of epoch 2, 126.36 ms/it, loss 0.455199
Finished training it 23552/76743 of epoch 2, 126.71 ms/it, loss 0.451529
rank 0 ranking from least wide range to the widest range [ 8 22  0 15  2 18  1  6 23 19  5 21 13 11 12 24 20  4 17 16 25  7  3  9
 10 14]
Finished training it 24576/76743 of epoch 2, 121.58 ms/it, loss 0.452567
Finished training it 24576/76743 of epoch 2, 121.13 ms/it, loss 0.453111
Finished training it 24576/76743 of epoch 2, 121.21 ms/it, loss 0.449340
Finished training it 24576/76743 of epoch 2, 121.53 ms/it, loss 0.452322
Finished training it 25600/76743 of epoch 2, 123.49 ms/it, loss 0.452155
rank 0 ranking from least wide range to the widest range [16 22  0 15  8  2  5 21 23 13 18  1 20  7  6  4 11 12 24 19 25 17  3 10
  9 14]
Finished training it 25600/76743 of epoch 2, 123.89 ms/it, loss 0.451714
Finished training it 25600/76743 of epoch 2, 123.83 ms/it, loss 0.453158
Finished training it 25600/76743 of epoch 2, 123.57 ms/it, loss 0.454796
Finished training it 26624/76743 of epoch 2, 126.97 ms/it, loss 0.455344
rank 0 ranking from least wide range to the widest range [16 22  0 13  8  5 21 15  1  2 17 23  4 18 12  7  6 20 19 24 25 11  3 14
 10  9]
Finished training it 26624/76743 of epoch 2, 127.16 ms/it, loss 0.451143
Finished training it 26624/76743 of epoch 2, 127.23 ms/it, loss 0.450456
Finished training it 26624/76743 of epoch 2, 126.92 ms/it, loss 0.452511
rank 0 ranking from least wide range to the widest range [16  1 18  8 19 12 24 21  5 17  2 15  0 22  6 23 25 20  7 13  4 11  3 10
  9 14]
Finished training it 27648/76743 of epoch 2, 127.34 ms/it, loss 0.452895
Finished training it 27648/76743 of epoch 2, 127.02 ms/it, loss 0.452520
Finished training it 27648/76743 of epoch 2, 127.08 ms/it, loss 0.448516
Finished training it 27648/76743 of epoch 2, 127.10 ms/it, loss 0.451754
rank 0 ranking from least wide range to the widest range [ 8 16 22 18 19  1 15 17 13 21 24  0  5  2 23  4 12  6 20 11  7 25  3 10
 14  9]
Finished training it 28672/76743 of epoch 2, 129.83 ms/it, loss 0.450433
Finished training it 28672/76743 of epoch 2, 129.30 ms/it, loss 0.452746
Finished training it 28672/76743 of epoch 2, 129.79 ms/it, loss 0.449926
Finished training it 28672/76743 of epoch 2, 129.33 ms/it, loss 0.453932
rank 0 ranking from least wide range to the widest range [ 8 16 13 15 22  0 21 17  2  5 18  1 24  6 25  4 12 23 11 20  7 19  3 10
  9 14]
Finished training it 29696/76743 of epoch 2, 130.37 ms/it, loss 0.453257
Finished training it 29696/76743 of epoch 2, 129.88 ms/it, loss 0.449731
Finished training it 29696/76743 of epoch 2, 129.70 ms/it, loss 0.453610
Finished training it 29696/76743 of epoch 2, 130.07 ms/it, loss 0.454460
Finished training it 30720/76743 of epoch 2, 128.98 ms/it, loss 0.453083
rank 0 ranking from least wide range to the widest range [18 22  8  2  0 23 16  1 12 17 15  6  5 21 25 13 20  7 11 19  4 24  3  9
 10 14]
Finished training it 30720/76743 of epoch 2, 129.24 ms/it, loss 0.452692
Finished training it 30720/76743 of epoch 2, 129.29 ms/it, loss 0.455371
Finished training it 30720/76743 of epoch 2, 129.00 ms/it, loss 0.454502
Testing at - 30720/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2564192.0
get out
0 has test check 2564192.0 and sample count 3273728
 accuracy 78.326 %, best 78.519 %, roc auc score 0.7959, best 0.7959
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16  8 15  0 22 17 18  1  5 23 13  2  4 12 21  7 19 11 20  6 24 25  3 10
  9 14]
Finished training it 31744/76743 of epoch 2, 128.16 ms/it, loss 0.451261
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2564445.0
get out
2 has test check 2564445.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 127.88 ms/it, loss 0.455433
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2564654.0
get out
3 has test check 2564654.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 128.24 ms/it, loss 0.451564
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2564756.0
get out
1 has test check 2564756.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 128.39 ms/it, loss 0.455151
rank 0 ranking from least wide range to the widest range [ 0  8 22 18 13 16 15  2 19 17 24  5  1  7  6 12 11 21 20 23  4 25  3 10
  9 14]
Finished training it 32768/76743 of epoch 2, 128.30 ms/it, loss 0.451254
Finished training it 32768/76743 of epoch 2, 128.47 ms/it, loss 0.450046
Finished training it 32768/76743 of epoch 2, 127.95 ms/it, loss 0.452003
Finished training it 32768/76743 of epoch 2, 128.11 ms/it, loss 0.452441
rank 0 ranking from least wide range to the widest range [15  8 22 17  1  2  0  5 13  6 23 19 12 20 25 24 11 21 16  7  3  4 18 10
  9 14]
Finished training it 33792/76743 of epoch 2, 129.11 ms/it, loss 0.452043
Finished training it 33792/76743 of epoch 2, 128.80 ms/it, loss 0.451720
Finished training it 33792/76743 of epoch 2, 128.81 ms/it, loss 0.454236
Finished training it 33792/76743 of epoch 2, 129.49 ms/it, loss 0.452136
Finished training it 34816/76743 of epoch 2, 128.79 ms/it, loss 0.454401
Finished training it 34816/76743 of epoch 2, 128.92 ms/it, loss 0.451218
rank 0 ranking from least wide range to the widest range [22  8  5 17  0 16 19 18  1  2 12 21 15  6 23 13 25 20  4  7 11 24  3 10
 14  9]
Finished training it 34816/76743 of epoch 2, 129.18 ms/it, loss 0.452714
Finished training it 34816/76743 of epoch 2, 129.55 ms/it, loss 0.451438
rank 0 ranking from least wide range to the widest range [ 5  0  1 18 22 17 16 15  2  8 13 12 23  6  4 21 20 11 25 19  7 24  3 10
 14  9]
Finished training it 35840/76743 of epoch 2, 128.66 ms/it, loss 0.452928
Finished training it 35840/76743 of epoch 2, 128.22 ms/it, loss 0.453232
Finished training it 35840/76743 of epoch 2, 128.53 ms/it, loss 0.449899
Finished training it 35840/76743 of epoch 2, 128.26 ms/it, loss 0.454111
rank 0 ranking from least wide range to the widest range [22 15  5  8  2  1  0 17 23 16 18 20 11  6 19 24 12 25 13 21  7  4  3 10
 14  9]
Finished training it 36864/76743 of epoch 2, 126.59 ms/it, loss 0.451220
Finished training it 36864/76743 of epoch 2, 126.34 ms/it, loss 0.449461
Finished training it 36864/76743 of epoch 2, 126.07 ms/it, loss 0.450749
Finished training it 36864/76743 of epoch 2, 126.59 ms/it, loss 0.451759
rank 0 ranking from least wide range to the widest range [ 8 16  1 15  5  0 22  2 17 12 13  4 18 21 23 20  6 11  7 19 25 24  3 10
  9 14]
Finished training it 37888/76743 of epoch 2, 126.19 ms/it, loss 0.450606
Finished training it 37888/76743 of epoch 2, 126.39 ms/it, loss 0.452695
Finished training it 37888/76743 of epoch 2, 126.09 ms/it, loss 0.453838
Finished training it 37888/76743 of epoch 2, 125.86 ms/it, loss 0.451307
Finished training it 38912/76743 of epoch 2, 127.27 ms/it, loss 0.451568
Finished training it 38912/76743 of epoch 2, 127.15 ms/it, loss 0.451104
rank 0 ranking from least wide range to the widest range [18  8 16 22 17 23  0  5 13  2 19 12  6  1 24 15  4 25 20 21  7 11  3 10
  9 14]
Finished training it 38912/76743 of epoch 2, 127.66 ms/it, loss 0.449928
Finished training it 38912/76743 of epoch 2, 127.56 ms/it, loss 0.449286
Finished training it 39936/76743 of epoch 2, 128.11 ms/it, loss 0.451501
rank 0 ranking from least wide range to the widest range [13 15  0 22  1  8  2  5 16 17 23 21 18 12  7  6 11 24 20 25  4 19  3 10
  9 14]
Finished training it 39936/76743 of epoch 2, 128.25 ms/it, loss 0.451793
Finished training it 39936/76743 of epoch 2, 128.49 ms/it, loss 0.451043
Finished training it 39936/76743 of epoch 2, 127.95 ms/it, loss 0.449772
Finished training it 40960/76743 of epoch 2, 126.32 ms/it, loss 0.454475
rank 0 ranking from least wide range to the widest range [ 8 22 16 17  1 19  5  2 15 18  0 13  7 12 23 21 20  6  4 25 11 24  3 10
 14  9]
Finished training it 40960/76743 of epoch 2, 126.74 ms/it, loss 0.449401
Finished training it 40960/76743 of epoch 2, 126.31 ms/it, loss 0.452286
Finished training it 40960/76743 of epoch 2, 126.55 ms/it, loss 0.451858
Testing at - 40960/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572566.0
get out
0 has test check 2572566.0 and sample count 3273728
 accuracy 78.582 %, best 78.582 %, roc auc score 0.7965, best 0.7965
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13 22  5  8  0 18 16 15 21 12 17  2  1  6 23  4 20 24 11 19 25  7  3 10
 14  9]
Finished training it 41984/76743 of epoch 2, 129.21 ms/it, loss 0.450093
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2572612.0
get out
2 has test check 2572612.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 129.19 ms/it, loss 0.454625
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2572748.0
get out
3 has test check 2572748.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 128.73 ms/it, loss 0.449623
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2572790.0
get out
1 has test check 2572790.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 129.40 ms/it, loss 0.453307
Finished training it 43008/76743 of epoch 2, 126.74 ms/it, loss 0.453687
rank 0 ranking from least wide range to the widest range [22  1  0 15  2  5 24 18 13 17 23 12  8 11  4 20  6 25 16 21 19  3  7 10
 14  9]
Finished training it 43008/76743 of epoch 2, 126.51 ms/it, loss 0.449928
Finished training it 43008/76743 of epoch 2, 126.74 ms/it, loss 0.452149
Finished training it 43008/76743 of epoch 2, 126.04 ms/it, loss 0.453825
rank 0 ranking from least wide range to the widest range [ 8  1  5 18 16  0  2 22 15 13 12 23 25 17 21 11 20  6 19 24  4  7  3  9
 10 14]
Finished training it 44032/76743 of epoch 2, 128.87 ms/it, loss 0.453188
Finished training it 44032/76743 of epoch 2, 128.80 ms/it, loss 0.450853
Finished training it 44032/76743 of epoch 2, 128.33 ms/it, loss 0.452806
Finished training it 44032/76743 of epoch 2, 128.34 ms/it, loss 0.449743
Finished training it 45056/76743 of epoch 2, 128.03 ms/it, loss 0.452274
rank 0 ranking from least wide range to the widest range [16  8  1 22  0 19 15  2 17  5 12 13  7 18 20  6 11 25  4 23 24 21  3 10
  9 14]
Finished training it 45056/76743 of epoch 2, 127.87 ms/it, loss 0.450066
Finished training it 45056/76743 of epoch 2, 127.93 ms/it, loss 0.450519
Finished training it 45056/76743 of epoch 2, 127.45 ms/it, loss 0.452590
Finished training it 46080/76743 of epoch 2, 126.69 ms/it, loss 0.451265
Finished training it 46080/76743 of epoch 2, 125.75 ms/it, loss 0.452810
rank 0 ranking from least wide range to the widest range [ 8 16 15  1 13  2 23 12  0  5 17 22  6 18 25  4 20  7 19 11 21 24  3 10
  9 14]
Finished training it 46080/76743 of epoch 2, 126.00 ms/it, loss 0.450552
Finished training it 46080/76743 of epoch 2, 125.58 ms/it, loss 0.454115
rank 0 ranking from least wide range to the widest range [ 8  2 13  5 16 15 22 17  1 18 25 21 23  0 24 12 20  6 11  4 19  7  3  9
 10 14]
Finished training it 47104/76743 of epoch 2, 129.18 ms/it, loss 0.454575
Finished training it 47104/76743 of epoch 2, 128.91 ms/it, loss 0.450958
Finished training it 47104/76743 of epoch 2, 129.23 ms/it, loss 0.449839
Finished training it 47104/76743 of epoch 2, 129.40 ms/it, loss 0.451198
rank 0 ranking from least wide range to the widest range [ 8 16 22 15 13 17  5  1  2 24 18  6 23 21 12  0 11 25 20 19  4  7  3 10
 14  9]
Finished training it 48128/76743 of epoch 2, 129.51 ms/it, loss 0.452028
Finished training it 48128/76743 of epoch 2, 128.82 ms/it, loss 0.450194
Finished training it 48128/76743 of epoch 2, 129.05 ms/it, loss 0.452108
Finished training it 48128/76743 of epoch 2, 129.26 ms/it, loss 0.448297
Finished training it 49152/76743 of epoch 2, 125.72 ms/it, loss 0.452378
rank 0 ranking from least wide range to the widest range [22  5 18  8  1 13  2 16 17 15  0 23  7 25 20 21 19  4 24 11 12  6  3 14
  9 10]
Finished training it 49152/76743 of epoch 2, 126.39 ms/it, loss 0.450382
Finished training it 49152/76743 of epoch 2, 126.17 ms/it, loss 0.452414
Finished training it 49152/76743 of epoch 2, 125.96 ms/it, loss 0.451312
rank 0 ranking from least wide range to the widest range [13 22 18 15  2  5  8 24 17 23  0  4 21  1 16 19 11 20 25  6  7 12  3  9
 10 14]
Finished training it 50176/76743 of epoch 2, 127.26 ms/it, loss 0.454757
Finished training it 50176/76743 of epoch 2, 126.69 ms/it, loss 0.451728
Finished training it 50176/76743 of epoch 2, 127.10 ms/it, loss 0.453512
Finished training it 50176/76743 of epoch 2, 126.93 ms/it, loss 0.452743
rank 0 ranking from least wide range to the widest range [19  8  2  5  0 15 17 22  4  1 21 12  6 16 20 11 18 23 24 13  7 25  3 10
 14  9]
Finished training it 51200/76743 of epoch 2, 127.96 ms/it, loss 0.453881
Finished training it 51200/76743 of epoch 2, 127.97 ms/it, loss 0.450583
Finished training it 51200/76743 of epoch 2, 127.78 ms/it, loss 0.449425
Finished training it 51200/76743 of epoch 2, 127.75 ms/it, loss 0.450136
Testing at - 51200/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572661.0
get out
0 has test check 2572661.0 and sample count 3273728
 accuracy 78.585 %, best 78.585 %, roc auc score 0.7966, best 0.7966
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2572534.0
get out
3 has test check 2572534.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 128.10 ms/it, loss 0.449990
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 22 15  8  2 13 12  1  5 18  7 17  6 11  4 23 20  0 19 25 21 24  3 10
  9 14]
Finished training it 52224/76743 of epoch 2, 128.13 ms/it, loss 0.450650
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2572610.0
get out
2 has test check 2572610.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 128.30 ms/it, loss 0.450838
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2572542.0
get out
1 has test check 2572542.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 128.32 ms/it, loss 0.450581
rank 0 ranking from least wide range to the widest range [ 8 13 16 22 18  5 15  2  1 17  4  0  6 11 25 24 23 20 12 21 19  7  3 14
  9 10]
Finished training it 53248/76743 of epoch 2, 125.60 ms/it, loss 0.450132
Finished training it 53248/76743 of epoch 2, 125.96 ms/it, loss 0.452027
Finished training it 53248/76743 of epoch 2, 125.54 ms/it, loss 0.453460
Finished training it 53248/76743 of epoch 2, 125.41 ms/it, loss 0.453377
rank 0 ranking from least wide range to the widest range [22  8 18  5 13 15  1 16 12 24 19  2  0 23  6  4  7 17 21 20 11 25  3  9
 10 14]
Finished training it 54272/76743 of epoch 2, 128.46 ms/it, loss 0.451147
Finished training it 54272/76743 of epoch 2, 128.43 ms/it, loss 0.448852
Finished training it 54272/76743 of epoch 2, 128.36 ms/it, loss 0.451700
Finished training it 54272/76743 of epoch 2, 128.05 ms/it, loss 0.453072
rank 0 ranking from least wide range to the widest range [ 8 16 22 13 19 15  1  2  0 12  5  4 20 25 23 11  7 17 18 24  6 21  3 14
 10  9]
Finished training it 55296/76743 of epoch 2, 129.16 ms/it, loss 0.452025
Finished training it 55296/76743 of epoch 2, 128.70 ms/it, loss 0.448381
Finished training it 55296/76743 of epoch 2, 128.61 ms/it, loss 0.449970
Finished training it 55296/76743 of epoch 2, 128.84 ms/it, loss 0.451422
rank 0 ranking from least wide range to the widest range [16  5 13  2  8 22  4 19  0 12 15  1 23  6 21 20 17 11 25 18  7 24  3 10
  9 14]
Finished training it 56320/76743 of epoch 2, 130.79 ms/it, loss 0.452088
Finished training it 56320/76743 of epoch 2, 130.75 ms/it, loss 0.453787
Finished training it 56320/76743 of epoch 2, 130.09 ms/it, loss 0.449365
Finished training it 56320/76743 of epoch 2, 130.45 ms/it, loss 0.451130
Finished training it 57344/76743 of epoch 2, 125.06 ms/it, loss 0.451555
rank 0 ranking from least wide range to the widest range [15 22  0 16  2  8 18 13 21 23 19 11 20  4  5 25 12 17  1  6  7 24  3  9
 10 14]
Finished training it 57344/76743 of epoch 2, 125.73 ms/it, loss 0.452213
Finished training it 57344/76743 of epoch 2, 125.72 ms/it, loss 0.453648
Finished training it 57344/76743 of epoch 2, 125.23 ms/it, loss 0.449972
rank 0 ranking from least wide range to the widest range [16 13  8 19 22 18  4 17 15  5  1  2 24 12 25 21  0 20 23 11  6  7  3  9
 10 14]
Finished training it 58368/76743 of epoch 2, 128.97 ms/it, loss 0.449334
Finished training it 58368/76743 of epoch 2, 128.01 ms/it, loss 0.454106
Finished training it 58368/76743 of epoch 2, 128.00 ms/it, loss 0.453013
Finished training it 58368/76743 of epoch 2, 128.57 ms/it, loss 0.452767
rank 0 ranking from least wide range to the widest range [16 18 22 13  2  8  5 15 23  0  1 20 19 11 17 12  7 25  6 21 24  4  3  9
 10 14]
Finished training it 59392/76743 of epoch 2, 129.22 ms/it, loss 0.452694
Finished training it 59392/76743 of epoch 2, 128.73 ms/it, loss 0.450853
Finished training it 59392/76743 of epoch 2, 128.76 ms/it, loss 0.447926
Finished training it 59392/76743 of epoch 2, 129.17 ms/it, loss 0.452896
rank 0 ranking from least wide range to the widest range [16 13 18  5  8  2  1 22  0 15 12 21 19 23 24  6 17  4 25 20 11  7  3 10
  9 14]
Finished training it 60416/76743 of epoch 2, 129.28 ms/it, loss 0.447950
Finished training it 60416/76743 of epoch 2, 129.07 ms/it, loss 0.451982
Finished training it 60416/76743 of epoch 2, 129.33 ms/it, loss 0.452047
Finished training it 60416/76743 of epoch 2, 128.97 ms/it, loss 0.450934
Finished training it 61440/76743 of epoch 2, 127.87 ms/it, loss 0.453134
rank 0 ranking from least wide range to the widest range [13  5 22  8 15 16  0 19  2  1  4 17 12 18 25  7 23 20 11 21  6 24  3  9
 10 14]
Finished training it 61440/76743 of epoch 2, 127.84 ms/it, loss 0.449066
Finished training it 61440/76743 of epoch 2, 127.44 ms/it, loss 0.450244
Finished training it 61440/76743 of epoch 2, 127.09 ms/it, loss 0.449603
Testing at - 61440/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572730.0
get out
0 has test check 2572730.0 and sample count 3273728
 accuracy 78.587 %, best 78.587 %, roc auc score 0.7968, best 0.7968
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 8  5  0 16 18 22 13 19 15  2  4 12 24  1 23 21  6 20 17  7 25 11  3  9
 10 14]
Finished training it 62464/76743 of epoch 2, 130.78 ms/it, loss 0.449195
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573043.0
get out
1 has test check 2573043.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 131.27 ms/it, loss 0.452127
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573018.0
get out
3 has test check 2573018.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 130.42 ms/it, loss 0.452110
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573091.0
get out
2 has test check 2573091.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 130.25 ms/it, loss 0.452948
rank 0 ranking from least wide range to the widest range [16 22  8 13 19 18  1  5 15  2  7  6  0 23 12 17  4 20 24 25 11 21  3  9
 10 14]
Finished training it 63488/76743 of epoch 2, 129.09 ms/it, loss 0.452074
Finished training it 63488/76743 of epoch 2, 128.62 ms/it, loss 0.451398
Finished training it 63488/76743 of epoch 2, 128.76 ms/it, loss 0.452055
Finished training it 63488/76743 of epoch 2, 129.01 ms/it, loss 0.451814
rank 0 ranking from least wide range to the widest range [ 8 16 18 12  1 15 24  0 17 19  2 13 22  4  6  5 25 21 23 20 11  7  3 10
 14  9]
Finished training it 64512/76743 of epoch 2, 127.44 ms/it, loss 0.450675
Finished training it 64512/76743 of epoch 2, 127.52 ms/it, loss 0.453491
Finished training it 64512/76743 of epoch 2, 126.99 ms/it, loss 0.452128
Finished training it 64512/76743 of epoch 2, 127.09 ms/it, loss 0.452450
rank 0 ranking from least wide range to the widest range [16  8  0 15 22  4  5  2 13 19 18 23 21 24 17  6  7  1 11 20 25 12  3  9
 10 14]
Finished training it 65536/76743 of epoch 2, 127.42 ms/it, loss 0.451104
Finished training it 65536/76743 of epoch 2, 127.06 ms/it, loss 0.451540
Finished training it 65536/76743 of epoch 2, 127.29 ms/it, loss 0.453227
Finished training it 65536/76743 of epoch 2, 127.61 ms/it, loss 0.451830
rank 0 ranking from least wide range to the widest range [16 22  8 19 13 24  5  0 15  2 18 12  1  6 17 20  4 11 25 23 21  7  3 10
  9 14]
Finished training it 66560/76743 of epoch 2, 127.23 ms/it, loss 0.450326
Finished training it 66560/76743 of epoch 2, 127.58 ms/it, loss 0.453821
Finished training it 66560/76743 of epoch 2, 127.03 ms/it, loss 0.449584
Finished training it 66560/76743 of epoch 2, 126.99 ms/it, loss 0.450037
rank 0 ranking from least wide range to the widest range [ 8 15 13  5 18  1 16  2 22  0 12 21 23 24 19  6 17 20 11 25  7  4  3  9
 10 14]
Finished training it 67584/76743 of epoch 2, 130.07 ms/it, loss 0.450754
Finished training it 67584/76743 of epoch 2, 129.69 ms/it, loss 0.450600
Finished training it 67584/76743 of epoch 2, 129.74 ms/it, loss 0.452053
Finished training it 67584/76743 of epoch 2, 130.05 ms/it, loss 0.451885
Finished training it 68608/76743 of epoch 2, 129.98 ms/it, loss 0.452629
rank 0 ranking from least wide range to the widest range [15  8  2 16 18 19  1  0 12 22  5  6 24 23 11 20 17 13 21  4 25  7  3 10
  9 14]
Finished training it 68608/76743 of epoch 2, 130.36 ms/it, loss 0.448065
Finished training it 68608/76743 of epoch 2, 130.59 ms/it, loss 0.451256
Finished training it 68608/76743 of epoch 2, 129.92 ms/it, loss 0.451598
rank 0 ranking from least wide range to the widest range [15 22  8  5  2  4  1 13 21  0 23 12 20 16 17 18 11  6 25  7 24 19  3 10
 14  9]
Finished training it 69632/76743 of epoch 2, 131.11 ms/it, loss 0.450355
Finished training it 69632/76743 of epoch 2, 130.79 ms/it, loss 0.450462
Finished training it 69632/76743 of epoch 2, 131.14 ms/it, loss 0.450956
Finished training it 69632/76743 of epoch 2, 130.89 ms/it, loss 0.452625
rank 0 ranking from least wide range to the widest range [ 8 15 18  1  2  5  0 13 19 16 24 23 22 17 25 20  6 11 12 21  7  3  4 10
  9 14]
Finished training it 70656/76743 of epoch 2, 131.67 ms/it, loss 0.454152
Finished training it 70656/76743 of epoch 2, 131.55 ms/it, loss 0.449907
Finished training it 70656/76743 of epoch 2, 131.38 ms/it, loss 0.452019
Finished training it 70656/76743 of epoch 2, 131.38 ms/it, loss 0.449998
Finished training it 71680/76743 of epoch 2, 127.34 ms/it, loss 0.449145
Finished training it 71680/76743 of epoch 2, 127.41 ms/it, loss 0.450886
rank 0 ranking from least wide range to the widest range [16 22 15  1  8  4  2 12  5  0 23 18  6  7 11 13 17 20 19 21 24 25  3 10
 14  9]
Finished training it 71680/76743 of epoch 2, 128.04 ms/it, loss 0.451418
Finished training it 71680/76743 of epoch 2, 127.95 ms/it, loss 0.451060
Testing at - 71680/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573213.0
get out
0 has test check 2573213.0 and sample count 3273728
 accuracy 78.602 %, best 78.602 %, roc auc score 0.7970, best 0.7970
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [22 16  0 15 24  2  1 19  8  4  5 13 23 18 21 12 11 17 20 25  6  7  3  9
 10 14]
Finished training it 72704/76743 of epoch 2, 128.13 ms/it, loss 0.448056
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573293.0
get out
2 has test check 2573293.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 127.59 ms/it, loss 0.448680
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573289.0
get out
3 has test check 2573289.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 127.71 ms/it, loss 0.449564
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573214.0
get out
1 has test check 2573214.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 128.21 ms/it, loss 0.449575
Finished training it 73728/76743 of epoch 2, 130.03 ms/it, loss 0.450115
rank 0 ranking from least wide range to the widest range [19  8 22 18 16  2  5  1 15  4 12 23 20  6 13  0 11 24 25 21  7 17  3 10
  9 14]
Finished training it 73728/76743 of epoch 2, 130.42 ms/it, loss 0.449768
Finished training it 73728/76743 of epoch 2, 129.81 ms/it, loss 0.451354
Finished training it 73728/76743 of epoch 2, 130.40 ms/it, loss 0.452403
Finished training it 74752/76743 of epoch 2, 127.76 ms/it, loss 0.451648
rank 0 ranking from least wide range to the widest range [18 15 16  0 22 23  2  1 12 24 19 11  8  5 20 17 25  6  4 21 13  3  7 10
  9 14]
Finished training it 74752/76743 of epoch 2, 127.99 ms/it, loss 0.448049
Finished training it 74752/76743 of epoch 2, 128.66 ms/it, loss 0.450997
Finished training it 74752/76743 of epoch 2, 127.60 ms/it, loss 0.449012
rank 0 ranking from least wide range to the widest range [16 18 22  1 15  5  2  0 12  4 23  6 13  8 20 11 19 17 24 25 21  7  3  9
 10 14]
Finished training it 75776/76743 of epoch 2, 129.71 ms/it, loss 0.452404
Finished training it 75776/76743 of epoch 2, 129.07 ms/it, loss 0.447390
Finished training it 75776/76743 of epoch 2, 129.04 ms/it, loss 0.451218
Finished training it 75776/76743 of epoch 2, 130.15 ms/it, loss 0.450930
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 129.08 ms/it, loss 0.449170
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [ 4 22  8 16  5 15  0  2 19 18 23 24 12  1 20  6 17 11 13 25 21  7  3 10
  9 14]
Finished training it 1024/76743 of epoch 3, 129.24 ms/it, loss 0.452402
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 128.63 ms/it, loss 0.448000
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 128.67 ms/it, loss 0.449720
Finished training it 2048/76743 of epoch 3, 126.94 ms/it, loss 0.451137
Finished training it 2048/76743 of epoch 3, 126.46 ms/it, loss 0.448905
rank 0 ranking from least wide range to the widest range [ 8 16 13  0 18 12  5 24  4 22 15 19  6  2 21 23 17  1  7 25 11 20  3  9
 10 14]
Finished training it 2048/76743 of epoch 3, 126.89 ms/it, loss 0.452061
Finished training it 2048/76743 of epoch 3, 126.57 ms/it, loss 0.452797
rank 0 ranking from least wide range to the widest range [22 16  5 15 21  2  0  1  8 19 23  6 18 12 13 25 24 20 11  4 17  7  3 10
  9 14]
Finished training it 3072/76743 of epoch 3, 127.55 ms/it, loss 0.447644
Finished training it 3072/76743 of epoch 3, 127.28 ms/it, loss 0.451270
Finished training it 3072/76743 of epoch 3, 127.28 ms/it, loss 0.452078
Finished training it 3072/76743 of epoch 3, 127.84 ms/it, loss 0.448584
rank 0 ranking from least wide range to the widest range [16  8 15 22 19  0  5  2 18  4  6  1 17 12 13 23 24 21 11 20 25  7  3 10
  9 14]
Finished training it 4096/76743 of epoch 3, 128.92 ms/it, loss 0.452115
Finished training it 4096/76743 of epoch 3, 129.03 ms/it, loss 0.450624
Finished training it 4096/76743 of epoch 3, 128.78 ms/it, loss 0.448256
Finished training it 4096/76743 of epoch 3, 128.47 ms/it, loss 0.450294
rank 0 ranking from least wide range to the widest range [ 5  4 15 16  0 22  2 19 12 21 17  1 20 24 18  8 23 11  6 25 13  7  3  9
 10 14]
Finished training it 5120/76743 of epoch 3, 130.28 ms/it, loss 0.449891
Finished training it 5120/76743 of epoch 3, 130.62 ms/it, loss 0.451688
Finished training it 5120/76743 of epoch 3, 130.07 ms/it, loss 0.451268
Finished training it 5120/76743 of epoch 3, 129.94 ms/it, loss 0.451094
rank 0 ranking from least wide range to the widest range [22 18 16  0  5 15  8  2 19 12  1 23 24 17 20 13 25 11  6  4  7 21  3  9
 10 14]
Finished training it 6144/76743 of epoch 3, 128.54 ms/it, loss 0.450359
Finished training it 6144/76743 of epoch 3, 128.38 ms/it, loss 0.448664
Finished training it 6144/76743 of epoch 3, 128.28 ms/it, loss 0.449756
Finished training it 6144/76743 of epoch 3, 128.79 ms/it, loss 0.453616
rank 0 ranking from least wide range to the widest range [ 8  1 16 15 21  0 12 13  4 17  2 19 22 24 25 18 23  6  5 20  7 11 10  3
  9 14]
Finished training it 7168/76743 of epoch 3, 129.22 ms/it, loss 0.451097
Finished training it 7168/76743 of epoch 3, 129.41 ms/it, loss 0.450381
Finished training it 7168/76743 of epoch 3, 128.80 ms/it, loss 0.449820
Finished training it 7168/76743 of epoch 3, 128.81 ms/it, loss 0.448299
Finished training it 8192/76743 of epoch 3, 128.63 ms/it, loss 0.450779
rank 0 ranking from least wide range to the widest range [ 5 15  2 16  6 22  0 12 23 20 18  8 11  1 17 13 25 21 19 24  7 10  3  9
  4 14]
Finished training it 8192/76743 of epoch 3, 129.26 ms/it, loss 0.449936
Finished training it 8192/76743 of epoch 3, 128.75 ms/it, loss 0.448960
Finished training it 8192/76743 of epoch 3, 129.13 ms/it, loss 0.455392
rank 0 ranking from least wide range to the widest range [ 0 22 15 19  1  8 12 16  5 18  2  6 13 24 23 20 17 11 25 21  7  9  3  4
 10 14]
Finished training it 9216/76743 of epoch 3, 126.80 ms/it, loss 0.449991
Finished training it 9216/76743 of epoch 3, 126.32 ms/it, loss 0.448775
Finished training it 9216/76743 of epoch 3, 126.51 ms/it, loss 0.448192
Finished training it 9216/76743 of epoch 3, 126.86 ms/it, loss 0.452415
rank 0 ranking from least wide range to the widest range [16  8  0 12 15 18 22  2  5  1 13 24 17  4 19  6 20 21 11 23  7 25  3  9
 10 14]
Finished training it 10240/76743 of epoch 3, 128.25 ms/it, loss 0.451697
Finished training it 10240/76743 of epoch 3, 126.91 ms/it, loss 0.449610
Finished training it 10240/76743 of epoch 3, 126.99 ms/it, loss 0.450276
Finished training it 10240/76743 of epoch 3, 127.38 ms/it, loss 0.449491
Testing at - 10240/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2574479.0
get out
0 has test check 2574479.0 and sample count 3273728
 accuracy 78.641 %, best 78.641 %, roc auc score 0.7976, best 0.7976
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16  8  5 22 18  2 12 19 15  0  1  4 23 24 20 13 21 11  6 25 17  7  3  9
 10 14]
Finished training it 11264/76743 of epoch 3, 129.33 ms/it, loss 0.449298
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574302.0
get out
2 has test check 2574302.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 129.00 ms/it, loss 0.452720
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2574506.0
get out
3 has test check 2574506.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 129.04 ms/it, loss 0.450764
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574506.0
get out
1 has test check 2574506.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 129.34 ms/it, loss 0.452605
Finished training it 12288/76743 of epoch 3, 131.56 ms/it, loss 0.449678
rank 0 ranking from least wide range to the widest range [22  0 16  5 19 12 15  1  8  2 17 25 24 18  6 21 23 13 20 11  4  3  7 10
  9 14]
Finished training it 12288/76743 of epoch 3, 131.75 ms/it, loss 0.449924
Finished training it 12288/76743 of epoch 3, 131.58 ms/it, loss 0.451038
Finished training it 12288/76743 of epoch 3, 131.95 ms/it, loss 0.449892
rank 0 ranking from least wide range to the widest range [ 8 16  5  0 15 12 21  2  4 13 24  1 18 19  6 22 23 25 20 11 17  7  3  9
 10 14]
Finished training it 13312/76743 of epoch 3, 128.64 ms/it, loss 0.451603
Finished training it 13312/76743 of epoch 3, 128.19 ms/it, loss 0.450829
Finished training it 13312/76743 of epoch 3, 128.39 ms/it, loss 0.449727
Finished training it 13312/76743 of epoch 3, 128.71 ms/it, loss 0.452052
Finished training it 14336/76743 of epoch 3, 130.72 ms/it, loss 0.450021
Finished training it 14336/76743 of epoch 3, 131.59 ms/it, loss 0.449222
rank 0 ranking from least wide range to the widest range [22  0 18 16  5 13  1 12 15  8  2 19  4  6 11 20 25 21 17 24  7 23  3  9
 10 14]
Finished training it 14336/76743 of epoch 3, 131.33 ms/it, loss 0.449290
Finished training it 14336/76743 of epoch 3, 130.73 ms/it, loss 0.448997
rank 0 ranking from least wide range to the widest range [ 8 16 22 18  0  1 19 12 23  2  5 15 13  6  7 25 11  4 17 20 24 21  9 10
  3 14]
Finished training it 15360/76743 of epoch 3, 126.27 ms/it, loss 0.450877
Finished training it 15360/76743 of epoch 3, 125.65 ms/it, loss 0.451822
Finished training it 15360/76743 of epoch 3, 126.19 ms/it, loss 0.450509
Finished training it 15360/76743 of epoch 3, 125.69 ms/it, loss 0.448999
rank 0 ranking from least wide range to the widest range [15  8 12  5  2  0 22 18 19 13 16  6 23 25 11 20  1  4 21 17  7 24  9  3
 10 14]
Finished training it 16384/76743 of epoch 3, 129.37 ms/it, loss 0.451845
Finished training it 16384/76743 of epoch 3, 128.82 ms/it, loss 0.451032
Finished training it 16384/76743 of epoch 3, 129.63 ms/it, loss 0.448292
Finished training it 16384/76743 of epoch 3, 128.85 ms/it, loss 0.448104
rank 0 ranking from least wide range to the widest range [22  0 16 12 15  8 18  1  4  5 13  2  6 17 23 20 24 25 11 21 19  7  3 10
  9 14]
Finished training it 17408/76743 of epoch 3, 127.95 ms/it, loss 0.448662
Finished training it 17408/76743 of epoch 3, 127.54 ms/it, loss 0.450637
Finished training it 17408/76743 of epoch 3, 127.70 ms/it, loss 0.447482
Finished training it 17408/76743 of epoch 3, 128.29 ms/it, loss 0.451242
rank 0 ranking from least wide range to the widest range [16 22  8 13  0 12 15 18 19  4  2  5  1 21 24  6 23 20 11 25 17  7  3 10
  9 14]
Finished training it 18432/76743 of epoch 3, 128.68 ms/it, loss 0.447143
Finished training it 18432/76743 of epoch 3, 128.16 ms/it, loss 0.448187
Finished training it 18432/76743 of epoch 3, 128.43 ms/it, loss 0.448890
Finished training it 18432/76743 of epoch 3, 128.90 ms/it, loss 0.447817
Finished training it 19456/76743 of epoch 3, 126.02 ms/it, loss 0.450200
Finished training it 19456/76743 of epoch 3, 125.95 ms/it, loss 0.444332
Finished training it 19456/76743 of epoch 3, 126.48 ms/it, loss 0.446828
rank 0 ranking from least wide range to the widest range [ 8 15 18 13  5  2  0 23 16  1 19  4 22 12 11 24 20  6 25  7 21 17  3  9
 10 14]
Finished training it 19456/76743 of epoch 3, 126.53 ms/it, loss 0.448400
Finished training it 20480/76743 of epoch 3, 126.57 ms/it, loss 0.451045
Finished training it 20480/76743 of epoch 3, 126.51 ms/it, loss 0.448987
Finished training it 20480/76743 of epoch 3, 126.90 ms/it, loss 0.448799
rank 0 ranking from least wide range to the widest range [22  8 18  4 19  0  5 21 16 24  1 15 12  2 25 23  6 13 20 11  7 17  3  9
 10 14]
Finished training it 20480/76743 of epoch 3, 126.87 ms/it, loss 0.451306
Testing at - 20480/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573951.0
get out
0 has test check 2573951.0 and sample count 3273728
 accuracy 78.624 %, best 78.641 %, roc auc score 0.7982, best 0.7982
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [22 19  5 16  1 12 15  2 18  4  0  8 24 23  6 11 20 17 25 21 13  7  3 10
  9 14]
Finished training it 21504/76743 of epoch 3, 128.74 ms/it, loss 0.452061
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573508.0
get out
1 has test check 2573508.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 128.32 ms/it, loss 0.449183
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573666.0
get out
3 has test check 2573666.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 127.75 ms/it, loss 0.452024
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573559.0
get out
2 has test check 2573559.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 127.88 ms/it, loss 0.452671
Finished training it 22528/76743 of epoch 3, 128.37 ms/it, loss 0.452605
Finished training it 22528/76743 of epoch 3, 128.43 ms/it, loss 0.448458
rank 0 ranking from least wide range to the widest range [22  8 12  5 18 16  4 15 19  0  2 23 13 24 20 11  6  1 21 17 25  7  3 14
  9 10]
Finished training it 22528/76743 of epoch 3, 129.06 ms/it, loss 0.451256
Finished training it 22528/76743 of epoch 3, 128.82 ms/it, loss 0.451541
rank 0 ranking from least wide range to the widest range [16  8 18  5 22 13 15  2 12  4 23 21  1  6  0 20 25 24 17  7 19 11  3 10
  9 14]
Finished training it 23552/76743 of epoch 3, 126.86 ms/it, loss 0.449091
Finished training it 23552/76743 of epoch 3, 126.53 ms/it, loss 0.452127
Finished training it 23552/76743 of epoch 3, 126.98 ms/it, loss 0.448422
Finished training it 23552/76743 of epoch 3, 126.62 ms/it, loss 0.450282
rank 0 ranking from least wide range to the widest range [22  0 18  8 15 12 19  4  2  5  6 16 24 13 21  1 11 20 17 25 23  9  7 10
  3 14]
Finished training it 24576/76743 of epoch 3, 127.18 ms/it, loss 0.450302
Finished training it 24576/76743 of epoch 3, 126.72 ms/it, loss 0.450605
Finished training it 24576/76743 of epoch 3, 126.60 ms/it, loss 0.447364
Finished training it 24576/76743 of epoch 3, 126.93 ms/it, loss 0.449494
Finished training it 25600/76743 of epoch 3, 125.77 ms/it, loss 0.450074
rank 0 ranking from least wide range to the widest range [ 8  0  5  2 16 22 15  7 13 21 20 12 11  1  4 19 23 18  6 24 25  9 17  3
 10 14]
Finished training it 25600/76743 of epoch 3, 126.39 ms/it, loss 0.449444
Finished training it 25600/76743 of epoch 3, 126.59 ms/it, loss 0.450977
Finished training it 25600/76743 of epoch 3, 125.91 ms/it, loss 0.452263
rank 0 ranking from least wide range to the widest range [16  8 22  5 13  0 15 21  2 18 19  4 12 20 23  7  1  6 11 24 25 17  9  3
 10 14]
Finished training it 26624/76743 of epoch 3, 132.66 ms/it, loss 0.448963
Finished training it 26624/76743 of epoch 3, 132.44 ms/it, loss 0.453600
Finished training it 26624/76743 of epoch 3, 132.35 ms/it, loss 0.450778
Finished training it 26624/76743 of epoch 3, 132.75 ms/it, loss 0.448827
rank 0 ranking from least wide range to the widest range [16 18 19 12  8  5  2 24 22  0  7  1 13 15  6 20 25  4 11 17 21 23  3  9
 10 14]
Finished training it 27648/76743 of epoch 3, 130.06 ms/it, loss 0.450507
Finished training it 27648/76743 of epoch 3, 129.44 ms/it, loss 0.445998
Finished training it 27648/76743 of epoch 3, 129.89 ms/it, loss 0.449393
Finished training it 27648/76743 of epoch 3, 129.55 ms/it, loss 0.449910
rank 0 ranking from least wide range to the widest range [16 18 19  8 22 21  0  4 15 13  5 24 12  2  1  7  6 20 11 23 25 17 10  3
  9 14]
Finished training it 28672/76743 of epoch 3, 129.90 ms/it, loss 0.448276
Finished training it 28672/76743 of epoch 3, 129.35 ms/it, loss 0.451703
Finished training it 28672/76743 of epoch 3, 129.57 ms/it, loss 0.450822
Finished training it 28672/76743 of epoch 3, 129.76 ms/it, loss 0.447302
Finished training it 29696/76743 of epoch 3, 131.69 ms/it, loss 0.450939
rank 0 ranking from least wide range to the widest range [13 22 16  5 12  2 15  8 18  4  0 24  6 20 11  7 25 23  1 21 17 19  3 10
  9 14]
Finished training it 29696/76743 of epoch 3, 132.26 ms/it, loss 0.450884
Finished training it 29696/76743 of epoch 3, 131.53 ms/it, loss 0.447503
Finished training it 29696/76743 of epoch 3, 131.82 ms/it, loss 0.451772
Finished training it 30720/76743 of epoch 3, 127.55 ms/it, loss 0.450643
Finished training it 30720/76743 of epoch 3, 127.66 ms/it, loss 0.451774
Finished training it 30720/76743 of epoch 3, 128.47 ms/it, loss 0.453026
rank 0 ranking from least wide range to the widest range [12  0 16 18  2 23 22  1  8  6 25 20 15 13  5  7 11  4 19 17 21 24  9 10
  3 14]
Finished training it 30720/76743 of epoch 3, 128.03 ms/it, loss 0.450178
Testing at - 30720/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2568550.0
get out
0 has test check 2568550.0 and sample count 3273728
 accuracy 78.459 %, best 78.641 %, roc auc score 0.7976, best 0.7982
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 15  0 22  5  8  4 12 18 23  7  2 19 13 24  1 11 20  6 17 21 25  9 10
  3 14]
Finished training it 31744/76743 of epoch 3, 131.18 ms/it, loss 0.449574
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567766.0
get out
3 has test check 2567766.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 130.60 ms/it, loss 0.449684
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567797.0
get out
2 has test check 2567797.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 130.61 ms/it, loss 0.453571
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2568131.0
get out
1 has test check 2568131.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 130.94 ms/it, loss 0.452833
rank 0 ranking from least wide range to the widest range [ 8  0 16 22 15 13 18 23  5  7 12  2  1  6 19 24 11 20 21  4 17 25  9  3
 10 14]
Finished training it 32768/76743 of epoch 3, 129.87 ms/it, loss 0.449110
Finished training it 32768/76743 of epoch 3, 129.65 ms/it, loss 0.447819
Finished training it 32768/76743 of epoch 3, 128.78 ms/it, loss 0.449897
Finished training it 32768/76743 of epoch 3, 128.82 ms/it, loss 0.449713
rank 0 ranking from least wide range to the widest range [ 5 12 22 19  2  8 16 21 13  0  6  4 20 24  7 15 11 25 23  1 18 17  9  3
 10 14]
Finished training it 33792/76743 of epoch 3, 129.22 ms/it, loss 0.449923
Finished training it 33792/76743 of epoch 3, 128.90 ms/it, loss 0.449574
Finished training it 33792/76743 of epoch 3, 129.02 ms/it, loss 0.451934
Finished training it 33792/76743 of epoch 3, 129.25 ms/it, loss 0.450413
rank 0 ranking from least wide range to the widest range [22  0  8 16  5 18 12 19  4 23 21 15 24  2 25  6 20  7 13  1 17 11  9 10
  3 14]
Finished training it 34816/76743 of epoch 3, 130.76 ms/it, loss 0.450379
Finished training it 34816/76743 of epoch 3, 130.49 ms/it, loss 0.449408
Finished training it 34816/76743 of epoch 3, 130.48 ms/it, loss 0.451979
Finished training it 34816/76743 of epoch 3, 131.04 ms/it, loss 0.449117
rank 0 ranking from least wide range to the widest range [16  5  4 12  0 22 15  8 18  2 19 13  6 21  1 11 23 20 17 25 24  7 10  3
  9 14]
Finished training it 35840/76743 of epoch 3, 128.63 ms/it, loss 0.450685
Finished training it 35840/76743 of epoch 3, 128.66 ms/it, loss 0.447789
Finished training it 35840/76743 of epoch 3, 128.50 ms/it, loss 0.450756
Finished training it 35840/76743 of epoch 3, 128.21 ms/it, loss 0.452466
rank 0 ranking from least wide range to the widest range [22  5  0 15  2 18 16  1  8 23 20  4 12 11 24  6 25  7 17 13 19 21  9 10
  3 14]
Finished training it 36864/76743 of epoch 3, 129.34 ms/it, loss 0.449685
Finished training it 36864/76743 of epoch 3, 129.05 ms/it, loss 0.448431
Finished training it 36864/76743 of epoch 3, 129.34 ms/it, loss 0.447089
Finished training it 36864/76743 of epoch 3, 129.48 ms/it, loss 0.449724
rank 0 ranking from least wide range to the widest range [16  4  8  5  0 15 12 22 18  6  2 13  1 17 21 19 20  7 11 24 23 25  9  3
 10 14]
Finished training it 37888/76743 of epoch 3, 129.65 ms/it, loss 0.448449
Finished training it 37888/76743 of epoch 3, 129.70 ms/it, loss 0.450399
Finished training it 37888/76743 of epoch 3, 129.36 ms/it, loss 0.449216
Finished training it 37888/76743 of epoch 3, 129.40 ms/it, loss 0.451707
Finished training it 38912/76743 of epoch 3, 129.43 ms/it, loss 0.449632
Finished training it 38912/76743 of epoch 3, 129.90 ms/it, loss 0.447505
rank 0 ranking from least wide range to the widest range [18 19 16  8 22  5 13  0 12  2  4  6 23 24 20 15 21 25 11 17  1  7  9 10
  3 14]
Finished training it 38912/76743 of epoch 3, 129.72 ms/it, loss 0.447768
Finished training it 38912/76743 of epoch 3, 129.31 ms/it, loss 0.448854
Finished training it 39936/76743 of epoch 3, 128.93 ms/it, loss 0.448005
rank 0 ranking from least wide range to the widest range [ 8 13 15 16 22  2  5  4  0 12 18 11 20 23  1 21  6 25 17 19  7 24  3  9
 10 14]
Finished training it 39936/76743 of epoch 3, 129.29 ms/it, loss 0.449916
Finished training it 39936/76743 of epoch 3, 128.89 ms/it, loss 0.449440
Finished training it 39936/76743 of epoch 3, 129.35 ms/it, loss 0.448795
rank 0 ranking from least wide range to the widest range [18  8 19  5 16 22  0  4  1 12 17 13  2 21  7  6 23 11 20 15 25 24 10  3
  9 14]
Finished training it 40960/76743 of epoch 3, 128.81 ms/it, loss 0.447544
Finished training it 40960/76743 of epoch 3, 129.09 ms/it, loss 0.449409
Finished training it 40960/76743 of epoch 3, 128.83 ms/it, loss 0.450639
Finished training it 40960/76743 of epoch 3, 128.47 ms/it, loss 0.452902
Testing at - 40960/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575161.0
get out
0 has test check 2575161.0 and sample count 3273728
 accuracy 78.661 %, best 78.661 %, roc auc score 0.7985, best 0.7985
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575397.0
get out
2 has test check 2575397.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 130.35 ms/it, loss 0.452563
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575409.0
get out
3 has test check 2575409.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 130.36 ms/it, loss 0.447653
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575078.0
get out
1 has test check 2575078.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 130.88 ms/it, loss 0.451460
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13  8  5 18  0 12 22 16 21  2 15 24  4 19  6 17 20  1 11 23  7 25 10  3
  9 14]
Finished training it 41984/76743 of epoch 3, 130.83 ms/it, loss 0.448298
rank 0 ranking from least wide range to the widest range [22  0  5  4 15 18  2 12  8 13 24 23 20  6 17 11 16 21  1 25 19  7  3 10
  9 14]
Finished training it 43008/76743 of epoch 3, 128.98 ms/it, loss 0.448218
Finished training it 43008/76743 of epoch 3, 128.53 ms/it, loss 0.451607
Finished training it 43008/76743 of epoch 3, 129.08 ms/it, loss 0.450114
Finished training it 43008/76743 of epoch 3, 128.54 ms/it, loss 0.451542
rank 0 ranking from least wide range to the widest range [16  5 22 12 13 18  0  8 15  2 21  1 19 24  4 23  7 11 20  6 25 17  9  3
 10 14]
Finished training it 44032/76743 of epoch 3, 130.07 ms/it, loss 0.450975
Finished training it 44032/76743 of epoch 3, 129.62 ms/it, loss 0.450527
Finished training it 44032/76743 of epoch 3, 130.60 ms/it, loss 0.448892
Finished training it 44032/76743 of epoch 3, 129.71 ms/it, loss 0.447927
Finished training it 45056/76743 of epoch 3, 128.20 ms/it, loss 0.450264
Finished training it 45056/76743 of epoch 3, 128.68 ms/it, loss 0.450257
Finished training it 45056/76743 of epoch 3, 128.51 ms/it, loss 0.448676
rank 0 ranking from least wide range to the widest range [16  8 22 18  5 12 19  1  2 15  0  7 13  4 20  6 11 21 24 17 25 23  9  3
 10 14]
Finished training it 45056/76743 of epoch 3, 128.49 ms/it, loss 0.448457
rank 0 ranking from least wide range to the widest range [16  8 12 13  5  0  2 18 15  1 23 22  6 25 19 20  4 11 21 17  7 24 10  3
  9 14]
Finished training it 46080/76743 of epoch 3, 127.59 ms/it, loss 0.448580
Finished training it 46080/76743 of epoch 3, 127.22 ms/it, loss 0.451864
Finished training it 46080/76743 of epoch 3, 127.39 ms/it, loss 0.451158
Finished training it 46080/76743 of epoch 3, 127.60 ms/it, loss 0.449242
Finished training it 47104/76743 of epoch 3, 128.95 ms/it, loss 0.449031
rank 0 ranking from least wide range to the widest range [ 8 13 16  5 22  2 18 15  1  4  0 21 12 25 19 20 11  6 24 23  7  9 17 10
  3 14]
Finished training it 47104/76743 of epoch 3, 129.44 ms/it, loss 0.452914
Finished training it 47104/76743 of epoch 3, 129.37 ms/it, loss 0.449522
Finished training it 47104/76743 of epoch 3, 129.38 ms/it, loss 0.447979
Finished training it 48128/76743 of epoch 3, 128.37 ms/it, loss 0.448425
rank 0 ranking from least wide range to the widest range [16  8 22 15 12 13  5  2 21  0  4 17  1  6 18 24 19 11 20 23 25  7 10  9
  3 14]
Finished training it 48128/76743 of epoch 3, 128.58 ms/it, loss 0.449985
Finished training it 48128/76743 of epoch 3, 128.70 ms/it, loss 0.446762
Finished training it 48128/76743 of epoch 3, 128.40 ms/it, loss 0.450490
rank 0 ranking from least wide range to the widest range [18 22 16 13  5  8  0  4  2 15  7  1 12 20 25 19 24 23 11 21  6 17  3  9
 10 14]
Finished training it 49152/76743 of epoch 3, 129.50 ms/it, loss 0.448380
Finished training it 49152/76743 of epoch 3, 129.06 ms/it, loss 0.450481
Finished training it 49152/76743 of epoch 3, 129.02 ms/it, loss 0.449187
Finished training it 49152/76743 of epoch 3, 129.62 ms/it, loss 0.450180
rank 0 ranking from least wide range to the widest range [ 5 13 18 22  2 16 12  8 15  4  0 19 20 23 24 11  6 21 25  1  7 17  9 10
  3 14]
Finished training it 50176/76743 of epoch 3, 127.65 ms/it, loss 0.452897
Finished training it 50176/76743 of epoch 3, 127.20 ms/it, loss 0.450479
Finished training it 50176/76743 of epoch 3, 127.98 ms/it, loss 0.451546
Finished training it 50176/76743 of epoch 3, 127.32 ms/it, loss 0.450107
Finished training it 51200/76743 of epoch 3, 125.86 ms/it, loss 0.448540
rank 0 ranking from least wide range to the widest range [19  8  0 12  2  4 22 15 16  5 20 18 23 21 11 24  7  6 13  1 17 25  3  9
 10 14]
Finished training it 51200/76743 of epoch 3, 126.19 ms/it, loss 0.452026
Finished training it 51200/76743 of epoch 3, 125.94 ms/it, loss 0.447642
Finished training it 51200/76743 of epoch 3, 126.43 ms/it, loss 0.448944
Testing at - 51200/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2574709.0
get out
0 has test check 2574709.0 and sample count 3273728
 accuracy 78.648 %, best 78.661 %, roc auc score 0.7983, best 0.7985
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 22 12  8  5 15  7  4  6 18 19  0  2 21 13 20 11 17  1 24 23 25 10  9
  3 14]
Finished training it 52224/76743 of epoch 3, 129.07 ms/it, loss 0.449238
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2574674.0
get out
3 has test check 2574674.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 128.77 ms/it, loss 0.448232
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574776.0
get out
2 has test check 2574776.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 128.73 ms/it, loss 0.449482
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574755.0
get out
1 has test check 2574755.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 128.89 ms/it, loss 0.448825
rank 0 ranking from least wide range to the widest range [ 8 13 16 18 22 15  2 12 24  0 19  4  5 11 20  1 25 23  6 21  7 17  9  3
 14 10]
Finished training it 53248/76743 of epoch 3, 129.97 ms/it, loss 0.448694
Finished training it 53248/76743 of epoch 3, 129.22 ms/it, loss 0.451787
Finished training it 53248/76743 of epoch 3, 129.70 ms/it, loss 0.450474
Finished training it 53248/76743 of epoch 3, 129.26 ms/it, loss 0.451573
rank 0 ranking from least wide range to the widest range [22 19  8  0 18 15  5 12 13 16  2  4  7  6 20 11  1 21 23 17 24 25  9 10
  3 14]
Finished training it 54272/76743 of epoch 3, 128.41 ms/it, loss 0.449226
Finished training it 54272/76743 of epoch 3, 127.63 ms/it, loss 0.451198
Finished training it 54272/76743 of epoch 3, 127.90 ms/it, loss 0.449682
Finished training it 54272/76743 of epoch 3, 127.53 ms/it, loss 0.446917
rank 0 ranking from least wide range to the widest range [19 22 16  8 12 13  5  0 15 18  4  1  2  7 20 17 24 11  6 21 25 23  9 10
  3 14]
Finished training it 55296/76743 of epoch 3, 128.23 ms/it, loss 0.450090
Finished training it 55296/76743 of epoch 3, 127.39 ms/it, loss 0.446130
Finished training it 55296/76743 of epoch 3, 127.82 ms/it, loss 0.447565
Finished training it 55296/76743 of epoch 3, 127.77 ms/it, loss 0.448834
rank 0 ranking from least wide range to the widest range [16 22  5 12 13  8  0 19  2  4 21 20 23 18  6  1 15 11  7 25 17 24  9 10
  3 14]
Finished training it 56320/76743 of epoch 3, 125.40 ms/it, loss 0.449346
Finished training it 56320/76743 of epoch 3, 125.20 ms/it, loss 0.446604
Finished training it 56320/76743 of epoch 3, 125.09 ms/it, loss 0.451716
Finished training it 56320/76743 of epoch 3, 125.37 ms/it, loss 0.449149
Finished training it 57344/76743 of epoch 3, 128.85 ms/it, loss 0.447572
rank 0 ranking from least wide range to the widest range [22 16 12 15  8 19  4  2 21 13 18 20 23  5  0 11  6 17  7 25  1 24  9 10
  3 14]
Finished training it 57344/76743 of epoch 3, 129.20 ms/it, loss 0.450133
Finished training it 57344/76743 of epoch 3, 129.04 ms/it, loss 0.449398
Finished training it 57344/76743 of epoch 3, 129.40 ms/it, loss 0.451536
rank 0 ranking from least wide range to the widest range [ 8 13 19 16 18 12  4 22  5 15  0 24  1 21  2 20  6 17 25  7 23 11  9 10
  3 14]
Finished training it 58368/76743 of epoch 3, 126.69 ms/it, loss 0.446850
Finished training it 58368/76743 of epoch 3, 126.52 ms/it, loss 0.450938
Finished training it 58368/76743 of epoch 3, 126.59 ms/it, loss 0.451953
Finished training it 58368/76743 of epoch 3, 126.77 ms/it, loss 0.450597
Finished training it 59392/76743 of epoch 3, 128.48 ms/it, loss 0.448882
rank 0 ranking from least wide range to the widest range [16 18  8 15 22 13  5 19 20  2 12  7  0 11 24 23  6  1 25 21  4 17  9 10
  3 14]
Finished training it 59392/76743 of epoch 3, 129.07 ms/it, loss 0.450731
Finished training it 59392/76743 of epoch 3, 128.94 ms/it, loss 0.451004
Finished training it 59392/76743 of epoch 3, 128.49 ms/it, loss 0.446105
rank 0 ranking from least wide range to the widest range [16 12  8 13 19  5 18 15  2 24 22 21  0  6  4 20  1 11 23  7 17 25  9 10
  3 14]
Finished training it 60416/76743 of epoch 3, 127.80 ms/it, loss 0.446428
Finished training it 60416/76743 of epoch 3, 127.39 ms/it, loss 0.449957
Finished training it 60416/76743 of epoch 3, 127.69 ms/it, loss 0.450000
Finished training it 60416/76743 of epoch 3, 127.37 ms/it, loss 0.448981
rank 0 ranking from least wide range to the widest range [13 19 16  0 15 12  4 22  5  8  2 20  1 18 25 17  7 11  6 21 23 24  9 10
  3 14]
Finished training it 61440/76743 of epoch 3, 126.85 ms/it, loss 0.447718
Finished training it 61440/76743 of epoch 3, 126.59 ms/it, loss 0.447894
Finished training it 61440/76743 of epoch 3, 126.59 ms/it, loss 0.448444
Finished training it 61440/76743 of epoch 3, 127.17 ms/it, loss 0.451039
Testing at - 61440/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575779.0
get out
0 has test check 2575779.0 and sample count 3273728
 accuracy 78.680 %, best 78.680 %, roc auc score 0.7988, best 0.7988
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575437.0
get out
3 has test check 2575437.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 129.84 ms/it, loss 0.449746
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 8 19 18  5 22 16  0 13  4 12 15 21  7  2 20 24 23 17  6  1 25 11  9 10
  3 14]
Finished training it 62464/76743 of epoch 3, 130.47 ms/it, loss 0.446680
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575889.0
get out
1 has test check 2575889.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 130.28 ms/it, loss 0.450275
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575800.0
get out
2 has test check 2575800.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 130.04 ms/it, loss 0.450858
rank 0 ranking from least wide range to the widest range [22 16 19  5 13 15  7  8 12 24  0 18  2  1  6 20 17  4 21 11 23 25 10  9
  3 14]
Finished training it 63488/76743 of epoch 3, 128.32 ms/it, loss 0.449895
Finished training it 63488/76743 of epoch 3, 128.20 ms/it, loss 0.449425
Finished training it 63488/76743 of epoch 3, 127.81 ms/it, loss 0.449960
Finished training it 63488/76743 of epoch 3, 128.20 ms/it, loss 0.449681
rank 0 ranking from least wide range to the widest range [12 18  0 16 22  5 19  8 15 13  4  1  6 24  2  7 20 25 11 21 17 23 10  9
 14  3]
Finished training it 64512/76743 of epoch 3, 128.81 ms/it, loss 0.447865
Finished training it 64512/76743 of epoch 3, 128.15 ms/it, loss 0.449887
Finished training it 64512/76743 of epoch 3, 128.50 ms/it, loss 0.451272
Finished training it 64512/76743 of epoch 3, 128.27 ms/it, loss 0.450288
rank 0 ranking from least wide range to the widest range [16  0  5 15  8 22 18  2 24  4 13 19 20 12 23 11  6 25 17  7  1 21  9 10
  3 14]
Finished training it 65536/76743 of epoch 3, 127.29 ms/it, loss 0.449434
Finished training it 65536/76743 of epoch 3, 126.87 ms/it, loss 0.451031
Finished training it 65536/76743 of epoch 3, 127.25 ms/it, loss 0.449918
Finished training it 65536/76743 of epoch 3, 126.98 ms/it, loss 0.449422
rank 0 ranking from least wide range to the widest range [12 13 16  5 18  0 22  8 19 15 24  4  1 20  2 17  6 11  7 21 23 25  9 10
  3 14]
Finished training it 66560/76743 of epoch 3, 126.55 ms/it, loss 0.448606
Finished training it 66560/76743 of epoch 3, 126.54 ms/it, loss 0.451220
Finished training it 66560/76743 of epoch 3, 126.31 ms/it, loss 0.447457
Finished training it 66560/76743 of epoch 3, 126.10 ms/it, loss 0.447827
Finished training it 67584/76743 of epoch 3, 128.10 ms/it, loss 0.449989
Finished training it 67584/76743 of epoch 3, 128.03 ms/it, loss 0.448445
rank 0 ranking from least wide range to the widest range [18  8 13 12 15  5 22 16 19  1  2  0  7 20 23 24  6 21 11  4 25 17  9 10
  3 14]
Finished training it 67584/76743 of epoch 3, 129.08 ms/it, loss 0.449358
Finished training it 67584/76743 of epoch 3, 128.42 ms/it, loss 0.450241
Finished training it 68608/76743 of epoch 3, 125.10 ms/it, loss 0.449315
rank 0 ranking from least wide range to the widest range [ 8 18  0 12 16 19  2 15 22 20  5 24  7 17  4  1  6 11 13 23 25 21  9 10
  3 14]
Finished training it 68608/76743 of epoch 3, 125.03 ms/it, loss 0.445974
Finished training it 68608/76743 of epoch 3, 124.59 ms/it, loss 0.450775
Finished training it 68608/76743 of epoch 3, 125.05 ms/it, loss 0.449335
rank 0 ranking from least wide range to the widest range [22 15  8  5 12  0  4  1 18 21 13  2 20 16  7  6 11 17 19 23 24 25 10  9
  3 14]
Finished training it 69632/76743 of epoch 3, 128.37 ms/it, loss 0.448406
Finished training it 69632/76743 of epoch 3, 127.99 ms/it, loss 0.448125
Finished training it 69632/76743 of epoch 3, 128.20 ms/it, loss 0.448999
Finished training it 69632/76743 of epoch 3, 127.82 ms/it, loss 0.450857
rank 0 ranking from least wide range to the widest range [18  8 13 15  0 19  5  2 24  7 12 20 22 16  1 21 23 25 11  6 17  4  9 10
  3 14]
Finished training it 70656/76743 of epoch 3, 127.74 ms/it, loss 0.452239
Finished training it 70656/76743 of epoch 3, 127.71 ms/it, loss 0.449903
Finished training it 70656/76743 of epoch 3, 127.34 ms/it, loss 0.447489
Finished training it 70656/76743 of epoch 3, 127.84 ms/it, loss 0.448001
rank 0 ranking from least wide range to the widest range [22 15 16  8 12  4  1  7  2 18 13  5 20 23 11  6 24  0 19 17 21 25 10  9
  3 14]
Finished training it 71680/76743 of epoch 3, 127.38 ms/it, loss 0.449080
Finished training it 71680/76743 of epoch 3, 127.11 ms/it, loss 0.446787
Finished training it 71680/76743 of epoch 3, 127.00 ms/it, loss 0.448698
Finished training it 71680/76743 of epoch 3, 127.32 ms/it, loss 0.448938
Testing at - 71680/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575391.0
get out
0 has test check 2575391.0 and sample count 3273728
 accuracy 78.668 %, best 78.680 %, roc auc score 0.7987, best 0.7988
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 22  5 15 12 19 18 24 21  0  4  8  2 13 17  1 20 11  7 23  6 25  9 10
  3 14]
Finished training it 72704/76743 of epoch 3, 129.78 ms/it, loss 0.445911
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575808.0
get out
3 has test check 2575808.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 128.95 ms/it, loss 0.447239
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575724.0
get out
2 has test check 2575724.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 128.83 ms/it, loss 0.446472
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575804.0
get out
1 has test check 2575804.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 129.75 ms/it, loss 0.447419
rank 0 ranking from least wide range to the widest range [19 18 22  4  8 16  0  5 12  7  1 13 24  6 20  2 15 17 11 21 23 25  9 10
  3 14]
Finished training it 73728/76743 of epoch 3, 129.03 ms/it, loss 0.447760
Finished training it 73728/76743 of epoch 3, 128.26 ms/it, loss 0.449509
Finished training it 73728/76743 of epoch 3, 128.71 ms/it, loss 0.450367
Finished training it 73728/76743 of epoch 3, 128.28 ms/it, loss 0.447913
Finished training it 74752/76743 of epoch 3, 127.40 ms/it, loss 0.449661
Finished training it 74752/76743 of epoch 3, 127.09 ms/it, loss 0.447150
Finished training it 74752/76743 of epoch 3, 127.47 ms/it, loss 0.448878
rank 0 ranking from least wide range to the widest range [12 15 22 19 24 18 16  1  8  2 23  0 11 20  5  6  7 25  4 17 13 21 10  9
 14  3]
Finished training it 74752/76743 of epoch 3, 127.53 ms/it, loss 0.446033
rank 0 ranking from least wide range to the widest range [22 18 16 15 12  5  1 21  2  4  8 19 24 20  6  0 11 13  7 23 17 25 10  9
  3 14]
Finished training it 75776/76743 of epoch 3, 129.63 ms/it, loss 0.450230
Finished training it 75776/76743 of epoch 3, 128.94 ms/it, loss 0.449173
Finished training it 75776/76743 of epoch 3, 128.98 ms/it, loss 0.444978
Finished training it 75776/76743 of epoch 3, 129.27 ms/it, loss 0.448587
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [ 8 22 16 18 12  4  2 15  5 24 23  6 20  1  7 19 21  0 17 11 13 25 10  9
  3 14]
Finished training it 1024/76743 of epoch 4, 129.10 ms/it, loss 0.450660
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 128.64 ms/it, loss 0.446052
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 128.48 ms/it, loss 0.447892
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 128.98 ms/it, loss 0.447087
rank 0 ranking from least wide range to the widest range [16 18 12  0 13  8  7  4 22 15  5 24 19  6  2 23 20 11 21  1 17 25  9 10
  3 14]
Finished training it 2048/76743 of epoch 4, 127.70 ms/it, loss 0.449988
Finished training it 2048/76743 of epoch 4, 127.27 ms/it, loss 0.447581
Finished training it 2048/76743 of epoch 4, 127.66 ms/it, loss 0.448841
Finished training it 2048/76743 of epoch 4, 127.24 ms/it, loss 0.450827
Finished training it 3072/76743 of epoch 4, 127.97 ms/it, loss 0.449706
Finished training it 3072/76743 of epoch 4, 127.48 ms/it, loss 0.450117
rank 0 ranking from least wide range to the widest range [22 21 15 18 19 12  8 16  5  1  2 24  7  0  4 23 13 20  6 11 17 25 10  9
  3 14]
Finished training it 3072/76743 of epoch 4, 127.74 ms/it, loss 0.446013
Finished training it 3072/76743 of epoch 4, 127.66 ms/it, loss 0.447171
Finished training it 4096/76743 of epoch 4, 128.10 ms/it, loss 0.448444
Finished training it 4096/76743 of epoch 4, 127.56 ms/it, loss 0.446583
rank 0 ranking from least wide range to the widest range [22 15 16  5  0 12  8 19 18 24 20  4  2  6 13 11 21  1 17 23  7 25 10  9
  3 14]
Finished training it 4096/76743 of epoch 4, 127.93 ms/it, loss 0.450467
Finished training it 4096/76743 of epoch 4, 127.69 ms/it, loss 0.448377
Finished training it 5120/76743 of epoch 4, 129.35 ms/it, loss 0.449414
Finished training it 5120/76743 of epoch 4, 129.60 ms/it, loss 0.449027
rank 0 ranking from least wide range to the widest range [ 4  0 12  5 22 19 16 21 15  7 24  2  8 20 13  1 18 17 23 11  6 25  9 10
  3 14]
Finished training it 5120/76743 of epoch 4, 129.69 ms/it, loss 0.448023
Finished training it 5120/76743 of epoch 4, 129.89 ms/it, loss 0.450249
Finished training it 6144/76743 of epoch 4, 128.14 ms/it, loss 0.452137
Finished training it 6144/76743 of epoch 4, 127.55 ms/it, loss 0.448154
Finished training it 6144/76743 of epoch 4, 127.96 ms/it, loss 0.446959
rank 0 ranking from least wide range to the widest range [22 18 12  5 19  8 16  4 13 15 21  0  2  7 20 23 24 11  6  1 25 17 10  9
 14  3]
Finished training it 6144/76743 of epoch 4, 128.03 ms/it, loss 0.448822
rank 0 ranking from least wide range to the widest range [ 1 12 16 22  4  0 15  5  8 21  7 20 13 23 24  2 19  6 18 17 11 25 10  9
  3 14]
Finished training it 7168/76743 of epoch 4, 128.65 ms/it, loss 0.449240
Finished training it 7168/76743 of epoch 4, 128.52 ms/it, loss 0.447860
Finished training it 7168/76743 of epoch 4, 128.22 ms/it, loss 0.446059
Finished training it 7168/76743 of epoch 4, 128.65 ms/it, loss 0.448492
rank 0 ranking from least wide range to the widest range [15 12  5  6 16 22  2  0 20 23 11  8  7 13 18 19 17 21  4  1 10 25  9 24
  3 14]
Finished training it 8192/76743 of epoch 4, 127.56 ms/it, loss 0.447919
Finished training it 8192/76743 of epoch 4, 127.19 ms/it, loss 0.447217
Finished training it 8192/76743 of epoch 4, 127.21 ms/it, loss 0.448862
Finished training it 8192/76743 of epoch 4, 127.61 ms/it, loss 0.453064
rank 0 ranking from least wide range to the widest range [22  0 12 19 15  1  8 13 20  6 24  5 16  7  2 23 11 21 18 17 25  4  9 10
  3 14]
Finished training it 9216/76743 of epoch 4, 124.19 ms/it, loss 0.447909
Finished training it 9216/76743 of epoch 4, 124.06 ms/it, loss 0.446689
Finished training it 9216/76743 of epoch 4, 124.41 ms/it, loss 0.450359
Finished training it 9216/76743 of epoch 4, 124.03 ms/it, loss 0.445943
rank 0 ranking from least wide range to the widest range [16 12  8 22  4  5 18 19 13 15  0  1  7 24  2  6 20 17 21 11 23 25 10  9
  3 14]
Finished training it 10240/76743 of epoch 4, 125.36 ms/it, loss 0.450009
Finished training it 10240/76743 of epoch 4, 125.12 ms/it, loss 0.447829
Finished training it 10240/76743 of epoch 4, 125.09 ms/it, loss 0.448680
Finished training it 10240/76743 of epoch 4, 125.25 ms/it, loss 0.448312
Testing at - 10240/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576446.0
get out
0 has test check 2576446.0 and sample count 3273728
 accuracy 78.701 %, best 78.701 %, roc auc score 0.7992, best 0.7992
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16  5  8 12 22  4 19 15 18  0 21 24  2 20 13  1  7 23  6 11 25 17  9 10
 14  3]
Finished training it 11264/76743 of epoch 4, 129.81 ms/it, loss 0.447642
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576820.0
get out
3 has test check 2576820.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 129.67 ms/it, loss 0.449371
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576775.0
get out
1 has test check 2576775.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 130.02 ms/it, loss 0.451207
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576795.0
get out
2 has test check 2576795.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 129.74 ms/it, loss 0.451562
rank 0 ranking from least wide range to the widest range [22 16 19  5 12  8  1 15  0 21 24  7 18  2  6 20 25 13 11 23  4 17 10  9
  3 14]
Finished training it 12288/76743 of epoch 4, 126.72 ms/it, loss 0.448625
Finished training it 12288/76743 of epoch 4, 126.19 ms/it, loss 0.449113
Finished training it 12288/76743 of epoch 4, 126.18 ms/it, loss 0.448307
Finished training it 12288/76743 of epoch 4, 127.01 ms/it, loss 0.448341
rank 0 ranking from least wide range to the widest range [12 16 15  0  5  8  6 21 19 13 22  4  2 24 18  1  7 20 23 17 11 25  9 10
  3 14]
Finished training it 13312/76743 of epoch 4, 127.63 ms/it, loss 0.450233
Finished training it 13312/76743 of epoch 4, 127.19 ms/it, loss 0.448426
Finished training it 13312/76743 of epoch 4, 127.26 ms/it, loss 0.450758
Finished training it 13312/76743 of epoch 4, 126.95 ms/it, loss 0.449878
rank 0 ranking from least wide range to the widest range [18 12 22 19 21 15 13  0  5 16  4  1  8  7 24 20  6  2 17 11 25 23  9 10
  3 14]
Finished training it 14336/76743 of epoch 4, 131.57 ms/it, loss 0.447774
Finished training it 14336/76743 of epoch 4, 130.94 ms/it, loss 0.447644
Finished training it 14336/76743 of epoch 4, 131.27 ms/it, loss 0.447913
Finished training it 14336/76743 of epoch 4, 131.05 ms/it, loss 0.448361
rank 0 ranking from least wide range to the widest range [22 12 19 18  0  5  7 16 23 13 15  8  1  2 24  6  4 20 21 11 25 17  9 10
  3 14]
Finished training it 15360/76743 of epoch 4, 128.17 ms/it, loss 0.449484
Finished training it 15360/76743 of epoch 4, 127.95 ms/it, loss 0.449976
Finished training it 15360/76743 of epoch 4, 128.05 ms/it, loss 0.447432
Finished training it 15360/76743 of epoch 4, 128.10 ms/it, loss 0.448986
Finished training it 16384/76743 of epoch 4, 126.65 ms/it, loss 0.446761
rank 0 ranking from least wide range to the widest range [18 12 13  8 16 15 19  7 22  5 21  2  0 20 24 11  6  4  1 23 17 25  9 10
 14  3]
Finished training it 16384/76743 of epoch 4, 126.85 ms/it, loss 0.449966
Finished training it 16384/76743 of epoch 4, 126.70 ms/it, loss 0.449154
Finished training it 16384/76743 of epoch 4, 126.75 ms/it, loss 0.447025
rank 0 ranking from least wide range to the widest range [ 0 12 18 22 16 15  8 13  1 20  6  7  4  2 23 21 19 17 24 11  5 25 10  9
 14  3]
Finished training it 17408/76743 of epoch 4, 125.49 ms/it, loss 0.447086
Finished training it 17408/76743 of epoch 4, 125.11 ms/it, loss 0.449212
Finished training it 17408/76743 of epoch 4, 125.17 ms/it, loss 0.445607
Finished training it 17408/76743 of epoch 4, 125.38 ms/it, loss 0.449899
rank 0 ranking from least wide range to the widest range [12 21  8 16 13  0 18 22  4 19  5 24 15  7  2 20  6 11  1 23 25  9 17 10
  3 14]
Finished training it 18432/76743 of epoch 4, 127.96 ms/it, loss 0.445225
Finished training it 18432/76743 of epoch 4, 127.39 ms/it, loss 0.447350
Finished training it 18432/76743 of epoch 4, 127.76 ms/it, loss 0.446088
Finished training it 18432/76743 of epoch 4, 127.35 ms/it, loss 0.446163
rank 0 ranking from least wide range to the widest range [18  0 13  5 15 12 19  4  8 16 24 23  2 22 20  6  1 21 11  7 17 25  9 10
  3 14]
Finished training it 19456/76743 of epoch 4, 128.90 ms/it, loss 0.447123
Finished training it 19456/76743 of epoch 4, 128.97 ms/it, loss 0.444982
Finished training it 19456/76743 of epoch 4, 128.56 ms/it, loss 0.443057
Finished training it 19456/76743 of epoch 4, 128.73 ms/it, loss 0.448960
Finished training it 20480/76743 of epoch 4, 126.15 ms/it, loss 0.447786
rank 0 ranking from least wide range to the widest range [18  4  0 19  7 12  8 22  5 21 16 24  1 13 15 20  6 25  2 17 11 23  9 10
  3 14]
Finished training it 20480/76743 of epoch 4, 126.97 ms/it, loss 0.450055
Finished training it 20480/76743 of epoch 4, 126.77 ms/it, loss 0.447506
Finished training it 20480/76743 of epoch 4, 126.07 ms/it, loss 0.449560
Testing at - 20480/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576324.0
get out
0 has test check 2576324.0 and sample count 3273728
 accuracy 78.697 %, best 78.701 %, roc auc score 0.7997, best 0.7997
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [22 24 19 16 12 15 17  5 21 18  1  4 20  6  8  2 23 13  0 11  7 25 10  9
  3 14]
Finished training it 21504/76743 of epoch 4, 129.86 ms/it, loss 0.450225
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576486.0
get out
3 has test check 2576486.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 129.67 ms/it, loss 0.449864
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576627.0
get out
2 has test check 2576627.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 129.55 ms/it, loss 0.451010
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576554.0
get out
1 has test check 2576554.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 130.17 ms/it, loss 0.446773
rank 0 ranking from least wide range to the widest range [12 19 16 22 13 15 18  0  8  5  7  1 23 21  2 24 17 20  4  6 11 25  9 14
 10  3]
Finished training it 22528/76743 of epoch 4, 125.36 ms/it, loss 0.449534
Finished training it 22528/76743 of epoch 4, 125.15 ms/it, loss 0.446903
Finished training it 22528/76743 of epoch 4, 125.80 ms/it, loss 0.449705
Finished training it 22528/76743 of epoch 4, 125.09 ms/it, loss 0.450953
Finished training it 23552/76743 of epoch 4, 126.80 ms/it, loss 0.448617
rank 0 ranking from least wide range to the widest range [18 16 13 22  4 12  0  8  7 15 20  5  1 24 21  2  6 19 23 17 11 25  9 10
 14  3]
Finished training it 23552/76743 of epoch 4, 127.00 ms/it, loss 0.446821
Finished training it 23552/76743 of epoch 4, 127.12 ms/it, loss 0.446452
Finished training it 23552/76743 of epoch 4, 126.81 ms/it, loss 0.450856
rank 0 ranking from least wide range to the widest range [12 22 19 21 15  0 13 18  8 24  6  5 16  1  2  4 17 20 11 23  7 25 10  9
  3 14]
Finished training it 24576/76743 of epoch 4, 129.99 ms/it, loss 0.448538
Finished training it 24576/76743 of epoch 4, 129.18 ms/it, loss 0.445187
Finished training it 24576/76743 of epoch 4, 129.70 ms/it, loss 0.447636
Finished training it 24576/76743 of epoch 4, 129.35 ms/it, loss 0.448251
Finished training it 25600/76743 of epoch 4, 127.85 ms/it, loss 0.450302
rank 0 ranking from least wide range to the widest range [22 13 12  7 16 21  4  5  1 24 19 15 20  8  2  6  0 18 23 11 17 25  9 10
  3 14]
Finished training it 25600/76743 of epoch 4, 128.24 ms/it, loss 0.447680
Finished training it 25600/76743 of epoch 4, 128.34 ms/it, loss 0.448638
Finished training it 25600/76743 of epoch 4, 128.54 ms/it, loss 0.448105
rank 0 ranking from least wide range to the widest range [ 0 16 22 19  5 12 13 24  1 21 18  8 20 15  2  7  6  4 23 11 17 25  9 10
  3 14]
Finished training it 26624/76743 of epoch 4, 131.11 ms/it, loss 0.446675
Finished training it 26624/76743 of epoch 4, 130.96 ms/it, loss 0.451234
Finished training it 26624/76743 of epoch 4, 131.25 ms/it, loss 0.447061
Finished training it 26624/76743 of epoch 4, 130.99 ms/it, loss 0.448543
rank 0 ranking from least wide range to the widest range [19 16 12  7 22 18  5  8  0  1 13 15 21  2 20 24  4  6 11 17 23 25 10  9
  3 14]
Finished training it 27648/76743 of epoch 4, 129.61 ms/it, loss 0.448850
Finished training it 27648/76743 of epoch 4, 129.10 ms/it, loss 0.443855
Finished training it 27648/76743 of epoch 4, 129.12 ms/it, loss 0.447994
Finished training it 27648/76743 of epoch 4, 129.53 ms/it, loss 0.447762
rank 0 ranking from least wide range to the widest range [18 19 16 12 24 21  0  8 13 22  1 15  5  7  4 20  2  6 23 11 17 25 10  9
  3 14]
Finished training it 28672/76743 of epoch 4, 129.31 ms/it, loss 0.446284
Finished training it 28672/76743 of epoch 4, 129.20 ms/it, loss 0.445198
Finished training it 28672/76743 of epoch 4, 128.87 ms/it, loss 0.449009
Finished training it 28672/76743 of epoch 4, 128.91 ms/it, loss 0.449609
rank 0 ranking from least wide range to the widest range [13 12 22  0  5  4 16 15 20  7 24 18  6  2 21 19  8  1 11 17 23 25  9 10
  3 14]
Finished training it 29696/76743 of epoch 4, 131.44 ms/it, loss 0.448957
Finished training it 29696/76743 of epoch 4, 130.86 ms/it, loss 0.449202
Finished training it 29696/76743 of epoch 4, 131.15 ms/it, loss 0.445265
Finished training it 29696/76743 of epoch 4, 131.28 ms/it, loss 0.449994
rank 0 ranking from least wide range to the widest range [12 18 22  4 15 16  5 21 19  2  0  1  6 23 13 20  7 17 24 11 25  8  9 10
  3 14]
Finished training it 30720/76743 of epoch 4, 126.29 ms/it, loss 0.448413
Finished training it 30720/76743 of epoch 4, 126.04 ms/it, loss 0.449964
Finished training it 30720/76743 of epoch 4, 125.91 ms/it, loss 0.448584
Finished training it 30720/76743 of epoch 4, 126.24 ms/it, loss 0.451066
Testing at - 30720/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570926.0
get out
0 has test check 2570926.0 and sample count 3273728
 accuracy 78.532 %, best 78.701 %, roc auc score 0.7994, best 0.7997
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570545.0
get out
2 has test check 2570545.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 129.21 ms/it, loss 0.451178
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570849.0
get out
3 has test check 2570849.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 129.25 ms/it, loss 0.447702
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 22 19 18  4 15 24  5  0 12  1  7 13 20 21  6 23  2  8 11 17 25  9 10
  3 14]
Finished training it 31744/76743 of epoch 4, 129.62 ms/it, loss 0.447578
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570902.0
get out
1 has test check 2570902.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 129.59 ms/it, loss 0.451115
rank 0 ranking from least wide range to the widest range [22 13 12 18 16  8 15 19 21  0  5  1 23  7  4 20 24  2  6 17 11 25  9 10
  3 14]
Finished training it 32768/76743 of epoch 4, 127.03 ms/it, loss 0.447257
Finished training it 32768/76743 of epoch 4, 126.30 ms/it, loss 0.448206
Finished training it 32768/76743 of epoch 4, 126.21 ms/it, loss 0.447840
Finished training it 32768/76743 of epoch 4, 126.33 ms/it, loss 0.445904
rank 0 ranking from least wide range to the widest range [ 5 12 19 22  7 20 13  0 21 16  2 15  6 23 24  4 18  1 17 11  8 25  9 10
  3 14]
Finished training it 33792/76743 of epoch 4, 128.06 ms/it, loss 0.448171
Finished training it 33792/76743 of epoch 4, 127.46 ms/it, loss 0.447827
Finished training it 33792/76743 of epoch 4, 127.67 ms/it, loss 0.448260
Finished training it 33792/76743 of epoch 4, 127.39 ms/it, loss 0.450217
rank 0 ranking from least wide range to the widest range [22 19 18 12  0 24 21 16  8  5 13  7  1 20  4  6 17 23 15  2 25 11  9 10
 14  3]
Finished training it 34816/76743 of epoch 4, 124.79 ms/it, loss 0.448855
Finished training it 34816/76743 of epoch 4, 124.14 ms/it, loss 0.447796
Finished training it 34816/76743 of epoch 4, 124.37 ms/it, loss 0.447340
Finished training it 34816/76743 of epoch 4, 124.34 ms/it, loss 0.450322
rank 0 ranking from least wide range to the widest range [12 19 16  5  4 21 18 22 15 13  8  0 24  6 20  7  1  2 23 17 11 25  9 10
 14  3]
Finished training it 35840/76743 of epoch 4, 127.73 ms/it, loss 0.448755
Finished training it 35840/76743 of epoch 4, 127.37 ms/it, loss 0.449091
Finished training it 35840/76743 of epoch 4, 127.43 ms/it, loss 0.450610
Finished training it 35840/76743 of epoch 4, 127.63 ms/it, loss 0.445887
rank 0 ranking from least wide range to the widest range [22  0 19 18 12 24 15  5  1 20 23  7 16  2 17 13  6  8 21  4 11 25 10  9
 14  3]
Finished training it 36864/76743 of epoch 4, 126.85 ms/it, loss 0.447824
Finished training it 36864/76743 of epoch 4, 126.52 ms/it, loss 0.445248
Finished training it 36864/76743 of epoch 4, 126.76 ms/it, loss 0.446120
Finished training it 36864/76743 of epoch 4, 126.87 ms/it, loss 0.448082
rank 0 ranking from least wide range to the widest range [16 12  0 18 22 13 15  4 17  1  7  5 20 19  8 21  6 24  2 23 11 25 10  9
  3 14]
Finished training it 37888/76743 of epoch 4, 130.37 ms/it, loss 0.446450
Finished training it 37888/76743 of epoch 4, 130.34 ms/it, loss 0.448226
Finished training it 37888/76743 of epoch 4, 130.08 ms/it, loss 0.447380
Finished training it 37888/76743 of epoch 4, 129.95 ms/it, loss 0.450001
Finished training it 38912/76743 of epoch 4, 129.04 ms/it, loss 0.447088
Finished training it 38912/76743 of epoch 4, 129.04 ms/it, loss 0.446961
rank 0 ranking from least wide range to the widest range [19 18 16 12 22 13  5 24 20  4  8 21  6  7  0  2 15 17 23  1 11 10 25  9
  3 14]
Finished training it 38912/76743 of epoch 4, 129.65 ms/it, loss 0.445815
Finished training it 38912/76743 of epoch 4, 129.33 ms/it, loss 0.445140
rank 0 ranking from least wide range to the widest range [22 16 13 15 19 12  1 21 18  4  8 20  5  0 23  7  2 24 17  6 11 25  9 10
  3 14]
Finished training it 39936/76743 of epoch 4, 126.74 ms/it, loss 0.448132
Finished training it 39936/76743 of epoch 4, 126.21 ms/it, loss 0.445801
Finished training it 39936/76743 of epoch 4, 126.50 ms/it, loss 0.447352
Finished training it 39936/76743 of epoch 4, 126.44 ms/it, loss 0.446700
rank 0 ranking from least wide range to the widest range [18 19 12 16 22  4  1 20  8 21 13  5  0 17  2 15  6  7 24 23 11 25 10  9
 14  3]
Finished training it 40960/76743 of epoch 4, 128.75 ms/it, loss 0.445946
Finished training it 40960/76743 of epoch 4, 128.56 ms/it, loss 0.448391
Finished training it 40960/76743 of epoch 4, 128.44 ms/it, loss 0.450364
Finished training it 40960/76743 of epoch 4, 128.93 ms/it, loss 0.447765
Testing at - 40960/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577141.0
get out
0 has test check 2577141.0 and sample count 3273728
 accuracy 78.722 %, best 78.722 %, roc auc score 0.8000, best 0.8000
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13 22 12  8 21  5 16 24  0 19 15 18 20  4  1  6  2  7 17 11 23 25 10  9
  3 14]
Finished training it 41984/76743 of epoch 4, 126.93 ms/it, loss 0.446356
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2577017.0
get out
1 has test check 2577017.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 126.94 ms/it, loss 0.449908
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577031.0
get out
3 has test check 2577031.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 126.95 ms/it, loss 0.445925
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577121.0
get out
2 has test check 2577121.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 126.74 ms/it, loss 0.450296
Finished training it 43008/76743 of epoch 4, 127.30 ms/it, loss 0.449604
Finished training it 43008/76743 of epoch 4, 127.23 ms/it, loss 0.449685
rank 0 ranking from least wide range to the widest range [22 13  0 18  5 12  1 15 24 17  4 21 20 19  7  2  8  6 23 16 11 25 10  9
  3 14]
Finished training it 43008/76743 of epoch 4, 127.72 ms/it, loss 0.445908
Finished training it 43008/76743 of epoch 4, 127.39 ms/it, loss 0.448195
rank 0 ranking from least wide range to the widest range [12 19 18  1 13  5 16 21 15 24  4 22 20  8  0  7  6  2 23 11 17 25  9 10
  3 14]
Finished training it 44032/76743 of epoch 4, 129.45 ms/it, loss 0.448513
Finished training it 44032/76743 of epoch 4, 129.24 ms/it, loss 0.448776
Finished training it 44032/76743 of epoch 4, 129.18 ms/it, loss 0.445837
Finished training it 44032/76743 of epoch 4, 129.41 ms/it, loss 0.446876
rank 0 ranking from least wide range to the widest range [16 12 22 19  7  5 18 15  1  8 20 13  4  0  2 24  6 21 11 23 17 25  9 10
  3 14]
Finished training it 45056/76743 of epoch 4, 129.23 ms/it, loss 0.446516
Finished training it 45056/76743 of epoch 4, 129.04 ms/it, loss 0.448506
Finished training it 45056/76743 of epoch 4, 129.27 ms/it, loss 0.446587
Finished training it 45056/76743 of epoch 4, 129.74 ms/it, loss 0.448504
Finished training it 46080/76743 of epoch 4, 127.86 ms/it, loss 0.450263
Finished training it 46080/76743 of epoch 4, 127.62 ms/it, loss 0.449144
rank 0 ranking from least wide range to the widest range [12 16 13  0 18  1 22  4  8 19  6 24 23 20  2  5 15  7 17 25 11 21  9 10
  3 14]
Finished training it 46080/76743 of epoch 4, 127.94 ms/it, loss 0.446208
Finished training it 46080/76743 of epoch 4, 128.09 ms/it, loss 0.447147
Finished training it 47104/76743 of epoch 4, 127.41 ms/it, loss 0.445911
Finished training it 47104/76743 of epoch 4, 127.82 ms/it, loss 0.447261
rank 0 ranking from least wide range to the widest range [ 5 13 22 21  8 18  1 19 16 15 24 20 12  4  2 23  7  6 25  0 11 17  9 10
  3 14]
Finished training it 47104/76743 of epoch 4, 127.77 ms/it, loss 0.450653
Finished training it 47104/76743 of epoch 4, 127.97 ms/it, loss 0.447069
Finished training it 48128/76743 of epoch 4, 126.15 ms/it, loss 0.446349
rank 0 ranking from least wide range to the widest range [16 15 22 12 13  5  8 19  0 21  4 24  1 20 18  7  6 17  2 11 23 10 25  9
 14  3]
Finished training it 48128/76743 of epoch 4, 126.34 ms/it, loss 0.447888
Finished training it 48128/76743 of epoch 4, 126.83 ms/it, loss 0.444675
Finished training it 48128/76743 of epoch 4, 126.34 ms/it, loss 0.448144
Finished training it 49152/76743 of epoch 4, 128.25 ms/it, loss 0.448612
rank 0 ranking from least wide range to the widest range [18 12 22 16 13 19  4  5  7 15  1 21  0 20  8 23  2 24 17  6 11 25 10  9
  3 14]
Finished training it 49152/76743 of epoch 4, 129.03 ms/it, loss 0.446664
Finished training it 49152/76743 of epoch 4, 128.65 ms/it, loss 0.448517
Finished training it 49152/76743 of epoch 4, 128.48 ms/it, loss 0.447063
rank 0 ranking from least wide range to the widest range [22 13 18 12 15  5 24 19 20 16 23  4  7  1  8  0  6  2 17 21 11 25  9 10
 14  3]
Finished training it 50176/76743 of epoch 4, 128.62 ms/it, loss 0.450951
Finished training it 50176/76743 of epoch 4, 128.53 ms/it, loss 0.450105
Finished training it 50176/76743 of epoch 4, 127.59 ms/it, loss 0.447665
Finished training it 50176/76743 of epoch 4, 127.75 ms/it, loss 0.448785
Finished training it 51200/76743 of epoch 4, 129.14 ms/it, loss 0.445696
Finished training it 51200/76743 of epoch 4, 128.69 ms/it, loss 0.446512
rank 0 ranking from least wide range to the widest range [19 12  4 24 22 15 20  5  8  0 21  2 16 18  1 17 23  6  7 13 11 25  9 10
  3 14]
Finished training it 51200/76743 of epoch 4, 129.18 ms/it, loss 0.450267
Finished training it 51200/76743 of epoch 4, 129.28 ms/it, loss 0.446599
Testing at - 51200/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577329.0
get out
0 has test check 2577329.0 and sample count 3273728
 accuracy 78.728 %, best 78.728 %, roc auc score 0.7996, best 0.8000
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 12 22 15  7  8 13 18 20 19 23  6  1  2  0 21  4  5 17 24 11 25 10  9
  3 14]
Finished training it 52224/76743 of epoch 4, 131.68 ms/it, loss 0.446907
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577191.0
get out
3 has test check 2577191.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 131.57 ms/it, loss 0.446171
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2577443.0
get out
1 has test check 2577443.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 131.81 ms/it, loss 0.446631
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577534.0
get out
2 has test check 2577534.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 131.38 ms/it, loss 0.446990
rank 0 ranking from least wide range to the widest range [16 12 18 22 13 19 15  8  5  4  1 20 24  0 21  7  2  6 23 17 25 11  9 10
 14  3]
Finished training it 53248/76743 of epoch 4, 129.22 ms/it, loss 0.446553
Finished training it 53248/76743 of epoch 4, 129.52 ms/it, loss 0.448605
Finished training it 53248/76743 of epoch 4, 128.85 ms/it, loss 0.449468
Finished training it 53248/76743 of epoch 4, 128.66 ms/it, loss 0.448878
rank 0 ranking from least wide range to the widest range [19 12  7  0 18 22 15 21 13  8 16  4  1 20  5 17 24  6  2 23 25 11 10  9
 14  3]
Finished training it 54272/76743 of epoch 4, 129.98 ms/it, loss 0.447023
Finished training it 54272/76743 of epoch 4, 129.57 ms/it, loss 0.449172
Finished training it 54272/76743 of epoch 4, 129.71 ms/it, loss 0.444663
Finished training it 54272/76743 of epoch 4, 130.26 ms/it, loss 0.447818
rank 0 ranking from least wide range to the widest range [19 12 22 15 16 13  4  5  8  1 18 20  0  7 24 17 21  2  6 11 23  9 25 10
 14  3]
Finished training it 55296/76743 of epoch 4, 128.19 ms/it, loss 0.448187
Finished training it 55296/76743 of epoch 4, 128.03 ms/it, loss 0.446489
Finished training it 55296/76743 of epoch 4, 127.49 ms/it, loss 0.445944
Finished training it 55296/76743 of epoch 4, 127.51 ms/it, loss 0.444236
rank 0 ranking from least wide range to the widest range [19 12 22 16 13  4  5 20  0  7 21  8  1 15  2  6 23 18 17 24 11 25  9 10
  3 14]
Finished training it 56320/76743 of epoch 4, 127.89 ms/it, loss 0.447660
Finished training it 56320/76743 of epoch 4, 127.57 ms/it, loss 0.444652
Finished training it 56320/76743 of epoch 4, 128.25 ms/it, loss 0.447132
Finished training it 56320/76743 of epoch 4, 127.38 ms/it, loss 0.450061
Finished training it 57344/76743 of epoch 4, 128.69 ms/it, loss 0.447472
Finished training it 57344/76743 of epoch 4, 128.74 ms/it, loss 0.445573
rank 0 ranking from least wide range to the widest range [12 19 18 16 15 21 20  4  0 22 23  8 24 13  2 17  7  6  1 11  5 25 10  9
 14  3]
Finished training it 57344/76743 of epoch 4, 129.05 ms/it, loss 0.448395
Finished training it 57344/76743 of epoch 4, 129.08 ms/it, loss 0.449799
rank 0 ranking from least wide range to the widest range [18 19  4 16 12 13  8 24  0 22  1  5 21 15 20 23  7 17  2  6 25  9 11 10
  3 14]
Finished training it 58368/76743 of epoch 4, 130.10 ms/it, loss 0.445071
Finished training it 58368/76743 of epoch 4, 129.96 ms/it, loss 0.450339
Finished training it 58368/76743 of epoch 4, 129.80 ms/it, loss 0.449291
Finished training it 58368/76743 of epoch 4, 130.46 ms/it, loss 0.448559
rank 0 ranking from least wide range to the widest range [16 19 18 13 12  8 15 20 24  7  5  0 22  1  2  4  6 21 23 17 11 25  9 10
  3 14]
Finished training it 59392/76743 of epoch 4, 126.93 ms/it, loss 0.448962
Finished training it 59392/76743 of epoch 4, 126.85 ms/it, loss 0.444604
Finished training it 59392/76743 of epoch 4, 127.02 ms/it, loss 0.449519
Finished training it 59392/76743 of epoch 4, 126.83 ms/it, loss 0.446855
rank 0 ranking from least wide range to the widest range [16 12 19 18 13 15  8 24 22  1  5 21  7 20  2 23  6  4  0 17 11 25 10  9
  3 14]
Finished training it 60416/76743 of epoch 4, 128.86 ms/it, loss 0.444508
Finished training it 60416/76743 of epoch 4, 128.57 ms/it, loss 0.448156
Finished training it 60416/76743 of epoch 4, 128.75 ms/it, loss 0.448339
Finished training it 60416/76743 of epoch 4, 128.44 ms/it, loss 0.447336
rank 0 ranking from least wide range to the widest range [12 19 13 15 22  4 16  5 20  1  8  7 17  2  6 18 23 21  0 24 11 25  9 10
  3 14]
Finished training it 61440/76743 of epoch 4, 121.67 ms/it, loss 0.445659
Finished training it 61440/76743 of epoch 4, 121.55 ms/it, loss 0.446330
Finished training it 61440/76743 of epoch 4, 121.79 ms/it, loss 0.446134
Finished training it 61440/76743 of epoch 4, 121.93 ms/it, loss 0.448962
Testing at - 61440/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577162.0
get out
0 has test check 2577162.0 and sample count 3273728
 accuracy 78.723 %, best 78.728 %, roc auc score 0.8000, best 0.8000
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [19 16  8 22  5  7  0 12  4 18 13 20 15 24  1  6 17 21  2 23 25 10 11  9
  3 14]
Finished training it 62464/76743 of epoch 4, 130.52 ms/it, loss 0.444792
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577338.0
get out
3 has test check 2577338.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 130.18 ms/it, loss 0.448162
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2577234.0
get out
1 has test check 2577234.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 130.58 ms/it, loss 0.448400
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577277.0
get out
2 has test check 2577277.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 130.32 ms/it, loss 0.449226
rank 0 ranking from least wide range to the widest range [19 22 16  4 13 24 12  8  0  7  1 20  6 15 21 17  2 18  5 23 10 11  9 25
 14  3]
Finished training it 63488/76743 of epoch 4, 123.14 ms/it, loss 0.448337
Finished training it 63488/76743 of epoch 4, 123.47 ms/it, loss 0.448226
Finished training it 63488/76743 of epoch 4, 124.06 ms/it, loss 0.447897
Finished training it 63488/76743 of epoch 4, 122.93 ms/it, loss 0.447323
rank 0 ranking from least wide range to the widest range [12 19 18 16  0  4 15 22  7 13 24  1 20  6  5  8  2 23 17 25 21 11 10  9
 14  3]
Finished training it 64512/76743 of epoch 4, 127.50 ms/it, loss 0.446455
Finished training it 64512/76743 of epoch 4, 127.50 ms/it, loss 0.448571
Finished training it 64512/76743 of epoch 4, 127.28 ms/it, loss 0.448120
Finished training it 64512/76743 of epoch 4, 127.57 ms/it, loss 0.449378
Finished training it 65536/76743 of epoch 4, 128.57 ms/it, loss 0.447738
rank 0 ranking from least wide range to the widest range [22 18 16 15 19 13  0  5  4  7  8 20 12  2  6 17 23 24 21  1 11 25 10  9
  3 14]
Finished training it 65536/76743 of epoch 4, 128.93 ms/it, loss 0.447467
Finished training it 65536/76743 of epoch 4, 128.63 ms/it, loss 0.449242
Finished training it 65536/76743 of epoch 4, 129.05 ms/it, loss 0.448388
rank 0 ranking from least wide range to the widest range [19 16 12  0 18 22 13 15  4 24  7 20 17  1  8  5  6  2 23 21 11 25  9 10
  3 14]
Finished training it 66560/76743 of epoch 4, 126.58 ms/it, loss 0.447122
Finished training it 66560/76743 of epoch 4, 125.96 ms/it, loss 0.446096
Finished training it 66560/76743 of epoch 4, 126.88 ms/it, loss 0.449766
Finished training it 66560/76743 of epoch 4, 126.38 ms/it, loss 0.445820
rank 0 ranking from least wide range to the widest range [19 13 15 12 22 18 21  1  8 20  7 16  5 23  2  6  0 24  4 17 11 25  9 10
  3 14]
Finished training it 67584/76743 of epoch 4, 126.34 ms/it, loss 0.447660
Finished training it 67584/76743 of epoch 4, 126.34 ms/it, loss 0.446491
Finished training it 67584/76743 of epoch 4, 127.05 ms/it, loss 0.448536
Finished training it 67584/76743 of epoch 4, 125.92 ms/it, loss 0.448588
rank 0 ranking from least wide range to the widest range [19 16 12 18 15  7  8  5  0 24 20 22  4 17  2  1  6 13 21 23 11 10 25  9
 14  3]
Finished training it 68608/76743 of epoch 4, 127.11 ms/it, loss 0.444428
Finished training it 68608/76743 of epoch 4, 128.41 ms/it, loss 0.447557
Finished training it 68608/76743 of epoch 4, 126.75 ms/it, loss 0.449085
Finished training it 68608/76743 of epoch 4, 127.04 ms/it, loss 0.447302
rank 0 ranking from least wide range to the widest range [22 15 12  7  4  5 19 18 20 13 21  1  8  0 16  2  6 17 24 23 11 10  9 25
 14  3]
Finished training it 69632/76743 of epoch 4, 122.36 ms/it, loss 0.446696
Finished training it 69632/76743 of epoch 4, 122.63 ms/it, loss 0.446735
Finished training it 69632/76743 of epoch 4, 122.79 ms/it, loss 0.447168
Finished training it 69632/76743 of epoch 4, 122.21 ms/it, loss 0.449082
rank 0 ranking from least wide range to the widest range [18 13 15 19 20  0 24  2 12  8  7  1 23  5  6 16 17 21 22 11 25  4 10  9
  3 14]
Finished training it 70656/76743 of epoch 4, 124.96 ms/it, loss 0.450534
Finished training it 70656/76743 of epoch 4, 124.49 ms/it, loss 0.448597
Finished training it 70656/76743 of epoch 4, 125.04 ms/it, loss 0.445941
Finished training it 70656/76743 of epoch 4, 125.01 ms/it, loss 0.446267
rank 0 ranking from least wide range to the widest range [ 4 15  8 12 22 16 13 18  1  7 20 19  5 24  0  2  6 23 17 21 11 25 10  9
  3 14]
Finished training it 71680/76743 of epoch 4, 126.78 ms/it, loss 0.447414
Finished training it 71680/76743 of epoch 4, 126.41 ms/it, loss 0.445354
Finished training it 71680/76743 of epoch 4, 126.49 ms/it, loss 0.446512
Finished training it 71680/76743 of epoch 4, 126.75 ms/it, loss 0.447105
Testing at - 71680/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575977.0
get out
0 has test check 2575977.0 and sample count 3273728
 accuracy 78.686 %, best 78.728 %, roc auc score 0.8003, best 0.8003
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576098.0
get out
3 has test check 2576098.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 127.14 ms/it, loss 0.445736
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576630.0
get out
2 has test check 2576630.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 127.47 ms/it, loss 0.444621
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [16 19 12 15  5 22  4 18  1  0 21 24 20 13  7  2 17  8  6 23 11 10 25  9
 14  3]
Finished training it 72704/76743 of epoch 4, 127.57 ms/it, loss 0.444114
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576472.0
get out
1 has test check 2576472.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 127.71 ms/it, loss 0.445565
rank 0 ranking from least wide range to the widest range [ 4 19 12 22 16  7 18  8 13 20  1 24  0  5  6 15 17  2 23 21  9 11 25 10
 14  3]
Finished training it 73728/76743 of epoch 4, 128.65 ms/it, loss 0.446166
Finished training it 73728/76743 of epoch 4, 128.35 ms/it, loss 0.447806
Finished training it 73728/76743 of epoch 4, 128.25 ms/it, loss 0.446216
Finished training it 73728/76743 of epoch 4, 128.76 ms/it, loss 0.448672
rank 0 ranking from least wide range to the widest range [12 19 15 22 16 24 20  1 18  6 23  7  2  8  4 13 21  5 17  0 11 10 25  9
 14  3]
Finished training it 74752/76743 of epoch 4, 127.85 ms/it, loss 0.444567
Finished training it 74752/76743 of epoch 4, 126.63 ms/it, loss 0.445847
Finished training it 74752/76743 of epoch 4, 127.05 ms/it, loss 0.447097
Finished training it 74752/76743 of epoch 4, 126.83 ms/it, loss 0.447866
rank 0 ranking from least wide range to the widest range [16 18 12 19 24 15 20  1  7  6 22  0  4  5  2 13 17 21  8 23 11 10  9 25
 14  3]
Finished training it 75776/76743 of epoch 4, 129.80 ms/it, loss 0.448636
Finished training it 75776/76743 of epoch 4, 128.83 ms/it, loss 0.443316
Finished training it 75776/76743 of epoch 4, 129.00 ms/it, loss 0.447553
Finished training it 75776/76743 of epoch 4, 129.25 ms/it, loss 0.446991
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2578589.0
get out
0 has test check 2578589.0 and sample count 3273728
 accuracy 78.766 %, best 78.766 %, roc auc score 0.8006, best 0.8006
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577981.0
get out
2 has test check 2577981.0 and sample count 3273728
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2578516.0
get out
3 has test check 2578516.0 and sample count 3273728
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.4944335937500002.pt
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2578372.0
get out
1 has test check 2578372.0 and sample count 3273728
