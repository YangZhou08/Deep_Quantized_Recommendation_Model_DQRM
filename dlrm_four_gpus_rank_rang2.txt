Unable to import mlperf_logging,  No module named 'mlperf_logging'
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0233, -0.0012,  0.0223,  0.0241,  0.0243, -0.0058,  0.0193,  0.0047,
        -0.0118,  0.0208, -0.0173, -0.0162,  0.0230,  0.0141, -0.0167,  0.0196])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
rank 0 ranking from least wide range to the widest range [22  1 16 19  5 12  7  4  8 21 24 13  6 18 17 14  0 10  9  3 11 15 25 23
  2 20]
Finished training it 1024/76743 of epoch 0, 136.25 ms/it, loss 0.556212
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0051,  0.0129, -0.0008, -0.0015,  0.0003,  0.0198,  0.0022,  0.0255,
        -0.0248, -0.0219,  0.0047,  0.0060,  0.0101,  0.0170, -0.0016, -0.0244])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 135.50 ms/it, loss 0.557992
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0093,  0.0108,  0.0061,  0.0153, -0.0051, -0.0094, -0.0210,  0.0127,
         0.0135,  0.0105, -0.0101, -0.0050, -0.0198,  0.0205,  0.0216,  0.0114])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 135.81 ms/it, loss 0.558778
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([-0.0169,  0.0169,  0.0036,  0.0167,  0.0158,  0.0215,  0.0183,  0.0178,
         0.0009,  0.0117, -0.0086,  0.0055, -0.0145, -0.0016, -0.0068,  0.0140])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 135.43 ms/it, loss 0.559750
rank 0 ranking from least wide range to the widest range [ 5 22  4 12  1  7  8 19 24 21  6 18  9 16 14  0 17 25  3 13 10 11 23 15
  2 20]
Finished training it 2048/76743 of epoch 0, 136.24 ms/it, loss 0.518405
Finished training it 2048/76743 of epoch 0, 136.26 ms/it, loss 0.517558
Finished training it 2048/76743 of epoch 0, 136.26 ms/it, loss 0.519217
Finished training it 2048/76743 of epoch 0, 136.35 ms/it, loss 0.520116
rank 0 ranking from least wide range to the widest range [ 5 12 22 19  7  1  4 24  8 18  6  0 21  3 14  2  9 23 25 15 10 17 11 20
 16 13]
Finished training it 3072/76743 of epoch 0, 136.73 ms/it, loss 0.509572
Finished training it 3072/76743 of epoch 0, 136.75 ms/it, loss 0.507932
Finished training it 3072/76743 of epoch 0, 136.70 ms/it, loss 0.505486
Finished training it 3072/76743 of epoch 0, 136.74 ms/it, loss 0.506861
Finished training it 4096/76743 of epoch 0, 136.90 ms/it, loss 0.501634
rank 0 ranking from least wide range to the widest range [ 5 12 19 22  7  8  1  6  4  0  9  3 21 24 23 10 14  2 17 11 15 20 18 13
 16 25]
Finished training it 4096/76743 of epoch 0, 136.81 ms/it, loss 0.503045
Finished training it 4096/76743 of epoch 0, 136.72 ms/it, loss 0.499678
Finished training it 4096/76743 of epoch 0, 136.79 ms/it, loss 0.501527
Finished training it 5120/76743 of epoch 0, 136.95 ms/it, loss 0.496439
Finished training it 5120/76743 of epoch 0, 136.97 ms/it, loss 0.493736
rank 0 ranking from least wide range to the widest range [12 22  4 19  5  6  8  7  0 21  9 16 24  2  1  3 13 11 20 14 15 10 23 18
 17 25]
Finished training it 5120/76743 of epoch 0, 137.01 ms/it, loss 0.495304
Finished training it 5120/76743 of epoch 0, 137.06 ms/it, loss 0.493966
rank 0 ranking from least wide range to the widest range [ 4 19 12  8 22  5  0 21  7  6  1 24  2 18 16  9 11 14 20 13 25 15 23  3
 17 10]
Finished training it 6144/76743 of epoch 0, 136.75 ms/it, loss 0.489625
Finished training it 6144/76743 of epoch 0, 136.78 ms/it, loss 0.487770
Finished training it 6144/76743 of epoch 0, 136.75 ms/it, loss 0.487535
Finished training it 6144/76743 of epoch 0, 136.80 ms/it, loss 0.486736
rank 0 ranking from least wide range to the widest range [ 4 19  8 21  5 12  7 22 16  0 24 13  6  1  2 20 15 11 18  9  3 25 23 14
 17 10]
Finished training it 7168/76743 of epoch 0, 135.41 ms/it, loss 0.482679
Finished training it 7168/76743 of epoch 0, 135.44 ms/it, loss 0.484067
Finished training it 7168/76743 of epoch 0, 135.52 ms/it, loss 0.481846
Finished training it 7168/76743 of epoch 0, 135.40 ms/it, loss 0.482117
rank 0 ranking from least wide range to the widest range [19  8  7  5  4 22 12 21  0 13 24 18  6 16  1  2 15 20 11 23 25  3 14  9
 10 17]
Finished training it 8192/76743 of epoch 0, 135.39 ms/it, loss 0.478514
Finished training it 8192/76743 of epoch 0, 135.42 ms/it, loss 0.481175
Finished training it 8192/76743 of epoch 0, 135.40 ms/it, loss 0.479734
Finished training it 8192/76743 of epoch 0, 135.45 ms/it, loss 0.480510
Finished training it 9216/76743 of epoch 0, 136.05 ms/it, loss 0.477788
rank 0 ranking from least wide range to the widest range [ 4 19  8  5 12 21 22  7  1  0  6 13 18 16 24  9  2 20 15 11 23  3 25 14
 17 10]
Finished training it 9216/76743 of epoch 0, 136.02 ms/it, loss 0.478562
Finished training it 9216/76743 of epoch 0, 136.08 ms/it, loss 0.476773
Finished training it 9216/76743 of epoch 0, 136.07 ms/it, loss 0.478947
rank 0 ranking from least wide range to the widest range [ 4 19  8  5 21 12  7 22 16 13  0  1  6 23 24  2 20 11  9 18 15  3 14 10
 25 17]
Finished training it 10240/76743 of epoch 0, 135.41 ms/it, loss 0.473461
Finished training it 10240/76743 of epoch 0, 135.47 ms/it, loss 0.473882
Finished training it 10240/76743 of epoch 0, 135.50 ms/it, loss 0.474419
Finished training it 10240/76743 of epoch 0, 135.44 ms/it, loss 0.473623
Testing at - 10240/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2539618.0
get out
0 has test check 2539618.0 and sample count 3273728
 accuracy 77.576 %, best 77.576 %, roc auc score 0.7725, best 0.7725
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 8 19 21  5  4 12 22  0  7  1 16 24  6 13 11 23  2 20 18 15  3 17 25 14
  9 10]
Finished training it 11264/76743 of epoch 0, 137.18 ms/it, loss 0.471801
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2539618.0
get out
3 has test check 2539618.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 137.28 ms/it, loss 0.473945
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2539618.0
get out
1 has test check 2539618.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 137.57 ms/it, loss 0.471529
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2539618.0
get out
2 has test check 2539618.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 137.35 ms/it, loss 0.472975
rank 0 ranking from least wide range to the widest range [ 4 19  8  5 21 22  7  0  1 12 16 13 24  6 23  2 11 18  9 20  3 15 17 25
 14 10]
Finished training it 12288/76743 of epoch 0, 136.93 ms/it, loss 0.472307
Finished training it 12288/76743 of epoch 0, 137.02 ms/it, loss 0.472167
Finished training it 12288/76743 of epoch 0, 137.02 ms/it, loss 0.472411
Finished training it 12288/76743 of epoch 0, 137.15 ms/it, loss 0.473073
rank 0 ranking from least wide range to the widest range [19  4  5  8  1 21 12  6 22  7 13 16 11  2 23 20  3 15 24  0  9 17 14 18
 10 25]
Finished training it 13312/76743 of epoch 0, 136.88 ms/it, loss 0.472821
Finished training it 13312/76743 of epoch 0, 136.82 ms/it, loss 0.473261
Finished training it 13312/76743 of epoch 0, 136.84 ms/it, loss 0.471757
Finished training it 13312/76743 of epoch 0, 136.97 ms/it, loss 0.472345
rank 0 ranking from least wide range to the widest range [ 8 19  4 21  5 22  7 16  0  1 12  6 13 24 23 18 11  2 20  3 17 15 10 25
  9 14]
Finished training it 14336/76743 of epoch 0, 138.36 ms/it, loss 0.472580
Finished training it 14336/76743 of epoch 0, 138.34 ms/it, loss 0.472095
Finished training it 14336/76743 of epoch 0, 138.35 ms/it, loss 0.469998
Finished training it 14336/76743 of epoch 0, 138.26 ms/it, loss 0.473879
rank 0 ranking from least wide range to the widest range [19  4  8 21  5  0  7 12 22 13  1 16  6 24 11 23  2 20 18  3 25 15 17  9
 10 14]
Finished training it 15360/76743 of epoch 0, 137.35 ms/it, loss 0.470147
Finished training it 15360/76743 of epoch 0, 137.47 ms/it, loss 0.469361
Finished training it 15360/76743 of epoch 0, 137.43 ms/it, loss 0.473771
Finished training it 15360/76743 of epoch 0, 137.46 ms/it, loss 0.467655
rank 0 ranking from least wide range to the widest range [19  5  8  4 21  0 12  1 22 16 13  7 11  2 20  6 24 15 23 18 17  3 10 14
 25  9]
Finished training it 16384/76743 of epoch 0, 137.05 ms/it, loss 0.470719
Finished training it 16384/76743 of epoch 0, 137.04 ms/it, loss 0.470079
Finished training it 16384/76743 of epoch 0, 137.09 ms/it, loss 0.470781
Finished training it 16384/76743 of epoch 0, 136.93 ms/it, loss 0.471249
rank 0 ranking from least wide range to the widest range [19  8  4 21  5  1  0  7 12 22 24 16 13  9 23 18  6  2 11 20 17 10 15  3
 25 14]
Finished training it 17408/76743 of epoch 0, 136.77 ms/it, loss 0.468388
Finished training it 17408/76743 of epoch 0, 136.76 ms/it, loss 0.469877
Finished training it 17408/76743 of epoch 0, 136.81 ms/it, loss 0.469776
Finished training it 17408/76743 of epoch 0, 136.74 ms/it, loss 0.470143
rank 0 ranking from least wide range to the widest range [19  8  4  5  0  1 21 22 24 16  7 12 13 23  2 25 11 20 17 15  3 18 10  6
  9 14]
Finished training it 18432/76743 of epoch 0, 137.19 ms/it, loss 0.465511
Finished training it 18432/76743 of epoch 0, 137.24 ms/it, loss 0.470138
Finished training it 18432/76743 of epoch 0, 137.20 ms/it, loss 0.468184
Finished training it 18432/76743 of epoch 0, 137.22 ms/it, loss 0.468635
rank 0 ranking from least wide range to the widest range [19  4  8 22  1  5  0 21  7 13 12 16  2 11 20 15 23 17 24  6 10  3  9 14
 18 25]
Finished training it 19456/76743 of epoch 0, 136.45 ms/it, loss 0.470832
Finished training it 19456/76743 of epoch 0, 136.51 ms/it, loss 0.469775
Finished training it 19456/76743 of epoch 0, 136.51 ms/it, loss 0.469521
Finished training it 19456/76743 of epoch 0, 136.59 ms/it, loss 0.468617
rank 0 ranking from least wide range to the widest range [19  8  4 22 21  1  7 12  0  5 16  9 24  2 13 17 11 20 10 23 15  6 18  3
 25 14]
Finished training it 20480/76743 of epoch 0, 137.22 ms/it, loss 0.467146
Finished training it 20480/76743 of epoch 0, 137.21 ms/it, loss 0.470995
Finished training it 20480/76743 of epoch 0, 137.21 ms/it, loss 0.467378
Finished training it 20480/76743 of epoch 0, 137.24 ms/it, loss 0.466699
Testing at - 20480/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2544177.0
get out
0 has test check 2544177.0 and sample count 3273728
 accuracy 77.715 %, best 77.715 %, roc auc score 0.7787, best 0.7787
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 8 19 21  4  7  1  5 22  0 16 13 12 24  9  2 23 17 20 11 15 18  3  6 10
 14 25]
Finished training it 21504/76743 of epoch 0, 135.85 ms/it, loss 0.468060
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2544177.0
get out
2 has test check 2544177.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 136.10 ms/it, loss 0.464908
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2544177.0
get out
3 has test check 2544177.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 135.91 ms/it, loss 0.469382
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2544177.0
get out
1 has test check 2544177.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 136.15 ms/it, loss 0.469784
rank 0 ranking from least wide range to the widest range [19  8  4 21  1 22 24  5  7  0 16 12  9  2 23 17 13 20 11 15  3 10  6 18
 14 25]
Finished training it 22528/76743 of epoch 0, 136.55 ms/it, loss 0.465414
Finished training it 22528/76743 of epoch 0, 136.55 ms/it, loss 0.467556
Finished training it 22528/76743 of epoch 0, 136.56 ms/it, loss 0.468496
Finished training it 22528/76743 of epoch 0, 136.63 ms/it, loss 0.467016
rank 0 ranking from least wide range to the widest range [ 8 19  4  1 21  5  0 22 12 15 16  2 23 20 11  7 17 24  3  9 13 10 18 14
  6 25]
Finished training it 23552/76743 of epoch 0, 137.14 ms/it, loss 0.468850
Finished training it 23552/76743 of epoch 0, 137.10 ms/it, loss 0.467013
Finished training it 23552/76743 of epoch 0, 137.16 ms/it, loss 0.468862
Finished training it 23552/76743 of epoch 0, 137.25 ms/it, loss 0.466803
rank 0 ranking from least wide range to the widest range [19  4  8 21  7  5 22  1 13  0  9 12 20 23  2 11 15  3 16 24 17  6 10 18
 14 25]
Finished training it 24576/76743 of epoch 0, 136.61 ms/it, loss 0.465345
Finished training it 24576/76743 of epoch 0, 136.68 ms/it, loss 0.465922
Finished training it 24576/76743 of epoch 0, 136.63 ms/it, loss 0.468527
Finished training it 24576/76743 of epoch 0, 136.73 ms/it, loss 0.468152
rank 0 ranking from least wide range to the widest range [ 8 19  4 21  0  5  1 24 22 12  7 16 13 17  9 23 10 20 25 11  2 15  3  6
 18 14]
Finished training it 25600/76743 of epoch 0, 137.68 ms/it, loss 0.466149
Finished training it 25600/76743 of epoch 0, 137.71 ms/it, loss 0.464626
Finished training it 25600/76743 of epoch 0, 137.70 ms/it, loss 0.467878
Finished training it 25600/76743 of epoch 0, 137.74 ms/it, loss 0.466205
Finished training it 26624/76743 of epoch 0, 137.60 ms/it, loss 0.466490
Finished training it 26624/76743 of epoch 0, 137.56 ms/it, loss 0.468068
rank 0 ranking from least wide range to the widest range [19  4  8 21  1  9 22  7  0 12  2  3 11 20 15 23 17  5 13 16 10 24  6 14
 18 25]
Finished training it 26624/76743 of epoch 0, 137.55 ms/it, loss 0.469813
Finished training it 26624/76743 of epoch 0, 137.58 ms/it, loss 0.466945
rank 0 ranking from least wide range to the widest range [ 4 19  8  1 21 12 23  2 22  9  3 17 13 11 20 15 24  0  5 10 14  7  6 16
 18 25]
Finished training it 27648/76743 of epoch 0, 137.08 ms/it, loss 0.464326
Finished training it 27648/76743 of epoch 0, 137.19 ms/it, loss 0.464838
Finished training it 27648/76743 of epoch 0, 137.24 ms/it, loss 0.466731
Finished training it 27648/76743 of epoch 0, 137.24 ms/it, loss 0.465920
Finished training it 28672/76743 of epoch 0, 137.82 ms/it, loss 0.464471
Finished training it 28672/76743 of epoch 0, 137.86 ms/it, loss 0.467512
Finished training it 28672/76743 of epoch 0, 137.90 ms/it, loss 0.465612
rank 0 ranking from least wide range to the widest range [ 4 19  8 21  7  0 12 13  9 23 16 17  1 22  5 15 20 11  2  3 10 14  6 24
 18 25]
Finished training it 28672/76743 of epoch 0, 137.83 ms/it, loss 0.466244
rank 0 ranking from least wide range to the widest range [19  8  4 22  1 16 13  0 15 23  7  3 11 12 20  9  2 17 21  5 10 24 14  6
 18 25]
Finished training it 29696/76743 of epoch 0, 136.78 ms/it, loss 0.465409
Finished training it 29696/76743 of epoch 0, 136.88 ms/it, loss 0.463748
Finished training it 29696/76743 of epoch 0, 136.79 ms/it, loss 0.467180
Finished training it 29696/76743 of epoch 0, 136.84 ms/it, loss 0.465778
rank 0 ranking from least wide range to the widest range [19  4  8  1  0 21  9  5 12  7 16 10 24 20 15 22 11 23  2 17 13 18  3  6
 14 25]
Finished training it 30720/76743 of epoch 0, 137.16 ms/it, loss 0.466716
Finished training it 30720/76743 of epoch 0, 137.12 ms/it, loss 0.460882
Finished training it 30720/76743 of epoch 0, 137.20 ms/it, loss 0.466183
Finished training it 30720/76743 of epoch 0, 137.08 ms/it, loss 0.465965
Testing at - 30720/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2547582.0
get out
0 has test check 2547582.0 and sample count 3273728
 accuracy 77.819 %, best 77.819 %, roc auc score 0.7815, best 0.7815
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [19  1  8  0  2 22 17 23 11 20  4  3 15 10 24 13  5 12  7 21  6  9 14 18
 16 25]
Finished training it 31744/76743 of epoch 0, 136.30 ms/it, loss 0.462841
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2547582.0
get out
1 has test check 2547582.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 136.49 ms/it, loss 0.463884
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2547582.0
get out
3 has test check 2547582.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 136.48 ms/it, loss 0.465587
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2547582.0
get out
2 has test check 2547582.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 136.39 ms/it, loss 0.464296
Finished training it 32768/76743 of epoch 0, 137.10 ms/it, loss 0.464864
rank 0 ranking from least wide range to the widest range [19  1  8  4 12 22  7 21  0  9 17 13 23 11 20  2  3  5 15 10  6 24 16 14
 18 25]
Finished training it 32768/76743 of epoch 0, 137.05 ms/it, loss 0.463739
Finished training it 32768/76743 of epoch 0, 137.14 ms/it, loss 0.464916
Finished training it 32768/76743 of epoch 0, 137.08 ms/it, loss 0.464368
rank 0 ranking from least wide range to the widest range [19  8 22 16  4  1  7 13 10 23  0 21  2 11 12 24 17  3 20  9 15 18  5 14
  6 25]
Finished training it 33792/76743 of epoch 0, 136.76 ms/it, loss 0.465302
Finished training it 33792/76743 of epoch 0, 136.85 ms/it, loss 0.465734
Finished training it 33792/76743 of epoch 0, 136.82 ms/it, loss 0.464100
Finished training it 33792/76743 of epoch 0, 136.75 ms/it, loss 0.463850
rank 0 ranking from least wide range to the widest range [19  8  1  0  4 21 24  7 22  5 13 12  9  2 23 15 11 20 18 10 17  3 16 14
  6 25]
Finished training it 34816/76743 of epoch 0, 137.64 ms/it, loss 0.461246
Finished training it 34816/76743 of epoch 0, 137.68 ms/it, loss 0.462539
Finished training it 34816/76743 of epoch 0, 137.67 ms/it, loss 0.464358
Finished training it 34816/76743 of epoch 0, 137.69 ms/it, loss 0.465910
Finished training it 35840/76743 of epoch 0, 137.34 ms/it, loss 0.461771
rank 0 ranking from least wide range to the widest range [19  8 21 16 24  1 22  7  5  0  4 18 12 23 11  2 20 15 10  9  3 17 13 14
  6 25]
Finished training it 35840/76743 of epoch 0, 137.27 ms/it, loss 0.463117
Finished training it 35840/76743 of epoch 0, 137.33 ms/it, loss 0.463769
Finished training it 35840/76743 of epoch 0, 137.32 ms/it, loss 0.463735
rank 0 ranking from least wide range to the widest range [19  8  4  7 16 21  0 13 18  1 22 17  9 23 10 12  5 15  3 11 24  2 14 20
  6 25]
Finished training it 36864/76743 of epoch 0, 136.89 ms/it, loss 0.464594
Finished training it 36864/76743 of epoch 0, 136.92 ms/it, loss 0.461322
Finished training it 36864/76743 of epoch 0, 136.88 ms/it, loss 0.463102
Finished training it 36864/76743 of epoch 0, 136.86 ms/it, loss 0.467249
rank 0 ranking from least wide range to the widest range [19  8  0  1 22 13  7 17 10 12 15 20 11  5 21  2  4  9 23 14  3 24 18 16
  6 25]
Finished training it 37888/76743 of epoch 0, 136.89 ms/it, loss 0.462201
Finished training it 37888/76743 of epoch 0, 136.89 ms/it, loss 0.459436
Finished training it 37888/76743 of epoch 0, 136.96 ms/it, loss 0.459288
Finished training it 37888/76743 of epoch 0, 136.94 ms/it, loss 0.463484
rank 0 ranking from least wide range to the widest range [19  8  4 21 13  0  1  7 12 16  9 18 23  5  3  2 15 11 20 10 17 22 24 14
  6 25]
Finished training it 38912/76743 of epoch 0, 136.54 ms/it, loss 0.462266
Finished training it 38912/76743 of epoch 0, 136.51 ms/it, loss 0.463483
Finished training it 38912/76743 of epoch 0, 136.48 ms/it, loss 0.461405
Finished training it 38912/76743 of epoch 0, 136.57 ms/it, loss 0.464907
Finished training it 39936/76743 of epoch 0, 136.92 ms/it, loss 0.462538
rank 0 ranking from least wide range to the widest range [19  8  0 21  7  1 13 24  4 16  5 12 10 18 11  2 22 15 20 17  3  9 23 14
  6 25]
Finished training it 39936/76743 of epoch 0, 136.89 ms/it, loss 0.464398
Finished training it 39936/76743 of epoch 0, 136.95 ms/it, loss 0.464850
Finished training it 39936/76743 of epoch 0, 136.94 ms/it, loss 0.463575
rank 0 ranking from least wide range to the widest range [19  8  4  7  1 21  0 22  5 24 18  2 17 12 23 20  3  9 11 15 16 10 13 14
 25  6]
Finished training it 40960/76743 of epoch 0, 136.85 ms/it, loss 0.464235
Finished training it 40960/76743 of epoch 0, 136.86 ms/it, loss 0.462108
Finished training it 40960/76743 of epoch 0, 136.91 ms/it, loss 0.462959
Finished training it 40960/76743 of epoch 0, 136.86 ms/it, loss 0.463201
Testing at - 40960/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2553613.0
get out
0 has test check 2553613.0 and sample count 3273728
 accuracy 78.003 %, best 78.003 %, roc auc score 0.7835, best 0.7835
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2553613.0
get out
1 has test check 2553613.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 137.01 ms/it, loss 0.462889
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [19 21  8  4  7 13  1  5 23 16 18  0 15 17 12 11  3 10 20 24  2  9 22 14
  6 25]
Finished training it 41984/76743 of epoch 0, 136.95 ms/it, loss 0.463294
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2553613.0
get out
3 has test check 2553613.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 136.95 ms/it, loss 0.464119
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2553613.0
get out
2 has test check 2553613.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 137.00 ms/it, loss 0.466242
rank 0 ranking from least wide range to the widest range [ 1  8 19  7  4 13 21  5  9 16 18 23 12  0  3  2 11 15 24 20 10 17 22 14
  6 25]
Finished training it 43008/76743 of epoch 0, 137.46 ms/it, loss 0.463139
Finished training it 43008/76743 of epoch 0, 137.49 ms/it, loss 0.461481
Finished training it 43008/76743 of epoch 0, 137.48 ms/it, loss 0.460175
Finished training it 43008/76743 of epoch 0, 137.54 ms/it, loss 0.460165
rank 0 ranking from least wide range to the widest range [19  7 21  8  4  9  1 18  5 16 10 23 13 12 20 15 17 11  2  3 24 22 14  0
  6 25]
Finished training it 44032/76743 of epoch 0, 137.87 ms/it, loss 0.463618
Finished training it 44032/76743 of epoch 0, 137.90 ms/it, loss 0.461564
Finished training it 44032/76743 of epoch 0, 137.88 ms/it, loss 0.463371
Finished training it 44032/76743 of epoch 0, 137.90 ms/it, loss 0.462945
rank 0 ranking from least wide range to the widest range [19  8  7 21  1  4  9 12 23 17  5  3 11  2 15 20  0 24 16 10 22 13 18 14
  6 25]
Finished training it 45056/76743 of epoch 0, 137.28 ms/it, loss 0.463185
Finished training it 45056/76743 of epoch 0, 137.32 ms/it, loss 0.461268
Finished training it 45056/76743 of epoch 0, 137.33 ms/it, loss 0.462558
Finished training it 45056/76743 of epoch 0, 137.31 ms/it, loss 0.462565
rank 0 ranking from least wide range to the widest range [19  1  8 17  5  7 21 16 23  2 11 18  9 10 15  4 20  3 13 24 14 12  0  6
 25 22]
Finished training it 46080/76743 of epoch 0, 136.91 ms/it, loss 0.458954
Finished training it 46080/76743 of epoch 0, 136.91 ms/it, loss 0.459893
Finished training it 46080/76743 of epoch 0, 136.92 ms/it, loss 0.460811
Finished training it 46080/76743 of epoch 0, 136.89 ms/it, loss 0.462678
rank 0 ranking from least wide range to the widest range [ 7 19  1  4  5 13 17 10 16 23 12  8 14  9  3 20 21  2 11 15 22 18  0 24
  6 25]
Finished training it 47104/76743 of epoch 0, 138.00 ms/it, loss 0.461909
Finished training it 47104/76743 of epoch 0, 138.04 ms/it, loss 0.463078
Finished training it 47104/76743 of epoch 0, 138.05 ms/it, loss 0.459181
Finished training it 47104/76743 of epoch 0, 138.05 ms/it, loss 0.463608
rank 0 ranking from least wide range to the widest range [ 1  7  4 19  8 13  5  9 23 17 12 18 10 21  2 11 15  3 20 16 14 22  0 24
  6 25]
Finished training it 48128/76743 of epoch 0, 137.47 ms/it, loss 0.461861
Finished training it 48128/76743 of epoch 0, 137.48 ms/it, loss 0.461363
Finished training it 48128/76743 of epoch 0, 137.47 ms/it, loss 0.461180
Finished training it 48128/76743 of epoch 0, 137.48 ms/it, loss 0.462856
rank 0 ranking from least wide range to the widest range [ 1  8 19 18  4  9  7 24  5 23 21  3 20  0 11  2 15 10 13 12 17 25 22 16
 14  6]
Finished training it 49152/76743 of epoch 0, 136.92 ms/it, loss 0.460809
Finished training it 49152/76743 of epoch 0, 136.92 ms/it, loss 0.462279
Finished training it 49152/76743 of epoch 0, 136.89 ms/it, loss 0.462278
Finished training it 49152/76743 of epoch 0, 136.95 ms/it, loss 0.460960
Finished training it 50176/76743 of epoch 0, 136.93 ms/it, loss 0.460236
Finished training it 50176/76743 of epoch 0, 136.96 ms/it, loss 0.460073
Finished training it 50176/76743 of epoch 0, 136.95 ms/it, loss 0.461333
rank 0 ranking from least wide range to the widest range [ 1 19  8 18  7  4 16  5 17  9 21 23  0 13  2 15 24 11 20  3 10 12 14 25
 22  6]
Finished training it 50176/76743 of epoch 0, 136.94 ms/it, loss 0.461054
Finished training it 51200/76743 of epoch 0, 136.78 ms/it, loss 0.462494
rank 0 ranking from least wide range to the widest range [ 7  1 19 17  8 23 21 18 15  4  5 11  2 20  3 16  9 13 10 14  0 12 24 22
  6 25]
Finished training it 51200/76743 of epoch 0, 136.73 ms/it, loss 0.459107
Finished training it 51200/76743 of epoch 0, 136.72 ms/it, loss 0.465055
Finished training it 51200/76743 of epoch 0, 136.72 ms/it, loss 0.460530
Testing at - 51200/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2556631.0
get out
0 has test check 2556631.0 and sample count 3273728
 accuracy 78.095 %, best 78.095 %, roc auc score 0.7857, best 0.7857
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [18  8  7  1 19  5 13  4  9 17 23 16 21 14  0 11  3  2 24 15 20 10 12 25
 22  6]
Finished training it 52224/76743 of epoch 0, 137.48 ms/it, loss 0.460356
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2556631.0
get out
1 has test check 2556631.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 137.64 ms/it, loss 0.462419
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2556631.0
get out
2 has test check 2556631.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 137.58 ms/it, loss 0.461940
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2556631.0
get out
3 has test check 2556631.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 137.67 ms/it, loss 0.462912
Finished training it 53248/76743 of epoch 0, 137.54 ms/it, loss 0.462320
Finished training it 53248/76743 of epoch 0, 137.48 ms/it, loss 0.462409
Finished training it 53248/76743 of epoch 0, 137.58 ms/it, loss 0.461321
rank 0 ranking from least wide range to the widest range [18  8  1 19  9  7  0  4 21 11  3  2 15 24 20 13 16  5 14 23 17 10 25 12
 22  6]
Finished training it 53248/76743 of epoch 0, 137.49 ms/it, loss 0.462033
rank 0 ranking from least wide range to the widest range [ 8 19 16  4  1 24 21  7 18 22  9  5 25 11 10 23 20 15  2  3  0 17 13 12
 14  6]
Finished training it 54272/76743 of epoch 0, 137.92 ms/it, loss 0.459396
Finished training it 54272/76743 of epoch 0, 137.85 ms/it, loss 0.459835
Finished training it 54272/76743 of epoch 0, 137.95 ms/it, loss 0.462282
Finished training it 54272/76743 of epoch 0, 137.99 ms/it, loss 0.462672
rank 0 ranking from least wide range to the widest range [19  1 18  8  9  7 24 21 23 13  2 17 15 20  5 11  3 10 25  4 16 12 14 22
  0  6]
Finished training it 55296/76743 of epoch 0, 137.31 ms/it, loss 0.459722
Finished training it 55296/76743 of epoch 0, 137.24 ms/it, loss 0.460261
Finished training it 55296/76743 of epoch 0, 137.26 ms/it, loss 0.461324
Finished training it 55296/76743 of epoch 0, 137.23 ms/it, loss 0.463168
rank 0 ranking from least wide range to the widest range [18 21 19  1  7  5 16  8  9 13 23 15 10  4 24  3 20  2 17 11  0 22 12 14
 25  6]
Finished training it 56320/76743 of epoch 0, 136.71 ms/it, loss 0.460833
Finished training it 56320/76743 of epoch 0, 136.71 ms/it, loss 0.462414
Finished training it 56320/76743 of epoch 0, 136.77 ms/it, loss 0.461454
Finished training it 56320/76743 of epoch 0, 136.73 ms/it, loss 0.460874
rank 0 ranking from least wide range to the widest range [ 7 19  1  2 18 11 20 10  8  3  5 23 15 16 24 12  4 14 22  9 13 17  0 21
 25  6]
Finished training it 57344/76743 of epoch 0, 137.21 ms/it, loss 0.459436
Finished training it 57344/76743 of epoch 0, 137.16 ms/it, loss 0.463007
Finished training it 57344/76743 of epoch 0, 137.20 ms/it, loss 0.459281
Finished training it 57344/76743 of epoch 0, 137.18 ms/it, loss 0.462103
Finished training it 58368/76743 of epoch 0, 137.09 ms/it, loss 0.463483
rank 0 ranking from least wide range to the widest range [ 1 21 18  9  7  5 16 22 15 11  0  8 20  2 17 19 10  3 24 23  4 14 12 13
 25  6]
Finished training it 58368/76743 of epoch 0, 137.07 ms/it, loss 0.460531
Finished training it 58368/76743 of epoch 0, 137.07 ms/it, loss 0.460687
Finished training it 58368/76743 of epoch 0, 137.10 ms/it, loss 0.460998
rank 0 ranking from least wide range to the widest range [18  1  7 19  9  8 24 21 13  4  5 23 17 12 15  3 11  2 20 10 16 25 14 22
  0  6]
Finished training it 59392/76743 of epoch 0, 137.35 ms/it, loss 0.460341
Finished training it 59392/76743 of epoch 0, 137.34 ms/it, loss 0.460130
Finished training it 59392/76743 of epoch 0, 137.33 ms/it, loss 0.457977
Finished training it 59392/76743 of epoch 0, 137.42 ms/it, loss 0.460379
rank 0 ranking from least wide range to the widest range [18  8  4 13  1 21  5  7  9 19 12 10 23 24 17 16 14  3 20 11 15  2 22 25
  6  0]
Finished training it 60416/76743 of epoch 0, 136.91 ms/it, loss 0.458606
Finished training it 60416/76743 of epoch 0, 136.90 ms/it, loss 0.458358
Finished training it 60416/76743 of epoch 0, 136.96 ms/it, loss 0.462913
Finished training it 60416/76743 of epoch 0, 136.98 ms/it, loss 0.462501
rank 0 ranking from least wide range to the widest range [18  8 19  9  1 24 23  5 10 17 21 20  3 11 15 25  7  2 14 22 13  0 16  4
 12  6]
Finished training it 61440/76743 of epoch 0, 137.23 ms/it, loss 0.459291
Finished training it 61440/76743 of epoch 0, 137.24 ms/it, loss 0.459941
Finished training it 61440/76743 of epoch 0, 137.24 ms/it, loss 0.457657
Finished training it 61440/76743 of epoch 0, 137.20 ms/it, loss 0.460930
Testing at - 61440/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2558940.0
get out
0 has test check 2558940.0 and sample count 3273728
 accuracy 78.166 %, best 78.166 %, roc auc score 0.7874, best 0.7874
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [18  1  8 19  5  7 20 11 15 17  2 24 10 23 14 13 12  3  9 16 22  4 25 21
  0  6]
Finished training it 62464/76743 of epoch 0, 136.69 ms/it, loss 0.460309
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2558940.0
get out
3 has test check 2558940.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 136.77 ms/it, loss 0.459641
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2558940.0
get out
1 has test check 2558940.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 136.74 ms/it, loss 0.462679
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2558940.0
get out
2 has test check 2558940.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 136.80 ms/it, loss 0.460633
rank 0 ranking from least wide range to the widest range [ 8  1 18 21  5  4 19  9  7  0 13 22 10 11 24 23  2 20 12 17 16 14 15  3
 25  6]
Finished training it 63488/76743 of epoch 0, 136.97 ms/it, loss 0.459474
Finished training it 63488/76743 of epoch 0, 137.03 ms/it, loss 0.459024
Finished training it 63488/76743 of epoch 0, 136.94 ms/it, loss 0.459772
Finished training it 63488/76743 of epoch 0, 137.04 ms/it, loss 0.460178
rank 0 ranking from least wide range to the widest range [ 1 18  5  7 19 24 16 21 20 11 15 13  2  3 17  8  0 23 25  4 10 14  9 12
 22  6]
Finished training it 64512/76743 of epoch 0, 136.88 ms/it, loss 0.458346
Finished training it 64512/76743 of epoch 0, 136.95 ms/it, loss 0.458070
Finished training it 64512/76743 of epoch 0, 136.94 ms/it, loss 0.462089
Finished training it 64512/76743 of epoch 0, 136.98 ms/it, loss 0.459474
rank 0 ranking from least wide range to the widest range [ 8 18  1 19 25 10  5  9  7 23 12 13  0 24 14 11 17 20  2  3 15 21 16  4
 22  6]
Finished training it 65536/76743 of epoch 0, 136.20 ms/it, loss 0.460247
Finished training it 65536/76743 of epoch 0, 136.17 ms/it, loss 0.459527
Finished training it 65536/76743 of epoch 0, 136.24 ms/it, loss 0.460879
Finished training it 65536/76743 of epoch 0, 136.17 ms/it, loss 0.456887
rank 0 ranking from least wide range to the widest range [18  8  9  7 12 10 17 23 16 21  1  4  5  3 20  2 11 13 15 14  0 22 19 24
 25  6]
Finished training it 66560/76743 of epoch 0, 136.66 ms/it, loss 0.460072
Finished training it 66560/76743 of epoch 0, 136.70 ms/it, loss 0.458864
Finished training it 66560/76743 of epoch 0, 136.77 ms/it, loss 0.459806
Finished training it 66560/76743 of epoch 0, 136.71 ms/it, loss 0.461196
rank 0 ranking from least wide range to the widest range [18  1 19 23  5  8  2 11 20  9 17 15 10 14  3 25 16  7 13 24 21  0  4 12
 22  6]
Finished training it 67584/76743 of epoch 0, 136.80 ms/it, loss 0.460034
Finished training it 67584/76743 of epoch 0, 136.82 ms/it, loss 0.460298
Finished training it 67584/76743 of epoch 0, 136.88 ms/it, loss 0.459157
Finished training it 67584/76743 of epoch 0, 136.87 ms/it, loss 0.461309
rank 0 ranking from least wide range to the widest range [18  1  8  9 13 19 23  0  5 16  3 15 21 11  2 25 20 14 10  7 24 17  4 12
 22  6]
Finished training it 68608/76743 of epoch 0, 137.24 ms/it, loss 0.462027
Finished training it 68608/76743 of epoch 0, 137.30 ms/it, loss 0.461346
Finished training it 68608/76743 of epoch 0, 137.24 ms/it, loss 0.462012
Finished training it 68608/76743 of epoch 0, 137.28 ms/it, loss 0.458489
rank 0 ranking from least wide range to the widest range [ 8 16 18 17  1  4  0 23  9 13 21 10  3 15  5 11 20 14  2 22 12 19  7 24
 25  6]
Finished training it 69632/76743 of epoch 0, 136.83 ms/it, loss 0.462152
Finished training it 69632/76743 of epoch 0, 136.89 ms/it, loss 0.460922
Finished training it 69632/76743 of epoch 0, 136.89 ms/it, loss 0.458977
Finished training it 69632/76743 of epoch 0, 136.82 ms/it, loss 0.459400
rank 0 ranking from least wide range to the widest range [18 19  8 13  1 24 21  0 25 15 16  9 23  5 11  2 20 17 22 10 14 12  7  4
  3  6]
Finished training it 70656/76743 of epoch 0, 137.19 ms/it, loss 0.460221
Finished training it 70656/76743 of epoch 0, 137.18 ms/it, loss 0.461102
Finished training it 70656/76743 of epoch 0, 137.16 ms/it, loss 0.457953
Finished training it 70656/76743 of epoch 0, 137.19 ms/it, loss 0.460512
rank 0 ranking from least wide range to the widest range [ 5  9 23 21 17 18 10  1 15 11  3  2 20 14  0 13 16  4 12  8 19  7 24 22
 25  6]
Finished training it 71680/76743 of epoch 0, 137.54 ms/it, loss 0.460794
Finished training it 71680/76743 of epoch 0, 137.64 ms/it, loss 0.459366
Finished training it 71680/76743 of epoch 0, 137.59 ms/it, loss 0.458824
Finished training it 71680/76743 of epoch 0, 137.55 ms/it, loss 0.460539
Testing at - 71680/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2558257.0
get out
0 has test check 2558257.0 and sample count 3273728
 accuracy 78.145 %, best 78.166 %, roc auc score 0.7875, best 0.7875
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 19  8 18 16  9 25 17 23  4 13 21  5 14 24  0  3 10 15 11  2 20 12  7
 22  6]
Finished training it 72704/76743 of epoch 0, 137.01 ms/it, loss 0.459555
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2558257.0
get out
1 has test check 2558257.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 137.09 ms/it, loss 0.462710
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2558257.0
get out
3 has test check 2558257.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 137.10 ms/it, loss 0.457983
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2558257.0
get out
2 has test check 2558257.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 137.05 ms/it, loss 0.459526
rank 0 ranking from least wide range to the widest range [ 1 19 18 21 24  8 16 25  0  9 23 10 13  2 15 20  4 11 12  3 17  5 22 14
  7  6]
Finished training it 73728/76743 of epoch 0, 136.57 ms/it, loss 0.459992
Finished training it 73728/76743 of epoch 0, 136.59 ms/it, loss 0.458007
Finished training it 73728/76743 of epoch 0, 136.61 ms/it, loss 0.459214
Finished training it 73728/76743 of epoch 0, 136.61 ms/it, loss 0.459897
rank 0 ranking from least wide range to the widest range [ 1 25  9  8 18 16  5 17  4 23 24 12  0 10  3 13 15 19 20 14 11  2 21  7
 22  6]
Finished training it 74752/76743 of epoch 0, 137.48 ms/it, loss 0.459470
Finished training it 74752/76743 of epoch 0, 137.36 ms/it, loss 0.459429
Finished training it 74752/76743 of epoch 0, 137.50 ms/it, loss 0.460780
Finished training it 74752/76743 of epoch 0, 137.45 ms/it, loss 0.457649
Finished training it 75776/76743 of epoch 0, 136.88 ms/it, loss 0.459799
rank 0 ranking from least wide range to the widest range [ 1 18  8 19 21 16 25 22 24 13  5  4 17  2 15 20 11 23  9  0 14  3  7 12
 10  6]
Finished training it 75776/76743 of epoch 0, 136.81 ms/it, loss 0.458610
Finished training it 75776/76743 of epoch 0, 136.88 ms/it, loss 0.460176
Finished training it 75776/76743 of epoch 0, 136.86 ms/it, loss 0.458026
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [ 1 18  9  8 16 21 17 23 13  5 24 22 15 10 14  7  2 20  4 11  3 25 12 19
  0  6]
Finished training it 1024/76743 of epoch 1, 138.57 ms/it, loss 0.458199
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 138.07 ms/it, loss 0.459149
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 138.22 ms/it, loss 0.460162
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 138.41 ms/it, loss 0.458168
rank 0 ranking from least wide range to the widest range [ 9  1  4 18 16 24 23  5 17 10 25  7 13 11 15  3  0  2 19 14 20 12  8 22
 21  6]
Finished training it 2048/76743 of epoch 1, 137.17 ms/it, loss 0.461323
Finished training it 2048/76743 of epoch 1, 137.22 ms/it, loss 0.461012
Finished training it 2048/76743 of epoch 1, 137.22 ms/it, loss 0.460421
Finished training it 2048/76743 of epoch 1, 137.19 ms/it, loss 0.463542
Finished training it 3072/76743 of epoch 1, 137.22 ms/it, loss 0.456553
Finished training it 3072/76743 of epoch 1, 137.18 ms/it, loss 0.459190
Finished training it 3072/76743 of epoch 1, 137.22 ms/it, loss 0.457573
rank 0 ranking from least wide range to the widest range [18  8 13  1  5 21 19 25 23 16  9 17 10 15 24  3 20 11  2 14  0 22 12  4
  7  6]
Finished training it 3072/76743 of epoch 1, 137.20 ms/it, loss 0.461098
rank 0 ranking from least wide range to the widest range [ 1  9  0  4  5 18 21  8 17 23 13 15 10 20 14 11  3  2 12 22 25 16 24 19
  7  6]
Finished training it 4096/76743 of epoch 1, 137.35 ms/it, loss 0.460567
Finished training it 4096/76743 of epoch 1, 137.42 ms/it, loss 0.457192
Finished training it 4096/76743 of epoch 1, 137.42 ms/it, loss 0.456809
Finished training it 4096/76743 of epoch 1, 137.46 ms/it, loss 0.459252
rank 0 ranking from least wide range to the widest range [ 1  9 25 18 23 16 13 17 21 24  8 19 15  0  2  3 10 20 11  5 14 12  7 22
  4  6]
Finished training it 5120/76743 of epoch 1, 136.87 ms/it, loss 0.458695
Finished training it 5120/76743 of epoch 1, 136.87 ms/it, loss 0.460927
Finished training it 5120/76743 of epoch 1, 136.94 ms/it, loss 0.457909
Finished training it 5120/76743 of epoch 1, 136.92 ms/it, loss 0.458726
rank 0 ranking from least wide range to the widest range [ 1 18 21  8 16  9 25  0 13 19 17  5 14 23  4 12 10 24 15  2  3 11 20 22
  7  6]
Finished training it 6144/76743 of epoch 1, 137.19 ms/it, loss 0.460768
Finished training it 6144/76743 of epoch 1, 137.28 ms/it, loss 0.458849
Finished training it 6144/76743 of epoch 1, 137.30 ms/it, loss 0.459144
Finished training it 6144/76743 of epoch 1, 137.22 ms/it, loss 0.459282
rank 0 ranking from least wide range to the widest range [ 1 18  5  8  9 17 23 25 19 16  4 10 24  2  0 20 12 15 11 14  3 13  7 21
 22  6]
Finished training it 7168/76743 of epoch 1, 137.20 ms/it, loss 0.459578
Finished training it 7168/76743 of epoch 1, 137.26 ms/it, loss 0.459646
Finished training it 7168/76743 of epoch 1, 137.21 ms/it, loss 0.457462
Finished training it 7168/76743 of epoch 1, 137.24 ms/it, loss 0.457062
rank 0 ranking from least wide range to the widest range [18  8 13 19 22  1 21 25 24 17 23  5 10 12 15 20  4 14 11  9  2  7 16  3
  0  6]
Finished training it 8192/76743 of epoch 1, 135.93 ms/it, loss 0.458768
Finished training it 8192/76743 of epoch 1, 135.94 ms/it, loss 0.460147
Finished training it 8192/76743 of epoch 1, 135.93 ms/it, loss 0.459050
Finished training it 8192/76743 of epoch 1, 135.94 ms/it, loss 0.459472
rank 0 ranking from least wide range to the widest range [18  9  1 21  8 23  5 19 13  0 25 22 16 17 20 11 15  2 14 24  3 12  7 10
  4  6]
Finished training it 9216/76743 of epoch 1, 137.59 ms/it, loss 0.459809
Finished training it 9216/76743 of epoch 1, 137.62 ms/it, loss 0.458704
Finished training it 9216/76743 of epoch 1, 137.61 ms/it, loss 0.458340
Finished training it 9216/76743 of epoch 1, 137.60 ms/it, loss 0.459217
rank 0 ranking from least wide range to the widest range [16 18 13 23  9  8  4  0 25  1 24 17  2 10 15  7 11 20  3 22 21 19 14  5
 12  6]
Finished training it 10240/76743 of epoch 1, 136.40 ms/it, loss 0.457000
Finished training it 10240/76743 of epoch 1, 136.43 ms/it, loss 0.458437
Finished training it 10240/76743 of epoch 1, 136.38 ms/it, loss 0.457585
Finished training it 10240/76743 of epoch 1, 136.32 ms/it, loss 0.457623
Testing at - 10240/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2561707.0
get out
0 has test check 2561707.0 and sample count 3273728
 accuracy 78.250 %, best 78.250 %, roc auc score 0.7891, best 0.7891
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2561707.0
get out
3 has test check 2561707.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 137.01 ms/it, loss 0.459256
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [18  1  8  5 24 17 21 23  9 14 13 25  0  4 19 16 15 20 11 10  7  2  3 22
 12  6]
Finished training it 11264/76743 of epoch 1, 136.97 ms/it, loss 0.457550
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2561707.0
get out
1 has test check 2561707.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 137.00 ms/it, loss 0.456172
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2561707.0
get out
2 has test check 2561707.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 136.93 ms/it, loss 0.457638
rank 0 ranking from least wide range to the widest range [19 25  1 23 21 18 16  8 13 22 24  0  9 17 10  2  4  3 20 11 15  5 14 12
  7  6]
Finished training it 12288/76743 of epoch 1, 137.23 ms/it, loss 0.458162
Finished training it 12288/76743 of epoch 1, 137.30 ms/it, loss 0.457388
Finished training it 12288/76743 of epoch 1, 137.25 ms/it, loss 0.457057
Finished training it 12288/76743 of epoch 1, 137.28 ms/it, loss 0.458407
rank 0 ranking from least wide range to the widest range [ 1  8 18 19 23 17  9  5 25 15 20 11  2  4 13 16  3 14 21 10  0 24  7 12
 22  6]
Finished training it 13312/76743 of epoch 1, 137.24 ms/it, loss 0.459351
Finished training it 13312/76743 of epoch 1, 137.22 ms/it, loss 0.458830
Finished training it 13312/76743 of epoch 1, 137.29 ms/it, loss 0.458526
Finished training it 13312/76743 of epoch 1, 137.27 ms/it, loss 0.458780
rank 0 ranking from least wide range to the widest range [ 1  8  5 16 25 17 18  0 21 22 13 24 19 23 10 14  4  9 12 11 15 20  2  3
  7  6]
Finished training it 14336/76743 of epoch 1, 137.12 ms/it, loss 0.459209
Finished training it 14336/76743 of epoch 1, 137.18 ms/it, loss 0.460321
Finished training it 14336/76743 of epoch 1, 137.18 ms/it, loss 0.456554
Finished training it 14336/76743 of epoch 1, 137.14 ms/it, loss 0.457997
rank 0 ranking from least wide range to the widest range [21 19 16  5  8 17  1 13 10 25 23  4 24  9 18 14 15 20 11  2  0  3 22 12
  7  6]
Finished training it 15360/76743 of epoch 1, 139.49 ms/it, loss 0.458022
Finished training it 15360/76743 of epoch 1, 139.40 ms/it, loss 0.457200
Finished training it 15360/76743 of epoch 1, 139.51 ms/it, loss 0.461362
Finished training it 15360/76743 of epoch 1, 139.48 ms/it, loss 0.455735
rank 0 ranking from least wide range to the widest range [18  1 21 17 16 23  8  5 19 13 15  2 20 11 25 24 22 14  3 10  7  4  9  0
 12  6]
Finished training it 16384/76743 of epoch 1, 136.69 ms/it, loss 0.459072
Finished training it 16384/76743 of epoch 1, 136.75 ms/it, loss 0.458758
Finished training it 16384/76743 of epoch 1, 136.71 ms/it, loss 0.457994
Finished training it 16384/76743 of epoch 1, 136.73 ms/it, loss 0.459029
rank 0 ranking from least wide range to the widest range [21  1  9 19  5 18  8 17 23 13 16 24 25 10 14  2 15 20 11 22  3  0  4 12
  7  6]
Finished training it 17408/76743 of epoch 1, 140.36 ms/it, loss 0.455978
Finished training it 17408/76743 of epoch 1, 140.48 ms/it, loss 0.458261
Finished training it 17408/76743 of epoch 1, 140.40 ms/it, loss 0.458977
Finished training it 17408/76743 of epoch 1, 140.47 ms/it, loss 0.458655
rank 0 ranking from least wide range to the widest range [ 1 19 25 16 23  0 13  8 20 24  9 15 11  2 17 10 18  5 21  3 22 14  7  4
 12  6]
Finished training it 18432/76743 of epoch 1, 137.23 ms/it, loss 0.454867
Finished training it 18432/76743 of epoch 1, 137.21 ms/it, loss 0.458665
Finished training it 18432/76743 of epoch 1, 137.26 ms/it, loss 0.456795
Finished training it 18432/76743 of epoch 1, 137.24 ms/it, loss 0.457244
rank 0 ranking from least wide range to the widest range [ 1  5  8 19 22 16  9 17 18 10  2 20 13 11 23 21 15 25  0 14 24  7 12  4
  3  6]
Finished training it 19456/76743 of epoch 1, 136.99 ms/it, loss 0.459173
Finished training it 19456/76743 of epoch 1, 136.99 ms/it, loss 0.458718
Finished training it 19456/76743 of epoch 1, 137.07 ms/it, loss 0.458399
Finished training it 19456/76743 of epoch 1, 137.05 ms/it, loss 0.457707
rank 0 ranking from least wide range to the widest range [ 8 18  9  1 19 24 22  5 16 21 25 17 13 23 10  2  0 20 15 11 14  3  7 12
  4  6]
Finished training it 20480/76743 of epoch 1, 137.19 ms/it, loss 0.455806
Finished training it 20480/76743 of epoch 1, 137.24 ms/it, loss 0.456595
Finished training it 20480/76743 of epoch 1, 137.25 ms/it, loss 0.459853
Finished training it 20480/76743 of epoch 1, 137.23 ms/it, loss 0.457299
Testing at - 20480/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2562488.0
get out
0 has test check 2562488.0 and sample count 3273728
 accuracy 78.274 %, best 78.274 %, roc auc score 0.7901, best 0.7901
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 1 19 22  9 13 16 17  8 24 18 23 25  0 15 20 14  5 11  2 21 10  3  7  4
 12  6]
Finished training it 21504/76743 of epoch 1, 136.64 ms/it, loss 0.457835
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2562488.0
get out
2 has test check 2562488.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 136.57 ms/it, loss 0.454765
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2562488.0
get out
3 has test check 2562488.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 136.66 ms/it, loss 0.459450
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2562488.0
get out
1 has test check 2562488.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 136.71 ms/it, loss 0.459251
rank 0 ranking from least wide range to the widest range [ 1  9 16  8 25 13 17  5 19 24 23 22 15 18 11 20 10  2 14 21  3  0 12  7
  4  6]
Finished training it 22528/76743 of epoch 1, 137.95 ms/it, loss 0.455546
Finished training it 22528/76743 of epoch 1, 137.91 ms/it, loss 0.457855
Finished training it 22528/76743 of epoch 1, 137.87 ms/it, loss 0.458734
Finished training it 22528/76743 of epoch 1, 137.95 ms/it, loss 0.456803
Finished training it 23552/76743 of epoch 1, 136.11 ms/it, loss 0.459393
rank 0 ranking from least wide range to the widest range [ 1 19  8  9  5 17 23 21 16 18 24 25 13 15 14 22 20 11 10  2  4 12  3  0
  7  6]
Finished training it 23552/76743 of epoch 1, 136.09 ms/it, loss 0.459322
Finished training it 23552/76743 of epoch 1, 136.06 ms/it, loss 0.457371
Finished training it 23552/76743 of epoch 1, 136.10 ms/it, loss 0.457489
rank 0 ranking from least wide range to the widest range [13  9 22  5  1 18 23 25 17 21  8 16 15 11  2 20 19 14 10  4 24  3 12  7
  6  0]
Finished training it 24576/76743 of epoch 1, 137.72 ms/it, loss 0.455519
Finished training it 24576/76743 of epoch 1, 137.81 ms/it, loss 0.458942
Finished training it 24576/76743 of epoch 1, 137.71 ms/it, loss 0.458657
Finished training it 24576/76743 of epoch 1, 137.67 ms/it, loss 0.456935
rank 0 ranking from least wide range to the widest range [21  8 16 19 18  1 23 13  9 25  5 10 17 24  7 15 20  2 11 14  3  0 22 12
  4  6]
Finished training it 25600/76743 of epoch 1, 136.46 ms/it, loss 0.456976
Finished training it 25600/76743 of epoch 1, 136.47 ms/it, loss 0.455040
Finished training it 25600/76743 of epoch 1, 136.42 ms/it, loss 0.458719
Finished training it 25600/76743 of epoch 1, 136.47 ms/it, loss 0.456602
rank 0 ranking from least wide range to the widest range [ 9  1  5 23 18 17 10 16 13 11 15  8 22 20 19 25  2 14  0 21 24  3  7 12
  4  6]
Finished training it 26624/76743 of epoch 1, 136.24 ms/it, loss 0.460602
Finished training it 26624/76743 of epoch 1, 136.33 ms/it, loss 0.456878
Finished training it 26624/76743 of epoch 1, 136.26 ms/it, loss 0.459030
Finished training it 26624/76743 of epoch 1, 136.30 ms/it, loss 0.457022
Finished training it 27648/76743 of epoch 1, 136.32 ms/it, loss 0.457176
Finished training it 27648/76743 of epoch 1, 136.31 ms/it, loss 0.455916
rank 0 ranking from least wide range to the widest range [ 5  1 23  9 17 25 24 19 11 20  2 15 14 10 21 22 13  8 18  3  4 12  0  6
 16  7]
Finished training it 27648/76743 of epoch 1, 136.23 ms/it, loss 0.455155
Finished training it 27648/76743 of epoch 1, 136.33 ms/it, loss 0.457249
Finished training it 28672/76743 of epoch 1, 136.59 ms/it, loss 0.458303
Finished training it 28672/76743 of epoch 1, 136.50 ms/it, loss 0.456185
Finished training it 28672/76743 of epoch 1, 136.57 ms/it, loss 0.456712
rank 0 ranking from least wide range to the widest range [ 9 22 23 10 13  5 15 20 25  8 11 17  2  1 16 14  3 18 24 21 19 12  0  6
  4  7]
Finished training it 28672/76743 of epoch 1, 136.54 ms/it, loss 0.456950
rank 0 ranking from least wide range to the widest range [22  9 16 19 13 23  1 17  4 10  5  8 18 15 11  2 20 25 14 21 24  7  3 12
  6  0]
Finished training it 29696/76743 of epoch 1, 136.85 ms/it, loss 0.456497
Finished training it 29696/76743 of epoch 1, 136.88 ms/it, loss 0.456828
Finished training it 29696/76743 of epoch 1, 136.89 ms/it, loss 0.455048
Finished training it 29696/76743 of epoch 1, 136.89 ms/it, loss 0.458769
Finished training it 30720/76743 of epoch 1, 137.43 ms/it, loss 0.452552
rank 0 ranking from least wide range to the widest range [ 1  8  9 22 25 19 23 18  5 10 17 16  0 20 11 15 24 13  2 21  4 14 12  3
  7  6]
Finished training it 30720/76743 of epoch 1, 137.38 ms/it, loss 0.459211
Finished training it 30720/76743 of epoch 1, 137.36 ms/it, loss 0.458039
Finished training it 30720/76743 of epoch 1, 137.43 ms/it, loss 0.457782
Testing at - 30720/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2563103.0
get out
0 has test check 2563103.0 and sample count 3273728
 accuracy 78.293 %, best 78.293 %, roc auc score 0.7903, best 0.7903
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2563103.0
get out
3 has test check 2563103.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 136.22 ms/it, loss 0.456590
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2563103.0
get out
2 has test check 2563103.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 136.23 ms/it, loss 0.456183
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 19 23  5 22 10 25 17  8 15 11 20  2 18  9 13 14 21 24  0 12  7  3  4
  6 16]
Finished training it 31744/76743 of epoch 1, 136.26 ms/it, loss 0.454800
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2563103.0
get out
1 has test check 2563103.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 136.35 ms/it, loss 0.455549
Finished training it 32768/76743 of epoch 1, 136.36 ms/it, loss 0.457378
rank 0 ranking from least wide range to the widest range [ 5  1 21 22  8 23  9  4 17 25 18 13 16 14 10 19 11 20 15  0  2 24  3 12
  6  7]
Finished training it 32768/76743 of epoch 1, 136.37 ms/it, loss 0.456843
Finished training it 32768/76743 of epoch 1, 136.47 ms/it, loss 0.457404
Finished training it 32768/76743 of epoch 1, 136.44 ms/it, loss 0.456354
rank 0 ranking from least wide range to the widest range [ 8 19  1 16  9 21 23 10 17 13 18 24 22  2 20 11 15 25  5  4 14  3 12  6
  0  7]
Finished training it 33792/76743 of epoch 1, 136.73 ms/it, loss 0.457644
Finished training it 33792/76743 of epoch 1, 136.78 ms/it, loss 0.458866
Finished training it 33792/76743 of epoch 1, 136.74 ms/it, loss 0.456969
Finished training it 33792/76743 of epoch 1, 136.68 ms/it, loss 0.456264
rank 0 ranking from least wide range to the widest range [ 1  5 19  9 13 22 24  8 25 17 21 18 23 20 15 11  2 10 14 16  0  4  3 12
  6  7]
Finished training it 34816/76743 of epoch 1, 136.34 ms/it, loss 0.453784
Finished training it 34816/76743 of epoch 1, 136.33 ms/it, loss 0.455208
Finished training it 34816/76743 of epoch 1, 136.34 ms/it, loss 0.456979
Finished training it 34816/76743 of epoch 1, 136.37 ms/it, loss 0.457829
rank 0 ranking from least wide range to the widest range [ 1 19 16  8  5 22 18 17 23 21  9 24 25 14 20  2 15 10 11  7  4  0 13  6
  3 12]
Finished training it 35840/76743 of epoch 1, 136.91 ms/it, loss 0.455643
Finished training it 35840/76743 of epoch 1, 137.01 ms/it, loss 0.456240
Finished training it 35840/76743 of epoch 1, 136.98 ms/it, loss 0.455055
Finished training it 35840/76743 of epoch 1, 136.93 ms/it, loss 0.457289
rank 0 ranking from least wide range to the widest range [16 22 21  8 19 13 23  9 17  1  4 18 10 15 25 14 20  5  2 24 11  3  6  7
  0 12]
Finished training it 36864/76743 of epoch 1, 138.09 ms/it, loss 0.457323
Finished training it 36864/76743 of epoch 1, 138.10 ms/it, loss 0.455696
Finished training it 36864/76743 of epoch 1, 138.09 ms/it, loss 0.454264
Finished training it 36864/76743 of epoch 1, 138.06 ms/it, loss 0.460200
rank 0 ranking from least wide range to the widest range [22  1 19 13 24 23 17 10  5 18  9 15 20 11 25 14  2 21  8 16  3  6 12  0
  4  7]
Finished training it 37888/76743 of epoch 1, 137.63 ms/it, loss 0.454646
Finished training it 37888/76743 of epoch 1, 137.71 ms/it, loss 0.453201
Finished training it 37888/76743 of epoch 1, 137.65 ms/it, loss 0.456080
Finished training it 37888/76743 of epoch 1, 137.70 ms/it, loss 0.452585
rank 0 ranking from least wide range to the widest range [19 21  8 13 16  1  4  9 22 18 23 25 24 17 10  5 14 20 11  2 15  7  0  3
  6 12]
Finished training it 38912/76743 of epoch 1, 137.70 ms/it, loss 0.455048
Finished training it 38912/76743 of epoch 1, 137.74 ms/it, loss 0.456785
Finished training it 38912/76743 of epoch 1, 137.67 ms/it, loss 0.454521
Finished training it 38912/76743 of epoch 1, 137.72 ms/it, loss 0.457585
rank 0 ranking from least wide range to the widest range [ 1  8  5 19 13 16 22 17 23 21  9 24 10 25 18 14 15 20 11  2  4  0  3  6
 12  7]
Finished training it 39936/76743 of epoch 1, 136.17 ms/it, loss 0.457609
Finished training it 39936/76743 of epoch 1, 136.19 ms/it, loss 0.458090
Finished training it 39936/76743 of epoch 1, 136.22 ms/it, loss 0.457233
Finished training it 39936/76743 of epoch 1, 136.14 ms/it, loss 0.456075
Finished training it 40960/76743 of epoch 1, 136.20 ms/it, loss 0.456552
rank 0 ranking from least wide range to the widest range [19  1 23  8  9 22 25  5 17 20 16 15 24 18 11 10 21 14  4  2 13  3  6  7
  0 12]
Finished training it 40960/76743 of epoch 1, 136.05 ms/it, loss 0.457493
Finished training it 40960/76743 of epoch 1, 136.12 ms/it, loss 0.455794
Finished training it 40960/76743 of epoch 1, 136.14 ms/it, loss 0.455645
Testing at - 40960/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2563970.0
get out
0 has test check 2563970.0 and sample count 3273728
 accuracy 78.320 %, best 78.320 %, roc auc score 0.7907, best 0.7907
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2563970.0
get out
3 has test check 2563970.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 135.19 ms/it, loss 0.456994
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13  8 21  1  9 16 19 17 10  5 22 23  4 15 20 18 11 25 14 24  2  6  3  0
  7 12]
Finished training it 41984/76743 of epoch 1, 135.16 ms/it, loss 0.456907
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2563970.0
get out
2 has test check 2563970.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 135.20 ms/it, loss 0.459121
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2563970.0
get out
1 has test check 2563970.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 135.17 ms/it, loss 0.456365
rank 0 ranking from least wide range to the widest range [ 1  8  9  5 21 13 23 17 19 25 14 24 22 10 15 11 16 20 18  2  4  3 12  6
  0  7]
Finished training it 43008/76743 of epoch 1, 136.32 ms/it, loss 0.457063
Finished training it 43008/76743 of epoch 1, 136.35 ms/it, loss 0.454446
Finished training it 43008/76743 of epoch 1, 136.34 ms/it, loss 0.453981
Finished training it 43008/76743 of epoch 1, 136.33 ms/it, loss 0.453985
rank 0 ranking from least wide range to the widest range [ 9  8  1 21 17 18  5 25 24 16 19 10 20  4 11 15 22 23 13 14  2  6  0  3
 12  7]
Finished training it 44032/76743 of epoch 1, 135.99 ms/it, loss 0.457370
Finished training it 44032/76743 of epoch 1, 136.01 ms/it, loss 0.454875
Finished training it 44032/76743 of epoch 1, 136.06 ms/it, loss 0.455789
Finished training it 44032/76743 of epoch 1, 136.07 ms/it, loss 0.456569
rank 0 ranking from least wide range to the widest range [ 1 21  9  8 19 23 22 16 24 17  5 15 11 20 13 10 25  2 14 18  0  6 12  4
  3  7]
Finished training it 45056/76743 of epoch 1, 135.95 ms/it, loss 0.456910
Finished training it 45056/76743 of epoch 1, 136.05 ms/it, loss 0.456565
Finished training it 45056/76743 of epoch 1, 136.00 ms/it, loss 0.456281
Finished training it 45056/76743 of epoch 1, 136.02 ms/it, loss 0.455547
rank 0 ranking from least wide range to the widest range [ 1  5 23  9 22 25 17 10 16 11 15  8  2 19 20 18 24 14 13 21  6  3  4  0
  7 12]
Finished training it 46080/76743 of epoch 1, 135.74 ms/it, loss 0.453097
Finished training it 46080/76743 of epoch 1, 135.81 ms/it, loss 0.456878
Finished training it 46080/76743 of epoch 1, 135.81 ms/it, loss 0.453926
Finished training it 46080/76743 of epoch 1, 135.78 ms/it, loss 0.455220
rank 0 ranking from least wide range to the widest range [ 1 21 17  5 22 13 24  4  9 16 19 14 10  8 23 25 18 20 11 15  2  0  6 12
  3  7]
Finished training it 47104/76743 of epoch 1, 136.50 ms/it, loss 0.456165
Finished training it 47104/76743 of epoch 1, 136.54 ms/it, loss 0.453539
Finished training it 47104/76743 of epoch 1, 136.52 ms/it, loss 0.456985
Finished training it 47104/76743 of epoch 1, 136.54 ms/it, loss 0.458032
rank 0 ranking from least wide range to the widest range [ 1  8 22  5 19 17  9 25 10 23 13 21 18 16 14 24 15 20 11  4  2  0 12  6
  3  7]
Finished training it 48128/76743 of epoch 1, 136.17 ms/it, loss 0.456054
Finished training it 48128/76743 of epoch 1, 136.15 ms/it, loss 0.455653
Finished training it 48128/76743 of epoch 1, 136.21 ms/it, loss 0.457397
Finished training it 48128/76743 of epoch 1, 136.22 ms/it, loss 0.455361
rank 0 ranking from least wide range to the widest range [ 1  9 22 19  5 18  8 24 10 23 25 11 20 21 15 16 14 17  2  0  4  6 13  3
  7 12]
Finished training it 49152/76743 of epoch 1, 136.41 ms/it, loss 0.455628
Finished training it 49152/76743 of epoch 1, 136.49 ms/it, loss 0.456466
Finished training it 49152/76743 of epoch 1, 136.45 ms/it, loss 0.456669
Finished training it 49152/76743 of epoch 1, 136.52 ms/it, loss 0.455527
rank 0 ranking from least wide range to the widest range [22  1  8  9 16 25 23 17  5 13 19 24 10 18 11 20 15 14  4  2 21  6  0  3
 12  7]
Finished training it 50176/76743 of epoch 1, 137.27 ms/it, loss 0.456244
Finished training it 50176/76743 of epoch 1, 137.27 ms/it, loss 0.454803
Finished training it 50176/76743 of epoch 1, 137.35 ms/it, loss 0.455481
Finished training it 50176/76743 of epoch 1, 137.32 ms/it, loss 0.455012
rank 0 ranking from least wide range to the widest range [ 1 17  5  9 22 16 15 23 14 11 10  8 20 13 21 25 18 19  2 24  6  4  0  3
 12  7]
Finished training it 51200/76743 of epoch 1, 137.85 ms/it, loss 0.452859
Finished training it 51200/76743 of epoch 1, 137.84 ms/it, loss 0.454324
Finished training it 51200/76743 of epoch 1, 137.83 ms/it, loss 0.459418
Finished training it 51200/76743 of epoch 1, 137.87 ms/it, loss 0.456255
Testing at - 51200/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2564032.0
get out
0 has test check 2564032.0 and sample count 3273728
 accuracy 78.321 %, best 78.321 %, roc auc score 0.7914, best 0.7914
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1  5  8 22  9 18 25 23 13 17 19 10 14 16 15 20 21  0 11 24  2  3  4  6
  7 12]
Finished training it 52224/76743 of epoch 1, 136.87 ms/it, loss 0.455058
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2564032.0
get out
3 has test check 2564032.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 136.98 ms/it, loss 0.457194
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2564032.0
get out
2 has test check 2564032.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 137.04 ms/it, loss 0.456390
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2564032.0
get out
1 has test check 2564032.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 137.00 ms/it, loss 0.457049
rank 0 ranking from least wide range to the widest range [ 1  9  8 22 25 16 23 18 17 20  5 14 21 11 13 24 15 19 10  2  6  3  0  4
 12  7]
Finished training it 53248/76743 of epoch 1, 139.05 ms/it, loss 0.456669
Finished training it 53248/76743 of epoch 1, 138.95 ms/it, loss 0.456963
Finished training it 53248/76743 of epoch 1, 138.98 ms/it, loss 0.456237
Finished training it 53248/76743 of epoch 1, 138.94 ms/it, loss 0.456622
rank 0 ranking from least wide range to the widest range [ 8 16  1  9 19 22 24  5 25 23 21 17 18 10 11 20 15  2 13  0 14  4  6  3
 12  7]
Finished training it 54272/76743 of epoch 1, 137.66 ms/it, loss 0.453733
Finished training it 54272/76743 of epoch 1, 137.70 ms/it, loss 0.457013
Finished training it 54272/76743 of epoch 1, 137.70 ms/it, loss 0.454166
Finished training it 54272/76743 of epoch 1, 137.69 ms/it, loss 0.456798
rank 0 ranking from least wide range to the widest range [ 1  9 22 19  8 24 13  0 18 25 17 23 10 16 15 11 20  4  2  5  3 14  6 21
 12  7]
Finished training it 55296/76743 of epoch 1, 136.65 ms/it, loss 0.453953
Finished training it 55296/76743 of epoch 1, 136.75 ms/it, loss 0.457289
Finished training it 55296/76743 of epoch 1, 136.67 ms/it, loss 0.456044
Finished training it 55296/76743 of epoch 1, 136.72 ms/it, loss 0.454639
rank 0 ranking from least wide range to the widest range [22  1  9 17 19 21 16 24  8  4 13  5 10 23 14 15 20 18 25 11  0  2  3  6
 12  7]
Finished training it 56320/76743 of epoch 1, 140.20 ms/it, loss 0.455537
Finished training it 56320/76743 of epoch 1, 140.29 ms/it, loss 0.455295
Finished training it 56320/76743 of epoch 1, 140.35 ms/it, loss 0.456557
Finished training it 56320/76743 of epoch 1, 140.33 ms/it, loss 0.456975
rank 0 ranking from least wide range to the widest range [22 23 19  1 16 25  8 20  5 10 11  2 15 17 24 14  3  9  6  4 18 13 21 12
  0  7]
Finished training it 57344/76743 of epoch 1, 137.41 ms/it, loss 0.454065
Finished training it 57344/76743 of epoch 1, 137.31 ms/it, loss 0.457548
Finished training it 57344/76743 of epoch 1, 137.41 ms/it, loss 0.456442
Finished training it 57344/76743 of epoch 1, 137.45 ms/it, loss 0.454142
rank 0 ranking from least wide range to the widest range [ 1 22  5  9 21 24 16 17  4 25 23 18 20 10 19 11  2 15 14 13  8  3  0  6
 12  7]
Finished training it 58368/76743 of epoch 1, 136.03 ms/it, loss 0.455137
Finished training it 58368/76743 of epoch 1, 135.98 ms/it, loss 0.455234
Finished training it 58368/76743 of epoch 1, 135.99 ms/it, loss 0.455276
Finished training it 58368/76743 of epoch 1, 136.01 ms/it, loss 0.458369
Finished training it 59392/76743 of epoch 1, 136.95 ms/it, loss 0.455131
rank 0 ranking from least wide range to the widest range [ 9  1 19  5 22  8 24 16 13 17 25 23 18 10  4 20 11 15 21  2  6 14  0  3
 12  7]
Finished training it 59392/76743 of epoch 1, 137.01 ms/it, loss 0.455600
Finished training it 59392/76743 of epoch 1, 137.00 ms/it, loss 0.455591
Finished training it 59392/76743 of epoch 1, 137.02 ms/it, loss 0.452595
rank 0 ranking from least wide range to the widest range [13  8  9  1  5 22 21 17 24 10 18 19 14 23 20 16 11 25  4  6 15  0  2  3
 12  7]
Finished training it 60416/76743 of epoch 1, 135.97 ms/it, loss 0.453598
Finished training it 60416/76743 of epoch 1, 136.05 ms/it, loss 0.457571
Finished training it 60416/76743 of epoch 1, 135.98 ms/it, loss 0.453254
Finished training it 60416/76743 of epoch 1, 135.98 ms/it, loss 0.457793
rank 0 ranking from least wide range to the widest range [22  9  8  1 19 21 10 18 17 23 25 24  5 11 13 20 15 14  0 16  2  4  6  3
  7 12]
Finished training it 61440/76743 of epoch 1, 136.42 ms/it, loss 0.454664
Finished training it 61440/76743 of epoch 1, 136.46 ms/it, loss 0.455063
Finished training it 61440/76743 of epoch 1, 136.42 ms/it, loss 0.453514
Finished training it 61440/76743 of epoch 1, 136.46 ms/it, loss 0.456231
Testing at - 61440/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2565297.0
get out
0 has test check 2565297.0 and sample count 3273728
 accuracy 78.360 %, best 78.360 %, roc auc score 0.7921, best 0.7921
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [22 19  1  5  8 25 23 17 24 18 13 10  9 16 20 14 11 15  2  4  6 21  3  0
 12  7]
Finished training it 62464/76743 of epoch 1, 136.51 ms/it, loss 0.455336
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2565297.0
get out
2 has test check 2565297.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 136.61 ms/it, loss 0.456306
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2565297.0
get out
1 has test check 2565297.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 136.60 ms/it, loss 0.457839
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2565297.0
get out
3 has test check 2565297.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 136.67 ms/it, loss 0.455219
rank 0 ranking from least wide range to the widest range [ 1  8  9 22 24  5 19 21 25 23 17 10 18 13  0 11 16 14 20  6  4  2  7 15
  3 12]
Finished training it 63488/76743 of epoch 1, 136.24 ms/it, loss 0.454953
Finished training it 63488/76743 of epoch 1, 136.31 ms/it, loss 0.454098
Finished training it 63488/76743 of epoch 1, 136.34 ms/it, loss 0.455347
Finished training it 63488/76743 of epoch 1, 136.35 ms/it, loss 0.454899
rank 0 ranking from least wide range to the widest range [ 1 16 24 17 19 25 23 13  5 14 22  9 20  8 11 18 15 10 21  2  3  6  0  4
 12  7]
Finished training it 64512/76743 of epoch 1, 137.38 ms/it, loss 0.453496
Finished training it 64512/76743 of epoch 1, 137.43 ms/it, loss 0.457745
Finished training it 64512/76743 of epoch 1, 137.40 ms/it, loss 0.453684
Finished training it 64512/76743 of epoch 1, 137.39 ms/it, loss 0.454827
rank 0 ranking from least wide range to the widest range [ 1  9 25 19  5  8 13 17 23 10 22 21 18 14 20 24 11 15 16  2  3  6  7  0
  4 12]
Finished training it 65536/76743 of epoch 1, 137.88 ms/it, loss 0.454912
Finished training it 65536/76743 of epoch 1, 137.92 ms/it, loss 0.455870
Finished training it 65536/76743 of epoch 1, 137.83 ms/it, loss 0.452174
Finished training it 65536/76743 of epoch 1, 137.91 ms/it, loss 0.455110
rank 0 ranking from least wide range to the widest range [22  9 17  4 16 25 14  1 18 10  8 13 20 23 19 11  0  6 15  2 21  3  5 24
  7 12]
Finished training it 66560/76743 of epoch 1, 136.92 ms/it, loss 0.455124
Finished training it 66560/76743 of epoch 1, 137.01 ms/it, loss 0.454431
Finished training it 66560/76743 of epoch 1, 136.98 ms/it, loss 0.454100
Finished training it 66560/76743 of epoch 1, 137.01 ms/it, loss 0.456162
rank 0 ranking from least wide range to the widest range [ 1 22  9 21 25 24 17  8 19 16 20 23 11 18 14  5 13 10 15  2  3  4  6  0
  7 12]
Finished training it 67584/76743 of epoch 1, 135.74 ms/it, loss 0.455683
Finished training it 67584/76743 of epoch 1, 135.80 ms/it, loss 0.454519
Finished training it 67584/76743 of epoch 1, 135.85 ms/it, loss 0.455998
Finished training it 67584/76743 of epoch 1, 135.84 ms/it, loss 0.456328
rank 0 ranking from least wide range to the widest range [ 9  1 22 13 17 16 25  8 19 14  5 23 10 20 11 15 24 18  0  2  3  6  4 21
  7 12]
Finished training it 68608/76743 of epoch 1, 136.24 ms/it, loss 0.457408
Finished training it 68608/76743 of epoch 1, 136.26 ms/it, loss 0.453739
Finished training it 68608/76743 of epoch 1, 136.30 ms/it, loss 0.456964
Finished training it 68608/76743 of epoch 1, 136.31 ms/it, loss 0.457285
rank 0 ranking from least wide range to the widest range [22 16  8  9 17 13  5 19  1 10 20 25 23 11 24 14 15  3  2  6 18 21  4  0
 12  7]
Finished training it 69632/76743 of epoch 1, 136.41 ms/it, loss 0.457224
Finished training it 69632/76743 of epoch 1, 136.43 ms/it, loss 0.456306
Finished training it 69632/76743 of epoch 1, 136.44 ms/it, loss 0.454383
Finished training it 69632/76743 of epoch 1, 136.46 ms/it, loss 0.455129
Finished training it 70656/76743 of epoch 1, 137.04 ms/it, loss 0.456105
Finished training it 70656/76743 of epoch 1, 137.00 ms/it, loss 0.456663
Finished training it 70656/76743 of epoch 1, 137.01 ms/it, loss 0.453641
rank 0 ranking from least wide range to the widest range [22  1 13 19 16 21 17  9 18 14 20 11 23 25  5  8 24 15 10  2  6  3  0 12
  4  7]
Finished training it 70656/76743 of epoch 1, 136.94 ms/it, loss 0.455504
rank 0 ranking from least wide range to the widest range [ 9  1 22 17  5 13 10 23 20 25 19 11 14 21 16 24 15  6  8  2  4  3 18 12
  0  7]
Finished training it 71680/76743 of epoch 1, 136.57 ms/it, loss 0.456351
Finished training it 71680/76743 of epoch 1, 136.59 ms/it, loss 0.454218
Finished training it 71680/76743 of epoch 1, 136.60 ms/it, loss 0.455828
Finished training it 71680/76743 of epoch 1, 136.54 ms/it, loss 0.454973
Testing at - 71680/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2565896.0
get out
0 has test check 2565896.0 and sample count 3273728
 accuracy 78.378 %, best 78.378 %, roc auc score 0.7923, best 0.7923
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1  9 22 16  8 25 19 21 17 23 18  5 13 20  4 11 24 14 10  6  2 15  3  7
  0 12]
Finished training it 72704/76743 of epoch 1, 136.38 ms/it, loss 0.455602
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2565896.0
get out
2 has test check 2565896.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 136.53 ms/it, loss 0.454817
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2565896.0
get out
3 has test check 2565896.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 136.52 ms/it, loss 0.453782
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2565896.0
get out
1 has test check 2565896.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 136.57 ms/it, loss 0.458376
rank 0 ranking from least wide range to the widest range [ 1 22 16 19  9 21 24 13 25  8 20 10 17 23  4 11 15  5 14  3  6  2  0 18
  7 12]
Finished training it 73728/76743 of epoch 1, 136.81 ms/it, loss 0.455734
Finished training it 73728/76743 of epoch 1, 136.86 ms/it, loss 0.453577
Finished training it 73728/76743 of epoch 1, 136.90 ms/it, loss 0.454660
Finished training it 73728/76743 of epoch 1, 136.83 ms/it, loss 0.455598
rank 0 ranking from least wide range to the widest range [ 9  1  8 17 25 20  5 23 16 14 19 21 11 22 15 10  0 13 24  3  4  2  6 18
 12  7]
Finished training it 74752/76743 of epoch 1, 137.12 ms/it, loss 0.455277
Finished training it 74752/76743 of epoch 1, 137.09 ms/it, loss 0.456715
Finished training it 74752/76743 of epoch 1, 137.09 ms/it, loss 0.455098
Finished training it 74752/76743 of epoch 1, 137.13 ms/it, loss 0.453402
Finished training it 75776/76743 of epoch 1, 136.63 ms/it, loss 0.453759
Finished training it 75776/76743 of epoch 1, 136.67 ms/it, loss 0.455542
rank 0 ranking from least wide range to the widest range [ 1 22 16 19  8 25 13  9 17 20 21 23 24  4 11  5 18 15 14  2  3 10  0  7
  6 12]
Finished training it 75776/76743 of epoch 1, 136.71 ms/it, loss 0.454550
Finished training it 75776/76743 of epoch 1, 136.65 ms/it, loss 0.455365
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 137.47 ms/it, loss 0.454968
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 137.49 ms/it, loss 0.453663
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 137.37 ms/it, loss 0.455660
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [ 1 22  9  5 17 16 13 24  8 19 14 23 25 20 10 11 21  4  6  2 15  0  3 18
 12  7]
Finished training it 1024/76743 of epoch 2, 137.47 ms/it, loss 0.453922
rank 0 ranking from least wide range to the widest range [ 9  1 16 13 25 17 19 23 24 20 10 11  0 22 14 15  2  6  3  8  5 18 21  4
 12  7]
Finished training it 2048/76743 of epoch 2, 136.89 ms/it, loss 0.456803
Finished training it 2048/76743 of epoch 2, 136.89 ms/it, loss 0.456366
Finished training it 2048/76743 of epoch 2, 137.00 ms/it, loss 0.459070
Finished training it 2048/76743 of epoch 2, 136.95 ms/it, loss 0.456583
rank 0 ranking from least wide range to the widest range [13 22 21  8  1  5  9 19  0 24 16 17 25 10 11 20 18 23 15 14  6  3  2  4
 12  7]
Finished training it 3072/76743 of epoch 2, 136.69 ms/it, loss 0.456798
Finished training it 3072/76743 of epoch 2, 136.71 ms/it, loss 0.453023
Finished training it 3072/76743 of epoch 2, 136.76 ms/it, loss 0.452046
Finished training it 3072/76743 of epoch 2, 136.76 ms/it, loss 0.455004
rank 0 ranking from least wide range to the widest range [ 1  9  8 22 13 19  5 21 17 25 10 20 11 23 24 14 16  0 15  6  2  3  4 18
 12  7]
Finished training it 4096/76743 of epoch 2, 137.17 ms/it, loss 0.455721
Finished training it 4096/76743 of epoch 2, 137.18 ms/it, loss 0.452685
Finished training it 4096/76743 of epoch 2, 137.15 ms/it, loss 0.454118
Finished training it 4096/76743 of epoch 2, 137.14 ms/it, loss 0.452099
rank 0 ranking from least wide range to the widest range [ 1  9 22 25 16 21 23 13 17  5 20  8 24 14 19 11 18 10 15  0  2  3  6  7
  4 12]
Finished training it 5120/76743 of epoch 2, 136.19 ms/it, loss 0.454653
Finished training it 5120/76743 of epoch 2, 136.14 ms/it, loss 0.454687
Finished training it 5120/76743 of epoch 2, 136.19 ms/it, loss 0.453980
Finished training it 5120/76743 of epoch 2, 136.15 ms/it, loss 0.456736
rank 0 ranking from least wide range to the widest range [ 1 16  9  8 22 21 13  5 14 17 25 19 10 24 18 11 23 20  0 15  4  3  6  2
 12  7]
Finished training it 6144/76743 of epoch 2, 136.37 ms/it, loss 0.456919
Finished training it 6144/76743 of epoch 2, 136.42 ms/it, loss 0.454568
Finished training it 6144/76743 of epoch 2, 136.41 ms/it, loss 0.455103
Finished training it 6144/76743 of epoch 2, 136.45 ms/it, loss 0.454682
rank 0 ranking from least wide range to the widest range [ 1  5 22  9  8 17 25 21 24 19  0 10 14 20 16 23  4 11 13 15 18  6  3  2
 12  7]
Finished training it 7168/76743 of epoch 2, 137.08 ms/it, loss 0.455752
Finished training it 7168/76743 of epoch 2, 137.05 ms/it, loss 0.452980
Finished training it 7168/76743 of epoch 2, 137.09 ms/it, loss 0.453755
Finished training it 7168/76743 of epoch 2, 137.05 ms/it, loss 0.455837
rank 0 ranking from least wide range to the widest range [19  8 22 13 24  1 25 17 20 11 10  0 18  4  9  5 23 21 16 14 15  6  3  2
 12  7]
Finished training it 8192/76743 of epoch 2, 136.67 ms/it, loss 0.454803
Finished training it 8192/76743 of epoch 2, 136.72 ms/it, loss 0.455156
Finished training it 8192/76743 of epoch 2, 136.72 ms/it, loss 0.455787
Finished training it 8192/76743 of epoch 2, 136.71 ms/it, loss 0.456004
rank 0 ranking from least wide range to the widest range [22  9  8  1 21  4 13 19 17 16 25  5 18 20 14 11  0 10 23 24 15  7  3  2
  6 12]
Finished training it 9216/76743 of epoch 2, 137.96 ms/it, loss 0.455664
Finished training it 9216/76743 of epoch 2, 137.96 ms/it, loss 0.454886
Finished training it 9216/76743 of epoch 2, 137.94 ms/it, loss 0.455305
Finished training it 9216/76743 of epoch 2, 137.89 ms/it, loss 0.454270
rank 0 ranking from least wide range to the widest range [22  9  8 16 13  1 25 24  0  4 10 23  5 11 20 17 14 18  3 19 15  6  2 21
 12  7]
Finished training it 10240/76743 of epoch 2, 136.43 ms/it, loss 0.452969
Finished training it 10240/76743 of epoch 2, 136.47 ms/it, loss 0.453332
Finished training it 10240/76743 of epoch 2, 136.47 ms/it, loss 0.453816
Finished training it 10240/76743 of epoch 2, 136.44 ms/it, loss 0.454289
Testing at - 10240/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567521.0
get out
0 has test check 2567521.0 and sample count 3273728
 accuracy 78.428 %, best 78.428 %, roc auc score 0.7930, best 0.7930
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 21 24 22  9  5 13 25 18 16 17  8 20 23 10  4 14 11 19  0  3 15  6  2
  7 12]
Finished training it 11264/76743 of epoch 2, 136.50 ms/it, loss 0.453519
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567521.0
get out
1 has test check 2567521.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 136.53 ms/it, loss 0.451886
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567521.0
get out
2 has test check 2567521.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 136.55 ms/it, loss 0.453941
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567521.0
get out
3 has test check 2567521.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 136.61 ms/it, loss 0.455047
rank 0 ranking from least wide range to the widest range [22  1 25  9 19 24 21 23  5 13 16 20  0  4  8 17 11 10  3  7 14  2 15  6
 18 12]
Finished training it 12288/76743 of epoch 2, 137.58 ms/it, loss 0.454061
Finished training it 12288/76743 of epoch 2, 137.58 ms/it, loss 0.453021
Finished training it 12288/76743 of epoch 2, 137.54 ms/it, loss 0.454863
Finished training it 12288/76743 of epoch 2, 137.55 ms/it, loss 0.453008
rank 0 ranking from least wide range to the widest range [22  9  8 16 19  1 25 13 20 11 10 17 23 24 21 14 15  6  3 18  2  5  0  4
  7 12]
Finished training it 13312/76743 of epoch 2, 137.38 ms/it, loss 0.455411
Finished training it 13312/76743 of epoch 2, 137.35 ms/it, loss 0.455174
Finished training it 13312/76743 of epoch 2, 137.38 ms/it, loss 0.455486
Finished training it 13312/76743 of epoch 2, 137.39 ms/it, loss 0.454492
rank 0 ranking from least wide range to the widest range [ 1  8 22 19  5 16 21 17 25 24 13 14  9 10  0 23 11 20  4 18  6  3 15  7
  2 12]
Finished training it 14336/76743 of epoch 2, 137.39 ms/it, loss 0.455278
Finished training it 14336/76743 of epoch 2, 137.40 ms/it, loss 0.452379
Finished training it 14336/76743 of epoch 2, 137.36 ms/it, loss 0.456192
Finished training it 14336/76743 of epoch 2, 137.41 ms/it, loss 0.454276
rank 0 ranking from least wide range to the widest range [21 19 22 24  5 13  9  8 17 16 10  1 20 11 25 14  0 23  6 15  3  2 18  4
  7 12]
Finished training it 15360/76743 of epoch 2, 136.86 ms/it, loss 0.454537
Finished training it 15360/76743 of epoch 2, 136.85 ms/it, loss 0.453768
Finished training it 15360/76743 of epoch 2, 136.81 ms/it, loss 0.457795
Finished training it 15360/76743 of epoch 2, 136.83 ms/it, loss 0.452018
rank 0 ranking from least wide range to the widest range [22 16 13  8  1 25 20  4 11 17 21 24  9 23  5 14 18 10  0 19  3 15  6  2
 12  7]
Finished training it 16384/76743 of epoch 2, 136.56 ms/it, loss 0.455852
Finished training it 16384/76743 of epoch 2, 136.59 ms/it, loss 0.454326
Finished training it 16384/76743 of epoch 2, 136.60 ms/it, loss 0.455477
Finished training it 16384/76743 of epoch 2, 136.62 ms/it, loss 0.455394
rank 0 ranking from least wide range to the widest range [ 9 21  1 19 16 22 13 17  4  5  8 24 14 25 23 10 20  0 11 18  6  7 15  3
  2 12]
Finished training it 17408/76743 of epoch 2, 135.69 ms/it, loss 0.452347
Finished training it 17408/76743 of epoch 2, 135.70 ms/it, loss 0.455262
Finished training it 17408/76743 of epoch 2, 135.72 ms/it, loss 0.455188
Finished training it 17408/76743 of epoch 2, 135.75 ms/it, loss 0.455727
rank 0 ranking from least wide range to the widest range [22  1 19 16 25  9 13 24  8 20 21  5 23 17  4 11 10  3  2  0 14 18 15  6
 12  7]
Finished training it 18432/76743 of epoch 2, 135.74 ms/it, loss 0.451257
Finished training it 18432/76743 of epoch 2, 135.77 ms/it, loss 0.453510
Finished training it 18432/76743 of epoch 2, 135.79 ms/it, loss 0.454441
Finished training it 18432/76743 of epoch 2, 135.78 ms/it, loss 0.453644
rank 0 ranking from least wide range to the widest range [22  1  8  9 13 21 20 16 17 11 24  5 23 10 25 19  6 14  4  2 15  0  3  7
 18 12]
Finished training it 19456/76743 of epoch 2, 136.09 ms/it, loss 0.455094
Finished training it 19456/76743 of epoch 2, 136.11 ms/it, loss 0.454972
Finished training it 19456/76743 of epoch 2, 136.18 ms/it, loss 0.453818
Finished training it 19456/76743 of epoch 2, 136.10 ms/it, loss 0.455079
rank 0 ranking from least wide range to the widest range [ 9 24  8 22  1  4 25 16 13 17  0 20  5 19 18 10 23 11 14  3  2  6 15 21
 12  7]
Finished training it 20480/76743 of epoch 2, 136.62 ms/it, loss 0.452878
Finished training it 20480/76743 of epoch 2, 136.67 ms/it, loss 0.456414
Finished training it 20480/76743 of epoch 2, 136.65 ms/it, loss 0.453688
Finished training it 20480/76743 of epoch 2, 136.62 ms/it, loss 0.452837
Testing at - 20480/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2568444.0
get out
0 has test check 2568444.0 and sample count 3273728
 accuracy 78.456 %, best 78.456 %, roc auc score 0.7936, best 0.7936
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 1 22 13 24  9 19 16 17 25  8 23 20 11 14  0 10  4  6 18  3 21  5 15  2
 12  7]
Finished training it 21504/76743 of epoch 2, 137.36 ms/it, loss 0.454093
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2568444.0
get out
2 has test check 2568444.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 137.48 ms/it, loss 0.451227
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2568444.0
get out
3 has test check 2568444.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 137.59 ms/it, loss 0.455665
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2568444.0
get out
1 has test check 2568444.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 137.46 ms/it, loss 0.455446
rank 0 ranking from least wide range to the widest range [ 1  9 16 13 22 24  8 19  4 25 17 10 11 20 23  5 14 21  6  3  0 15  2 18
  7 12]
Finished training it 22528/76743 of epoch 2, 136.97 ms/it, loss 0.452494
Finished training it 22528/76743 of epoch 2, 136.98 ms/it, loss 0.453643
Finished training it 22528/76743 of epoch 2, 137.00 ms/it, loss 0.454449
Finished training it 22528/76743 of epoch 2, 137.03 ms/it, loss 0.455414
rank 0 ranking from least wide range to the widest range [ 1 19  9  8 24 21  5  4 25 13 16 17 22 23 20 10 11 14  3 18  6 12  2 15
  0  7]
Finished training it 23552/76743 of epoch 2, 136.88 ms/it, loss 0.455888
Finished training it 23552/76743 of epoch 2, 136.89 ms/it, loss 0.454220
Finished training it 23552/76743 of epoch 2, 136.94 ms/it, loss 0.455943
Finished training it 23552/76743 of epoch 2, 136.89 ms/it, loss 0.454578
rank 0 ranking from least wide range to the widest range [13 22  9 17  1 24 25 23  8 21 20 19 16  4 11 10 14  5  7 18  6  3  2 15
 12  0]
Finished training it 24576/76743 of epoch 2, 137.48 ms/it, loss 0.452347
Finished training it 24576/76743 of epoch 2, 137.47 ms/it, loss 0.453428
Finished training it 24576/76743 of epoch 2, 137.48 ms/it, loss 0.455175
Finished training it 24576/76743 of epoch 2, 137.55 ms/it, loss 0.455251
rank 0 ranking from least wide range to the widest range [ 1  8  9 19 13 24 21 16 22 25 23  5 17 20 10 11 14  3  6  4 18 15  0  2
  7 12]
Finished training it 25600/76743 of epoch 2, 136.97 ms/it, loss 0.453146
Finished training it 25600/76743 of epoch 2, 137.10 ms/it, loss 0.455579
Finished training it 25600/76743 of epoch 2, 137.06 ms/it, loss 0.453277
Finished training it 25600/76743 of epoch 2, 137.01 ms/it, loss 0.451414
rank 0 ranking from least wide range to the widest range [ 9  1 22 16  5  4 11  8 20 13 25 10 17 23 24 18  6 19 14 21  0  3 12  2
 15  7]
Finished training it 26624/76743 of epoch 2, 136.60 ms/it, loss 0.457208
Finished training it 26624/76743 of epoch 2, 136.63 ms/it, loss 0.453543
Finished training it 26624/76743 of epoch 2, 136.64 ms/it, loss 0.453327
Finished training it 26624/76743 of epoch 2, 136.67 ms/it, loss 0.456125
Finished training it 27648/76743 of epoch 2, 136.77 ms/it, loss 0.453784
rank 0 ranking from least wide range to the widest range [ 9 24 22 25  1 23 17 21  5 19 20  8 10 11  4 13 14  6 16  3  2 15  0 12
 18  7]
Finished training it 27648/76743 of epoch 2, 136.80 ms/it, loss 0.451564
Finished training it 27648/76743 of epoch 2, 136.83 ms/it, loss 0.453717
Finished training it 27648/76743 of epoch 2, 136.87 ms/it, loss 0.452495
rank 0 ranking from least wide range to the widest range [22  9  8  1 24 25 13 20 23 19 16 11 10 17 18  4  0  3  6 14  5 21 15  2
 12  7]
Finished training it 28672/76743 of epoch 2, 135.59 ms/it, loss 0.453720
Finished training it 28672/76743 of epoch 2, 135.61 ms/it, loss 0.453508
Finished training it 28672/76743 of epoch 2, 135.59 ms/it, loss 0.454861
Finished training it 28672/76743 of epoch 2, 135.60 ms/it, loss 0.452265
Finished training it 29696/76743 of epoch 2, 137.79 ms/it, loss 0.455656
rank 0 ranking from least wide range to the widest range [22  9  1  4 16 13 24 23 25 19 17 20 11  5  0  8 10 14  3 21  6  2 15  7
 18 12]
Finished training it 29696/76743 of epoch 2, 137.67 ms/it, loss 0.453270
Finished training it 29696/76743 of epoch 2, 137.83 ms/it, loss 0.453400
Finished training it 29696/76743 of epoch 2, 137.70 ms/it, loss 0.451876
rank 0 ranking from least wide range to the widest range [22  1  9 19  0  8 21 25 24 13 20  4 16  5 23 10 17 11  6  3 18 14 12  2
 15  7]
Finished training it 30720/76743 of epoch 2, 136.01 ms/it, loss 0.455653
Finished training it 30720/76743 of epoch 2, 136.01 ms/it, loss 0.454516
Finished training it 30720/76743 of epoch 2, 136.02 ms/it, loss 0.449446
Finished training it 30720/76743 of epoch 2, 136.00 ms/it, loss 0.454882
Testing at - 30720/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567312.0
get out
0 has test check 2567312.0 and sample count 3273728
 accuracy 78.422 %, best 78.456 %, roc auc score 0.7936, best 0.7936
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 19 22 17 25  9 10  5 23 20 24 13 11  0 14 21 18  8  7  6  3  4 15 16
  2 12]
Finished training it 31744/76743 of epoch 2, 136.13 ms/it, loss 0.451936
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567312.0
get out
3 has test check 2567312.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 136.20 ms/it, loss 0.453813
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567312.0
get out
1 has test check 2567312.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 136.12 ms/it, loss 0.452665
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567312.0
get out
2 has test check 2567312.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 136.27 ms/it, loss 0.452893
Finished training it 32768/76743 of epoch 2, 135.22 ms/it, loss 0.453640
Finished training it 32768/76743 of epoch 2, 135.23 ms/it, loss 0.453343
Finished training it 32768/76743 of epoch 2, 135.24 ms/it, loss 0.454427
rank 0 ranking from least wide range to the widest range [22  1 21  4  9  5 13  8 23 19 16 24 17 20  0 25 11 10 18 14  3  6  2 12
 15  7]
Finished training it 32768/76743 of epoch 2, 135.21 ms/it, loss 0.453304
rank 0 ranking from least wide range to the widest range [13 16  9  1 24  8 22 19 25 21 17 23 20 10 11  0 18  5  6 14  4  3 12  2
 15  7]
Finished training it 33792/76743 of epoch 2, 137.23 ms/it, loss 0.454538
Finished training it 33792/76743 of epoch 2, 137.30 ms/it, loss 0.455972
Finished training it 33792/76743 of epoch 2, 137.24 ms/it, loss 0.453920
Finished training it 33792/76743 of epoch 2, 137.27 ms/it, loss 0.452766
rank 0 ranking from least wide range to the widest range [24 13  1  9 21  5 22 19 25 17 20  8 10 11 23 16  0 14  4  6 18  3  7 12
  2 15]
Finished training it 34816/76743 of epoch 2, 137.69 ms/it, loss 0.450838
Finished training it 34816/76743 of epoch 2, 137.73 ms/it, loss 0.454177
Finished training it 34816/76743 of epoch 2, 137.70 ms/it, loss 0.451823
Finished training it 34816/76743 of epoch 2, 137.72 ms/it, loss 0.454805
rank 0 ranking from least wide range to the widest range [ 1 22 24 16 21  9  8 17 19 20 25 23 13 18  5 14 11 10  0  4  6  7  2  3
 15 12]
Finished training it 35840/76743 of epoch 2, 136.37 ms/it, loss 0.452891
Finished training it 35840/76743 of epoch 2, 136.39 ms/it, loss 0.454951
Finished training it 35840/76743 of epoch 2, 136.34 ms/it, loss 0.451550
Finished training it 35840/76743 of epoch 2, 136.34 ms/it, loss 0.452935
Finished training it 36864/76743 of epoch 2, 136.96 ms/it, loss 0.450315
rank 0 ranking from least wide range to the widest range [22 16  1 21 13  9  8 25 19 17 23  4 10  0 24 20 11 18  5 14  6  3  2 12
 15  7]
Finished training it 36864/76743 of epoch 2, 136.92 ms/it, loss 0.454275
Finished training it 36864/76743 of epoch 2, 136.97 ms/it, loss 0.452076
Finished training it 36864/76743 of epoch 2, 136.92 ms/it, loss 0.456607
rank 0 ranking from least wide range to the widest range [22  1  9 24 13 21 23 19 17  5 25 20  8 18 10 16 11 14  0  3  4  6  2 15
 12  7]
Finished training it 37888/76743 of epoch 2, 135.59 ms/it, loss 0.451993
Finished training it 37888/76743 of epoch 2, 135.63 ms/it, loss 0.449504
Finished training it 37888/76743 of epoch 2, 135.58 ms/it, loss 0.453220
Finished training it 37888/76743 of epoch 2, 135.58 ms/it, loss 0.450463
rank 0 ranking from least wide range to the widest range [22  1 24 13 16 19  9 17  8  0 21  4 10 20 23 11  5 25 14 18  6  3 12  2
 15  7]
Finished training it 38912/76743 of epoch 2, 136.81 ms/it, loss 0.451994
Finished training it 38912/76743 of epoch 2, 136.81 ms/it, loss 0.453955
Finished training it 38912/76743 of epoch 2, 136.79 ms/it, loss 0.451932
Finished training it 38912/76743 of epoch 2, 136.77 ms/it, loss 0.454598
rank 0 ranking from least wide range to the widest range [ 1  8 24  9 13 17 16  5 21 19 25 10 22  4 23 11  0 20 14 18  6  3  7 15
 12  2]
Finished training it 39936/76743 of epoch 2, 136.29 ms/it, loss 0.454576
Finished training it 39936/76743 of epoch 2, 136.35 ms/it, loss 0.455654
Finished training it 39936/76743 of epoch 2, 136.37 ms/it, loss 0.453181
Finished training it 39936/76743 of epoch 2, 136.35 ms/it, loss 0.454379
Finished training it 40960/76743 of epoch 2, 136.14 ms/it, loss 0.453185
Finished training it 40960/76743 of epoch 2, 136.13 ms/it, loss 0.453885
rank 0 ranking from least wide range to the widest range [19  1 24 22 25  5  4  9 23 17 20 11  0  8 10 14 16 18  6 13  3 21  2 15
  7 12]
Finished training it 40960/76743 of epoch 2, 136.06 ms/it, loss 0.454368
Finished training it 40960/76743 of epoch 2, 136.20 ms/it, loss 0.452910
Testing at - 40960/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567029.0
get out
0 has test check 2567029.0 and sample count 3273728
 accuracy 78.413 %, best 78.456 %, roc auc score 0.7933, best 0.7936
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13 19  4  8  9  1 22 21 24 16 10 17 11 20 25  5 23 18  0  7 14  6  3 15
  2 12]
Finished training it 41984/76743 of epoch 2, 136.86 ms/it, loss 0.454295
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567029.0
get out
3 has test check 2567029.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 136.98 ms/it, loss 0.454460
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567029.0
get out
2 has test check 2567029.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 136.98 ms/it, loss 0.456698
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567029.0
get out
1 has test check 2567029.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 136.98 ms/it, loss 0.453709
rank 0 ranking from least wide range to the widest range [ 1 21  8 17 24 19  9  4 13  5 23 25 20 16 22 11 10 14 18  6  0  3 12  7
  2 15]
Finished training it 43008/76743 of epoch 2, 136.70 ms/it, loss 0.453688
Finished training it 43008/76743 of epoch 2, 136.79 ms/it, loss 0.451077
Finished training it 43008/76743 of epoch 2, 136.76 ms/it, loss 0.451256
Finished training it 43008/76743 of epoch 2, 136.78 ms/it, loss 0.451949
Finished training it 44032/76743 of epoch 2, 136.93 ms/it, loss 0.452386
rank 0 ranking from least wide range to the widest range [ 9 24  1 25 22 17 16  4  8 13 10 20 11 18  0 19 21  5 23 14  6  3 12 15
  2  7]
Finished training it 44032/76743 of epoch 2, 136.84 ms/it, loss 0.454857
Finished training it 44032/76743 of epoch 2, 136.88 ms/it, loss 0.453355
Finished training it 44032/76743 of epoch 2, 136.89 ms/it, loss 0.453843
rank 0 ranking from least wide range to the widest range [ 1  9 21 24 19 22  5 16 13 17 11  0  8 23 20 10 25 12 18  6 14  4  3  7
 15  2]
Finished training it 45056/76743 of epoch 2, 135.41 ms/it, loss 0.454161
Finished training it 45056/76743 of epoch 2, 135.50 ms/it, loss 0.453656
Finished training it 45056/76743 of epoch 2, 135.44 ms/it, loss 0.453465
Finished training it 45056/76743 of epoch 2, 135.49 ms/it, loss 0.453792
rank 0 ranking from least wide range to the widest range [22 24  9  1  8 23 11 17  4 10 25  5 16 20 19 13 18  0  3  6 14 21  7  2
 12 15]
Finished training it 46080/76743 of epoch 2, 137.13 ms/it, loss 0.450859
Finished training it 46080/76743 of epoch 2, 137.13 ms/it, loss 0.452543
Finished training it 46080/76743 of epoch 2, 137.12 ms/it, loss 0.451268
Finished training it 46080/76743 of epoch 2, 137.13 ms/it, loss 0.453491
rank 0 ranking from least wide range to the widest range [21 24  1 17 13  5 22  9 16 10 23 20 25 11 14  4 19  8  0  6 12 18  7  3
  2 15]
Finished training it 47104/76743 of epoch 2, 136.55 ms/it, loss 0.453387
Finished training it 47104/76743 of epoch 2, 136.64 ms/it, loss 0.454261
Finished training it 47104/76743 of epoch 2, 136.68 ms/it, loss 0.455421
Finished training it 47104/76743 of epoch 2, 136.61 ms/it, loss 0.450658
rank 0 ranking from least wide range to the widest range [ 9  1 24 19 25 17 22  8 23 10 20 13  4  0 16 21 11 18 14  5  3  6 12  7
  2 15]
Finished training it 48128/76743 of epoch 2, 136.40 ms/it, loss 0.453389
Finished training it 48128/76743 of epoch 2, 136.46 ms/it, loss 0.454411
Finished training it 48128/76743 of epoch 2, 136.52 ms/it, loss 0.452703
Finished training it 48128/76743 of epoch 2, 136.52 ms/it, loss 0.453261
rank 0 ranking from least wide range to the widest range [ 1  9 22 24  5 20 11 23 19 25 10  8  0 16 21  4 18 17  6 14 13  3  7 12
  2 15]
Finished training it 49152/76743 of epoch 2, 136.53 ms/it, loss 0.452795
Finished training it 49152/76743 of epoch 2, 136.53 ms/it, loss 0.453128
Finished training it 49152/76743 of epoch 2, 136.52 ms/it, loss 0.452617
Finished training it 49152/76743 of epoch 2, 136.54 ms/it, loss 0.453521
Finished training it 50176/76743 of epoch 2, 136.03 ms/it, loss 0.451770
Finished training it 50176/76743 of epoch 2, 136.01 ms/it, loss 0.452096
Finished training it 50176/76743 of epoch 2, 135.96 ms/it, loss 0.452484
rank 0 ranking from least wide range to the widest range [24 22  1  9 13 16 25 23 20 17 10 11  8 19  0  5 18  7  4  6 14 21  3 12
  2 15]
Finished training it 50176/76743 of epoch 2, 135.97 ms/it, loss 0.452837
rank 0 ranking from least wide range to the widest range [ 1 17  5  9 16 10 20 25  0 14 19  4 24 11  8 23 13 22  6 21  7  3 18 15
  2 12]
Finished training it 51200/76743 of epoch 2, 136.21 ms/it, loss 0.450750
Finished training it 51200/76743 of epoch 2, 136.24 ms/it, loss 0.453615
Finished training it 51200/76743 of epoch 2, 136.28 ms/it, loss 0.451487
Finished training it 51200/76743 of epoch 2, 136.31 ms/it, loss 0.456441
Testing at - 51200/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2568487.0
get out
0 has test check 2568487.0 and sample count 3273728
 accuracy 78.458 %, best 78.458 %, roc auc score 0.7946, best 0.7946
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 22  9 24  5 25 20 13  8 23 10 11  4 17 18 14  7 19 16  0  3  6 21 12
 15  2]
Finished training it 52224/76743 of epoch 2, 136.26 ms/it, loss 0.451669
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2568487.0
get out
3 has test check 2568487.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 136.34 ms/it, loss 0.453909
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2568487.0
get out
2 has test check 2568487.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 136.29 ms/it, loss 0.453093
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2568487.0
get out
1 has test check 2568487.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 136.28 ms/it, loss 0.454287
rank 0 ranking from least wide range to the widest range [ 1  8  9 24 25 22 23 13 17 20 16 18  7 11 14 21 19  5 10  6  4  3  0 12
  2 15]
Finished training it 53248/76743 of epoch 2, 136.36 ms/it, loss 0.453733
Finished training it 53248/76743 of epoch 2, 136.35 ms/it, loss 0.453746
Finished training it 53248/76743 of epoch 2, 136.41 ms/it, loss 0.453249
Finished training it 53248/76743 of epoch 2, 136.41 ms/it, loss 0.454062
rank 0 ranking from least wide range to the widest range [22  1 24  9 16 20  8 25 19 23  5 17  0 13 11 10  4 18  3  6 14 21 12  2
 15  7]
Finished training it 54272/76743 of epoch 2, 136.77 ms/it, loss 0.450785
Finished training it 54272/76743 of epoch 2, 136.71 ms/it, loss 0.453903
Finished training it 54272/76743 of epoch 2, 136.78 ms/it, loss 0.451258
Finished training it 54272/76743 of epoch 2, 136.79 ms/it, loss 0.453555
rank 0 ranking from least wide range to the widest range [ 0  1  8  9 19 22  4 24 13 18 25  5 17 20 23 10 16 11 21  3  6 14  7 12
 15  2]
Finished training it 55296/76743 of epoch 2, 136.64 ms/it, loss 0.451139
Finished training it 55296/76743 of epoch 2, 136.62 ms/it, loss 0.454126
Finished training it 55296/76743 of epoch 2, 136.68 ms/it, loss 0.452787
Finished training it 55296/76743 of epoch 2, 136.65 ms/it, loss 0.451945
rank 0 ranking from least wide range to the widest range [24  9 21  1 22 17 13 19  8  5 25 20 23 10 18 14 16 11  0  4  3  6  7 12
 15  2]
Finished training it 56320/76743 of epoch 2, 138.00 ms/it, loss 0.452723
Finished training it 56320/76743 of epoch 2, 137.92 ms/it, loss 0.453708
Finished training it 56320/76743 of epoch 2, 138.01 ms/it, loss 0.454170
Finished training it 56320/76743 of epoch 2, 137.94 ms/it, loss 0.452682
rank 0 ranking from least wide range to the widest range [22 24 20 23  1  8 17 11 25 10 16  9  0 19  6 14 13  5 21  3  4  2 18 12
 15  7]
Finished training it 57344/76743 of epoch 2, 136.81 ms/it, loss 0.451021
Finished training it 57344/76743 of epoch 2, 136.86 ms/it, loss 0.451139
Finished training it 57344/76743 of epoch 2, 136.78 ms/it, loss 0.453619
Finished training it 57344/76743 of epoch 2, 136.86 ms/it, loss 0.454673
rank 0 ranking from least wide range to the widest range [22  0 24  1  9  4  5 17 21 13 23 25 20 18 10 19  8 11 16 14  6 12  3  7
  2 15]
Finished training it 58368/76743 of epoch 2, 136.51 ms/it, loss 0.451947
Finished training it 58368/76743 of epoch 2, 136.62 ms/it, loss 0.452204
Finished training it 58368/76743 of epoch 2, 136.60 ms/it, loss 0.455408
Finished training it 58368/76743 of epoch 2, 136.65 ms/it, loss 0.451975
rank 0 ranking from least wide range to the widest range [ 1  9 22 24 19  4  0 13  8  5 17 20 25 21 23 11 10 16 18 12  6 14  3  7
 15  2]
Finished training it 59392/76743 of epoch 2, 137.00 ms/it, loss 0.453231
Finished training it 59392/76743 of epoch 2, 137.04 ms/it, loss 0.452591
Finished training it 59392/76743 of epoch 2, 137.03 ms/it, loss 0.450195
Finished training it 59392/76743 of epoch 2, 137.05 ms/it, loss 0.452372
rank 0 ranking from least wide range to the widest range [22 21  0  1  9 24 13 17  5 10  8 20 18  4 11 14 23 19 25  6 16 12  3  2
 15  7]
Finished training it 60416/76743 of epoch 2, 137.09 ms/it, loss 0.451067
Finished training it 60416/76743 of epoch 2, 137.12 ms/it, loss 0.450411
Finished training it 60416/76743 of epoch 2, 137.11 ms/it, loss 0.455063
Finished training it 60416/76743 of epoch 2, 137.11 ms/it, loss 0.454926
rank 0 ranking from least wide range to the widest range [22  1  9  8 19 10 13 20 21 24 17 23  0 11 18 16 25  4  5  7 14  6 12  3
  2 15]
Finished training it 61440/76743 of epoch 2, 136.43 ms/it, loss 0.451777
Finished training it 61440/76743 of epoch 2, 136.52 ms/it, loss 0.452428
Finished training it 61440/76743 of epoch 2, 136.47 ms/it, loss 0.453114
Finished training it 61440/76743 of epoch 2, 136.46 ms/it, loss 0.450690
Testing at - 61440/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570230.0
get out
0 has test check 2570230.0 and sample count 3273728
 accuracy 78.511 %, best 78.511 %, roc auc score 0.7950, best 0.7950
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [22  1 24 19  5 13  9 18 25 23 17  8 20 21 16 11  0 10  4 14 12  7  6  3
  2 15]
Finished training it 62464/76743 of epoch 2, 136.60 ms/it, loss 0.452071
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570230.0
get out
1 has test check 2570230.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 136.61 ms/it, loss 0.454782
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570230.0
get out
3 has test check 2570230.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 136.65 ms/it, loss 0.452024
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570230.0
get out
2 has test check 2570230.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 136.75 ms/it, loss 0.453190
rank 0 ranking from least wide range to the widest range [ 1 24  9 22 21  4 18  8 25 13 23  5 10 19 20 17 11  0 16  6 14 12  3  7
  2 15]
Finished training it 63488/76743 of epoch 2, 136.94 ms/it, loss 0.451473
Finished training it 63488/76743 of epoch 2, 137.00 ms/it, loss 0.451993
Finished training it 63488/76743 of epoch 2, 136.96 ms/it, loss 0.452542
Finished training it 63488/76743 of epoch 2, 136.89 ms/it, loss 0.451873
rank 0 ranking from least wide range to the widest range [ 1 24 19 16 13  9 17 22 23 20  7 14 25 11 18 10  4 21  5  8  6  0 12  3
  2 15]
Finished training it 64512/76743 of epoch 2, 136.44 ms/it, loss 0.450764
Finished training it 64512/76743 of epoch 2, 136.40 ms/it, loss 0.452278
Finished training it 64512/76743 of epoch 2, 136.46 ms/it, loss 0.454401
Finished training it 64512/76743 of epoch 2, 136.46 ms/it, loss 0.450945
rank 0 ranking from least wide range to the widest range [ 1  9 22 19 24 23 25 20  5 10 13  8 17 18 11  4 14  0 21 16  6  3 12  7
 15  2]
Finished training it 65536/76743 of epoch 2, 137.10 ms/it, loss 0.452330
Finished training it 65536/76743 of epoch 2, 137.16 ms/it, loss 0.452045
Finished training it 65536/76743 of epoch 2, 137.21 ms/it, loss 0.449904
Finished training it 65536/76743 of epoch 2, 137.14 ms/it, loss 0.453306
rank 0 ranking from least wide range to the widest range [22  9 17 13  4  1 14 25 18 11 20  5 24 19 16  8 21 10 23  6 12  3  0  7
  2 15]
Finished training it 66560/76743 of epoch 2, 137.00 ms/it, loss 0.452766
Finished training it 66560/76743 of epoch 2, 136.97 ms/it, loss 0.451484
Finished training it 66560/76743 of epoch 2, 137.00 ms/it, loss 0.453804
Finished training it 66560/76743 of epoch 2, 137.05 ms/it, loss 0.452039
Finished training it 67584/76743 of epoch 2, 137.32 ms/it, loss 0.451787
Finished training it 67584/76743 of epoch 2, 137.31 ms/it, loss 0.453669
Finished training it 67584/76743 of epoch 2, 137.29 ms/it, loss 0.453648
rank 0 ranking from least wide range to the widest range [ 1 22  9 24 21  5 19 16  8 13 20 23  4 25 17 10 11 18 14  6  0  7  3 12
  2 15]
Finished training it 67584/76743 of epoch 2, 137.33 ms/it, loss 0.453025
rank 0 ranking from least wide range to the widest range [22  9 13 24  1 17 16  0 10 14 25 19 20 23 11  4 18  8  5 21  7  6  3 12
  2 15]
Finished training it 68608/76743 of epoch 2, 136.83 ms/it, loss 0.454783
Finished training it 68608/76743 of epoch 2, 136.80 ms/it, loss 0.454164
Finished training it 68608/76743 of epoch 2, 136.83 ms/it, loss 0.454563
Finished training it 68608/76743 of epoch 2, 136.81 ms/it, loss 0.451447
rank 0 ranking from least wide range to the widest range [22  9 16 13 24 19 20 10  5  0 17 23 11  1 25 21  4 18 14  6  7  8 12  3
  2 15]
Finished training it 69632/76743 of epoch 2, 136.69 ms/it, loss 0.454355
Finished training it 69632/76743 of epoch 2, 136.74 ms/it, loss 0.452498
Finished training it 69632/76743 of epoch 2, 136.67 ms/it, loss 0.453437
Finished training it 69632/76743 of epoch 2, 136.71 ms/it, loss 0.451778
rank 0 ranking from least wide range to the widest range [22 21 13  1  0 19 16 24  9 20 17 11 25 18 23  8 14  5 10  3  4  6 12  7
  2 15]
Finished training it 70656/76743 of epoch 2, 136.65 ms/it, loss 0.452613
Finished training it 70656/76743 of epoch 2, 136.76 ms/it, loss 0.453808
Finished training it 70656/76743 of epoch 2, 136.75 ms/it, loss 0.453220
Finished training it 70656/76743 of epoch 2, 136.70 ms/it, loss 0.451299
rank 0 ranking from least wide range to the widest range [22  1  9 13 24  0 20 17 25 23 11 10  5 16 19  8 21 14 18  4  6  3 12  7
 15  2]
Finished training it 71680/76743 of epoch 2, 137.13 ms/it, loss 0.453926
Finished training it 71680/76743 of epoch 2, 137.21 ms/it, loss 0.452614
Finished training it 71680/76743 of epoch 2, 137.24 ms/it, loss 0.453126
Finished training it 71680/76743 of epoch 2, 137.20 ms/it, loss 0.451554
Testing at - 71680/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570128.0
get out
0 has test check 2570128.0 and sample count 3273728
 accuracy 78.508 %, best 78.511 %, roc auc score 0.7947, best 0.7950
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1  9 24 21 22  4 16 17 23 13 20 19  5 18  8 25 11  7  0 10 14  6  3 12
  2 15]
Finished training it 72704/76743 of epoch 2, 136.76 ms/it, loss 0.452955
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570128.0
get out
1 has test check 2570128.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 136.81 ms/it, loss 0.455317
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570128.0
get out
2 has test check 2570128.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 136.83 ms/it, loss 0.452025
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570128.0
get out
3 has test check 2570128.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 136.84 ms/it, loss 0.450979
rank 0 ranking from least wide range to the widest range [ 1 22 24  9 19 13  8  4 21  0 17 16 20 25 11 10 23  5 14 18  6  3  7 12
 15  2]
Finished training it 73728/76743 of epoch 2, 137.41 ms/it, loss 0.453048
Finished training it 73728/76743 of epoch 2, 137.39 ms/it, loss 0.450305
Finished training it 73728/76743 of epoch 2, 137.45 ms/it, loss 0.451727
Finished training it 73728/76743 of epoch 2, 137.42 ms/it, loss 0.452784
rank 0 ranking from least wide range to the widest range [ 9  1 24 23  4 22 17 20 25 19 16 13 11  8 14 10 21  5  0  3  6 18  7 12
 15  2]
Finished training it 74752/76743 of epoch 2, 136.94 ms/it, loss 0.452097
Finished training it 74752/76743 of epoch 2, 137.07 ms/it, loss 0.453704
Finished training it 74752/76743 of epoch 2, 137.07 ms/it, loss 0.450508
Finished training it 74752/76743 of epoch 2, 137.03 ms/it, loss 0.452560
rank 0 ranking from least wide range to the widest range [ 1 22  9  4  8 24 13 19 16 20 17 23 21 25  0 11 18 10  5 14  3  7  6 12
  2 15]
Finished training it 75776/76743 of epoch 2, 137.01 ms/it, loss 0.451699
Finished training it 75776/76743 of epoch 2, 137.04 ms/it, loss 0.452334
Finished training it 75776/76743 of epoch 2, 137.08 ms/it, loss 0.451083
Finished training it 75776/76743 of epoch 2, 137.09 ms/it, loss 0.452306
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 137.69 ms/it, loss 0.451978
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 137.58 ms/it, loss 0.453030
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [24  9 22  1 13 17  8 16 23 20 14  5 25  0 21 11 10 19  4  7 18  6  3 12
 15  2]
Finished training it 1024/76743 of epoch 3, 137.60 ms/it, loss 0.451623
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 137.77 ms/it, loss 0.450717
rank 0 ranking from least wide range to the widest range [ 9  1 24 13  0 17 23 20 25 16 19 10 22 11 14 21  8  4  3  6 18  5  7 12
 15  2]
Finished training it 2048/76743 of epoch 3, 136.83 ms/it, loss 0.454510
Finished training it 2048/76743 of epoch 3, 136.88 ms/it, loss 0.454195
Finished training it 2048/76743 of epoch 3, 136.86 ms/it, loss 0.453674
Finished training it 2048/76743 of epoch 3, 136.86 ms/it, loss 0.456659
Finished training it 3072/76743 of epoch 3, 136.23 ms/it, loss 0.449571
rank 0 ranking from least wide range to the widest range [22 21 13 24  5  0  9  8  1 10 18 16 19 17 25 20 11 23  4  7  6 14  3 12
 15  2]
Finished training it 3072/76743 of epoch 3, 136.23 ms/it, loss 0.454085
Finished training it 3072/76743 of epoch 3, 136.21 ms/it, loss 0.452457
Finished training it 3072/76743 of epoch 3, 136.16 ms/it, loss 0.450352
Finished training it 4096/76743 of epoch 3, 137.30 ms/it, loss 0.449749
Finished training it 4096/76743 of epoch 3, 137.35 ms/it, loss 0.450179
Finished training it 4096/76743 of epoch 3, 137.31 ms/it, loss 0.451624
rank 0 ranking from least wide range to the widest range [ 9 22  1  0 24  8  5 13 17 19 21  4 20 25 10 11 23 14  7 16 18  6  3 12
 15  2]
Finished training it 4096/76743 of epoch 3, 137.28 ms/it, loss 0.453186
Finished training it 5120/76743 of epoch 3, 137.17 ms/it, loss 0.452319
rank 0 ranking from least wide range to the widest range [ 1 21  0  9 22 24 13 23 17 25 20 16  7 19 18 11 14 10  8  5  4  3  6 12
 15  2]
Finished training it 5120/76743 of epoch 3, 137.14 ms/it, loss 0.452174
Finished training it 5120/76743 of epoch 3, 137.09 ms/it, loss 0.451733
Finished training it 5120/76743 of epoch 3, 137.11 ms/it, loss 0.454028
rank 0 ranking from least wide range to the widest range [ 9 22 21  1 24  8 16 17  5 13 14  7 11 25 20 10 18  4 19 23  0 12  6  3
 15  2]
Finished training it 6144/76743 of epoch 3, 135.99 ms/it, loss 0.454281
Finished training it 6144/76743 of epoch 3, 136.06 ms/it, loss 0.452663
Finished training it 6144/76743 of epoch 3, 135.99 ms/it, loss 0.451923
Finished training it 6144/76743 of epoch 3, 136.10 ms/it, loss 0.451649
rank 0 ranking from least wide range to the widest range [ 1 22 24  9  5  8 17 21  0 20 13 10 19  7 23 25 11  4 14 18 16  6 12  3
 15  2]
Finished training it 7168/76743 of epoch 3, 136.17 ms/it, loss 0.453321
Finished training it 7168/76743 of epoch 3, 136.18 ms/it, loss 0.451241
Finished training it 7168/76743 of epoch 3, 136.14 ms/it, loss 0.450748
Finished training it 7168/76743 of epoch 3, 136.16 ms/it, loss 0.453242
rank 0 ranking from least wide range to the widest range [22 24  4 19 13  1 21  8  9 18 25 20 17  5 11 10 23 16  7 14 12  3  0  6
 15  2]
Finished training it 8192/76743 of epoch 3, 136.54 ms/it, loss 0.452058
Finished training it 8192/76743 of epoch 3, 136.52 ms/it, loss 0.452479
Finished training it 8192/76743 of epoch 3, 136.48 ms/it, loss 0.453096
Finished training it 8192/76743 of epoch 3, 136.54 ms/it, loss 0.453388
rank 0 ranking from least wide range to the widest range [ 9  8 22  1 13 16 19  4 20 17 24 10 18 25 21 11  7 23 14  0  5  6  3 12
 15  2]
Finished training it 9216/76743 of epoch 3, 136.67 ms/it, loss 0.453301
Finished training it 9216/76743 of epoch 3, 136.68 ms/it, loss 0.452548
Finished training it 9216/76743 of epoch 3, 136.69 ms/it, loss 0.452167
Finished training it 9216/76743 of epoch 3, 136.72 ms/it, loss 0.451538
rank 0 ranking from least wide range to the widest range [22 24  9  8 13 16  1 23 25 20 21 10 17  0 11 14 18  4  5 19  6  7  3 12
 15  2]
Finished training it 10240/76743 of epoch 3, 136.33 ms/it, loss 0.450454
Finished training it 10240/76743 of epoch 3, 136.41 ms/it, loss 0.451248
Finished training it 10240/76743 of epoch 3, 136.46 ms/it, loss 0.452303
Finished training it 10240/76743 of epoch 3, 136.35 ms/it, loss 0.450702
Testing at - 10240/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570619.0
get out
0 has test check 2570619.0 and sample count 3273728
 accuracy 78.523 %, best 78.523 %, roc auc score 0.7955, best 0.7955
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570619.0
get out
3 has test check 2570619.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 136.53 ms/it, loss 0.452932
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570619.0
get out
2 has test check 2570619.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 136.42 ms/it, loss 0.451576
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570619.0
get out
1 has test check 2570619.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 136.53 ms/it, loss 0.449345
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [24 22  1 21  5  9 13 17 23  0 20 18  7  8 10 25 16 11 19 14  4  3  6 12
 15  2]
Finished training it 11264/76743 of epoch 3, 136.53 ms/it, loss 0.450934
Finished training it 12288/76743 of epoch 3, 136.45 ms/it, loss 0.450705
Finished training it 12288/76743 of epoch 3, 136.45 ms/it, loss 0.450688
Finished training it 12288/76743 of epoch 3, 136.42 ms/it, loss 0.452230
rank 0 ranking from least wide range to the widest range [21 22 24  1 25 13  9 23 20 16  5  0 19  4 17 11  7 10  8 18 14  3 12  6
 15  2]
Finished training it 12288/76743 of epoch 3, 136.51 ms/it, loss 0.451543
rank 0 ranking from least wide range to the widest range [ 9 22  1 13 24  8 19 20 25 21 17 23 10 16 11  0  7 18 14  5  3  4  6 12
 15  2]
Finished training it 13312/76743 of epoch 3, 136.60 ms/it, loss 0.452593
Finished training it 13312/76743 of epoch 3, 136.62 ms/it, loss 0.452671
Finished training it 13312/76743 of epoch 3, 136.64 ms/it, loss 0.452020
Finished training it 13312/76743 of epoch 3, 136.53 ms/it, loss 0.452565
rank 0 ranking from least wide range to the widest range [ 1 22 24 19 21 13 17  5  8  9 25 20 16  4 14 23 10  0 11 18  7  6  3 12
 15  2]
Finished training it 14336/76743 of epoch 3, 137.45 ms/it, loss 0.452449
Finished training it 14336/76743 of epoch 3, 137.46 ms/it, loss 0.451189
Finished training it 14336/76743 of epoch 3, 137.44 ms/it, loss 0.453517
Finished training it 14336/76743 of epoch 3, 137.46 ms/it, loss 0.449468
rank 0 ranking from least wide range to the widest range [22 24 21 13  5  9 19  1 17  8 20 16  0 10 25 11 23 14  4  6 18  7  3 12
 15  2]
Finished training it 15360/76743 of epoch 3, 136.71 ms/it, loss 0.452068
Finished training it 15360/76743 of epoch 3, 136.75 ms/it, loss 0.449297
Finished training it 15360/76743 of epoch 3, 136.73 ms/it, loss 0.450816
Finished training it 15360/76743 of epoch 3, 136.75 ms/it, loss 0.455380
rank 0 ranking from least wide range to the widest range [24 22 21 20 13  1 11 23  5 16 18 25 17 19  9  8  4  7 10  0 14  3  6 12
  2 15]
Finished training it 16384/76743 of epoch 3, 136.42 ms/it, loss 0.452872
Finished training it 16384/76743 of epoch 3, 136.45 ms/it, loss 0.452685
Finished training it 16384/76743 of epoch 3, 136.42 ms/it, loss 0.452577
Finished training it 16384/76743 of epoch 3, 136.41 ms/it, loss 0.451422
Finished training it 17408/76743 of epoch 3, 136.97 ms/it, loss 0.452513
rank 0 ranking from least wide range to the widest range [ 1  9 22 13 19 24 21 16 17  5  8  0 20  4 23 25 18 14 10 11  7  6 12  3
 15  2]
Finished training it 17408/76743 of epoch 3, 136.99 ms/it, loss 0.449541
Finished training it 17408/76743 of epoch 3, 137.02 ms/it, loss 0.452358
Finished training it 17408/76743 of epoch 3, 137.07 ms/it, loss 0.452759
rank 0 ranking from least wide range to the widest range [24 22  1 19 25  5 13 21  9 20  8 16 17 23  4 11 10 18  0  7  3 14  6 12
  2 15]
Finished training it 18432/76743 of epoch 3, 136.12 ms/it, loss 0.448806
Finished training it 18432/76743 of epoch 3, 136.13 ms/it, loss 0.451897
Finished training it 18432/76743 of epoch 3, 136.15 ms/it, loss 0.450866
Finished training it 18432/76743 of epoch 3, 136.19 ms/it, loss 0.451157
Finished training it 19456/76743 of epoch 3, 137.33 ms/it, loss 0.452249
Finished training it 19456/76743 of epoch 3, 137.24 ms/it, loss 0.452702
Finished training it 19456/76743 of epoch 3, 137.24 ms/it, loss 0.451617
rank 0 ranking from least wide range to the widest range [ 1 22 24  9 20  5 13 21 23 10 17 25  8 11  4 16  7 19 14  0 18  6  3 12
  2 15]
Finished training it 19456/76743 of epoch 3, 137.23 ms/it, loss 0.452234
Finished training it 20480/76743 of epoch 3, 137.24 ms/it, loss 0.451070
rank 0 ranking from least wide range to the widest range [24  9 22  8  1  4 18 13  0 23 20 16 25 19 17  5 10 11 14  7 21  3 12  6
 15  2]
Finished training it 20480/76743 of epoch 3, 137.34 ms/it, loss 0.450435
Finished training it 20480/76743 of epoch 3, 137.21 ms/it, loss 0.450672
Finished training it 20480/76743 of epoch 3, 137.22 ms/it, loss 0.453536
Testing at - 20480/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2571229.0
get out
0 has test check 2571229.0 and sample count 3273728
 accuracy 78.541 %, best 78.541 %, roc auc score 0.7961, best 0.7961
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2571229.0
get out
2 has test check 2571229.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 135.89 ms/it, loss 0.448702
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2571229.0
get out
3 has test check 2571229.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 135.82 ms/it, loss 0.453273
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 1 22 24 13  9  8 19 20 17 23  0 25 16  4 14 10 11 18 21  7  5  6  3 12
  2 15]
Finished training it 21504/76743 of epoch 3, 135.82 ms/it, loss 0.451650
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2571229.0
get out
1 has test check 2571229.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 135.88 ms/it, loss 0.452994
Finished training it 22528/76743 of epoch 3, 136.10 ms/it, loss 0.451181
rank 0 ranking from least wide range to the widest range [ 1  9 22 13 24  8 21 20 19 16  5 17 25 10 23  7 11 18  0 14  4  6  3 12
 15  2]
Finished training it 22528/76743 of epoch 3, 136.11 ms/it, loss 0.449996
Finished training it 22528/76743 of epoch 3, 136.05 ms/it, loss 0.451939
Finished training it 22528/76743 of epoch 3, 136.03 ms/it, loss 0.452512
rank 0 ranking from least wide range to the widest range [ 1 24  9 19 22 13 17  8 20 25 23  5 10 21 18 14 16 11 12  4  7  0  3  6
  2 15]
Finished training it 23552/76743 of epoch 3, 137.50 ms/it, loss 0.453433
Finished training it 23552/76743 of epoch 3, 137.59 ms/it, loss 0.453491
Finished training it 23552/76743 of epoch 3, 137.54 ms/it, loss 0.451540
Finished training it 23552/76743 of epoch 3, 137.55 ms/it, loss 0.452011
rank 0 ranking from least wide range to the widest range [22  9 13 24  1 17 23 19  0 20  8  4 25 10 11 14  7 18 21  5 16 12  6  3
  2 15]
Finished training it 24576/76743 of epoch 3, 140.31 ms/it, loss 0.449739
Finished training it 24576/76743 of epoch 3, 140.17 ms/it, loss 0.451314
Finished training it 24576/76743 of epoch 3, 140.08 ms/it, loss 0.452495
Finished training it 24576/76743 of epoch 3, 140.18 ms/it, loss 0.452760
Finished training it 25600/76743 of epoch 3, 137.04 ms/it, loss 0.449073
rank 0 ranking from least wide range to the widest range [24  1 13  9 22 21 16  8 23  7 20 25 19 18 10  0 17  5 11  4  6 14 12  3
 15  2]
Finished training it 25600/76743 of epoch 3, 137.11 ms/it, loss 0.450624
Finished training it 25600/76743 of epoch 3, 137.05 ms/it, loss 0.452681
Finished training it 25600/76743 of epoch 3, 137.06 ms/it, loss 0.450750
rank 0 ranking from least wide range to the widest range [ 1  9 22 24 13 23 20  5 18 16  8 17  4 11 10 25 19  7 21  6 14 12  0  3
  2 15]
Finished training it 26624/76743 of epoch 3, 136.83 ms/it, loss 0.454543
Finished training it 26624/76743 of epoch 3, 136.85 ms/it, loss 0.451212
Finished training it 26624/76743 of epoch 3, 136.86 ms/it, loss 0.453585
Finished training it 26624/76743 of epoch 3, 136.86 ms/it, loss 0.450666
rank 0 ranking from least wide range to the widest range [24  9  1 21 23 22 20 10 19 17 13 25  8  5  4 11 14  0  6 12 18  3 16  7
  2 15]
Finished training it 27648/76743 of epoch 3, 136.44 ms/it, loss 0.449321
Finished training it 27648/76743 of epoch 3, 136.49 ms/it, loss 0.449597
Finished training it 27648/76743 of epoch 3, 136.53 ms/it, loss 0.451280
Finished training it 27648/76743 of epoch 3, 136.53 ms/it, loss 0.451141
rank 0 ranking from least wide range to the widest range [24  9 22  1 13  0 20 23 25  8 10 17 19 11 18 16  5  4  3 14 21  6  7 12
  2 15]
Finished training it 28672/76743 of epoch 3, 136.70 ms/it, loss 0.451267
Finished training it 28672/76743 of epoch 3, 136.84 ms/it, loss 0.452271
Finished training it 28672/76743 of epoch 3, 136.78 ms/it, loss 0.449453
Finished training it 28672/76743 of epoch 3, 136.76 ms/it, loss 0.450918
rank 0 ranking from least wide range to the widest range [24 13  9 22  1 19 23 20 25 16 17  8  0  4 11 10  5 21 14  7 18  3  6 12
  2 15]
Finished training it 29696/76743 of epoch 3, 140.58 ms/it, loss 0.450654
Finished training it 29696/76743 of epoch 3, 140.67 ms/it, loss 0.449069
Finished training it 29696/76743 of epoch 3, 140.73 ms/it, loss 0.453200
Finished training it 29696/76743 of epoch 3, 140.72 ms/it, loss 0.450774
rank 0 ranking from least wide range to the widest range [24  1  9 22 13 19  0  4 25 20 23  5 17 21 10 16 18  8 11 14 12  6  7  3
  2 15]
Finished training it 30720/76743 of epoch 3, 136.29 ms/it, loss 0.453043
Finished training it 30720/76743 of epoch 3, 136.29 ms/it, loss 0.447149
Finished training it 30720/76743 of epoch 3, 136.27 ms/it, loss 0.451469
Finished training it 30720/76743 of epoch 3, 136.26 ms/it, loss 0.452193
Testing at - 30720/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2571612.0
get out
0 has test check 2571612.0 and sample count 3273728
 accuracy 78.553 %, best 78.553 %, roc auc score 0.7961, best 0.7961
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 22 19 24  0 17 10 23 25  9 20  5 13 21  8  4 14 11 18  6 16  7 12  3
  2 15]
Finished training it 31744/76743 of epoch 3, 136.90 ms/it, loss 0.448978
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2571612.0
get out
2 has test check 2571612.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 136.83 ms/it, loss 0.450362
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2571612.0
get out
1 has test check 2571612.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 136.81 ms/it, loss 0.449862
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2571612.0
get out
3 has test check 2571612.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 136.85 ms/it, loss 0.450939
Finished training it 32768/76743 of epoch 3, 136.60 ms/it, loss 0.451028
rank 0 ranking from least wide range to the widest range [22 24  1  9 21 13  5 18 20 19  4 23 17 10  0  8 25 16 11 14 12  7  3  6
  2 15]
Finished training it 32768/76743 of epoch 3, 136.56 ms/it, loss 0.450570
Finished training it 32768/76743 of epoch 3, 136.54 ms/it, loss 0.450742
Finished training it 32768/76743 of epoch 3, 136.55 ms/it, loss 0.451831
rank 0 ranking from least wide range to the widest range [24 13  9 21  8  1 16 22 19 17 23 20 10  5  0 18  4 25 11 14  7 12  6  3
  2 15]
Finished training it 33792/76743 of epoch 3, 137.50 ms/it, loss 0.452135
Finished training it 33792/76743 of epoch 3, 137.55 ms/it, loss 0.450402
Finished training it 33792/76743 of epoch 3, 137.57 ms/it, loss 0.451466
Finished training it 33792/76743 of epoch 3, 137.55 ms/it, loss 0.453776
Finished training it 34816/76743 of epoch 3, 136.67 ms/it, loss 0.451405
Finished training it 34816/76743 of epoch 3, 136.66 ms/it, loss 0.449444
rank 0 ranking from least wide range to the widest range [24 13  9  1  0  8  5 19 22 17 20 21 10 25 23 16 14  4 18  7 11 12  6  3
  2 15]
Finished training it 34816/76743 of epoch 3, 136.62 ms/it, loss 0.448409
Finished training it 34816/76743 of epoch 3, 136.65 ms/it, loss 0.452439
rank 0 ranking from least wide range to the widest range [22  1  9 21 19 24 13 20  8 16 17  5 23 18  7 25 14  0 10  4 11  6  3 12
  2 15]
Finished training it 35840/76743 of epoch 3, 136.78 ms/it, loss 0.450022
Finished training it 35840/76743 of epoch 3, 136.77 ms/it, loss 0.448654
Finished training it 35840/76743 of epoch 3, 136.74 ms/it, loss 0.450316
Finished training it 35840/76743 of epoch 3, 136.77 ms/it, loss 0.452230
rank 0 ranking from least wide range to the widest range [22 16 24  9  1 13 20  0  8 23 17 19 10 21 25 18  4 11  5 14  7  6  3 12
  2 15]
Finished training it 36864/76743 of epoch 3, 136.20 ms/it, loss 0.451716
Finished training it 36864/76743 of epoch 3, 136.28 ms/it, loss 0.454048
Finished training it 36864/76743 of epoch 3, 136.21 ms/it, loss 0.449896
Finished training it 36864/76743 of epoch 3, 136.18 ms/it, loss 0.447569
rank 0 ranking from least wide range to the widest range [22 24  1 13  9  0  8 21 19  5 20 18 17 23 25 10 16  4 14 11  7  6  3 12
  2 15]
Finished training it 37888/76743 of epoch 3, 136.36 ms/it, loss 0.449399
Finished training it 37888/76743 of epoch 3, 136.29 ms/it, loss 0.450680
Finished training it 37888/76743 of epoch 3, 136.31 ms/it, loss 0.447990
Finished training it 37888/76743 of epoch 3, 136.31 ms/it, loss 0.446692
rank 0 ranking from least wide range to the widest range [22 24 13  1 17  9 16  0 19  5  8 23 20 18  4 10 14 21 25  7 11  6 12  3
  2 15]
Finished training it 38912/76743 of epoch 3, 136.07 ms/it, loss 0.449283
Finished training it 38912/76743 of epoch 3, 136.05 ms/it, loss 0.450722
Finished training it 38912/76743 of epoch 3, 136.12 ms/it, loss 0.449501
Finished training it 38912/76743 of epoch 3, 136.10 ms/it, loss 0.452106
rank 0 ranking from least wide range to the widest range [ 1  9 24 22 13  8 10  5 17 20 16  7 19 21  4 23 25 11 14 18  0  6  3 12
  2 15]
Finished training it 39936/76743 of epoch 3, 136.63 ms/it, loss 0.451820
Finished training it 39936/76743 of epoch 3, 136.67 ms/it, loss 0.452963
Finished training it 39936/76743 of epoch 3, 136.66 ms/it, loss 0.450715
Finished training it 39936/76743 of epoch 3, 136.59 ms/it, loss 0.451806
rank 0 ranking from least wide range to the widest range [24  1 22 19  5 20 25 21  9 10 23 17  4  8  7  0 14 18 11 13 16  6  3 12
  2 15]
Finished training it 40960/76743 of epoch 3, 137.05 ms/it, loss 0.451948
Finished training it 40960/76743 of epoch 3, 137.06 ms/it, loss 0.450788
Finished training it 40960/76743 of epoch 3, 137.00 ms/it, loss 0.451261
Finished training it 40960/76743 of epoch 3, 137.05 ms/it, loss 0.450635
Testing at - 40960/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572509.0
get out
0 has test check 2572509.0 and sample count 3273728
 accuracy 78.580 %, best 78.580 %, roc auc score 0.7963, best 0.7963
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13  8 19  9 24  1 22 18  7  4 20 17 16 10  0 11  5 23 25 14 21  6 12  3
  2 15]
Finished training it 41984/76743 of epoch 3, 135.63 ms/it, loss 0.451590
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2572509.0
get out
1 has test check 2572509.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 135.66 ms/it, loss 0.450552
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2572509.0
get out
2 has test check 2572509.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 135.74 ms/it, loss 0.453804
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2572509.0
get out
3 has test check 2572509.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 135.69 ms/it, loss 0.451840
rank 0 ranking from least wide range to the widest range [ 1 21 24 17  5 13  8 22 19  9 20 23 10  4 14 16 18 11  0 25 12  7  6  3
  2 15]
Finished training it 43008/76743 of epoch 3, 137.16 ms/it, loss 0.450967
Finished training it 43008/76743 of epoch 3, 137.21 ms/it, loss 0.448358
Finished training it 43008/76743 of epoch 3, 137.04 ms/it, loss 0.448625
Finished training it 43008/76743 of epoch 3, 137.18 ms/it, loss 0.449470
rank 0 ranking from least wide range to the widest range [24  9 21 22  1 20 13  8 17 16  5 10 18  4 25 19 23  0 11 14  6 12  7  3
  2 15]
Finished training it 44032/76743 of epoch 3, 136.33 ms/it, loss 0.452433
Finished training it 44032/76743 of epoch 3, 136.33 ms/it, loss 0.450728
Finished training it 44032/76743 of epoch 3, 136.32 ms/it, loss 0.451458
Finished training it 44032/76743 of epoch 3, 136.34 ms/it, loss 0.449766
Finished training it 45056/76743 of epoch 3, 136.51 ms/it, loss 0.451350
rank 0 ranking from least wide range to the widest range [21  1 24 22  9  0  5 13 19 20 23 10 17 18  8  7 16 11  4 25 12 14  3  6
  2 15]
Finished training it 45056/76743 of epoch 3, 136.54 ms/it, loss 0.451768
Finished training it 45056/76743 of epoch 3, 136.55 ms/it, loss 0.451038
Finished training it 45056/76743 of epoch 3, 136.52 ms/it, loss 0.450963
rank 0 ranking from least wide range to the widest range [24 22 23 18  9  8  1 20 10 25  5 13  4 17 19 16  7 11  0 21  3  6 14 12
  2 15]
Finished training it 46080/76743 of epoch 3, 136.68 ms/it, loss 0.448276
Finished training it 46080/76743 of epoch 3, 136.67 ms/it, loss 0.450001
Finished training it 46080/76743 of epoch 3, 136.71 ms/it, loss 0.451585
Finished training it 46080/76743 of epoch 3, 136.70 ms/it, loss 0.448802
Finished training it 47104/76743 of epoch 3, 135.73 ms/it, loss 0.451678
rank 0 ranking from least wide range to the widest range [24  1 21  5 13 17 22  9 20 16  4 23 10 14 19  0 25  8 11  7 18 12  6  3
  2 15]
Finished training it 47104/76743 of epoch 3, 135.69 ms/it, loss 0.450723
Finished training it 47104/76743 of epoch 3, 135.70 ms/it, loss 0.448137
Finished training it 47104/76743 of epoch 3, 135.76 ms/it, loss 0.452382
rank 0 ranking from least wide range to the widest range [24  9 13 22  1 19 17 10 23  5 20  8  0 21 18 25 14  4 12 16 11  7  6  3
  2 15]
Finished training it 48128/76743 of epoch 3, 136.39 ms/it, loss 0.450851
Finished training it 48128/76743 of epoch 3, 136.38 ms/it, loss 0.450472
Finished training it 48128/76743 of epoch 3, 136.44 ms/it, loss 0.450035
Finished training it 48128/76743 of epoch 3, 136.42 ms/it, loss 0.452010
rank 0 ranking from least wide range to the widest range [22 24  1  9  5  0 20 18 10 21 23 25  8 11 19 16 14 17 13  6 12  3  4  7
  2 15]
Finished training it 49152/76743 of epoch 3, 136.28 ms/it, loss 0.450393
Finished training it 49152/76743 of epoch 3, 136.27 ms/it, loss 0.450544
Finished training it 49152/76743 of epoch 3, 136.34 ms/it, loss 0.451242
Finished training it 49152/76743 of epoch 3, 136.37 ms/it, loss 0.449683
rank 0 ranking from least wide range to the widest range [24 22 13  9  1 20 23 17 19 16 25 18  7 10  4  0  5  8 11 21 14 12  6  3
  2 15]
Finished training it 50176/76743 of epoch 3, 136.71 ms/it, loss 0.450644
Finished training it 50176/76743 of epoch 3, 136.71 ms/it, loss 0.450442
Finished training it 50176/76743 of epoch 3, 136.69 ms/it, loss 0.449327
Finished training it 50176/76743 of epoch 3, 136.73 ms/it, loss 0.449476
rank 0 ranking from least wide range to the widest range [ 1  9  5 24 17 20 10 16  4 23 22 14 13  0 25 21 19  8 18 11  7  6  3 12
  2 15]
Finished training it 51200/76743 of epoch 3, 136.33 ms/it, loss 0.447844
Finished training it 51200/76743 of epoch 3, 136.39 ms/it, loss 0.448706
Finished training it 51200/76743 of epoch 3, 136.37 ms/it, loss 0.453812
Finished training it 51200/76743 of epoch 3, 136.38 ms/it, loss 0.451223
Testing at - 51200/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2571157.0
get out
0 has test check 2571157.0 and sample count 3273728
 accuracy 78.539 %, best 78.580 %, roc auc score 0.7965, best 0.7965
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 24 22  5 19  9 13  7 10 20 23 18 17  8 21 11 16 14  0  4 25  3 12  6
  2 15]
Finished training it 52224/76743 of epoch 3, 136.17 ms/it, loss 0.449315
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2571157.0
get out
3 has test check 2571157.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 136.12 ms/it, loss 0.451659
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2571157.0
get out
2 has test check 2571157.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 136.09 ms/it, loss 0.450776
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2571157.0
get out
1 has test check 2571157.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 136.08 ms/it, loss 0.451525
Finished training it 53248/76743 of epoch 3, 136.37 ms/it, loss 0.451687
Finished training it 53248/76743 of epoch 3, 136.35 ms/it, loss 0.451103
rank 0 ranking from least wide range to the widest range [ 1 24 22  4  8  9 13 20 17 21 23  7 18 10 25 16 14 19  5 11  0  6 12  3
  2 15]
Finished training it 53248/76743 of epoch 3, 136.31 ms/it, loss 0.451191
Finished training it 53248/76743 of epoch 3, 136.41 ms/it, loss 0.450756
rank 0 ranking from least wide range to the widest range [22 24  1  9 23  8 20 17 16 13  4  0 25  5 10 19 18 11 21 12  7 14  3  6
  2 15]
Finished training it 54272/76743 of epoch 3, 136.64 ms/it, loss 0.448740
Finished training it 54272/76743 of epoch 3, 136.64 ms/it, loss 0.451547
Finished training it 54272/76743 of epoch 3, 136.64 ms/it, loss 0.449139
Finished training it 54272/76743 of epoch 3, 136.66 ms/it, loss 0.451565
rank 0 ranking from least wide range to the widest range [ 1 19  9 24  8  0 22 13  4 18  5 20 17 16 21 10 23  7 25 11 14  6  3 12
  2 15]
Finished training it 55296/76743 of epoch 3, 136.45 ms/it, loss 0.448943
Finished training it 55296/76743 of epoch 3, 136.44 ms/it, loss 0.450744
Finished training it 55296/76743 of epoch 3, 136.53 ms/it, loss 0.449594
Finished training it 55296/76743 of epoch 3, 136.45 ms/it, loss 0.451677
rank 0 ranking from least wide range to the widest range [24 13 21  1 22 17  9  8  5 20 23 18  4 19 10 16  0 25 14 11 12  3  7  6
  2 15]
Finished training it 56320/76743 of epoch 3, 136.30 ms/it, loss 0.450102
Finished training it 56320/76743 of epoch 3, 136.38 ms/it, loss 0.451941
Finished training it 56320/76743 of epoch 3, 136.25 ms/it, loss 0.451289
Finished training it 56320/76743 of epoch 3, 136.32 ms/it, loss 0.450262
rank 0 ranking from least wide range to the widest range [ 0  9 23  1 22 24 20 10  8 17 25 16 13  7  5 21 19  4 11 14  6 18  3 12
  2 15]
Finished training it 57344/76743 of epoch 3, 136.79 ms/it, loss 0.448858
Finished training it 57344/76743 of epoch 3, 136.79 ms/it, loss 0.451931
Finished training it 57344/76743 of epoch 3, 136.78 ms/it, loss 0.448854
Finished training it 57344/76743 of epoch 3, 136.80 ms/it, loss 0.452351
rank 0 ranking from least wide range to the widest range [24 22  1 21  5  4  0 17  9 20 23 19 13 10 18 14  8 16 11  7 25 12  6  3
  2 15]
Finished training it 58368/76743 of epoch 3, 137.01 ms/it, loss 0.449888
Finished training it 58368/76743 of epoch 3, 137.06 ms/it, loss 0.450006
Finished training it 58368/76743 of epoch 3, 137.03 ms/it, loss 0.453516
Finished training it 58368/76743 of epoch 3, 137.03 ms/it, loss 0.450194
Finished training it 59392/76743 of epoch 3, 136.14 ms/it, loss 0.447385
rank 0 ranking from least wide range to the widest range [ 1  4 24 22  9 19 13  8 20  0 17 18 23  5 16 25 10 21  7 11 12 14  6  3
  2 15]
Finished training it 59392/76743 of epoch 3, 136.07 ms/it, loss 0.450596
Finished training it 59392/76743 of epoch 3, 136.17 ms/it, loss 0.449965
Finished training it 59392/76743 of epoch 3, 136.19 ms/it, loss 0.450427
rank 0 ranking from least wide range to the widest range [21 24  9 22 17 13  1  8  5 10 20  4 18  0 14 23 19 11 16 12  6 25  3  7
  2 15]
Finished training it 60416/76743 of epoch 3, 137.04 ms/it, loss 0.448796
Finished training it 60416/76743 of epoch 3, 137.08 ms/it, loss 0.448224
Finished training it 60416/76743 of epoch 3, 137.02 ms/it, loss 0.453076
Finished training it 60416/76743 of epoch 3, 137.05 ms/it, loss 0.452651
rank 0 ranking from least wide range to the widest range [22  1 21 13  9  8 20 10  7 17 24 19 18 23  4  0  5 16 11 14 25 12  6  3
  2 15]
Finished training it 61440/76743 of epoch 3, 136.01 ms/it, loss 0.449565
Finished training it 61440/76743 of epoch 3, 136.06 ms/it, loss 0.450611
Finished training it 61440/76743 of epoch 3, 135.98 ms/it, loss 0.449901
Finished training it 61440/76743 of epoch 3, 136.08 ms/it, loss 0.447909
Testing at - 61440/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573966.0
get out
0 has test check 2573966.0 and sample count 3273728
 accuracy 78.625 %, best 78.625 %, roc auc score 0.7975, best 0.7975
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [22 24  1 13  5 23 17  4 21  8 20 19 25  9  7 18 14 10 16  0 12 11  3  6
  2 15]
Finished training it 62464/76743 of epoch 3, 137.46 ms/it, loss 0.449656
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573966.0
get out
3 has test check 2573966.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 137.43 ms/it, loss 0.449813
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573966.0
get out
2 has test check 2573966.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 137.47 ms/it, loss 0.450553
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573966.0
get out
1 has test check 2573966.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 137.43 ms/it, loss 0.452560
rank 0 ranking from least wide range to the widest range [ 1 22 21 24  9  0  4 13 18  7 23 17 20 10  8 14 19 25 16  5 11 12  6  3
  2 15]
Finished training it 63488/76743 of epoch 3, 139.58 ms/it, loss 0.449289
Finished training it 63488/76743 of epoch 3, 139.63 ms/it, loss 0.449407
Finished training it 63488/76743 of epoch 3, 139.52 ms/it, loss 0.449309
Finished training it 63488/76743 of epoch 3, 139.52 ms/it, loss 0.450189
rank 0 ranking from least wide range to the widest range [ 1 13 24  7 16  4 17 19  9  5 22 21 23 20 18  0  8 14 10 25 11 12  6  3
  2 15]
Finished training it 64512/76743 of epoch 3, 134.97 ms/it, loss 0.448404
Finished training it 64512/76743 of epoch 3, 135.00 ms/it, loss 0.448365
Finished training it 64512/76743 of epoch 3, 134.98 ms/it, loss 0.452283
Finished training it 64512/76743 of epoch 3, 134.98 ms/it, loss 0.449601
Finished training it 65536/76743 of epoch 3, 136.75 ms/it, loss 0.447524
Finished training it 65536/76743 of epoch 3, 136.72 ms/it, loss 0.449637
rank 0 ranking from least wide range to the widest range [ 1  9  0 13 24 22 19 20 17 23 18 21 10 14 25  5  8  7 11  4 16 12  3  6
  2 15]
Finished training it 65536/76743 of epoch 3, 136.73 ms/it, loss 0.449866
Finished training it 65536/76743 of epoch 3, 136.76 ms/it, loss 0.451188
rank 0 ranking from least wide range to the widest range [22  9 21 24 17 13  4  1 18  8 14 20  5 19 10 23 12 16 11  7 25  0  3  6
  2 15]
Finished training it 66560/76743 of epoch 3, 140.42 ms/it, loss 0.450238
Finished training it 66560/76743 of epoch 3, 140.56 ms/it, loss 0.451048
Finished training it 66560/76743 of epoch 3, 140.57 ms/it, loss 0.449551
Finished training it 66560/76743 of epoch 3, 140.51 ms/it, loss 0.448771
rank 0 ranking from least wide range to the widest range [22  1 24  9  5 23 21 20  8 17  0 10  4 13 16 18 19  7 25 14 11  6 12  3
  2 15]
Finished training it 67584/76743 of epoch 3, 137.13 ms/it, loss 0.450955
Finished training it 67584/76743 of epoch 3, 137.20 ms/it, loss 0.451273
Finished training it 67584/76743 of epoch 3, 137.19 ms/it, loss 0.451722
Finished training it 67584/76743 of epoch 3, 137.14 ms/it, loss 0.449446
rank 0 ranking from least wide range to the widest range [22 13 24  1  9 17 21  7  0  5  8 20 10 23 14 19 16 18  4 11 25 12  6  3
  2 15]
Finished training it 68608/76743 of epoch 3, 136.40 ms/it, loss 0.452802
Finished training it 68608/76743 of epoch 3, 136.43 ms/it, loss 0.452018
Finished training it 68608/76743 of epoch 3, 136.44 ms/it, loss 0.452174
Finished training it 68608/76743 of epoch 3, 136.52 ms/it, loss 0.449196
rank 0 ranking from least wide range to the widest range [22 24  9 16 13 19 17 20  5  0 10 21 23  1 18  4 25 14  8 11 12  6  7  3
  2 15]
Finished training it 69632/76743 of epoch 3, 136.56 ms/it, loss 0.452040
Finished training it 69632/76743 of epoch 3, 136.46 ms/it, loss 0.450998
Finished training it 69632/76743 of epoch 3, 136.61 ms/it, loss 0.450272
Finished training it 69632/76743 of epoch 3, 136.61 ms/it, loss 0.449147
rank 0 ranking from least wide range to the widest range [22 21 13 24  1 17 20  9 16 23 18  4  8 19 14  5 10  7  0 25 11 12  6  3
  2 15]
Finished training it 70656/76743 of epoch 3, 136.80 ms/it, loss 0.450970
Finished training it 70656/76743 of epoch 3, 136.77 ms/it, loss 0.451682
Finished training it 70656/76743 of epoch 3, 136.77 ms/it, loss 0.451025
Finished training it 70656/76743 of epoch 3, 136.77 ms/it, loss 0.449133
rank 0 ranking from least wide range to the widest range [ 1 22  9 13 24  0 18 23 10 17 20 16 19 14 21  7  5  8 25 11  4  6 12  3
  2 15]
Finished training it 71680/76743 of epoch 3, 136.62 ms/it, loss 0.451548
Finished training it 71680/76743 of epoch 3, 136.59 ms/it, loss 0.449984
Finished training it 71680/76743 of epoch 3, 136.66 ms/it, loss 0.450974
Finished training it 71680/76743 of epoch 3, 136.65 ms/it, loss 0.449393
Testing at - 71680/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573417.0
get out
0 has test check 2573417.0 and sample count 3273728
 accuracy 78.608 %, best 78.625 %, roc auc score 0.7971, best 0.7975
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [22  1 24  9  0 21  4 17 16  8 18 20 23 13 19 10  5 14  7 11 25  6 12  3
  2 15]
Finished training it 72704/76743 of epoch 3, 135.45 ms/it, loss 0.450653
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573417.0
get out
1 has test check 2573417.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 135.54 ms/it, loss 0.453160
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573417.0
get out
3 has test check 2573417.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 135.46 ms/it, loss 0.448832
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573417.0
get out
2 has test check 2573417.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 135.55 ms/it, loss 0.449568
rank 0 ranking from least wide range to the widest range [ 1 24 13  8  4 22  9 19 20 17 16  0  7 23 10 21 18  5 11 14 25  6  3 12
  2 15]
Finished training it 73728/76743 of epoch 3, 136.76 ms/it, loss 0.450955
Finished training it 73728/76743 of epoch 3, 136.74 ms/it, loss 0.449950
Finished training it 73728/76743 of epoch 3, 136.78 ms/it, loss 0.450635
Finished training it 73728/76743 of epoch 3, 136.79 ms/it, loss 0.448212
rank 0 ranking from least wide range to the widest range [ 9  1 17 20 24 23  8  4 13 22 16 19 10  0 14 21 25 11  7 18  5  6 12  3
  2 15]
Finished training it 74752/76743 of epoch 3, 136.07 ms/it, loss 0.449917
Finished training it 74752/76743 of epoch 3, 136.11 ms/it, loss 0.451485
Finished training it 74752/76743 of epoch 3, 136.09 ms/it, loss 0.450342
Finished training it 74752/76743 of epoch 3, 136.10 ms/it, loss 0.448055
rank 0 ranking from least wide range to the widest range [ 1 22 24 19  9  0 16 17 20 13 23  4 18  8  5  7 21 25 14 10 11  3 12  6
  2 15]
Finished training it 75776/76743 of epoch 3, 136.36 ms/it, loss 0.449774
Finished training it 75776/76743 of epoch 3, 136.35 ms/it, loss 0.450545
Finished training it 75776/76743 of epoch 3, 136.38 ms/it, loss 0.450799
Finished training it 75776/76743 of epoch 3, 136.38 ms/it, loss 0.449068
Warning: Skipping the batch 76742 with size 14
rank 0 ranking from least wide range to the widest range [24  1  9 13 22 17 23 20 19  7  8  0  5 14 16 21  4 10 18 25 11 12  6  3
  2 15]
Finished training it 1024/76743 of epoch 4, 137.38 ms/it, loss 0.449337
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 137.15 ms/it, loss 0.451122
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 137.35 ms/it, loss 0.448940
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 137.29 ms/it, loss 0.450095
rank 0 ranking from least wide range to the widest range [ 1 13 24 17  9 22 23 20 19 16  4  0 10 14  7  8 21 25 18 11  5  6  3 12
  2 15]
Finished training it 2048/76743 of epoch 4, 137.10 ms/it, loss 0.452274
Finished training it 2048/76743 of epoch 4, 137.10 ms/it, loss 0.451756
Finished training it 2048/76743 of epoch 4, 137.12 ms/it, loss 0.451519
Finished training it 2048/76743 of epoch 4, 137.17 ms/it, loss 0.454588
rank 0 ranking from least wide range to the widest range [22 21 24 13  0  5  1  9 17 10  8 20 18  7 16 19  4 23 14  6 11 25 12  3
  2 15]
Finished training it 3072/76743 of epoch 4, 136.69 ms/it, loss 0.452083
Finished training it 3072/76743 of epoch 4, 136.76 ms/it, loss 0.450050
Finished training it 3072/76743 of epoch 4, 136.72 ms/it, loss 0.447591
Finished training it 3072/76743 of epoch 4, 136.70 ms/it, loss 0.448400
rank 0 ranking from least wide range to the widest range [ 9  1 22 13  8 24 19 17 20 21  5  4  0 10  7 23 14 18 16 25 11  6 12  3
  2 15]
Finished training it 4096/76743 of epoch 4, 136.40 ms/it, loss 0.450982
Finished training it 4096/76743 of epoch 4, 136.45 ms/it, loss 0.448384
Finished training it 4096/76743 of epoch 4, 136.36 ms/it, loss 0.449386
Finished training it 4096/76743 of epoch 4, 136.42 ms/it, loss 0.447558
Finished training it 5120/76743 of epoch 4, 136.66 ms/it, loss 0.450326
Finished training it 5120/76743 of epoch 4, 136.67 ms/it, loss 0.451626
rank 0 ranking from least wide range to the widest range [ 1 22 24 17  9 13 21 20  0 16 23 18  8  4 25  7 14 10 19  5 11 12  6  3
  2 15]
Finished training it 5120/76743 of epoch 4, 136.61 ms/it, loss 0.449919
Finished training it 5120/76743 of epoch 4, 136.66 ms/it, loss 0.449625
rank 0 ranking from least wide range to the widest range [21 22  1 24  9 16  8 17  5 13 14 20 10 18  0  7 23 19 11  4 25 12  6  3
  2 15]
Finished training it 6144/76743 of epoch 4, 136.47 ms/it, loss 0.452194
Finished training it 6144/76743 of epoch 4, 136.51 ms/it, loss 0.449511
Finished training it 6144/76743 of epoch 4, 136.39 ms/it, loss 0.450276
Finished training it 6144/76743 of epoch 4, 136.53 ms/it, loss 0.449618
rank 0 ranking from least wide range to the widest range [ 1 24 22 17  9 13 21  5  8 20  7 19 23  4 10  0 14 18 16 25 11  6 12  3
  2 15]
Finished training it 7168/76743 of epoch 4, 137.00 ms/it, loss 0.450834
Finished training it 7168/76743 of epoch 4, 137.03 ms/it, loss 0.448807
Finished training it 7168/76743 of epoch 4, 137.08 ms/it, loss 0.448162
Finished training it 7168/76743 of epoch 4, 137.04 ms/it, loss 0.451040
rank 0 ranking from least wide range to the widest range [24 22 13 19  4  1 21  9  8 18 17 20  5 23  7  0 10 16 25 11 14 12  3  6
  2 15]
Finished training it 8192/76743 of epoch 4, 135.41 ms/it, loss 0.449863
Finished training it 8192/76743 of epoch 4, 135.57 ms/it, loss 0.450874
Finished training it 8192/76743 of epoch 4, 135.48 ms/it, loss 0.450465
Finished training it 8192/76743 of epoch 4, 135.53 ms/it, loss 0.450366
Finished training it 9216/76743 of epoch 4, 136.34 ms/it, loss 0.449631
Finished training it 9216/76743 of epoch 4, 136.38 ms/it, loss 0.449894
rank 0 ranking from least wide range to the widest range [22  8  9 13  1 17 18 24 20 16 10  7 19 21 14 23 25  4  0 11  5  6 12  3
  2 15]
Finished training it 9216/76743 of epoch 4, 136.35 ms/it, loss 0.451121
Finished training it 9216/76743 of epoch 4, 136.40 ms/it, loss 0.450403
rank 0 ranking from least wide range to the widest range [22 24 13  9  1  8  0 16  4  5 23 20 17  7 18 10 21 25 14 19 11  6  3 12
  2 15]
Finished training it 10240/76743 of epoch 4, 135.98 ms/it, loss 0.448031
Finished training it 10240/76743 of epoch 4, 136.02 ms/it, loss 0.448957
Finished training it 10240/76743 of epoch 4, 136.03 ms/it, loss 0.448814
Finished training it 10240/76743 of epoch 4, 135.96 ms/it, loss 0.450067
Testing at - 10240/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573908.0
get out
0 has test check 2573908.0 and sample count 3273728
 accuracy 78.623 %, best 78.625 %, roc auc score 0.7972, best 0.7975
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 24  5 22 21  9 17 18 13 23 20 16  8 10  0 14 19  7 25 11  4  3  6 12
  2 15]
Finished training it 11264/76743 of epoch 4, 136.79 ms/it, loss 0.448885
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573908.0
get out
3 has test check 2573908.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 136.95 ms/it, loss 0.450626
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573908.0
get out
1 has test check 2573908.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 136.92 ms/it, loss 0.447312
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573908.0
get out
2 has test check 2573908.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 136.84 ms/it, loss 0.449470
rank 0 ranking from least wide range to the widest range [24 22 21  5  1 13 16  9 23 20 19  8  4  7 17 25 18  0 10 11 14 12  3  6
  2 15]
Finished training it 12288/76743 of epoch 4, 136.27 ms/it, loss 0.449358
Finished training it 12288/76743 of epoch 4, 136.30 ms/it, loss 0.450116
Finished training it 12288/76743 of epoch 4, 136.33 ms/it, loss 0.448384
Finished training it 12288/76743 of epoch 4, 136.24 ms/it, loss 0.448321
rank 0 ranking from least wide range to the widest range [ 9 22 24  1 20 19 21 23 13  4  8 17 10 16 18 25  0  5  7 14 11  3  6 12
  2 15]
Finished training it 13312/76743 of epoch 4, 136.58 ms/it, loss 0.450925
Finished training it 13312/76743 of epoch 4, 136.59 ms/it, loss 0.450713
Finished training it 13312/76743 of epoch 4, 136.62 ms/it, loss 0.450330
Finished training it 13312/76743 of epoch 4, 136.59 ms/it, loss 0.450437
Finished training it 14336/76743 of epoch 4, 136.18 ms/it, loss 0.451578
Finished training it 14336/76743 of epoch 4, 136.00 ms/it, loss 0.447527
rank 0 ranking from least wide range to the widest range [22  1 24 13 19  5 21  9 20 17  8 18 14 10 16 23  0  7  4 25 11  6  3 12
  2 15]
Finished training it 14336/76743 of epoch 4, 136.00 ms/it, loss 0.450825
Finished training it 14336/76743 of epoch 4, 136.10 ms/it, loss 0.449584
rank 0 ranking from least wide range to the widest range [24 22 21  5 17 13 19  1 20  8  9 10  0 14 16 23  7 18  4 11  6 25 12  3
  2 15]
Finished training it 15360/76743 of epoch 4, 135.89 ms/it, loss 0.449773
Finished training it 15360/76743 of epoch 4, 135.91 ms/it, loss 0.453559
Finished training it 15360/76743 of epoch 4, 135.95 ms/it, loss 0.448833
Finished training it 15360/76743 of epoch 4, 136.00 ms/it, loss 0.447423
rank 0 ranking from least wide range to the widest range [24 13 22 20 16  1 21 19 23  5  9 18 17  8  4  0 10 11 25 14  7  6  3  2
 12 15]
Finished training it 16384/76743 of epoch 4, 136.70 ms/it, loss 0.451130
Finished training it 16384/76743 of epoch 4, 136.71 ms/it, loss 0.449275
Finished training it 16384/76743 of epoch 4, 136.79 ms/it, loss 0.450491
Finished training it 16384/76743 of epoch 4, 136.71 ms/it, loss 0.450803
rank 0 ranking from least wide range to the widest range [13  1 22 19  9 24 17  5 23 20 18  7 16 21  8 14  0 10 25  4 12 11  6  3
  2 15]
Finished training it 17408/76743 of epoch 4, 136.70 ms/it, loss 0.447708
Finished training it 17408/76743 of epoch 4, 136.68 ms/it, loss 0.451069
Finished training it 17408/76743 of epoch 4, 136.67 ms/it, loss 0.450602
Finished training it 17408/76743 of epoch 4, 136.70 ms/it, loss 0.450796
Finished training it 18432/76743 of epoch 4, 135.89 ms/it, loss 0.449168
Finished training it 18432/76743 of epoch 4, 135.83 ms/it, loss 0.449687
rank 0 ranking from least wide range to the widest range [24 22  1  8  5 21 20  9 13 19 16  7 25 23 17 18  0 10  4 14  3 11 12  6
  2 15]
Finished training it 18432/76743 of epoch 4, 135.88 ms/it, loss 0.447077
Finished training it 18432/76743 of epoch 4, 135.92 ms/it, loss 0.449240
Finished training it 19456/76743 of epoch 4, 137.53 ms/it, loss 0.450459
rank 0 ranking from least wide range to the widest range [ 1 22 21 24  9  7  8 13 17  5 20 23 16 10 19 18  4 14  0  6 11 25 12  3
  2 15]
Finished training it 19456/76743 of epoch 4, 137.55 ms/it, loss 0.450182
Finished training it 19456/76743 of epoch 4, 137.49 ms/it, loss 0.450087
Finished training it 19456/76743 of epoch 4, 137.49 ms/it, loss 0.449174
Finished training it 20480/76743 of epoch 4, 137.35 ms/it, loss 0.451628
rank 0 ranking from least wide range to the widest range [ 1 24 22  9  8 18 13  4 20 23 17 19  0 10 25 16  5 21 14  7 11  3 12  6
  2 15]
Finished training it 20480/76743 of epoch 4, 137.40 ms/it, loss 0.448644
Finished training it 20480/76743 of epoch 4, 137.35 ms/it, loss 0.449098
Finished training it 20480/76743 of epoch 4, 137.37 ms/it, loss 0.448767
Testing at - 20480/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573632.0
get out
0 has test check 2573632.0 and sample count 3273728
 accuracy 78.615 %, best 78.625 %, roc auc score 0.7977, best 0.7977
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [ 1 13 22 24  8  9 20 23 17 19  4  7 16  0 18 10 14 21 25 11  5 12  6  3
  2 15]
Finished training it 21504/76743 of epoch 4, 136.59 ms/it, loss 0.449318
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573632.0
get out
2 has test check 2573632.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 136.72 ms/it, loss 0.446921
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573632.0
get out
1 has test check 2573632.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 136.62 ms/it, loss 0.451155
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573632.0
get out
3 has test check 2573632.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 136.61 ms/it, loss 0.451163
rank 0 ranking from least wide range to the widest range [ 1 13  9 24  8 22 21 20  0 16  4 17 18  5 10 19 23  7 14 25 11  6  3 12
  2 15]
Finished training it 22528/76743 of epoch 4, 135.89 ms/it, loss 0.447818
Finished training it 22528/76743 of epoch 4, 135.93 ms/it, loss 0.449861
Finished training it 22528/76743 of epoch 4, 136.02 ms/it, loss 0.450725
Finished training it 22528/76743 of epoch 4, 135.92 ms/it, loss 0.449117
rank 0 ranking from least wide range to the widest range [24  1 19  9  5 21 13 22 17 20 23 18 10  0  8 16  4 14  7 25 12 11  3  6
  2 15]
Finished training it 23552/76743 of epoch 4, 137.44 ms/it, loss 0.451469
Finished training it 23552/76743 of epoch 4, 137.44 ms/it, loss 0.450109
Finished training it 23552/76743 of epoch 4, 137.50 ms/it, loss 0.451236
Finished training it 23552/76743 of epoch 4, 137.48 ms/it, loss 0.449659
rank 0 ranking from least wide range to the widest range [22  1 24 13 17  9  7  8 23  4 20 21  5 18 19 10  0 14 16 25 12 11  3  6
  2 15]
Finished training it 24576/76743 of epoch 4, 136.77 ms/it, loss 0.447480
Finished training it 24576/76743 of epoch 4, 136.81 ms/it, loss 0.450819
Finished training it 24576/76743 of epoch 4, 136.84 ms/it, loss 0.450642
Finished training it 24576/76743 of epoch 4, 136.80 ms/it, loss 0.449247
rank 0 ranking from least wide range to the widest range [ 1 13 24 22  7 21 16 18  8 20 23  9 10 19 17  5 25  0 12  6 11 14  4  3
  2 15]
Finished training it 25600/76743 of epoch 4, 137.07 ms/it, loss 0.448986
Finished training it 25600/76743 of epoch 4, 137.10 ms/it, loss 0.447048
Finished training it 25600/76743 of epoch 4, 137.09 ms/it, loss 0.448758
Finished training it 25600/76743 of epoch 4, 137.11 ms/it, loss 0.450754
rank 0 ranking from least wide range to the widest range [22  1 24  8  5  9  7 23 20 13  4 18 16 17 10 21 19  6  0 25 11 14 12  3
  2 15]
Finished training it 26624/76743 of epoch 4, 136.28 ms/it, loss 0.452900
Finished training it 26624/76743 of epoch 4, 136.31 ms/it, loss 0.449328
Finished training it 26624/76743 of epoch 4, 136.36 ms/it, loss 0.451661
Finished training it 26624/76743 of epoch 4, 136.35 ms/it, loss 0.448511
rank 0 ranking from least wide range to the widest range [24 21 13  4  1 23  9 22 20  8 17 19 10  5 25 14 18  0  6 12  7 16  3 11
  2 15]
Finished training it 27648/76743 of epoch 4, 136.32 ms/it, loss 0.447424
Finished training it 27648/76743 of epoch 4, 136.30 ms/it, loss 0.448910
Finished training it 27648/76743 of epoch 4, 136.33 ms/it, loss 0.447822
Finished training it 27648/76743 of epoch 4, 136.30 ms/it, loss 0.449023
rank 0 ranking from least wide range to the widest range [22  1 13  9 24 20 23  0  4  8 18 10 19  7 17  5 25 16 21 12  3 14 11  6
  2 15]
Finished training it 28672/76743 of epoch 4, 136.29 ms/it, loss 0.449669
Finished training it 28672/76743 of epoch 4, 136.37 ms/it, loss 0.447890
Finished training it 28672/76743 of epoch 4, 136.33 ms/it, loss 0.450500
Finished training it 28672/76743 of epoch 4, 136.28 ms/it, loss 0.448873
rank 0 ranking from least wide range to the widest range [13 24  1  9 22  0 19  8 23  4 17 20 16 10  7  5 25 14 18 21 11  3  6 12
  2 15]
Finished training it 29696/76743 of epoch 4, 136.09 ms/it, loss 0.448645
Finished training it 29696/76743 of epoch 4, 136.09 ms/it, loss 0.447263
Finished training it 29696/76743 of epoch 4, 136.17 ms/it, loss 0.448961
Finished training it 29696/76743 of epoch 4, 136.13 ms/it, loss 0.451314
rank 0 ranking from least wide range to the widest range [22  1 24 13  9  0 20  7 23 17  5 18  8  4 19 21 16 25 10 14 12 11  3  6
  2 15]
Finished training it 30720/76743 of epoch 4, 135.58 ms/it, loss 0.451270
Finished training it 30720/76743 of epoch 4, 135.58 ms/it, loss 0.445464
Finished training it 30720/76743 of epoch 4, 135.67 ms/it, loss 0.450680
Finished training it 30720/76743 of epoch 4, 135.62 ms/it, loss 0.449444
Testing at - 30720/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2574607.0
get out
0 has test check 2574607.0 and sample count 3273728
 accuracy 78.644 %, best 78.644 %, roc auc score 0.7979, best 0.7979
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 22 24 17 19 23 20 13 10  9 18  8  5 14  0  4 25 21  7 16  6 11 12  3
  2 15]
Finished training it 31744/76743 of epoch 4, 136.45 ms/it, loss 0.447343
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574607.0
get out
2 has test check 2574607.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 136.53 ms/it, loss 0.448824
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2574607.0
get out
3 has test check 2574607.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 136.56 ms/it, loss 0.449526
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574607.0
get out
1 has test check 2574607.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 136.63 ms/it, loss 0.448124
rank 0 ranking from least wide range to the widest range [ 1 22 21 24 13  9  5 18 20 19  4 17 23  0 16  8 10  7 14 12 25 11  3  6
  2 15]
Finished training it 32768/76743 of epoch 4, 136.28 ms/it, loss 0.448779
Finished training it 32768/76743 of epoch 4, 136.28 ms/it, loss 0.449021
Finished training it 32768/76743 of epoch 4, 136.34 ms/it, loss 0.449913
Finished training it 32768/76743 of epoch 4, 136.31 ms/it, loss 0.449224
rank 0 ranking from least wide range to the widest range [24  1 13  8 22  9 19  5 16 21 10 18 20 23 17  7  0  4 12 14 11 25  6  3
  2 15]
Finished training it 33792/76743 of epoch 4, 137.97 ms/it, loss 0.449968
Finished training it 33792/76743 of epoch 4, 138.07 ms/it, loss 0.448722
Finished training it 33792/76743 of epoch 4, 138.04 ms/it, loss 0.449460
Finished training it 33792/76743 of epoch 4, 138.08 ms/it, loss 0.451720
rank 0 ranking from least wide range to the widest range [24  1 13  0  9 22 19  8 17 21 20  5 16 10 18 23  4 14  7 25 12 11  6  3
  2 15]
Finished training it 34816/76743 of epoch 4, 136.89 ms/it, loss 0.446300
Finished training it 34816/76743 of epoch 4, 136.87 ms/it, loss 0.447404
Finished training it 34816/76743 of epoch 4, 136.94 ms/it, loss 0.449275
Finished training it 34816/76743 of epoch 4, 136.90 ms/it, loss 0.450533
rank 0 ranking from least wide range to the widest range [ 1 22  8 19 18 24 21  9 20 16 13  7 23 17  5 10  0 14  4 25  6 11  3  2
 12 15]
Finished training it 35840/76743 of epoch 4, 136.07 ms/it, loss 0.448087
Finished training it 35840/76743 of epoch 4, 136.07 ms/it, loss 0.447027
Finished training it 35840/76743 of epoch 4, 136.08 ms/it, loss 0.450346
Finished training it 35840/76743 of epoch 4, 136.12 ms/it, loss 0.448448
rank 0 ranking from least wide range to the widest range [22  8 16 24 13  0  1  9 20 18  4 17 23 10 19  5 14 21  7 25 11  6  3 12
  2 15]
Finished training it 36864/76743 of epoch 4, 136.11 ms/it, loss 0.449837
Finished training it 36864/76743 of epoch 4, 136.16 ms/it, loss 0.452356
Finished training it 36864/76743 of epoch 4, 136.13 ms/it, loss 0.445949
Finished training it 36864/76743 of epoch 4, 136.18 ms/it, loss 0.447973
rank 0 ranking from least wide range to the widest range [22  1 24 21  9 13  8 19 17 20 23  5  0 10 18  4 16 14  7 25  6 12 11  3
  2 15]
Finished training it 37888/76743 of epoch 4, 137.84 ms/it, loss 0.447569
Finished training it 37888/76743 of epoch 4, 137.88 ms/it, loss 0.448431
Finished training it 37888/76743 of epoch 4, 137.88 ms/it, loss 0.446316
Finished training it 37888/76743 of epoch 4, 137.81 ms/it, loss 0.445466
rank 0 ranking from least wide range to the widest range [22 24 13 21  4  1 17  5  8  9 18 16 20 19 23 10  0  7 14 25 12  6 11  3
  2 15]
Finished training it 38912/76743 of epoch 4, 136.65 ms/it, loss 0.447375
Finished training it 38912/76743 of epoch 4, 136.66 ms/it, loss 0.448006
Finished training it 38912/76743 of epoch 4, 136.66 ms/it, loss 0.449111
Finished training it 38912/76743 of epoch 4, 136.65 ms/it, loss 0.450296
rank 0 ranking from least wide range to the widest range [ 1 22 24 13  8  9 17  7 10 21 20 18  4  5 19 14 16  0 23 25 11 12  6  3
  2 15]
Finished training it 39936/76743 of epoch 4, 136.38 ms/it, loss 0.449762
Finished training it 39936/76743 of epoch 4, 136.39 ms/it, loss 0.450164
Finished training it 39936/76743 of epoch 4, 136.41 ms/it, loss 0.448615
Finished training it 39936/76743 of epoch 4, 136.39 ms/it, loss 0.450838
rank 0 ranking from least wide range to the widest range [24  1 22 19 10  7 20 21 17 18  9 13  0  4  5  8 23 14 25 16  6 11 12  3
  2 15]
Finished training it 40960/76743 of epoch 4, 137.03 ms/it, loss 0.449886
Finished training it 40960/76743 of epoch 4, 137.15 ms/it, loss 0.448856
Finished training it 40960/76743 of epoch 4, 137.13 ms/it, loss 0.449050
Finished training it 40960/76743 of epoch 4, 137.10 ms/it, loss 0.448719
Testing at - 40960/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575051.0
get out
0 has test check 2575051.0 and sample count 3273728
 accuracy 78.658 %, best 78.658 %, roc auc score 0.7976, best 0.7979
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575051.0
get out
3 has test check 2575051.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 136.94 ms/it, loss 0.450177
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [13 22  1 19 24  4  8 17  9 16 20 18  5  7  0 10 23 14 21 11  6 25 12  3
  2 15]
Finished training it 41984/76743 of epoch 4, 136.66 ms/it, loss 0.450156
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575051.0
get out
2 has test check 2575051.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 136.96 ms/it, loss 0.452454
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575051.0
get out
1 has test check 2575051.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 136.99 ms/it, loss 0.449017
rank 0 ranking from least wide range to the widest range [ 1 17 21  5 24 22 20 23  8 19 13 14 16  4  7 10  9 18  0 12 11 25  3  6
  2 15]
Finished training it 43008/76743 of epoch 4, 135.87 ms/it, loss 0.449722
Finished training it 43008/76743 of epoch 4, 135.83 ms/it, loss 0.446755
Finished training it 43008/76743 of epoch 4, 135.94 ms/it, loss 0.447415
Finished training it 43008/76743 of epoch 4, 135.88 ms/it, loss 0.447536
rank 0 ranking from least wide range to the widest range [24 21 22  9  1  5 18  8  4 13 20 17 10 16 19 23  0 14 25 12  7 11  6  3
  2 15]
Finished training it 44032/76743 of epoch 4, 136.91 ms/it, loss 0.451003
Finished training it 44032/76743 of epoch 4, 136.93 ms/it, loss 0.449125
Finished training it 44032/76743 of epoch 4, 136.95 ms/it, loss 0.449334
Finished training it 44032/76743 of epoch 4, 136.93 ms/it, loss 0.447896
rank 0 ranking from least wide range to the widest range [24  1 21 22  0  9  5 19  7 23 18 13 17 20  8 10 12 16  4 14 11 25  3  6
  2 15]
Finished training it 45056/76743 of epoch 4, 136.04 ms/it, loss 0.449934
Finished training it 45056/76743 of epoch 4, 136.10 ms/it, loss 0.449133
Finished training it 45056/76743 of epoch 4, 135.96 ms/it, loss 0.449208
Finished training it 45056/76743 of epoch 4, 136.02 ms/it, loss 0.449449
rank 0 ranking from least wide range to the widest range [24 22  9 18 23  8  1  7 20 17 10 13  5 21  4 19 16  0 25 14  3 11  6 12
  2 15]
Finished training it 46080/76743 of epoch 4, 136.66 ms/it, loss 0.446403
Finished training it 46080/76743 of epoch 4, 136.67 ms/it, loss 0.449481
Finished training it 46080/76743 of epoch 4, 136.68 ms/it, loss 0.446747
Finished training it 46080/76743 of epoch 4, 136.62 ms/it, loss 0.448413
Finished training it 47104/76743 of epoch 4, 136.62 ms/it, loss 0.449871
Finished training it 47104/76743 of epoch 4, 136.61 ms/it, loss 0.446396
rank 0 ranking from least wide range to the widest range [21 24  1 13  5 22  9 17 23 20  8 16  7 10  0 18  4 19 14 12 11 25  6  2
  3 15]
Finished training it 47104/76743 of epoch 4, 136.59 ms/it, loss 0.448937
Finished training it 47104/76743 of epoch 4, 136.64 ms/it, loss 0.450638
rank 0 ranking from least wide range to the widest range [24 22  9 13  1 19  7 17 10 21  0  8 18 20  5 23 14 16  4 12 25  6  2 11
  3 15]
Finished training it 48128/76743 of epoch 4, 136.54 ms/it, loss 0.449522
Finished training it 48128/76743 of epoch 4, 136.54 ms/it, loss 0.450285
Finished training it 48128/76743 of epoch 4, 136.52 ms/it, loss 0.448435
Finished training it 48128/76743 of epoch 4, 136.59 ms/it, loss 0.449023
rank 0 ranking from least wide range to the widest range [24 22  1  5  9 20 21 18  0 10  4 23  8  7 19 17 13 14 16 25 12 11  6  3
  2 15]
Finished training it 49152/76743 of epoch 4, 135.30 ms/it, loss 0.448820
Finished training it 49152/76743 of epoch 4, 135.31 ms/it, loss 0.448268
Finished training it 49152/76743 of epoch 4, 135.27 ms/it, loss 0.448515
Finished training it 49152/76743 of epoch 4, 135.29 ms/it, loss 0.449518
rank 0 ranking from least wide range to the widest range [24 22 13  7  1  9 23 18 17 20  5 16  4  8 10 19  0 14 21 25 12 11  3  6
  2 15]
Finished training it 50176/76743 of epoch 4, 136.53 ms/it, loss 0.449059
Finished training it 50176/76743 of epoch 4, 136.63 ms/it, loss 0.447966
Finished training it 50176/76743 of epoch 4, 136.56 ms/it, loss 0.447530
Finished training it 50176/76743 of epoch 4, 136.56 ms/it, loss 0.448736
rank 0 ranking from least wide range to the widest range [ 1  9 24 20 17  5  0 10 16 13 22  8  4 18 23 14 19 25  7  6 21 11  3 12
  2 15]
Finished training it 51200/76743 of epoch 4, 136.49 ms/it, loss 0.445869
Finished training it 51200/76743 of epoch 4, 136.55 ms/it, loss 0.447006
Finished training it 51200/76743 of epoch 4, 136.53 ms/it, loss 0.449294
Finished training it 51200/76743 of epoch 4, 136.51 ms/it, loss 0.451746
Testing at - 51200/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575458.0
get out
0 has test check 2575458.0 and sample count 3273728
 accuracy 78.670 %, best 78.670 %, roc auc score 0.7984, best 0.7984
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [ 1 22  5 24  9 20 13 19 18 17 10 21 23  4  7 16  8 14  0 12 11 25  3  6
  2 15]
Finished training it 52224/76743 of epoch 4, 135.08 ms/it, loss 0.447912
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575458.0
get out
1 has test check 2575458.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 135.21 ms/it, loss 0.449848
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575458.0
get out
3 has test check 2575458.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 135.16 ms/it, loss 0.449927
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575458.0
get out
2 has test check 2575458.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 135.14 ms/it, loss 0.449062
rank 0 ranking from least wide range to the widest range [ 1 24 22  9 13 21  8 20 23 17 16 18 10  4  7  5 19 14 25  0  6 12 11  3
  2 15]
Finished training it 53248/76743 of epoch 4, 135.67 ms/it, loss 0.449675
Finished training it 53248/76743 of epoch 4, 135.66 ms/it, loss 0.449518
Finished training it 53248/76743 of epoch 4, 135.73 ms/it, loss 0.449907
Finished training it 53248/76743 of epoch 4, 135.73 ms/it, loss 0.449323
rank 0 ranking from least wide range to the widest range [24 22  1  9 17 20 16  8 23  5 13 19 10 18  4  0 12 21 25 14  2  7 11  6
  3 15]
Finished training it 54272/76743 of epoch 4, 136.81 ms/it, loss 0.446888
Finished training it 54272/76743 of epoch 4, 136.90 ms/it, loss 0.449799
Finished training it 54272/76743 of epoch 4, 136.88 ms/it, loss 0.449517
Finished training it 54272/76743 of epoch 4, 136.89 ms/it, loss 0.447285
rank 0 ranking from least wide range to the widest range [19  1 24  8  9  4 13 21  5 22 18  0 20 17 16 10  7 23 14 25  6 11  3 12
  2 15]
Finished training it 55296/76743 of epoch 4, 136.74 ms/it, loss 0.447433
Finished training it 55296/76743 of epoch 4, 136.69 ms/it, loss 0.448738
Finished training it 55296/76743 of epoch 4, 136.72 ms/it, loss 0.450001
Finished training it 55296/76743 of epoch 4, 136.73 ms/it, loss 0.447661
rank 0 ranking from least wide range to the widest range [24 13 22  1  8  9 17 18 21 20 19 23  5 10  0  7 14 16  4 12 25  6 11  3
  2 15]
Finished training it 56320/76743 of epoch 4, 137.25 ms/it, loss 0.448438
Finished training it 56320/76743 of epoch 4, 137.25 ms/it, loss 0.448462
Finished training it 56320/76743 of epoch 4, 137.26 ms/it, loss 0.449438
Finished training it 56320/76743 of epoch 4, 137.29 ms/it, loss 0.449767
rank 0 ranking from least wide range to the widest range [22 24  1 23  9  0 20 10  7 17 13 21 16  8 19  4 18  5 25  6 14 11 12  2
  3 15]
Finished training it 57344/76743 of epoch 4, 136.27 ms/it, loss 0.446961
Finished training it 57344/76743 of epoch 4, 136.37 ms/it, loss 0.449864
Finished training it 57344/76743 of epoch 4, 136.34 ms/it, loss 0.447091
Finished training it 57344/76743 of epoch 4, 136.33 ms/it, loss 0.450577
rank 0 ranking from least wide range to the widest range [24 22  1 21 17  5 20  9  0 10 13 23 18  4 19  8  7 14 16 12 11  6 25  2
  3 15]
Finished training it 58368/76743 of epoch 4, 136.27 ms/it, loss 0.447950
Finished training it 58368/76743 of epoch 4, 136.31 ms/it, loss 0.448455
Finished training it 58368/76743 of epoch 4, 136.31 ms/it, loss 0.451694
Finished training it 58368/76743 of epoch 4, 136.23 ms/it, loss 0.448088
rank 0 ranking from least wide range to the widest range [24  1 22 13 19 20  4  9 18 17 23  5  8  0 10 16 25  7 14 21 12 11  6  3
  2 15]
Finished training it 59392/76743 of epoch 4, 137.19 ms/it, loss 0.449073
Finished training it 59392/76743 of epoch 4, 137.22 ms/it, loss 0.448861
Finished training it 59392/76743 of epoch 4, 137.20 ms/it, loss 0.445999
Finished training it 59392/76743 of epoch 4, 137.17 ms/it, loss 0.448263
Finished training it 60416/76743 of epoch 4, 136.26 ms/it, loss 0.450742
rank 0 ranking from least wide range to the widest range [24 22 13 21  9  5  1 20  8 10 17  0 18 16 19 23 14  4 12  7  6 11 25  3
  2 15]
Finished training it 60416/76743 of epoch 4, 136.27 ms/it, loss 0.446663
Finished training it 60416/76743 of epoch 4, 136.26 ms/it, loss 0.451058
Finished training it 60416/76743 of epoch 4, 136.23 ms/it, loss 0.446404
rank 0 ranking from least wide range to the widest range [22  1 21 24 13 10  9  7 20  5 17 18 19  4 23  8 16  0 14 11 12 25  6  2
  3 15]
Finished training it 61440/76743 of epoch 4, 136.23 ms/it, loss 0.447561
Finished training it 61440/76743 of epoch 4, 136.32 ms/it, loss 0.448722
Finished training it 61440/76743 of epoch 4, 136.31 ms/it, loss 0.448675
Finished training it 61440/76743 of epoch 4, 136.28 ms/it, loss 0.446073
Testing at - 61440/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575750.0
get out
0 has test check 2575750.0 and sample count 3273728
 accuracy 78.679 %, best 78.679 %, roc auc score 0.7990, best 0.7990
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
rank 0 ranking from least wide range to the widest range [24 22  1  7 13  5 18  8 21 17  9 23 16 20  0 19 14 10  4 12 25 11  2  3
  6 15]
Finished training it 62464/76743 of epoch 4, 137.12 ms/it, loss 0.447623
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575750.0
get out
1 has test check 2575750.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 137.14 ms/it, loss 0.450645
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575750.0
get out
3 has test check 2575750.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 137.11 ms/it, loss 0.447866
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575750.0
get out
2 has test check 2575750.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 137.01 ms/it, loss 0.449127
Finished training it 63488/76743 of epoch 4, 136.91 ms/it, loss 0.447644
Finished training it 63488/76743 of epoch 4, 136.87 ms/it, loss 0.447574
Finished training it 63488/76743 of epoch 4, 136.96 ms/it, loss 0.448366
rank 0 ranking from least wide range to the widest range [22  1 24 21  9 13  0 18  7 17 10 19 20  4  5  8 23 14 16 25 12  6 11  3
  2 15]
Finished training it 63488/76743 of epoch 4, 136.91 ms/it, loss 0.447999
rank 0 ranking from least wide range to the widest range [ 1 24 13 22 23 19  7  5 17  9 16 20  8 18 21  4  0 10 14 12 25 11  2  6
  3 15]
Finished training it 64512/76743 of epoch 4, 137.09 ms/it, loss 0.446828
Finished training it 64512/76743 of epoch 4, 137.09 ms/it, loss 0.446798
Finished training it 64512/76743 of epoch 4, 137.11 ms/it, loss 0.450801
Finished training it 64512/76743 of epoch 4, 137.05 ms/it, loss 0.447984
rank 0 ranking from least wide range to the widest range [ 1 24 22  9  0 13  7 18 17 23  5 20 19 10 14 21  4  8 25 16 12 11  6  3
  2 15]
Finished training it 65536/76743 of epoch 4, 136.70 ms/it, loss 0.448495
Finished training it 65536/76743 of epoch 4, 136.64 ms/it, loss 0.447834
Finished training it 65536/76743 of epoch 4, 136.68 ms/it, loss 0.445750
Finished training it 65536/76743 of epoch 4, 136.64 ms/it, loss 0.449094
rank 0 ranking from least wide range to the widest range [22 21 24  9 17  1  8  4 18 13 14  5 20 19 10 16  7 23 12  0 11  6 25  3
  2 15]
Finished training it 66560/76743 of epoch 4, 136.26 ms/it, loss 0.448795
Finished training it 66560/76743 of epoch 4, 136.33 ms/it, loss 0.447642
Finished training it 66560/76743 of epoch 4, 136.27 ms/it, loss 0.447251
Finished training it 66560/76743 of epoch 4, 136.34 ms/it, loss 0.449352
Finished training it 67584/76743 of epoch 4, 136.47 ms/it, loss 0.449723
rank 0 ranking from least wide range to the widest range [22  1 24  5  9 21 18 23 13  8 17 20  4  7 10 16 19 14  0 25 12  6 11  3
  2 15]
Finished training it 67584/76743 of epoch 4, 136.45 ms/it, loss 0.448866
Finished training it 67584/76743 of epoch 4, 136.47 ms/it, loss 0.449958
Finished training it 67584/76743 of epoch 4, 136.44 ms/it, loss 0.447670
rank 0 ranking from least wide range to the widest range [22 13 24  1 17  9 21  0  4 20 23  8  5 10 18 16  7 14 19 12 11 25  2  6
  3 15]
Finished training it 68608/76743 of epoch 4, 137.71 ms/it, loss 0.451192
Finished training it 68608/76743 of epoch 4, 137.70 ms/it, loss 0.450341
Finished training it 68608/76743 of epoch 4, 137.75 ms/it, loss 0.447585
Finished training it 68608/76743 of epoch 4, 137.76 ms/it, loss 0.450748
rank 0 ranking from least wide range to the widest range [22 24 13  9  5 17 21 20 16 10 23 19 18  8  0  1  4  7 14 25  6 12 11  3
  2 15]
Finished training it 69632/76743 of epoch 4, 136.64 ms/it, loss 0.450751
Finished training it 69632/76743 of epoch 4, 136.66 ms/it, loss 0.449311
Finished training it 69632/76743 of epoch 4, 136.63 ms/it, loss 0.448302
Finished training it 69632/76743 of epoch 4, 136.69 ms/it, loss 0.447510
rank 0 ranking from least wide range to the widest range [24 22 13 21  1 17 20 16  9  8 23 19 18  0  4  5  7 14 10 25  3 12 11  2
  6 15]
Finished training it 70656/76743 of epoch 4, 136.45 ms/it, loss 0.449091
Finished training it 70656/76743 of epoch 4, 136.45 ms/it, loss 0.447577
Finished training it 70656/76743 of epoch 4, 136.49 ms/it, loss 0.449161
Finished training it 70656/76743 of epoch 4, 136.48 ms/it, loss 0.449944
rank 0 ranking from least wide range to the widest range [22  1 24 13  0  9 20 21 18 10  5 23 17 16  8 19 14  4  7 25 12  6 11  3
  2 15]
Finished training it 71680/76743 of epoch 4, 137.14 ms/it, loss 0.450068
Finished training it 71680/76743 of epoch 4, 137.16 ms/it, loss 0.447737
Finished training it 71680/76743 of epoch 4, 137.13 ms/it, loss 0.448726
Finished training it 71680/76743 of epoch 4, 137.11 ms/it, loss 0.449321
Testing at - 71680/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575302.0
get out
0 has test check 2575302.0 and sample count 3273728
 accuracy 78.666 %, best 78.679 %, roc auc score 0.7984, best 0.7990
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
rank 0 ranking from least wide range to the widest range [22 24  1  4  9  0 13  8 20 21 17 18 16 19 10 23  5  7 14  6 25 12  3  2
 11 15]
Finished training it 72704/76743 of epoch 4, 136.67 ms/it, loss 0.449176
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575302.0
get out
3 has test check 2575302.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 136.68 ms/it, loss 0.446997
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575302.0
get out
1 has test check 2575302.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 136.68 ms/it, loss 0.451280
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575302.0
get out
2 has test check 2575302.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 136.75 ms/it, loss 0.447923
rank 0 ranking from least wide range to the widest range [24  1  4 13 22  8  9 20 23 17 19  7 18  0 21 10  5 16 14 25 11 12  3  2
  6 15]
Finished training it 73728/76743 of epoch 4, 136.65 ms/it, loss 0.449279
Finished training it 73728/76743 of epoch 4, 136.69 ms/it, loss 0.449225
Finished training it 73728/76743 of epoch 4, 136.63 ms/it, loss 0.446504
Finished training it 73728/76743 of epoch 4, 136.63 ms/it, loss 0.448391
rank 0 ranking from least wide range to the widest range [24  9  1 20 22  8 17  7 23  0  4 18 19 13  5 21 10 14 16 25 11 12  3  6
  2 15]
Finished training it 74752/76743 of epoch 4, 136.82 ms/it, loss 0.448428
Finished training it 74752/76743 of epoch 4, 136.97 ms/it, loss 0.448799
Finished training it 74752/76743 of epoch 4, 137.02 ms/it, loss 0.449884
Finished training it 74752/76743 of epoch 4, 136.83 ms/it, loss 0.446306
rank 0 ranking from least wide range to the widest range [24 22  1  7 18 20  9 19 23  4 16 17 13  0  8 21  5 10 25 14  2 12  3 11
  6 15]
Finished training it 75776/76743 of epoch 4, 136.07 ms/it, loss 0.447996
Finished training it 75776/76743 of epoch 4, 136.09 ms/it, loss 0.447414
Finished training it 75776/76743 of epoch 4, 136.03 ms/it, loss 0.448803
Finished training it 75776/76743 of epoch 4, 136.10 ms/it, loss 0.448880
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573737.0
get out
0 has test check 2573737.0 and sample count 3273728
 accuracy 78.618 %, best 78.679 %, roc auc score 0.7989, best 0.7990
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573737.0
get out
2 has test check 2573737.0 and sample count 3273728
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573737.0
get out
3 has test check 2573737.0 and sample count 3273728
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573737.0
get out
1 has test check 2573737.0 and sample count 3273728
