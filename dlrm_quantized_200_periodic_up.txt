Finished training it 302080/306969 of epoch 3, 49.23 ms/it, loss 0.434021
Finished training it 303104/306969 of epoch 3, 49.55 ms/it, loss 0.442227
Finished training it 303104/306969 of epoch 3, 49.37 ms/it, loss 0.440330
Finished training it 303104/306969 of epoch 3, 49.57 ms/it, loss 0.436836
Finished training it 303104/306969 of epoch 3, 49.60 ms/it, loss 0.437665
Finished training it 304128/306969 of epoch 3, 49.37 ms/it, loss 0.439420
Finished training it 304128/306969 of epoch 3, 49.34 ms/it, loss 0.437520
Finished training it 304128/306969 of epoch 3, 49.33 ms/it, loss 0.441189
Finished training it 304128/306969 of epoch 3, 49.34 ms/it, loss 0.437006
Finished training it 305152/306969 of epoch 3, 49.02 ms/it, loss 0.435508
Finished training it 305152/306969 of epoch 3, 48.97 ms/it, loss 0.436127
Finished training it 305152/306969 of epoch 3, 49.07 ms/it, loss 0.435731
Finished training it 305152/306969 of epoch 3, 48.95 ms/it, loss 0.435325
Finished training it 306176/306969 of epoch 3, 48.95 ms/it, loss 0.436165
Finished training it 306176/306969 of epoch 3, 48.97 ms/it, loss 0.432928
Finished training it 306176/306969 of epoch 3, 48.90 ms/it, loss 0.430182
Finished training it 306176/306969 of epoch 3, 48.86 ms/it, loss 0.431375
Warning: Skipping the batch 306968 with size 54
Warning: Skipping the batch 306968 with size 54
Warning: Skipping the batch 306968 with size 54
Warning: Skipping the batch 306968 with size 54
Finished training it 1024/306969 of epoch 4, 49.19 ms/it, loss 0.432900
Finished training it 1024/306969 of epoch 4, 49.16 ms/it, loss 0.436054
Finished training it 1024/306969 of epoch 4, 49.12 ms/it, loss 0.436509
Finished training it 1024/306969 of epoch 4, 49.14 ms/it, loss 0.436881
Finished training it 2048/306969 of epoch 4, 48.87 ms/it, loss 0.441994
Finished training it 2048/306969 of epoch 4, 48.89 ms/it, loss 0.431874
Finished training it 2048/306969 of epoch 4, 48.88 ms/it, loss 0.434190
Finished training it 2048/306969 of epoch 4, 48.87 ms/it, loss 0.438051
Finished training it 3072/306969 of epoch 4, 49.10 ms/it, loss 0.440012
Finished training it 3072/306969 of epoch 4, 49.04 ms/it, loss 0.437812
Finished training it 3072/306969 of epoch 4, 49.03 ms/it, loss 0.437702
Finished training it 3072/306969 of epoch 4, 49.01 ms/it, loss 0.437769
Finished training it 4096/306969 of epoch 4, 49.37 ms/it, loss 0.435384
Finished training it 4096/306969 of epoch 4, 49.35 ms/it, loss 0.433330
Finished training it 4096/306969 of epoch 4, 49.38 ms/it, loss 0.431529
Finished training it 4096/306969 of epoch 4, 49.35 ms/it, loss 0.432279
Finished training it 5120/306969 of epoch 4, 48.58 ms/it, loss 0.437263
Finished training it 5120/306969 of epoch 4, 48.53 ms/it, loss 0.435487
Finished training it 5120/306969 of epoch 4, 48.55 ms/it, loss 0.439487
Finished training it 5120/306969 of epoch 4, 48.54 ms/it, loss 0.436917
Finished training it 6144/306969 of epoch 4, 49.41 ms/it, loss 0.434754
Finished training it 6144/306969 of epoch 4, 49.44 ms/it, loss 0.431587
Finished training it 6144/306969 of epoch 4, 49.43 ms/it, loss 0.437735
Finished training it 6144/306969 of epoch 4, 49.41 ms/it, loss 0.437026
Finished training it 7168/306969 of epoch 4, 49.77 ms/it, loss 0.441542
Finished training it 7168/306969 of epoch 4, 49.77 ms/it, loss 0.435099
Finished training it 7168/306969 of epoch 4, 49.71 ms/it, loss 0.441279
Finished training it 7168/306969 of epoch 4, 49.77 ms/it, loss 0.439227
Finished training it 8192/306969 of epoch 4, 49.11 ms/it, loss 0.432771
Finished training it 8192/306969 of epoch 4, 49.19 ms/it, loss 0.432550
Finished training it 8192/306969 of epoch 4, 49.16 ms/it, loss 0.435412
Finished training it 8192/306969 of epoch 4, 49.13 ms/it, loss 0.437923
Finished training it 9216/306969 of epoch 4, 49.68 ms/it, loss 0.431963
Finished training it 9216/306969 of epoch 4, 49.68 ms/it, loss 0.436208
Finished training it 9216/306969 of epoch 4, 49.64 ms/it, loss 0.434870
Finished training it 9216/306969 of epoch 4, 49.65 ms/it, loss 0.430166
Finished training it 10240/306969 of epoch 4, 49.00 ms/it, loss 0.438724
Finished training it 10240/306969 of epoch 4, 48.95 ms/it, loss 0.433933
Finished training it 10240/306969 of epoch 4, 48.98 ms/it, loss 0.438648
Finished training it 10240/306969 of epoch 4, 48.97 ms/it, loss 0.441915
Testing at - 10240/306969 of epoch 4,
Testing at - 10240/306969 of epoch 4,
Testing at - 10240/306969 of epoch 4,
Testing at - 10240/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581055.0
get out
1 has test check 2581055.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2581055.0
get out
3 has test check 2581055.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581055.0
get out
2 has test check 2581055.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581055.0
get out
0 has test check 2581055.0 and sample count 3273728
 accuracy 78.841 %, best 78.922 %, roc auc score 0.8030, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 11264/306969 of epoch 4, 49.45 ms/it, loss 0.437931
Finished training it 11264/306969 of epoch 4, 49.47 ms/it, loss 0.434525
Finished training it 11264/306969 of epoch 4, 49.44 ms/it, loss 0.436316
Finished training it 11264/306969 of epoch 4, 49.45 ms/it, loss 0.432054
Finished training it 12288/306969 of epoch 4, 49.18 ms/it, loss 0.435888
Finished training it 12288/306969 of epoch 4, 49.18 ms/it, loss 0.432853
Finished training it 12288/306969 of epoch 4, 49.11 ms/it, loss 0.434642
Finished training it 12288/306969 of epoch 4, 49.19 ms/it, loss 0.437635
Finished training it 13312/306969 of epoch 4, 51.98 ms/it, loss 0.440208
Finished training it 13312/306969 of epoch 4, 51.98 ms/it, loss 0.434047
Finished training it 13312/306969 of epoch 4, 51.97 ms/it, loss 0.434193
Finished training it 13312/306969 of epoch 4, 51.97 ms/it, loss 0.442970
Finished training it 14336/306969 of epoch 4, 48.91 ms/it, loss 0.439649
Finished training it 14336/306969 of epoch 4, 48.88 ms/it, loss 0.436740
Finished training it 14336/306969 of epoch 4, 48.93 ms/it, loss 0.435034
Finished training it 14336/306969 of epoch 4, 48.92 ms/it, loss 0.435201
Finished training it 15360/306969 of epoch 4, 48.52 ms/it, loss 0.430676
Finished training it 15360/306969 of epoch 4, 48.55 ms/it, loss 0.430899
Finished training it 15360/306969 of epoch 4, 48.55 ms/it, loss 0.434388
Finished training it 15360/306969 of epoch 4, 48.53 ms/it, loss 0.434645
Finished training it 16384/306969 of epoch 4, 49.01 ms/it, loss 0.435070
Finished training it 16384/306969 of epoch 4, 48.95 ms/it, loss 0.437362
Finished training it 16384/306969 of epoch 4, 48.93 ms/it, loss 0.441968
Finished training it 16384/306969 of epoch 4, 49.02 ms/it, loss 0.434201
Finished training it 17408/306969 of epoch 4, 49.27 ms/it, loss 0.441392
Finished training it 17408/306969 of epoch 4, 49.23 ms/it, loss 0.433722
Finished training it 17408/306969 of epoch 4, 49.16 ms/it, loss 0.440058
Finished training it 17408/306969 of epoch 4, 49.19 ms/it, loss 0.437294
Finished training it 18432/306969 of epoch 4, 48.83 ms/it, loss 0.442852
Finished training it 18432/306969 of epoch 4, 48.82 ms/it, loss 0.434529
Finished training it 18432/306969 of epoch 4, 48.76 ms/it, loss 0.433980
Finished training it 18432/306969 of epoch 4, 48.79 ms/it, loss 0.435771
Finished training it 19456/306969 of epoch 4, 50.16 ms/it, loss 0.435164
Finished training it 19456/306969 of epoch 4, 50.32 ms/it, loss 0.436465
Finished training it 19456/306969 of epoch 4, 50.37 ms/it, loss 0.439230
Finished training it 19456/306969 of epoch 4, 50.19 ms/it, loss 0.443545
Finished training it 20480/306969 of epoch 4, 48.94 ms/it, loss 0.435523
Finished training it 20480/306969 of epoch 4, 48.98 ms/it, loss 0.436852
Finished training it 20480/306969 of epoch 4, 48.89 ms/it, loss 0.435403
Finished training it 20480/306969 of epoch 4, 48.87 ms/it, loss 0.437288
Testing at - 20480/306969 of epoch 4,
Testing at - 20480/306969 of epoch 4,
Testing at - 20480/306969 of epoch 4,
Testing at - 20480/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580762.0
get out
0 has test check 2580762.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2580762.0
rank: 3 test_accu: 2580762.0
get out
get out
1 has test check 2580762.0 and sample count 3273728
3 has test check 2580762.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580762.0
get out
2 has test check 2580762.0 and sample count 3273728
 accuracy 78.833 %, best 78.922 %, roc auc score 0.8032, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 21504/306969 of epoch 4, 49.27 ms/it, loss 0.438785
Finished training it 21504/306969 of epoch 4, 49.26 ms/it, loss 0.438121
Finished training it 21504/306969 of epoch 4, 49.31 ms/it, loss 0.435841
Finished training it 21504/306969 of epoch 4, 49.24 ms/it, loss 0.427934
Finished training it 22528/306969 of epoch 4, 49.19 ms/it, loss 0.437318
Finished training it 22528/306969 of epoch 4, 49.20 ms/it, loss 0.438664
Finished training it 22528/306969 of epoch 4, 49.21 ms/it, loss 0.430411
Finished training it 22528/306969 of epoch 4, 49.22 ms/it, loss 0.429331
Finished training it 23552/306969 of epoch 4, 49.64 ms/it, loss 0.437712
Finished training it 23552/306969 of epoch 4, 49.65 ms/it, loss 0.437865
Finished training it 23552/306969 of epoch 4, 49.57 ms/it, loss 0.438029
Finished training it 23552/306969 of epoch 4, 49.67 ms/it, loss 0.440429
Finished training it 24576/306969 of epoch 4, 49.63 ms/it, loss 0.428907
Finished training it 24576/306969 of epoch 4, 49.68 ms/it, loss 0.436174
Finished training it 24576/306969 of epoch 4, 49.72 ms/it, loss 0.435913
Finished training it 24576/306969 of epoch 4, 49.69 ms/it, loss 0.436757
Finished training it 25600/306969 of epoch 4, 49.54 ms/it, loss 0.434023
Finished training it 25600/306969 of epoch 4, 49.59 ms/it, loss 0.429659
Finished training it 25600/306969 of epoch 4, 49.55 ms/it, loss 0.439417
Finished training it 25600/306969 of epoch 4, 49.54 ms/it, loss 0.435401
Finished training it 26624/306969 of epoch 4, 49.23 ms/it, loss 0.438170
Finished training it 26624/306969 of epoch 4, 49.24 ms/it, loss 0.433594
Finished training it 26624/306969 of epoch 4, 49.18 ms/it, loss 0.435431
Finished training it 26624/306969 of epoch 4, 49.26 ms/it, loss 0.435091
Finished training it 27648/306969 of epoch 4, 49.22 ms/it, loss 0.432769
Finished training it 27648/306969 of epoch 4, 49.15 ms/it, loss 0.428987
Finished training it 27648/306969 of epoch 4, 49.19 ms/it, loss 0.433104
Finished training it 27648/306969 of epoch 4, 49.22 ms/it, loss 0.433589
Finished training it 28672/306969 of epoch 4, 49.38 ms/it, loss 0.433683
Finished training it 28672/306969 of epoch 4, 49.23 ms/it, loss 0.436138
Finished training it 28672/306969 of epoch 4, 49.37 ms/it, loss 0.436578
Finished training it 28672/306969 of epoch 4, 49.31 ms/it, loss 0.437859
Finished training it 29696/306969 of epoch 4, 48.99 ms/it, loss 0.434307
Finished training it 29696/306969 of epoch 4, 49.00 ms/it, loss 0.435338
Finished training it 29696/306969 of epoch 4, 48.96 ms/it, loss 0.427331
Finished training it 29696/306969 of epoch 4, 48.96 ms/it, loss 0.439184
Finished training it 30720/306969 of epoch 4, 49.72 ms/it, loss 0.431596
Finished training it 30720/306969 of epoch 4, 49.71 ms/it, loss 0.437262
Finished training it 30720/306969 of epoch 4, 49.66 ms/it, loss 0.431341
Testing at - 30720/306969 of epoch 4,
Finished training it 30720/306969 of epoch 4, 49.68 ms/it, loss 0.434377
Testing at - 30720/306969 of epoch 4,
Testing at - 30720/306969 of epoch 4,
Testing at - 30720/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2582175.0
get out
0 has test check 2582175.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2582175.0
get out
2 has test check 2582175.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2582175.0
Warning: Skipping the batch 3197 with size 602
get out
3 has test check 2582175.0 and sample count 3273728
rank: 1 test_accu: 2582175.0
get out
1 has test check 2582175.0 and sample count 3273728
 accuracy 78.876 %, best 78.922 %, roc auc score 0.8031, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 31744/306969 of epoch 4, 49.20 ms/it, loss 0.430235
Finished training it 31744/306969 of epoch 4, 49.47 ms/it, loss 0.432339
Finished training it 31744/306969 of epoch 4, 49.48 ms/it, loss 0.433976
Finished training it 31744/306969 of epoch 4, 49.48 ms/it, loss 0.430296
Finished training it 32768/306969 of epoch 4, 55.07 ms/it, loss 0.436427
Finished training it 32768/306969 of epoch 4, 54.95 ms/it, loss 0.436631
Finished training it 32768/306969 of epoch 4, 54.96 ms/it, loss 0.434326
Finished training it 32768/306969 of epoch 4, 54.73 ms/it, loss 0.436967
Finished training it 33792/306969 of epoch 4, 59.19 ms/it, loss 0.437362
Finished training it 33792/306969 of epoch 4, 59.23 ms/it, loss 0.431143
Finished training it 33792/306969 of epoch 4, 59.63 ms/it, loss 0.437144
Finished training it 33792/306969 of epoch 4, 59.29 ms/it, loss 0.434068
Finished training it 34816/306969 of epoch 4, 65.45 ms/it, loss 0.432401
Finished training it 34816/306969 of epoch 4, 65.60 ms/it, loss 0.434003
Finished training it 34816/306969 of epoch 4, 65.85 ms/it, loss 0.438730
Finished training it 34816/306969 of epoch 4, 65.29 ms/it, loss 0.436083
Finished training it 35840/306969 of epoch 4, 60.12 ms/it, loss 0.438626
Finished training it 35840/306969 of epoch 4, 59.65 ms/it, loss 0.435044
Finished training it 35840/306969 of epoch 4, 59.64 ms/it, loss 0.438734
Finished training it 35840/306969 of epoch 4, 59.81 ms/it, loss 0.432891
Finished training it 36864/306969 of epoch 4, 58.91 ms/it, loss 0.435142
Finished training it 36864/306969 of epoch 4, 59.40 ms/it, loss 0.439987
Finished training it 36864/306969 of epoch 4, 59.10 ms/it, loss 0.430998
Finished training it 36864/306969 of epoch 4, 59.04 ms/it, loss 0.432754
Finished training it 37888/306969 of epoch 4, 61.07 ms/it, loss 0.435111
Finished training it 37888/306969 of epoch 4, 61.08 ms/it, loss 0.436434
Finished training it 37888/306969 of epoch 4, 61.43 ms/it, loss 0.433481
Finished training it 37888/306969 of epoch 4, 60.80 ms/it, loss 0.437176
Finished training it 38912/306969 of epoch 4, 60.24 ms/it, loss 0.439274
Finished training it 38912/306969 of epoch 4, 60.11 ms/it, loss 0.433983
Finished training it 38912/306969 of epoch 4, 60.10 ms/it, loss 0.434201
Finished training it 38912/306969 of epoch 4, 60.01 ms/it, loss 0.441848
Finished training it 39936/306969 of epoch 4, 59.56 ms/it, loss 0.433061
Finished training it 39936/306969 of epoch 4, 59.74 ms/it, loss 0.436952
Finished training it 39936/306969 of epoch 4, 59.85 ms/it, loss 0.434175
Finished training it 39936/306969 of epoch 4, 59.64 ms/it, loss 0.433345
Finished training it 40960/306969 of epoch 4, 58.37 ms/it, loss 0.439184
Finished training it 40960/306969 of epoch 4, 58.25 ms/it, loss 0.438604
Finished training it 40960/306969 of epoch 4, 58.09 ms/it, loss 0.436937
Finished training it 40960/306969 of epoch 4, 58.21 ms/it, loss 0.440312
Testing at - 40960/306969 of epoch 4,
Testing at - 40960/306969 of epoch 4,
Testing at - 40960/306969 of epoch 4,
Testing at - 40960/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2580996.0
get out
1 has test check 2580996.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580996.0
get out
2 has test check 2580996.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2580996.0
get out
3 has test check 2580996.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580996.0
get out
0 has test check 2580996.0 and sample count 3273728
 accuracy 78.840 %, best 78.922 %, roc auc score 0.8021, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 41984/306969 of epoch 4, 60.81 ms/it, loss 0.434382
Finished training it 41984/306969 of epoch 4, 60.53 ms/it, loss 0.432746
Finished training it 41984/306969 of epoch 4, 61.13 ms/it, loss 0.435545
Finished training it 41984/306969 of epoch 4, 60.21 ms/it, loss 0.432779
Finished training it 43008/306969 of epoch 4, 59.87 ms/it, loss 0.437396
Finished training it 43008/306969 of epoch 4, 59.97 ms/it, loss 0.437216
Finished training it 43008/306969 of epoch 4, 60.29 ms/it, loss 0.435827
Finished training it 43008/306969 of epoch 4, 59.92 ms/it, loss 0.436143
Finished training it 44032/306969 of epoch 4, 59.56 ms/it, loss 0.428737
Finished training it 44032/306969 of epoch 4, 59.58 ms/it, loss 0.432821
Finished training it 44032/306969 of epoch 4, 60.03 ms/it, loss 0.434448
Finished training it 44032/306969 of epoch 4, 59.77 ms/it, loss 0.432595
Finished training it 45056/306969 of epoch 4, 60.47 ms/it, loss 0.435783
Finished training it 45056/306969 of epoch 4, 60.17 ms/it, loss 0.431609
Finished training it 45056/306969 of epoch 4, 59.73 ms/it, loss 0.436209
Finished training it 45056/306969 of epoch 4, 60.20 ms/it, loss 0.434742
Finished training it 46080/306969 of epoch 4, 61.65 ms/it, loss 0.435911
Finished training it 46080/306969 of epoch 4, 61.30 ms/it, loss 0.440556
Finished training it 46080/306969 of epoch 4, 60.72 ms/it, loss 0.436457
Finished training it 46080/306969 of epoch 4, 61.24 ms/it, loss 0.430776
Finished training it 47104/306969 of epoch 4, 60.95 ms/it, loss 0.433268
Finished training it 47104/306969 of epoch 4, 61.37 ms/it, loss 0.437595
Finished training it 47104/306969 of epoch 4, 60.45 ms/it, loss 0.431099
Finished training it 47104/306969 of epoch 4, 60.97 ms/it, loss 0.433701
Finished training it 48128/306969 of epoch 4, 61.58 ms/it, loss 0.430576
Finished training it 48128/306969 of epoch 4, 61.33 ms/it, loss 0.439169
Finished training it 48128/306969 of epoch 4, 61.28 ms/it, loss 0.433308
Finished training it 48128/306969 of epoch 4, 60.66 ms/it, loss 0.431661
Finished training it 49152/306969 of epoch 4, 60.58 ms/it, loss 0.430762
Finished training it 49152/306969 of epoch 4, 60.65 ms/it, loss 0.436542
Finished training it 49152/306969 of epoch 4, 61.14 ms/it, loss 0.431104
Finished training it 49152/306969 of epoch 4, 60.00 ms/it, loss 0.432266
Finished training it 50176/306969 of epoch 4, 60.60 ms/it, loss 0.436023
Finished training it 50176/306969 of epoch 4, 60.26 ms/it, loss 0.438662
Finished training it 50176/306969 of epoch 4, 59.57 ms/it, loss 0.436267
Finished training it 50176/306969 of epoch 4, 60.09 ms/it, loss 0.436195
Finished training it 51200/306969 of epoch 4, 60.92 ms/it, loss 0.435326
Finished training it 51200/306969 of epoch 4, 60.71 ms/it, loss 0.432578
Finished training it 51200/306969 of epoch 4, 60.56 ms/it, loss 0.427691
Testing at - 51200/306969 of epoch 4,
Finished training it 51200/306969 of epoch 4, 60.10 ms/it, loss 0.433640
Testing at - 51200/306969 of epoch 4,
Testing at - 51200/306969 of epoch 4,
Testing at - 51200/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581269.0
get out
1 has test check 2581269.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2581269.0
get out
3 has test check 2581269.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581269.0
get out
2 has test check 2581269.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581269.0
get out
0 has test check 2581269.0 and sample count 3273728
 accuracy 78.848 %, best 78.922 %, roc auc score 0.8030, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 52224/306969 of epoch 4, 59.94 ms/it, loss 0.431606
Finished training it 52224/306969 of epoch 4, 59.10 ms/it, loss 0.433291
Finished training it 52224/306969 of epoch 4, 59.46 ms/it, loss 0.433025
Finished training it 52224/306969 of epoch 4, 59.66 ms/it, loss 0.435420
Finished training it 53248/306969 of epoch 4, 64.73 ms/it, loss 0.435284
Finished training it 53248/306969 of epoch 4, 63.90 ms/it, loss 0.434004
Finished training it 53248/306969 of epoch 4, 64.55 ms/it, loss 0.440790
Finished training it 53248/306969 of epoch 4, 64.33 ms/it, loss 0.430183
Finished training it 54272/306969 of epoch 4, 59.73 ms/it, loss 0.436086
Finished training it 54272/306969 of epoch 4, 59.22 ms/it, loss 0.435818
Finished training it 54272/306969 of epoch 4, 59.15 ms/it, loss 0.437769
Finished training it 54272/306969 of epoch 4, 59.24 ms/it, loss 0.430737
Finished training it 55296/306969 of epoch 4, 64.36 ms/it, loss 0.433859
Finished training it 55296/306969 of epoch 4, 64.09 ms/it, loss 0.434800
Finished training it 55296/306969 of epoch 4, 63.98 ms/it, loss 0.431350
Finished training it 55296/306969 of epoch 4, 63.85 ms/it, loss 0.433650
Finished training it 56320/306969 of epoch 4, 59.09 ms/it, loss 0.434311
Finished training it 56320/306969 of epoch 4, 58.31 ms/it, loss 0.429053
Finished training it 56320/306969 of epoch 4, 58.70 ms/it, loss 0.434045
Finished training it 56320/306969 of epoch 4, 58.59 ms/it, loss 0.433428
Finished training it 57344/306969 of epoch 4, 60.34 ms/it, loss 0.435128
Finished training it 57344/306969 of epoch 4, 59.91 ms/it, loss 0.442630
Finished training it 57344/306969 of epoch 4, 60.71 ms/it, loss 0.430791
Finished training it 57344/306969 of epoch 4, 60.29 ms/it, loss 0.435423
Finished training it 58368/306969 of epoch 4, 58.72 ms/it, loss 0.437705
Finished training it 58368/306969 of epoch 4, 58.29 ms/it, loss 0.438842
Finished training it 58368/306969 of epoch 4, 58.39 ms/it, loss 0.434461
Finished training it 58368/306969 of epoch 4, 58.34 ms/it, loss 0.436985
Finished training it 59392/306969 of epoch 4, 58.78 ms/it, loss 0.434298
Finished training it 59392/306969 of epoch 4, 58.45 ms/it, loss 0.434410
Finished training it 59392/306969 of epoch 4, 58.51 ms/it, loss 0.436576
Finished training it 59392/306969 of epoch 4, 58.45 ms/it, loss 0.435140
Finished training it 60416/306969 of epoch 4, 59.63 ms/it, loss 0.438521
Finished training it 60416/306969 of epoch 4, 59.44 ms/it, loss 0.431166
Finished training it 60416/306969 of epoch 4, 59.23 ms/it, loss 0.436020
Finished training it 60416/306969 of epoch 4, 59.34 ms/it, loss 0.434691
Finished training it 61440/306969 of epoch 4, 59.37 ms/it, loss 0.433154
Finished training it 61440/306969 of epoch 4, 58.93 ms/it, loss 0.431692
Testing at - 61440/306969 of epoch 4,
Finished training it 61440/306969 of epoch 4, 58.91 ms/it, loss 0.439226
Finished training it 61440/306969 of epoch 4, 58.94 ms/it, loss 0.437575
Testing at - 61440/306969 of epoch 4,
Testing at - 61440/306969 of epoch 4,
Testing at - 61440/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575583.0
get out
1 has test check 2575583.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575583.0
get out
2 has test check 2575583.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575583.0
get out
3 has test check 2575583.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575583.0
get out
0 has test check 2575583.0 and sample count 3273728
 accuracy 78.674 %, best 78.922 %, roc auc score 0.8029, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 62464/306969 of epoch 4, 59.27 ms/it, loss 0.436338
Finished training it 62464/306969 of epoch 4, 58.68 ms/it, loss 0.433416
Finished training it 62464/306969 of epoch 4, 59.59 ms/it, loss 0.436256
Finished training it 62464/306969 of epoch 4, 59.27 ms/it, loss 0.432629
Finished training it 63488/306969 of epoch 4, 59.56 ms/it, loss 0.434608
Finished training it 63488/306969 of epoch 4, 59.86 ms/it, loss 0.439154
Finished training it 63488/306969 of epoch 4, 59.52 ms/it, loss 0.433148
Finished training it 63488/306969 of epoch 4, 59.00 ms/it, loss 0.438744
Finished training it 64512/306969 of epoch 4, 60.62 ms/it, loss 0.434416
Finished training it 64512/306969 of epoch 4, 59.78 ms/it, loss 0.436534
Finished training it 64512/306969 of epoch 4, 60.12 ms/it, loss 0.435042
Finished training it 64512/306969 of epoch 4, 60.26 ms/it, loss 0.431579
Finished training it 65536/306969 of epoch 4, 60.53 ms/it, loss 0.430626
Finished training it 65536/306969 of epoch 4, 60.06 ms/it, loss 0.434750
Finished training it 65536/306969 of epoch 4, 60.28 ms/it, loss 0.436018
Finished training it 65536/306969 of epoch 4, 59.69 ms/it, loss 0.433983
Finished training it 66560/306969 of epoch 4, 60.05 ms/it, loss 0.437608
Finished training it 66560/306969 of epoch 4, 60.39 ms/it, loss 0.427773
Finished training it 66560/306969 of epoch 4, 59.54 ms/it, loss 0.429421
Finished training it 66560/306969 of epoch 4, 60.07 ms/it, loss 0.432711
Finished training it 67584/306969 of epoch 4, 60.79 ms/it, loss 0.433517
Finished training it 67584/306969 of epoch 4, 60.39 ms/it, loss 0.435140
Finished training it 67584/306969 of epoch 4, 59.90 ms/it, loss 0.432474
Finished training it 67584/306969 of epoch 4, 60.33 ms/it, loss 0.431893
Finished training it 68608/306969 of epoch 4, 60.07 ms/it, loss 0.439930
Finished training it 68608/306969 of epoch 4, 59.72 ms/it, loss 0.433049
Finished training it 68608/306969 of epoch 4, 59.77 ms/it, loss 0.436717
Finished training it 68608/306969 of epoch 4, 59.34 ms/it, loss 0.434500
Finished training it 69632/306969 of epoch 4, 59.67 ms/it, loss 0.426591
Finished training it 69632/306969 of epoch 4, 59.38 ms/it, loss 0.433452
Finished training it 69632/306969 of epoch 4, 59.30 ms/it, loss 0.436392
Finished training it 69632/306969 of epoch 4, 59.34 ms/it, loss 0.430390
Finished training it 70656/306969 of epoch 4, 58.75 ms/it, loss 0.437911
Finished training it 70656/306969 of epoch 4, 58.34 ms/it, loss 0.431333
Finished training it 70656/306969 of epoch 4, 58.38 ms/it, loss 0.432084
Finished training it 70656/306969 of epoch 4, 58.42 ms/it, loss 0.435186
Finished training it 71680/306969 of epoch 4, 58.96 ms/it, loss 0.433217
Finished training it 71680/306969 of epoch 4, 59.43 ms/it, loss 0.432205
Finished training it 71680/306969 of epoch 4, 58.95 ms/it, loss 0.432041
Finished training it 71680/306969 of epoch 4, 59.00 ms/it, loss 0.433237
Testing at - 71680/306969 of epoch 4,
Testing at - 71680/306969 of epoch 4,
Testing at - 71680/306969 of epoch 4,
Testing at - 71680/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579270.0
get out
1 has test check 2579270.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579270.0
get out
2 has test check 2579270.0 and sample count 3273728
rank: 3 test_accu: 2579270.0
get out
3 has test check 2579270.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2579270.0
get out
0 has test check 2579270.0 and sample count 3273728
 accuracy 78.787 %, best 78.922 %, roc auc score 0.8038, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 72704/306969 of epoch 4, 59.07 ms/it, loss 0.430235
Finished training it 72704/306969 of epoch 4, 59.20 ms/it, loss 0.439203
Finished training it 72704/306969 of epoch 4, 58.49 ms/it, loss 0.430733
Finished training it 72704/306969 of epoch 4, 58.74 ms/it, loss 0.434377
Finished training it 73728/306969 of epoch 4, 65.37 ms/it, loss 0.435387
Finished training it 73728/306969 of epoch 4, 65.08 ms/it, loss 0.440989
Finished training it 73728/306969 of epoch 4, 64.91 ms/it, loss 0.434355
Finished training it 73728/306969 of epoch 4, 64.45 ms/it, loss 0.440429
Finished training it 74752/306969 of epoch 4, 60.76 ms/it, loss 0.433314
Finished training it 74752/306969 of epoch 4, 60.21 ms/it, loss 0.433140
Finished training it 74752/306969 of epoch 4, 60.51 ms/it, loss 0.431878
Finished training it 74752/306969 of epoch 4, 59.84 ms/it, loss 0.435751
Finished training it 75776/306969 of epoch 4, 60.81 ms/it, loss 0.432556
Finished training it 75776/306969 of epoch 4, 60.48 ms/it, loss 0.434471
Finished training it 75776/306969 of epoch 4, 60.02 ms/it, loss 0.429772
Finished training it 75776/306969 of epoch 4, 60.69 ms/it, loss 0.432853
Finished training it 76800/306969 of epoch 4, 65.28 ms/it, loss 0.433752
Finished training it 76800/306969 of epoch 4, 64.46 ms/it, loss 0.429487
Finished training it 76800/306969 of epoch 4, 64.96 ms/it, loss 0.435792
Finished training it 76800/306969 of epoch 4, 65.08 ms/it, loss 0.431786
Finished training it 77824/306969 of epoch 4, 60.25 ms/it, loss 0.431916
Finished training it 77824/306969 of epoch 4, 59.90 ms/it, loss 0.437837
Finished training it 77824/306969 of epoch 4, 59.49 ms/it, loss 0.433493
Finished training it 77824/306969 of epoch 4, 60.01 ms/it, loss 0.432526
Finished training it 78848/306969 of epoch 4, 60.57 ms/it, loss 0.434981
Finished training it 78848/306969 of epoch 4, 60.23 ms/it, loss 0.432348
Finished training it 78848/306969 of epoch 4, 59.66 ms/it, loss 0.431897
Finished training it 78848/306969 of epoch 4, 60.27 ms/it, loss 0.435030
Finished training it 79872/306969 of epoch 4, 61.04 ms/it, loss 0.434003
Finished training it 79872/306969 of epoch 4, 60.62 ms/it, loss 0.430896
Finished training it 79872/306969 of epoch 4, 60.72 ms/it, loss 0.426757
Finished training it 79872/306969 of epoch 4, 60.09 ms/it, loss 0.434458
Finished training it 80896/306969 of epoch 4, 60.50 ms/it, loss 0.433610
Finished training it 80896/306969 of epoch 4, 60.14 ms/it, loss 0.429004
Finished training it 80896/306969 of epoch 4, 60.18 ms/it, loss 0.436493
Finished training it 80896/306969 of epoch 4, 59.58 ms/it, loss 0.438107
Finished training it 81920/306969 of epoch 4, 60.34 ms/it, loss 0.435319
Finished training it 81920/306969 of epoch 4, 60.28 ms/it, loss 0.432243
Finished training it 81920/306969 of epoch 4, 59.95 ms/it, loss 0.430173
Testing at - 81920/306969 of epoch 4,
Finished training it 81920/306969 of epoch 4, 60.78 ms/it, loss 0.429931
Testing at - 81920/306969 of epoch 4,
Testing at - 81920/306969 of epoch 4,
Testing at - 81920/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579360.0
get out
2 has test check 2579360.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2579360.0
get out
3 has test check 2579360.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2579360.0
get out
0 has test check 2579360.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579360.0
get out
1 has test check 2579360.0 and sample count 3273728
 accuracy 78.790 %, best 78.922 %, roc auc score 0.8017, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 82944/306969 of epoch 4, 59.35 ms/it, loss 0.435187
Finished training it 82944/306969 of epoch 4, 59.74 ms/it, loss 0.431670
Finished training it 82944/306969 of epoch 4, 59.36 ms/it, loss 0.435382
Finished training it 82944/306969 of epoch 4, 58.89 ms/it, loss 0.438601
Finished training it 83968/306969 of epoch 4, 60.75 ms/it, loss 0.430291
Finished training it 83968/306969 of epoch 4, 59.83 ms/it, loss 0.432888
Finished training it 83968/306969 of epoch 4, 60.48 ms/it, loss 0.432634
Finished training it 83968/306969 of epoch 4, 60.34 ms/it, loss 0.431774
Finished training it 84992/306969 of epoch 4, 60.28 ms/it, loss 0.432246
Finished training it 84992/306969 of epoch 4, 60.15 ms/it, loss 0.436782
Finished training it 84992/306969 of epoch 4, 59.83 ms/it, loss 0.436365
Finished training it 84992/306969 of epoch 4, 60.65 ms/it, loss 0.431919
Finished training it 86016/306969 of epoch 4, 60.31 ms/it, loss 0.425670
Finished training it 86016/306969 of epoch 4, 60.18 ms/it, loss 0.430451
Finished training it 86016/306969 of epoch 4, 59.98 ms/it, loss 0.431697
Finished training it 86016/306969 of epoch 4, 59.48 ms/it, loss 0.438751
Finished training it 87040/306969 of epoch 4, 59.80 ms/it, loss 0.433941
Finished training it 87040/306969 of epoch 4, 59.45 ms/it, loss 0.437445
Finished training it 87040/306969 of epoch 4, 58.90 ms/it, loss 0.440534
Finished training it 87040/306969 of epoch 4, 59.60 ms/it, loss 0.438359
Finished training it 88064/306969 of epoch 4, 60.94 ms/it, loss 0.430450
Finished training it 88064/306969 of epoch 4, 60.60 ms/it, loss 0.432011
Finished training it 88064/306969 of epoch 4, 60.67 ms/it, loss 0.430810
Finished training it 88064/306969 of epoch 4, 60.03 ms/it, loss 0.432511
Finished training it 89088/306969 of epoch 4, 60.21 ms/it, loss 0.435826
Finished training it 89088/306969 of epoch 4, 60.19 ms/it, loss 0.432607
Finished training it 89088/306969 of epoch 4, 60.45 ms/it, loss 0.428633
Finished training it 89088/306969 of epoch 4, 59.55 ms/it, loss 0.433364
Finished training it 90112/306969 of epoch 4, 60.52 ms/it, loss 0.430461
Finished training it 90112/306969 of epoch 4, 60.57 ms/it, loss 0.432434
Finished training it 90112/306969 of epoch 4, 59.91 ms/it, loss 0.434222
Finished training it 90112/306969 of epoch 4, 60.82 ms/it, loss 0.434147
Finished training it 91136/306969 of epoch 4, 60.48 ms/it, loss 0.436703
Finished training it 91136/306969 of epoch 4, 60.76 ms/it, loss 0.436365
Finished training it 91136/306969 of epoch 4, 60.44 ms/it, loss 0.433402
Finished training it 91136/306969 of epoch 4, 59.73 ms/it, loss 0.432170
Finished training it 92160/306969 of epoch 4, 59.42 ms/it, loss 0.438111
Testing at - 92160/306969 of epoch 4,
Finished training it 92160/306969 of epoch 4, 59.10 ms/it, loss 0.434279
Finished training it 92160/306969 of epoch 4, 59.16 ms/it, loss 0.435100
Testing at - 92160/306969 of epoch 4,
Finished training it 92160/306969 of epoch 4, 59.11 ms/it, loss 0.436545
Testing at - 92160/306969 of epoch 4,
Testing at - 92160/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581389.0
get out
1 has test check 2581389.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2581389.0
rank: 2 test_accu: 2581389.0
get out
get out
3 has test check 2581389.0 and sample count 3273728
2 has test check 2581389.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581389.0
get out
0 has test check 2581389.0 and sample count 3273728
 accuracy 78.852 %, best 78.922 %, roc auc score 0.8025, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 93184/306969 of epoch 4, 57.60 ms/it, loss 0.432908
Finished training it 93184/306969 of epoch 4, 58.31 ms/it, loss 0.433184
Finished training it 93184/306969 of epoch 4, 57.38 ms/it, loss 0.436391
Finished training it 93184/306969 of epoch 4, 58.01 ms/it, loss 0.430309
Finished training it 94208/306969 of epoch 4, 60.49 ms/it, loss 0.434471
Finished training it 94208/306969 of epoch 4, 60.86 ms/it, loss 0.439240
Finished training it 94208/306969 of epoch 4, 60.36 ms/it, loss 0.438471
Finished training it 94208/306969 of epoch 4, 60.02 ms/it, loss 0.432295
Finished training it 95232/306969 of epoch 4, 65.68 ms/it, loss 0.439888
Finished training it 95232/306969 of epoch 4, 65.44 ms/it, loss 0.434238
Finished training it 95232/306969 of epoch 4, 65.34 ms/it, loss 0.433913
Finished training it 95232/306969 of epoch 4, 64.85 ms/it, loss 0.431001
Finished training it 96256/306969 of epoch 4, 60.23 ms/it, loss 0.437576
Finished training it 96256/306969 of epoch 4, 59.36 ms/it, loss 0.434166
Finished training it 96256/306969 of epoch 4, 59.87 ms/it, loss 0.430853
Finished training it 96256/306969 of epoch 4, 59.92 ms/it, loss 0.430566
Finished training it 97280/306969 of epoch 4, 65.06 ms/it, loss 0.433558
Finished training it 97280/306969 of epoch 4, 65.33 ms/it, loss 0.434314
Finished training it 97280/306969 of epoch 4, 65.06 ms/it, loss 0.435882
Finished training it 97280/306969 of epoch 4, 64.42 ms/it, loss 0.440950
Finished training it 98304/306969 of epoch 4, 59.79 ms/it, loss 0.436235
Finished training it 98304/306969 of epoch 4, 59.03 ms/it, loss 0.434259
Finished training it 98304/306969 of epoch 4, 59.38 ms/it, loss 0.434270
Finished training it 98304/306969 of epoch 4, 59.52 ms/it, loss 0.432459
Finished training it 99328/306969 of epoch 4, 60.68 ms/it, loss 0.439033
Finished training it 99328/306969 of epoch 4, 60.39 ms/it, loss 0.431890
Finished training it 99328/306969 of epoch 4, 59.91 ms/it, loss 0.436174
Finished training it 99328/306969 of epoch 4, 60.52 ms/it, loss 0.437134
Finished training it 100352/306969 of epoch 4, 60.42 ms/it, loss 0.438413
Finished training it 100352/306969 of epoch 4, 60.61 ms/it, loss 0.431967
Finished training it 100352/306969 of epoch 4, 59.73 ms/it, loss 0.431394
Finished training it 100352/306969 of epoch 4, 60.24 ms/it, loss 0.438113
Finished training it 101376/306969 of epoch 4, 58.18 ms/it, loss 0.435280
Finished training it 101376/306969 of epoch 4, 57.75 ms/it, loss 0.437992
Finished training it 101376/306969 of epoch 4, 57.71 ms/it, loss 0.431145
Finished training it 101376/306969 of epoch 4, 57.15 ms/it, loss 0.433710
Finished training it 102400/306969 of epoch 4, 59.53 ms/it, loss 0.433929
Finished training it 102400/306969 of epoch 4, 59.78 ms/it, loss 0.435527
Testing at - 102400/306969 of epoch 4,
Finished training it 102400/306969 of epoch 4, 59.25 ms/it, loss 0.430671
Testing at - 102400/306969 of epoch 4,
Testing at - 102400/306969 of epoch 4,
Finished training it 102400/306969 of epoch 4, 59.40 ms/it, loss 0.436150
Testing at - 102400/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2581194.0
get out
3 has test check 2581194.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581194.0
get out
1 has test check 2581194.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581194.0
get out
2 has test check 2581194.0 and sample count 3273728
rank: 0 test_accu: 2581194.0
get out
0 has test check 2581194.0 and sample count 3273728
 accuracy 78.846 %, best 78.922 %, roc auc score 0.8030, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 103424/306969 of epoch 4, 59.36 ms/it, loss 0.435387
Finished training it 103424/306969 of epoch 4, 58.53 ms/it, loss 0.434927
Finished training it 103424/306969 of epoch 4, 59.05 ms/it, loss 0.433838
Finished training it 103424/306969 of epoch 4, 58.43 ms/it, loss 0.435815
Finished training it 104448/306969 of epoch 4, 60.90 ms/it, loss 0.430770
Finished training it 104448/306969 of epoch 4, 60.09 ms/it, loss 0.436982
Finished training it 104448/306969 of epoch 4, 60.44 ms/it, loss 0.428426
Finished training it 104448/306969 of epoch 4, 60.11 ms/it, loss 0.434208
Finished training it 105472/306969 of epoch 4, 59.51 ms/it, loss 0.433340
Finished training it 105472/306969 of epoch 4, 60.00 ms/it, loss 0.433150
Finished training it 105472/306969 of epoch 4, 59.75 ms/it, loss 0.435437
Finished training it 105472/306969 of epoch 4, 59.40 ms/it, loss 0.433477
Finished training it 106496/306969 of epoch 4, 59.41 ms/it, loss 0.436164
Finished training it 106496/306969 of epoch 4, 59.62 ms/it, loss 0.436094
Finished training it 106496/306969 of epoch 4, 59.36 ms/it, loss 0.438594
Finished training it 106496/306969 of epoch 4, 58.85 ms/it, loss 0.440088
Finished training it 107520/306969 of epoch 4, 59.79 ms/it, loss 0.435794
Finished training it 107520/306969 of epoch 4, 59.63 ms/it, loss 0.439185
Finished training it 107520/306969 of epoch 4, 59.91 ms/it, loss 0.432751
Finished training it 107520/306969 of epoch 4, 59.24 ms/it, loss 0.431059
Finished training it 108544/306969 of epoch 4, 60.51 ms/it, loss 0.435239
Finished training it 108544/306969 of epoch 4, 59.72 ms/it, loss 0.430267
Finished training it 108544/306969 of epoch 4, 60.18 ms/it, loss 0.435240
Finished training it 108544/306969 of epoch 4, 60.13 ms/it, loss 0.436269
Finished training it 109568/306969 of epoch 4, 61.25 ms/it, loss 0.434859
Finished training it 109568/306969 of epoch 4, 60.85 ms/it, loss 0.429525
Finished training it 109568/306969 of epoch 4, 60.78 ms/it, loss 0.431575
Finished training it 109568/306969 of epoch 4, 60.26 ms/it, loss 0.435741
Finished training it 110592/306969 of epoch 4, 61.29 ms/it, loss 0.435014
Finished training it 110592/306969 of epoch 4, 61.37 ms/it, loss 0.434133
Finished training it 110592/306969 of epoch 4, 61.68 ms/it, loss 0.430534
Finished training it 110592/306969 of epoch 4, 60.84 ms/it, loss 0.426649
Finished training it 111616/306969 of epoch 4, 60.94 ms/it, loss 0.434364
Finished training it 111616/306969 of epoch 4, 60.66 ms/it, loss 0.435412
Finished training it 111616/306969 of epoch 4, 60.02 ms/it, loss 0.435668
Finished training it 111616/306969 of epoch 4, 60.73 ms/it, loss 0.435102
Finished training it 112640/306969 of epoch 4, 60.96 ms/it, loss 0.433613
Finished training it 112640/306969 of epoch 4, 60.61 ms/it, loss 0.439464
Finished training it 112640/306969 of epoch 4, 60.55 ms/it, loss 0.436556
Testing at - 112640/306969 of epoch 4,
Testing at - 112640/306969 of epoch 4,
Testing at - 112640/306969 of epoch 4,
Finished training it 112640/306969 of epoch 4, 60.02 ms/it, loss 0.433253
Testing at - 112640/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2578779.0
get out
0 has test check 2578779.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2578779.0
get out
3 has test check 2578779.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2578779.0
get out
1 has test check 2578779.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2578779.0
get out
2 has test check 2578779.0 and sample count 3273728
 accuracy 78.772 %, best 78.922 %, roc auc score 0.8028, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 113664/306969 of epoch 4, 60.51 ms/it, loss 0.434300
Finished training it 113664/306969 of epoch 4, 59.99 ms/it, loss 0.431974
Finished training it 113664/306969 of epoch 4, 59.74 ms/it, loss 0.431131
Finished training it 113664/306969 of epoch 4, 59.60 ms/it, loss 0.434373
Finished training it 114688/306969 of epoch 4, 60.28 ms/it, loss 0.437945
Finished training it 114688/306969 of epoch 4, 59.98 ms/it, loss 0.430575
Finished training it 114688/306969 of epoch 4, 59.47 ms/it, loss 0.431871
Finished training it 114688/306969 of epoch 4, 59.98 ms/it, loss 0.434986
Finished training it 115712/306969 of epoch 4, 63.56 ms/it, loss 0.428108
Finished training it 115712/306969 of epoch 4, 63.44 ms/it, loss 0.426186
Finished training it 115712/306969 of epoch 4, 63.38 ms/it, loss 0.432197
Finished training it 115712/306969 of epoch 4, 62.76 ms/it, loss 0.434511
Finished training it 116736/306969 of epoch 4, 59.75 ms/it, loss 0.434712
Finished training it 116736/306969 of epoch 4, 59.62 ms/it, loss 0.432969
Finished training it 116736/306969 of epoch 4, 58.84 ms/it, loss 0.433733
Finished training it 116736/306969 of epoch 4, 59.49 ms/it, loss 0.435953
Finished training it 117760/306969 of epoch 4, 59.21 ms/it, loss 0.433723
Finished training it 117760/306969 of epoch 4, 59.05 ms/it, loss 0.429447
Finished training it 117760/306969 of epoch 4, 59.10 ms/it, loss 0.429319
Finished training it 117760/306969 of epoch 4, 58.79 ms/it, loss 0.427360
Finished training it 118784/306969 of epoch 4, 62.66 ms/it, loss 0.435866
Finished training it 118784/306969 of epoch 4, 62.32 ms/it, loss 0.435239
Finished training it 118784/306969 of epoch 4, 62.40 ms/it, loss 0.429582
Finished training it 118784/306969 of epoch 4, 62.41 ms/it, loss 0.430801
Finished training it 119808/306969 of epoch 4, 58.38 ms/it, loss 0.435427
Finished training it 119808/306969 of epoch 4, 58.31 ms/it, loss 0.433148
Finished training it 119808/306969 of epoch 4, 58.54 ms/it, loss 0.429410
Finished training it 119808/306969 of epoch 4, 58.34 ms/it, loss 0.428359
Finished training it 120832/306969 of epoch 4, 58.70 ms/it, loss 0.437345
Finished training it 120832/306969 of epoch 4, 58.74 ms/it, loss 0.432406
Finished training it 120832/306969 of epoch 4, 58.96 ms/it, loss 0.433988
Finished training it 120832/306969 of epoch 4, 58.77 ms/it, loss 0.430664
Finished training it 121856/306969 of epoch 4, 57.52 ms/it, loss 0.435150
Finished training it 121856/306969 of epoch 4, 57.44 ms/it, loss 0.431773
Finished training it 121856/306969 of epoch 4, 57.50 ms/it, loss 0.431764
Finished training it 121856/306969 of epoch 4, 57.65 ms/it, loss 0.436773
Finished training it 122880/306969 of epoch 4, 58.76 ms/it, loss 0.438067
Finished training it 122880/306969 of epoch 4, 58.66 ms/it, loss 0.428615
Finished training it 122880/306969 of epoch 4, 58.87 ms/it, loss 0.439824
Testing at - 122880/306969 of epoch 4,
Finished training it 122880/306969 of epoch 4, 58.59 ms/it, loss 0.428443
Testing at - 122880/306969 of epoch 4,
Testing at - 122880/306969 of epoch 4,
Testing at - 122880/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581024.0
get out
Warning: Skipping the batch 3197 with size 602
1 has test check 2581024.0 and sample count 3273728
rank: 3 test_accu: 2581024.0
get out
3 has test check 2581024.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581024.0
get out
0 has test check 2581024.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581024.0
get out
2 has test check 2581024.0 and sample count 3273728
 accuracy 78.841 %, best 78.922 %, roc auc score 0.8017, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 123904/306969 of epoch 4, 57.44 ms/it, loss 0.433415
Finished training it 123904/306969 of epoch 4, 58.11 ms/it, loss 0.434740
Finished training it 123904/306969 of epoch 4, 57.45 ms/it, loss 0.438207
Finished training it 123904/306969 of epoch 4, 57.79 ms/it, loss 0.435009
Finished training it 124928/306969 of epoch 4, 58.50 ms/it, loss 0.433604
Finished training it 124928/306969 of epoch 4, 57.93 ms/it, loss 0.431439
Finished training it 124928/306969 of epoch 4, 58.24 ms/it, loss 0.432080
Finished training it 124928/306969 of epoch 4, 58.27 ms/it, loss 0.433686
Finished training it 125952/306969 of epoch 4, 59.05 ms/it, loss 0.432233
Finished training it 125952/306969 of epoch 4, 59.00 ms/it, loss 0.429687
Finished training it 125952/306969 of epoch 4, 59.35 ms/it, loss 0.429015
Finished training it 125952/306969 of epoch 4, 58.56 ms/it, loss 0.431068
Finished training it 126976/306969 of epoch 4, 59.17 ms/it, loss 0.434560
Finished training it 126976/306969 of epoch 4, 58.66 ms/it, loss 0.441452
Finished training it 126976/306969 of epoch 4, 59.57 ms/it, loss 0.433280
Finished training it 126976/306969 of epoch 4, 59.30 ms/it, loss 0.430630
Finished training it 128000/306969 of epoch 4, 58.55 ms/it, loss 0.431558
Finished training it 128000/306969 of epoch 4, 57.94 ms/it, loss 0.433315
Finished training it 128000/306969 of epoch 4, 58.26 ms/it, loss 0.434257
Finished training it 128000/306969 of epoch 4, 58.03 ms/it, loss 0.434965
Finished training it 129024/306969 of epoch 4, 57.42 ms/it, loss 0.432667
Finished training it 129024/306969 of epoch 4, 57.15 ms/it, loss 0.436218
Finished training it 129024/306969 of epoch 4, 57.23 ms/it, loss 0.439557
Finished training it 129024/306969 of epoch 4, 57.14 ms/it, loss 0.435589
Finished training it 130048/306969 of epoch 4, 57.44 ms/it, loss 0.435723
Finished training it 130048/306969 of epoch 4, 57.45 ms/it, loss 0.438841
Finished training it 130048/306969 of epoch 4, 57.71 ms/it, loss 0.434355
Finished training it 130048/306969 of epoch 4, 57.48 ms/it, loss 0.428738
Finished training it 131072/306969 of epoch 4, 55.58 ms/it, loss 0.436156
Finished training it 131072/306969 of epoch 4, 55.68 ms/it, loss 0.435558
Finished training it 131072/306969 of epoch 4, 55.58 ms/it, loss 0.434910
Finished training it 131072/306969 of epoch 4, 55.84 ms/it, loss 0.437224
Finished training it 132096/306969 of epoch 4, 55.57 ms/it, loss 0.430985
Finished training it 132096/306969 of epoch 4, 55.77 ms/it, loss 0.433828
Finished training it 132096/306969 of epoch 4, 55.94 ms/it, loss 0.436100
Finished training it 132096/306969 of epoch 4, 55.67 ms/it, loss 0.432577
Finished training it 133120/306969 of epoch 4, 52.39 ms/it, loss 0.435043
Finished training it 133120/306969 of epoch 4, 52.41 ms/it, loss 0.435760
Finished training it 133120/306969 of epoch 4, 52.33 ms/it, loss 0.432686
Finished training it 133120/306969 of epoch 4, 52.32 ms/it, loss 0.436949
Testing at - 133120/306969 of epoch 4,
Testing at - 133120/306969 of epoch 4,
Testing at - 133120/306969 of epoch 4,
Testing at - 133120/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573260.0
get out
3 has test check 2573260.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573260.0
get out
0 has test check 2573260.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573260.0
get out
1 has test check 2573260.0 and sample count 3273728
rank: 2 test_accu: 2573260.0
get out
2 has test check 2573260.0 and sample count 3273728
 accuracy 78.603 %, best 78.922 %, roc auc score 0.8024, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 134144/306969 of epoch 4, 54.33 ms/it, loss 0.433004
Finished training it 134144/306969 of epoch 4, 54.17 ms/it, loss 0.427094
Finished training it 134144/306969 of epoch 4, 54.36 ms/it, loss 0.431888
Finished training it 134144/306969 of epoch 4, 53.92 ms/it, loss 0.436508
Finished training it 135168/306969 of epoch 4, 50.19 ms/it, loss 0.435940
Finished training it 135168/306969 of epoch 4, 50.13 ms/it, loss 0.434300
Finished training it 135168/306969 of epoch 4, 50.14 ms/it, loss 0.426490
Finished training it 135168/306969 of epoch 4, 50.01 ms/it, loss 0.425953
Finished training it 136192/306969 of epoch 4, 49.80 ms/it, loss 0.437372
Finished training it 136192/306969 of epoch 4, 49.79 ms/it, loss 0.432518
Finished training it 136192/306969 of epoch 4, 49.74 ms/it, loss 0.432155
Finished training it 136192/306969 of epoch 4, 49.82 ms/it, loss 0.428392
Finished training it 137216/306969 of epoch 4, 53.90 ms/it, loss 0.435176
Finished training it 137216/306969 of epoch 4, 53.76 ms/it, loss 0.427977
Finished training it 137216/306969 of epoch 4, 53.91 ms/it, loss 0.433833
Finished training it 137216/306969 of epoch 4, 53.86 ms/it, loss 0.437765
Finished training it 138240/306969 of epoch 4, 49.43 ms/it, loss 0.431889
Finished training it 138240/306969 of epoch 4, 49.50 ms/it, loss 0.435707
Finished training it 138240/306969 of epoch 4, 49.41 ms/it, loss 0.432913
Finished training it 138240/306969 of epoch 4, 49.40 ms/it, loss 0.432135
Finished training it 139264/306969 of epoch 4, 52.53 ms/it, loss 0.432934
Finished training it 139264/306969 of epoch 4, 52.52 ms/it, loss 0.436948
Finished training it 139264/306969 of epoch 4, 52.49 ms/it, loss 0.434275
Finished training it 139264/306969 of epoch 4, 52.53 ms/it, loss 0.432032
Finished training it 140288/306969 of epoch 4, 48.92 ms/it, loss 0.429878
Finished training it 140288/306969 of epoch 4, 48.93 ms/it, loss 0.429551
Finished training it 140288/306969 of epoch 4, 48.97 ms/it, loss 0.431346
Finished training it 140288/306969 of epoch 4, 48.91 ms/it, loss 0.431302
Finished training it 141312/306969 of epoch 4, 49.13 ms/it, loss 0.431892
Finished training it 141312/306969 of epoch 4, 49.08 ms/it, loss 0.436610
Finished training it 141312/306969 of epoch 4, 49.10 ms/it, loss 0.435432
Finished training it 141312/306969 of epoch 4, 49.13 ms/it, loss 0.436110
Finished training it 142336/306969 of epoch 4, 49.19 ms/it, loss 0.430796
Finished training it 142336/306969 of epoch 4, 49.20 ms/it, loss 0.428584
Finished training it 142336/306969 of epoch 4, 49.23 ms/it, loss 0.435917
Finished training it 142336/306969 of epoch 4, 49.21 ms/it, loss 0.433859
Finished training it 143360/306969 of epoch 4, 48.67 ms/it, loss 0.429612
Finished training it 143360/306969 of epoch 4, 48.68 ms/it, loss 0.437216
Finished training it 143360/306969 of epoch 4, 48.72 ms/it, loss 0.431140
Testing at - 143360/306969 of epoch 4,
Finished training it 143360/306969 of epoch 4, 48.74 ms/it, loss 0.431826
Testing at - 143360/306969 of epoch 4,
Testing at - 143360/306969 of epoch 4,
Testing at - 143360/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2581091.0
get out
3 has test check 2581091.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581091.0
get out
1 has test check 2581091.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581091.0
get out
2 has test check 2581091.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581091.0
get out
0 has test check 2581091.0 and sample count 3273728
 accuracy 78.843 %, best 78.922 %, roc auc score 0.8026, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 144384/306969 of epoch 4, 49.37 ms/it, loss 0.435915
Finished training it 144384/306969 of epoch 4, 49.37 ms/it, loss 0.433395
Finished training it 144384/306969 of epoch 4, 49.40 ms/it, loss 0.434226
Finished training it 144384/306969 of epoch 4, 49.16 ms/it, loss 0.434331
Finished training it 145408/306969 of epoch 4, 50.05 ms/it, loss 0.432003
Finished training it 145408/306969 of epoch 4, 50.06 ms/it, loss 0.427372
Finished training it 145408/306969 of epoch 4, 49.98 ms/it, loss 0.433881
Finished training it 145408/306969 of epoch 4, 49.96 ms/it, loss 0.435367
Finished training it 146432/306969 of epoch 4, 49.68 ms/it, loss 0.441531
Finished training it 146432/306969 of epoch 4, 49.72 ms/it, loss 0.437350
Finished training it 146432/306969 of epoch 4, 49.74 ms/it, loss 0.433028
Finished training it 146432/306969 of epoch 4, 49.73 ms/it, loss 0.439886
Finished training it 147456/306969 of epoch 4, 49.49 ms/it, loss 0.429789
Finished training it 147456/306969 of epoch 4, 49.52 ms/it, loss 0.432094
Finished training it 147456/306969 of epoch 4, 49.56 ms/it, loss 0.433932
Finished training it 147456/306969 of epoch 4, 49.46 ms/it, loss 0.433768
Finished training it 148480/306969 of epoch 4, 49.52 ms/it, loss 0.431265
Finished training it 148480/306969 of epoch 4, 49.53 ms/it, loss 0.431194
Finished training it 148480/306969 of epoch 4, 49.59 ms/it, loss 0.435032
Finished training it 148480/306969 of epoch 4, 49.58 ms/it, loss 0.432968
Finished training it 149504/306969 of epoch 4, 48.99 ms/it, loss 0.429812
Finished training it 149504/306969 of epoch 4, 49.03 ms/it, loss 0.431862
Finished training it 149504/306969 of epoch 4, 49.02 ms/it, loss 0.430841
Finished training it 149504/306969 of epoch 4, 49.01 ms/it, loss 0.434246
Finished training it 150528/306969 of epoch 4, 49.22 ms/it, loss 0.429978
Finished training it 150528/306969 of epoch 4, 49.17 ms/it, loss 0.437498
Finished training it 150528/306969 of epoch 4, 49.21 ms/it, loss 0.432786
Finished training it 150528/306969 of epoch 4, 49.25 ms/it, loss 0.424325
Finished training it 151552/306969 of epoch 4, 48.81 ms/it, loss 0.431414
Finished training it 151552/306969 of epoch 4, 48.79 ms/it, loss 0.429053
Finished training it 151552/306969 of epoch 4, 48.79 ms/it, loss 0.424529
Finished training it 151552/306969 of epoch 4, 48.80 ms/it, loss 0.436130
Finished training it 152576/306969 of epoch 4, 49.75 ms/it, loss 0.432572
Finished training it 152576/306969 of epoch 4, 49.80 ms/it, loss 0.434423
Finished training it 152576/306969 of epoch 4, 49.78 ms/it, loss 0.432757
Finished training it 152576/306969 of epoch 4, 49.77 ms/it, loss 0.434815
Finished training it 153600/306969 of epoch 4, 49.40 ms/it, loss 0.429800
Finished training it 153600/306969 of epoch 4, 49.43 ms/it, loss 0.428197
Finished training it 153600/306969 of epoch 4, 49.49 ms/it, loss 0.432800
Testing at - 153600/306969 of epoch 4,
Finished training it 153600/306969 of epoch 4, 49.45 ms/it, loss 0.429675
Testing at - 153600/306969 of epoch 4,
Testing at - 153600/306969 of epoch 4,
Testing at - 153600/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2578797.0
get out
1 has test check 2578797.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2578797.0
get out
0 has test check 2578797.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2578797.0
get out
3 has test check 2578797.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2578797.0
get out
2 has test check 2578797.0 and sample count 3273728
 accuracy 78.772 %, best 78.922 %, roc auc score 0.8018, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 154624/306969 of epoch 4, 52.31 ms/it, loss 0.431441
Finished training it 154624/306969 of epoch 4, 52.34 ms/it, loss 0.434096
Finished training it 154624/306969 of epoch 4, 52.01 ms/it, loss 0.433646
Finished training it 154624/306969 of epoch 4, 52.33 ms/it, loss 0.430202
Finished training it 155648/306969 of epoch 4, 49.86 ms/it, loss 0.428095
Finished training it 155648/306969 of epoch 4, 49.75 ms/it, loss 0.435008
Finished training it 155648/306969 of epoch 4, 49.82 ms/it, loss 0.429056
Finished training it 155648/306969 of epoch 4, 49.89 ms/it, loss 0.427699
Finished training it 156672/306969 of epoch 4, 49.66 ms/it, loss 0.431874
Finished training it 156672/306969 of epoch 4, 49.60 ms/it, loss 0.436996
Finished training it 156672/306969 of epoch 4, 49.73 ms/it, loss 0.428416
Finished training it 156672/306969 of epoch 4, 49.76 ms/it, loss 0.430637
Finished training it 157696/306969 of epoch 4, 53.53 ms/it, loss 0.434054
Finished training it 157696/306969 of epoch 4, 53.58 ms/it, loss 0.428064
Finished training it 157696/306969 of epoch 4, 53.58 ms/it, loss 0.432560
Finished training it 157696/306969 of epoch 4, 53.35 ms/it, loss 0.430764
Finished training it 158720/306969 of epoch 4, 49.47 ms/it, loss 0.433296
Finished training it 158720/306969 of epoch 4, 49.47 ms/it, loss 0.433637
Finished training it 158720/306969 of epoch 4, 49.39 ms/it, loss 0.434786
Finished training it 158720/306969 of epoch 4, 49.52 ms/it, loss 0.436930
Finished training it 159744/306969 of epoch 4, 48.69 ms/it, loss 0.433032
Finished training it 159744/306969 of epoch 4, 48.68 ms/it, loss 0.434270
Finished training it 159744/306969 of epoch 4, 48.64 ms/it, loss 0.435148
Finished training it 159744/306969 of epoch 4, 48.68 ms/it, loss 0.434855
Finished training it 160768/306969 of epoch 4, 52.36 ms/it, loss 0.431400
Finished training it 160768/306969 of epoch 4, 52.36 ms/it, loss 0.431625
Finished training it 160768/306969 of epoch 4, 52.28 ms/it, loss 0.434909
Finished training it 160768/306969 of epoch 4, 52.33 ms/it, loss 0.435783
Finished training it 161792/306969 of epoch 4, 49.86 ms/it, loss 0.432078
Finished training it 161792/306969 of epoch 4, 49.81 ms/it, loss 0.428928
Finished training it 161792/306969 of epoch 4, 49.78 ms/it, loss 0.432421
Finished training it 161792/306969 of epoch 4, 49.79 ms/it, loss 0.429558
Finished training it 162816/306969 of epoch 4, 49.13 ms/it, loss 0.427490
Finished training it 162816/306969 of epoch 4, 49.27 ms/it, loss 0.432556
Finished training it 162816/306969 of epoch 4, 49.30 ms/it, loss 0.430738
Finished training it 162816/306969 of epoch 4, 49.24 ms/it, loss 0.429417
Finished training it 163840/306969 of epoch 4, 48.70 ms/it, loss 0.436328
Finished training it 163840/306969 of epoch 4, 48.76 ms/it, loss 0.431764
Finished training it 163840/306969 of epoch 4, 48.83 ms/it, loss 0.431193
Finished training it 163840/306969 of epoch 4, 48.76 ms/it, loss 0.434186
Testing at - 163840/306969 of epoch 4,
Testing at - 163840/306969 of epoch 4,
Testing at - 163840/306969 of epoch 4,
Testing at - 163840/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576381.0
get out
1 has test check 2576381.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576381.0
get out
3 has test check 2576381.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576381.0
rank: 0 test_accu: 2576381.0
get out
get out
2 has test check 2576381.0 and sample count 3273728
0 has test check 2576381.0 and sample count 3273728
 accuracy 78.699 %, best 78.922 %, roc auc score 0.8015, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 164864/306969 of epoch 4, 49.08 ms/it, loss 0.432155
Finished training it 164864/306969 of epoch 4, 49.10 ms/it, loss 0.432061
Finished training it 164864/306969 of epoch 4, 49.07 ms/it, loss 0.434596
Finished training it 164864/306969 of epoch 4, 49.09 ms/it, loss 0.433393
Finished training it 165888/306969 of epoch 4, 50.47 ms/it, loss 0.435174
Finished training it 165888/306969 of epoch 4, 50.27 ms/it, loss 0.434706
Finished training it 165888/306969 of epoch 4, 50.45 ms/it, loss 0.430594
Finished training it 165888/306969 of epoch 4, 50.41 ms/it, loss 0.429957
Finished training it 166912/306969 of epoch 4, 49.29 ms/it, loss 0.432286
Finished training it 166912/306969 of epoch 4, 49.23 ms/it, loss 0.429387
Finished training it 166912/306969 of epoch 4, 49.23 ms/it, loss 0.430566
Finished training it 166912/306969 of epoch 4, 49.24 ms/it, loss 0.436723
Finished training it 167936/306969 of epoch 4, 48.97 ms/it, loss 0.428716
Finished training it 167936/306969 of epoch 4, 49.04 ms/it, loss 0.432787
Finished training it 167936/306969 of epoch 4, 49.03 ms/it, loss 0.437599
Finished training it 167936/306969 of epoch 4, 49.01 ms/it, loss 0.432602
Finished training it 168960/306969 of epoch 4, 49.37 ms/it, loss 0.426120
Finished training it 168960/306969 of epoch 4, 49.40 ms/it, loss 0.434469
Finished training it 168960/306969 of epoch 4, 49.37 ms/it, loss 0.438844
Finished training it 168960/306969 of epoch 4, 49.35 ms/it, loss 0.430607
Finished training it 169984/306969 of epoch 4, 50.08 ms/it, loss 0.427819
Finished training it 169984/306969 of epoch 4, 50.07 ms/it, loss 0.431878
Finished training it 169984/306969 of epoch 4, 50.04 ms/it, loss 0.429949
Finished training it 169984/306969 of epoch 4, 50.07 ms/it, loss 0.431809
Finished training it 171008/306969 of epoch 4, 49.63 ms/it, loss 0.431956
Finished training it 171008/306969 of epoch 4, 49.69 ms/it, loss 0.428624
Finished training it 171008/306969 of epoch 4, 49.66 ms/it, loss 0.437649
Finished training it 171008/306969 of epoch 4, 49.63 ms/it, loss 0.429616
Finished training it 172032/306969 of epoch 4, 49.57 ms/it, loss 0.434417
Finished training it 172032/306969 of epoch 4, 49.65 ms/it, loss 0.432603
Finished training it 172032/306969 of epoch 4, 49.54 ms/it, loss 0.435121
Finished training it 172032/306969 of epoch 4, 49.57 ms/it, loss 0.435387
Finished training it 173056/306969 of epoch 4, 50.13 ms/it, loss 0.437118
Finished training it 173056/306969 of epoch 4, 50.16 ms/it, loss 0.429932
Finished training it 173056/306969 of epoch 4, 50.12 ms/it, loss 0.426021
Finished training it 173056/306969 of epoch 4, 50.20 ms/it, loss 0.433331
Finished training it 174080/306969 of epoch 4, 49.39 ms/it, loss 0.437535
Finished training it 174080/306969 of epoch 4, 49.43 ms/it, loss 0.429553
Finished training it 174080/306969 of epoch 4, 49.48 ms/it, loss 0.425199
Testing at - 174080/306969 of epoch 4,
Testing at - 174080/306969 of epoch 4,
Finished training it 174080/306969 of epoch 4, 49.45 ms/it, loss 0.431683
Testing at - 174080/306969 of epoch 4,
Testing at - 174080/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580678.0
get out
0 has test check 2580678.0 and sample count 3273728
rank: 2 test_accu: 2580678.0
get out
2 has test check 2580678.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2580678.0
get out
3 has test check 2580678.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2580678.0
get out
1 has test check 2580678.0 and sample count 3273728
 accuracy 78.830 %, best 78.922 %, roc auc score 0.8027, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 175104/306969 of epoch 4, 52.05 ms/it, loss 0.431799
Finished training it 175104/306969 of epoch 4, 52.12 ms/it, loss 0.430635
Finished training it 175104/306969 of epoch 4, 52.06 ms/it, loss 0.426613
Finished training it 175104/306969 of epoch 4, 52.09 ms/it, loss 0.434678
Finished training it 176128/306969 of epoch 4, 49.02 ms/it, loss 0.434814
Finished training it 176128/306969 of epoch 4, 49.05 ms/it, loss 0.431617
Finished training it 176128/306969 of epoch 4, 49.04 ms/it, loss 0.433491
Finished training it 176128/306969 of epoch 4, 49.09 ms/it, loss 0.428940
Finished training it 177152/306969 of epoch 4, 49.26 ms/it, loss 0.428778
Finished training it 177152/306969 of epoch 4, 49.23 ms/it, loss 0.429024
Finished training it 177152/306969 of epoch 4, 49.27 ms/it, loss 0.430184
Finished training it 177152/306969 of epoch 4, 49.24 ms/it, loss 0.435709
Finished training it 178176/306969 of epoch 4, 50.32 ms/it, loss 0.432367
Finished training it 178176/306969 of epoch 4, 50.18 ms/it, loss 0.433536
Finished training it 178176/306969 of epoch 4, 50.27 ms/it, loss 0.429332
Finished training it 178176/306969 of epoch 4, 50.31 ms/it, loss 0.434489
Finished training it 179200/306969 of epoch 4, 52.08 ms/it, loss 0.432111
Finished training it 179200/306969 of epoch 4, 52.10 ms/it, loss 0.436550
Finished training it 179200/306969 of epoch 4, 52.05 ms/it, loss 0.428859
Finished training it 179200/306969 of epoch 4, 52.11 ms/it, loss 0.432685
Finished training it 180224/306969 of epoch 4, 49.17 ms/it, loss 0.431913
Finished training it 180224/306969 of epoch 4, 49.17 ms/it, loss 0.433588
Finished training it 180224/306969 of epoch 4, 49.16 ms/it, loss 0.431785
Finished training it 180224/306969 of epoch 4, 49.12 ms/it, loss 0.432984
Finished training it 181248/306969 of epoch 4, 52.18 ms/it, loss 0.434476
Finished training it 181248/306969 of epoch 4, 52.12 ms/it, loss 0.426164
Finished training it 181248/306969 of epoch 4, 52.05 ms/it, loss 0.435384
Finished training it 181248/306969 of epoch 4, 52.11 ms/it, loss 0.431120
Finished training it 182272/306969 of epoch 4, 48.77 ms/it, loss 0.428864
Finished training it 182272/306969 of epoch 4, 48.79 ms/it, loss 0.436114
Finished training it 182272/306969 of epoch 4, 48.73 ms/it, loss 0.430756
Finished training it 182272/306969 of epoch 4, 48.78 ms/it, loss 0.432207
Finished training it 183296/306969 of epoch 4, 48.90 ms/it, loss 0.432849
Finished training it 183296/306969 of epoch 4, 48.90 ms/it, loss 0.436650
Finished training it 183296/306969 of epoch 4, 48.91 ms/it, loss 0.431728
Finished training it 183296/306969 of epoch 4, 48.98 ms/it, loss 0.432968
Finished training it 184320/306969 of epoch 4, 49.52 ms/it, loss 0.433542
Finished training it 184320/306969 of epoch 4, 49.44 ms/it, loss 0.431214
Finished training it 184320/306969 of epoch 4, 49.42 ms/it, loss 0.436684
Testing at - 184320/306969 of epoch 4,
Testing at - 184320/306969 of epoch 4,
Finished training it 184320/306969 of epoch 4, 49.49 ms/it, loss 0.430122
Testing at - 184320/306969 of epoch 4,
Testing at - 184320/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580760.0
get out
0 has test check 2580760.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2580760.0
get out
1 has test check 2580760.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2580760.0
get out
3 has test check 2580760.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580760.0
get out
2 has test check 2580760.0 and sample count 3273728
 accuracy 78.832 %, best 78.922 %, roc auc score 0.8017, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 185344/306969 of epoch 4, 49.02 ms/it, loss 0.437291
Finished training it 185344/306969 of epoch 4, 49.03 ms/it, loss 0.422231
Finished training it 185344/306969 of epoch 4, 49.03 ms/it, loss 0.429021
Finished training it 185344/306969 of epoch 4, 49.06 ms/it, loss 0.429733
Finished training it 186368/306969 of epoch 4, 49.25 ms/it, loss 0.428441
Finished training it 186368/306969 of epoch 4, 49.44 ms/it, loss 0.436089
Finished training it 186368/306969 of epoch 4, 49.38 ms/it, loss 0.434386
Finished training it 186368/306969 of epoch 4, 49.43 ms/it, loss 0.431293
Finished training it 187392/306969 of epoch 4, 49.09 ms/it, loss 0.429358
Finished training it 187392/306969 of epoch 4, 49.07 ms/it, loss 0.428086
Finished training it 187392/306969 of epoch 4, 49.11 ms/it, loss 0.429923
Finished training it 187392/306969 of epoch 4, 49.13 ms/it, loss 0.435666
Finished training it 188416/306969 of epoch 4, 48.56 ms/it, loss 0.431845
Finished training it 188416/306969 of epoch 4, 48.62 ms/it, loss 0.435365
Finished training it 188416/306969 of epoch 4, 48.58 ms/it, loss 0.432252
Finished training it 188416/306969 of epoch 4, 48.59 ms/it, loss 0.429960
Finished training it 189440/306969 of epoch 4, 49.94 ms/it, loss 0.428520
Finished training it 189440/306969 of epoch 4, 49.89 ms/it, loss 0.433879
Finished training it 189440/306969 of epoch 4, 49.87 ms/it, loss 0.431398
Finished training it 189440/306969 of epoch 4, 49.95 ms/it, loss 0.434845
Finished training it 190464/306969 of epoch 4, 49.61 ms/it, loss 0.437637
Finished training it 190464/306969 of epoch 4, 49.62 ms/it, loss 0.431681
Finished training it 190464/306969 of epoch 4, 49.52 ms/it, loss 0.430703
Finished training it 190464/306969 of epoch 4, 49.49 ms/it, loss 0.434032
Finished training it 191488/306969 of epoch 4, 48.79 ms/it, loss 0.427904
Finished training it 191488/306969 of epoch 4, 48.79 ms/it, loss 0.432615
Finished training it 191488/306969 of epoch 4, 48.79 ms/it, loss 0.430559
Finished training it 191488/306969 of epoch 4, 48.82 ms/it, loss 0.430835
Finished training it 192512/306969 of epoch 4, 49.08 ms/it, loss 0.433620
Finished training it 192512/306969 of epoch 4, 49.12 ms/it, loss 0.436755
Finished training it 192512/306969 of epoch 4, 49.10 ms/it, loss 0.431005
Finished training it 192512/306969 of epoch 4, 49.07 ms/it, loss 0.434462
Finished training it 193536/306969 of epoch 4, 49.28 ms/it, loss 0.430125
Finished training it 193536/306969 of epoch 4, 49.21 ms/it, loss 0.436712
Finished training it 193536/306969 of epoch 4, 49.26 ms/it, loss 0.431265
Finished training it 193536/306969 of epoch 4, 49.26 ms/it, loss 0.434597
Finished training it 194560/306969 of epoch 4, 49.48 ms/it, loss 0.429279
Finished training it 194560/306969 of epoch 4, 49.52 ms/it, loss 0.427667
Finished training it 194560/306969 of epoch 4, 49.54 ms/it, loss 0.434167
Finished training it 194560/306969 of epoch 4, 49.47 ms/it, loss 0.435711
Testing at - 194560/306969 of epoch 4,
Testing at - 194560/306969 of epoch 4,
Testing at - 194560/306969 of epoch 4,
Testing at - 194560/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576809.0
get out
3 has test check 2576809.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576809.0
get out
1 has test check 2576809.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576809.0
get out
0 has test check 2576809.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576809.0
get out
2 has test check 2576809.0 and sample count 3273728
 accuracy 78.712 %, best 78.922 %, roc auc score 0.8016, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 195584/306969 of epoch 4, 52.25 ms/it, loss 0.427534
Finished training it 195584/306969 of epoch 4, 52.25 ms/it, loss 0.435530
Finished training it 195584/306969 of epoch 4, 52.27 ms/it, loss 0.429224
Finished training it 195584/306969 of epoch 4, 52.30 ms/it, loss 0.430255
Finished training it 196608/306969 of epoch 4, 49.44 ms/it, loss 0.432398
Finished training it 196608/306969 of epoch 4, 49.39 ms/it, loss 0.432813
Finished training it 196608/306969 of epoch 4, 49.40 ms/it, loss 0.436484
Finished training it 196608/306969 of epoch 4, 49.43 ms/it, loss 0.434280
Finished training it 197632/306969 of epoch 4, 48.92 ms/it, loss 0.433057
Finished training it 197632/306969 of epoch 4, 48.93 ms/it, loss 0.432848
Finished training it 197632/306969 of epoch 4, 48.96 ms/it, loss 0.430899
Finished training it 197632/306969 of epoch 4, 48.95 ms/it, loss 0.433172
Finished training it 198656/306969 of epoch 4, 49.18 ms/it, loss 0.430163
Finished training it 198656/306969 of epoch 4, 49.22 ms/it, loss 0.434263
Finished training it 198656/306969 of epoch 4, 49.23 ms/it, loss 0.433518
Finished training it 198656/306969 of epoch 4, 49.26 ms/it, loss 0.431189
Finished training it 199680/306969 of epoch 4, 52.71 ms/it, loss 0.430429
Finished training it 199680/306969 of epoch 4, 52.87 ms/it, loss 0.430609
Finished training it 199680/306969 of epoch 4, 52.86 ms/it, loss 0.438145
Finished training it 199680/306969 of epoch 4, 52.82 ms/it, loss 0.435854
Finished training it 200704/306969 of epoch 4, 49.84 ms/it, loss 0.428751
Finished training it 200704/306969 of epoch 4, 49.74 ms/it, loss 0.426481
Finished training it 200704/306969 of epoch 4, 49.80 ms/it, loss 0.428369
Finished training it 200704/306969 of epoch 4, 49.89 ms/it, loss 0.434300
Finished training it 201728/306969 of epoch 4, 49.02 ms/it, loss 0.430468
Finished training it 201728/306969 of epoch 4, 48.97 ms/it, loss 0.431638
Finished training it 201728/306969 of epoch 4, 48.97 ms/it, loss 0.432625
Finished training it 201728/306969 of epoch 4, 48.95 ms/it, loss 0.435524
Finished training it 202752/306969 of epoch 4, 52.28 ms/it, loss 0.436597
Finished training it 202752/306969 of epoch 4, 52.25 ms/it, loss 0.431530
Finished training it 202752/306969 of epoch 4, 52.29 ms/it, loss 0.436339
Finished training it 202752/306969 of epoch 4, 52.26 ms/it, loss 0.430624
Finished training it 203776/306969 of epoch 4, 49.10 ms/it, loss 0.434866
Finished training it 203776/306969 of epoch 4, 49.11 ms/it, loss 0.437914
Finished training it 203776/306969 of epoch 4, 49.13 ms/it, loss 0.428908
Finished training it 203776/306969 of epoch 4, 49.11 ms/it, loss 0.429917
Finished training it 204800/306969 of epoch 4, 48.94 ms/it, loss 0.434302
Finished training it 204800/306969 of epoch 4, 48.96 ms/it, loss 0.429618
Finished training it 204800/306969 of epoch 4, 49.02 ms/it, loss 0.430588
Finished training it 204800/306969 of epoch 4, 48.88 ms/it, loss 0.431943
Testing at - 204800/306969 of epoch 4,
Testing at - 204800/306969 of epoch 4,
Testing at - 204800/306969 of epoch 4,
Testing at - 204800/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576969.0
get out
0 has test check 2576969.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576969.0
get out
3 has test check 2576969.0 and sample count 3273728
rank: 1 test_accu: 2576969.0
get out
1 has test check 2576969.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576969.0
get out
2 has test check 2576969.0 and sample count 3273728
 accuracy 78.717 %, best 78.922 %, roc auc score 0.8030, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 205824/306969 of epoch 4, 48.92 ms/it, loss 0.432538
Finished training it 205824/306969 of epoch 4, 48.90 ms/it, loss 0.431949
Finished training it 205824/306969 of epoch 4, 48.96 ms/it, loss 0.432308
Finished training it 205824/306969 of epoch 4, 48.95 ms/it, loss 0.432164
Finished training it 206848/306969 of epoch 4, 48.37 ms/it, loss 0.429665
Finished training it 206848/306969 of epoch 4, 48.35 ms/it, loss 0.431675
Finished training it 206848/306969 of epoch 4, 48.39 ms/it, loss 0.429969
Finished training it 206848/306969 of epoch 4, 48.33 ms/it, loss 0.431455
Finished training it 207872/306969 of epoch 4, 48.53 ms/it, loss 0.434811
Finished training it 207872/306969 of epoch 4, 48.57 ms/it, loss 0.430903
Finished training it 207872/306969 of epoch 4, 48.50 ms/it, loss 0.426137
Finished training it 207872/306969 of epoch 4, 48.49 ms/it, loss 0.427980
Finished training it 208896/306969 of epoch 4, 49.03 ms/it, loss 0.436759
Finished training it 208896/306969 of epoch 4, 48.94 ms/it, loss 0.432487
Finished training it 208896/306969 of epoch 4, 48.89 ms/it, loss 0.430125
Finished training it 208896/306969 of epoch 4, 48.92 ms/it, loss 0.429572
Finished training it 209920/306969 of epoch 4, 48.84 ms/it, loss 0.434363
Finished training it 209920/306969 of epoch 4, 48.78 ms/it, loss 0.438033
Finished training it 209920/306969 of epoch 4, 48.81 ms/it, loss 0.435490
Finished training it 209920/306969 of epoch 4, 48.77 ms/it, loss 0.429629
Finished training it 210944/306969 of epoch 4, 49.29 ms/it, loss 0.428657
Finished training it 210944/306969 of epoch 4, 49.30 ms/it, loss 0.432285
Finished training it 210944/306969 of epoch 4, 49.19 ms/it, loss 0.438976
Finished training it 210944/306969 of epoch 4, 49.28 ms/it, loss 0.428938
Finished training it 211968/306969 of epoch 4, 49.26 ms/it, loss 0.433084
Finished training it 211968/306969 of epoch 4, 49.25 ms/it, loss 0.432295
Finished training it 211968/306969 of epoch 4, 49.27 ms/it, loss 0.429693
Finished training it 211968/306969 of epoch 4, 49.28 ms/it, loss 0.431338
Finished training it 212992/306969 of epoch 4, 48.87 ms/it, loss 0.432419
Finished training it 212992/306969 of epoch 4, 48.92 ms/it, loss 0.426722
Finished training it 212992/306969 of epoch 4, 48.91 ms/it, loss 0.427485
Finished training it 212992/306969 of epoch 4, 48.92 ms/it, loss 0.431458
Finished training it 214016/306969 of epoch 4, 49.22 ms/it, loss 0.434735
Finished training it 214016/306969 of epoch 4, 49.10 ms/it, loss 0.435051
Finished training it 214016/306969 of epoch 4, 49.09 ms/it, loss 0.431818
Finished training it 214016/306969 of epoch 4, 49.17 ms/it, loss 0.436163
Finished training it 215040/306969 of epoch 4, 48.88 ms/it, loss 0.429295
Finished training it 215040/306969 of epoch 4, 48.81 ms/it, loss 0.436132
Finished training it 215040/306969 of epoch 4, 48.84 ms/it, loss 0.434915
Finished training it 215040/306969 of epoch 4, 48.81 ms/it, loss 0.429252
Testing at - 215040/306969 of epoch 4,
Testing at - 215040/306969 of epoch 4,
Testing at - 215040/306969 of epoch 4,
Testing at - 215040/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2578933.0
get out
1 has test check 2578933.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2578933.0
get out
0 has test check 2578933.0 and sample count 3273728
rank: 3 test_accu: 2578933.0
get out
3 has test check 2578933.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2578933.0
get out
2 has test check 2578933.0 and sample count 3273728
 accuracy 78.777 %, best 78.922 %, roc auc score 0.8028, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 216064/306969 of epoch 4, 52.85 ms/it, loss 0.427926
Finished training it 216064/306969 of epoch 4, 52.93 ms/it, loss 0.433425
Finished training it 216064/306969 of epoch 4, 52.89 ms/it, loss 0.434379
Finished training it 216064/306969 of epoch 4, 52.82 ms/it, loss 0.428229
Finished training it 217088/306969 of epoch 4, 49.23 ms/it, loss 0.432437
Finished training it 217088/306969 of epoch 4, 49.20 ms/it, loss 0.427399
Finished training it 217088/306969 of epoch 4, 49.22 ms/it, loss 0.431319
Finished training it 217088/306969 of epoch 4, 49.19 ms/it, loss 0.430346
Finished training it 218112/306969 of epoch 4, 49.79 ms/it, loss 0.437362
Finished training it 218112/306969 of epoch 4, 49.84 ms/it, loss 0.431123
Finished training it 218112/306969 of epoch 4, 49.75 ms/it, loss 0.434261
Finished training it 218112/306969 of epoch 4, 49.77 ms/it, loss 0.428936
Finished training it 219136/306969 of epoch 4, 49.54 ms/it, loss 0.427304
Finished training it 219136/306969 of epoch 4, 49.59 ms/it, loss 0.429883
Finished training it 219136/306969 of epoch 4, 49.44 ms/it, loss 0.432923
Finished training it 219136/306969 of epoch 4, 49.58 ms/it, loss 0.432040
Finished training it 220160/306969 of epoch 4, 49.57 ms/it, loss 0.440326
Finished training it 220160/306969 of epoch 4, 49.60 ms/it, loss 0.430350
Finished training it 220160/306969 of epoch 4, 49.50 ms/it, loss 0.434836
Finished training it 220160/306969 of epoch 4, 49.51 ms/it, loss 0.435678
Finished training it 221184/306969 of epoch 4, 52.24 ms/it, loss 0.435303
Finished training it 221184/306969 of epoch 4, 52.21 ms/it, loss 0.434548
Finished training it 221184/306969 of epoch 4, 52.24 ms/it, loss 0.426963
Finished training it 221184/306969 of epoch 4, 52.15 ms/it, loss 0.430617
Finished training it 222208/306969 of epoch 4, 49.10 ms/it, loss 0.431579
Finished training it 222208/306969 of epoch 4, 49.08 ms/it, loss 0.428915
Finished training it 222208/306969 of epoch 4, 49.12 ms/it, loss 0.434224
Finished training it 222208/306969 of epoch 4, 49.07 ms/it, loss 0.434484
Finished training it 223232/306969 of epoch 4, 49.52 ms/it, loss 0.432254
Finished training it 223232/306969 of epoch 4, 49.53 ms/it, loss 0.429765
Finished training it 223232/306969 of epoch 4, 49.58 ms/it, loss 0.430863
Finished training it 223232/306969 of epoch 4, 49.59 ms/it, loss 0.434756
Finished training it 224256/306969 of epoch 4, 52.06 ms/it, loss 0.436598
Finished training it 224256/306969 of epoch 4, 52.07 ms/it, loss 0.435713
Finished training it 224256/306969 of epoch 4, 52.06 ms/it, loss 0.432657
Finished training it 224256/306969 of epoch 4, 52.10 ms/it, loss 0.435407
Finished training it 225280/306969 of epoch 4, 49.27 ms/it, loss 0.429699
Finished training it 225280/306969 of epoch 4, 49.30 ms/it, loss 0.430666
Finished training it 225280/306969 of epoch 4, 49.27 ms/it, loss 0.431007
Testing at - 225280/306969 of epoch 4,
Testing at - 225280/306969 of epoch 4,
Finished training it 225280/306969 of epoch 4, 49.25 ms/it, loss 0.431743
Testing at - 225280/306969 of epoch 4,
Testing at - 225280/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576881.0
get out
3 has test check 2576881.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576881.0
get out
0 has test check 2576881.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576881.0
get out
rank: 1 test_accu: 2576881.0
2 has test check 2576881.0 and sample count 3273728
get out
1 has test check 2576881.0 and sample count 3273728
 accuracy 78.714 %, best 78.922 %, roc auc score 0.8016, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 226304/306969 of epoch 4, 49.35 ms/it, loss 0.433843
Finished training it 226304/306969 of epoch 4, 49.32 ms/it, loss 0.430326
Finished training it 226304/306969 of epoch 4, 49.29 ms/it, loss 0.434604
Finished training it 226304/306969 of epoch 4, 49.35 ms/it, loss 0.428586
Finished training it 227328/306969 of epoch 4, 49.38 ms/it, loss 0.436221
Finished training it 227328/306969 of epoch 4, 49.34 ms/it, loss 0.430576
Finished training it 227328/306969 of epoch 4, 49.39 ms/it, loss 0.430786
Finished training it 227328/306969 of epoch 4, 49.39 ms/it, loss 0.429417
Finished training it 228352/306969 of epoch 4, 49.67 ms/it, loss 0.428924
Finished training it 228352/306969 of epoch 4, 49.57 ms/it, loss 0.439006
Finished training it 228352/306969 of epoch 4, 49.61 ms/it, loss 0.438293
Finished training it 228352/306969 of epoch 4, 49.57 ms/it, loss 0.430235
Finished training it 229376/306969 of epoch 4, 48.50 ms/it, loss 0.432375
Finished training it 229376/306969 of epoch 4, 48.43 ms/it, loss 0.427861
Finished training it 229376/306969 of epoch 4, 48.45 ms/it, loss 0.436966
Finished training it 229376/306969 of epoch 4, 48.48 ms/it, loss 0.429429
Finished training it 230400/306969 of epoch 4, 48.87 ms/it, loss 0.433266
Finished training it 230400/306969 of epoch 4, 48.88 ms/it, loss 0.431427
Finished training it 230400/306969 of epoch 4, 48.84 ms/it, loss 0.427133
Finished training it 230400/306969 of epoch 4, 48.94 ms/it, loss 0.430351
Finished training it 231424/306969 of epoch 4, 48.68 ms/it, loss 0.431789
Finished training it 231424/306969 of epoch 4, 48.63 ms/it, loss 0.428829
Finished training it 231424/306969 of epoch 4, 48.64 ms/it, loss 0.429930
Finished training it 231424/306969 of epoch 4, 48.66 ms/it, loss 0.428495
Finished training it 232448/306969 of epoch 4, 48.67 ms/it, loss 0.437443
Finished training it 232448/306969 of epoch 4, 48.70 ms/it, loss 0.428992
Finished training it 232448/306969 of epoch 4, 48.70 ms/it, loss 0.436707
Finished training it 232448/306969 of epoch 4, 48.68 ms/it, loss 0.431855
Finished training it 233472/306969 of epoch 4, 48.60 ms/it, loss 0.429432
Finished training it 233472/306969 of epoch 4, 48.56 ms/it, loss 0.434068
Finished training it 233472/306969 of epoch 4, 48.62 ms/it, loss 0.430470
Finished training it 233472/306969 of epoch 4, 48.65 ms/it, loss 0.434527
Finished training it 234496/306969 of epoch 4, 49.94 ms/it, loss 0.432104
Finished training it 234496/306969 of epoch 4, 49.95 ms/it, loss 0.429647
Finished training it 234496/306969 of epoch 4, 49.90 ms/it, loss 0.427763
Finished training it 234496/306969 of epoch 4, 49.91 ms/it, loss 0.430469
Finished training it 235520/306969 of epoch 4, 49.38 ms/it, loss 0.427848
Finished training it 235520/306969 of epoch 4, 49.36 ms/it, loss 0.430140
Finished training it 235520/306969 of epoch 4, 49.38 ms/it, loss 0.430804
Finished training it 235520/306969 of epoch 4, 49.39 ms/it, loss 0.432944
Testing at - 235520/306969 of epoch 4,
Testing at - 235520/306969 of epoch 4,
Testing at - 235520/306969 of epoch 4,
Testing at - 235520/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576331.0
get out
3 has test check 2576331.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576331.0
get out
1 has test check 2576331.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576331.0
get out
0 has test check 2576331.0 and sample count 3273728
rank: 2 test_accu: 2576331.0
get out
2 has test check 2576331.0 and sample count 3273728
 accuracy 78.697 %, best 78.922 %, roc auc score 0.8011, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 236544/306969 of epoch 4, 52.02 ms/it, loss 0.431724
Finished training it 236544/306969 of epoch 4, 51.98 ms/it, loss 0.430298
Finished training it 236544/306969 of epoch 4, 52.06 ms/it, loss 0.430962
Finished training it 236544/306969 of epoch 4, 52.10 ms/it, loss 0.432901
Finished training it 237568/306969 of epoch 4, 49.56 ms/it, loss 0.433597
Finished training it 237568/306969 of epoch 4, 49.52 ms/it, loss 0.430292
Finished training it 237568/306969 of epoch 4, 49.51 ms/it, loss 0.432340
Finished training it 237568/306969 of epoch 4, 49.59 ms/it, loss 0.433097
Finished training it 238592/306969 of epoch 4, 49.60 ms/it, loss 0.426607
Finished training it 238592/306969 of epoch 4, 49.61 ms/it, loss 0.430545
Finished training it 238592/306969 of epoch 4, 49.47 ms/it, loss 0.426866
Finished training it 238592/306969 of epoch 4, 49.58 ms/it, loss 0.436751
Finished training it 239616/306969 of epoch 4, 50.06 ms/it, loss 0.429791
Finished training it 239616/306969 of epoch 4, 50.00 ms/it, loss 0.427740
Finished training it 239616/306969 of epoch 4, 50.01 ms/it, loss 0.432661
Finished training it 239616/306969 of epoch 4, 49.88 ms/it, loss 0.433541
Finished training it 240640/306969 of epoch 4, 50.11 ms/it, loss 0.432451
Finished training it 240640/306969 of epoch 4, 50.00 ms/it, loss 0.423972
Finished training it 240640/306969 of epoch 4, 50.07 ms/it, loss 0.429066
Finished training it 240640/306969 of epoch 4, 50.08 ms/it, loss 0.429632
Finished training it 241664/306969 of epoch 4, 53.40 ms/it, loss 0.428610
Finished training it 241664/306969 of epoch 4, 53.35 ms/it, loss 0.431563
Finished training it 241664/306969 of epoch 4, 53.29 ms/it, loss 0.426037
Finished training it 241664/306969 of epoch 4, 53.32 ms/it, loss 0.429785
Finished training it 242688/306969 of epoch 4, 49.95 ms/it, loss 0.431874
Finished training it 242688/306969 of epoch 4, 50.00 ms/it, loss 0.425855
Finished training it 242688/306969 of epoch 4, 49.96 ms/it, loss 0.429528
Finished training it 242688/306969 of epoch 4, 49.97 ms/it, loss 0.424367
Finished training it 243712/306969 of epoch 4, 49.85 ms/it, loss 0.434366
Finished training it 243712/306969 of epoch 4, 49.84 ms/it, loss 0.427692
Finished training it 243712/306969 of epoch 4, 49.87 ms/it, loss 0.431704
Finished training it 243712/306969 of epoch 4, 49.86 ms/it, loss 0.429661
Finished training it 244736/306969 of epoch 4, 52.06 ms/it, loss 0.431682
Finished training it 244736/306969 of epoch 4, 52.04 ms/it, loss 0.427966
Finished training it 244736/306969 of epoch 4, 52.10 ms/it, loss 0.435395
Finished training it 244736/306969 of epoch 4, 52.06 ms/it, loss 0.428275
Finished training it 245760/306969 of epoch 4, 48.98 ms/it, loss 0.428591
Finished training it 245760/306969 of epoch 4, 48.94 ms/it, loss 0.429484
Finished training it 245760/306969 of epoch 4, 48.93 ms/it, loss 0.433788
Finished training it 245760/306969 of epoch 4, 48.92 ms/it, loss 0.429965
Testing at - 245760/306969 of epoch 4,
Testing at - 245760/306969 of epoch 4,
Testing at - 245760/306969 of epoch 4,
Testing at - 245760/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2580536.0
get out
3 has test check 2580536.0 and sample count 3273728
rank: 1 test_accu: 2580536.0
get out
1 has test check 2580536.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580536.0
get out
0 has test check 2580536.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580536.0
get out
2 has test check 2580536.0 and sample count 3273728
 accuracy 78.826 %, best 78.922 %, roc auc score 0.8015, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 246784/306969 of epoch 4, 48.96 ms/it, loss 0.431686
Finished training it 246784/306969 of epoch 4, 48.96 ms/it, loss 0.428223
Finished training it 246784/306969 of epoch 4, 49.01 ms/it, loss 0.433013
Finished training it 246784/306969 of epoch 4, 49.04 ms/it, loss 0.437591
Finished training it 247808/306969 of epoch 4, 48.42 ms/it, loss 0.432062
Finished training it 247808/306969 of epoch 4, 48.44 ms/it, loss 0.434318
Finished training it 247808/306969 of epoch 4, 48.46 ms/it, loss 0.430027
Finished training it 247808/306969 of epoch 4, 48.46 ms/it, loss 0.430574
Finished training it 248832/306969 of epoch 4, 49.51 ms/it, loss 0.430804
Finished training it 248832/306969 of epoch 4, 49.43 ms/it, loss 0.432008
Finished training it 248832/306969 of epoch 4, 49.48 ms/it, loss 0.433601
Finished training it 248832/306969 of epoch 4, 49.47 ms/it, loss 0.434454
Finished training it 249856/306969 of epoch 4, 49.05 ms/it, loss 0.430983
Finished training it 249856/306969 of epoch 4, 49.12 ms/it, loss 0.429318
Finished training it 249856/306969 of epoch 4, 49.15 ms/it, loss 0.424682
Finished training it 249856/306969 of epoch 4, 49.10 ms/it, loss 0.432885
Finished training it 250880/306969 of epoch 4, 49.31 ms/it, loss 0.436100
Finished training it 250880/306969 of epoch 4, 49.62 ms/it, loss 0.427643
Finished training it 250880/306969 of epoch 4, 49.65 ms/it, loss 0.432867
Finished training it 250880/306969 of epoch 4, 49.63 ms/it, loss 0.431643
Finished training it 251904/306969 of epoch 4, 48.95 ms/it, loss 0.430520
Finished training it 251904/306969 of epoch 4, 48.89 ms/it, loss 0.434174
Finished training it 251904/306969 of epoch 4, 48.96 ms/it, loss 0.428695
Finished training it 251904/306969 of epoch 4, 48.98 ms/it, loss 0.429069
Finished training it 252928/306969 of epoch 4, 49.51 ms/it, loss 0.428940
Finished training it 252928/306969 of epoch 4, 49.52 ms/it, loss 0.428744
Finished training it 252928/306969 of epoch 4, 49.47 ms/it, loss 0.434902
Finished training it 252928/306969 of epoch 4, 49.50 ms/it, loss 0.431408
Finished training it 253952/306969 of epoch 4, 49.36 ms/it, loss 0.428572
Finished training it 253952/306969 of epoch 4, 49.36 ms/it, loss 0.428477
Finished training it 253952/306969 of epoch 4, 49.34 ms/it, loss 0.428464
Finished training it 253952/306969 of epoch 4, 49.38 ms/it, loss 0.426482
Finished training it 254976/306969 of epoch 4, 49.53 ms/it, loss 0.422557
Finished training it 254976/306969 of epoch 4, 49.56 ms/it, loss 0.436774
Finished training it 254976/306969 of epoch 4, 49.55 ms/it, loss 0.432000
Finished training it 254976/306969 of epoch 4, 49.58 ms/it, loss 0.429877
Finished training it 256000/306969 of epoch 4, 49.10 ms/it, loss 0.427171
Finished training it 256000/306969 of epoch 4, 49.13 ms/it, loss 0.428563
Finished training it 256000/306969 of epoch 4, 49.11 ms/it, loss 0.431060
Finished training it 256000/306969 of epoch 4, 49.06 ms/it, loss 0.424893
Testing at - 256000/306969 of epoch 4,
Testing at - 256000/306969 of epoch 4,
Testing at - 256000/306969 of epoch 4,
Testing at - 256000/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577797.0
get out
3 has test check 2577797.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577797.0
get out
0 has test check 2577797.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2577797.0
get out
1 has test check 2577797.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577797.0
get out
2 has test check 2577797.0 and sample count 3273728
 accuracy 78.742 %, best 78.922 %, roc auc score 0.8018, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 257024/306969 of epoch 4, 52.15 ms/it, loss 0.433416
Finished training it 257024/306969 of epoch 4, 52.15 ms/it, loss 0.428942
Finished training it 257024/306969 of epoch 4, 52.11 ms/it, loss 0.432050
Finished training it 257024/306969 of epoch 4, 52.16 ms/it, loss 0.430808
Finished training it 258048/306969 of epoch 4, 49.43 ms/it, loss 0.429633
Finished training it 258048/306969 of epoch 4, 49.37 ms/it, loss 0.436016
Finished training it 258048/306969 of epoch 4, 49.39 ms/it, loss 0.431078
Finished training it 258048/306969 of epoch 4, 49.37 ms/it, loss 0.429455
Finished training it 259072/306969 of epoch 4, 49.06 ms/it, loss 0.430032
Finished training it 259072/306969 of epoch 4, 48.98 ms/it, loss 0.427105
Finished training it 259072/306969 of epoch 4, 49.00 ms/it, loss 0.430762
Finished training it 259072/306969 of epoch 4, 48.97 ms/it, loss 0.434109
Finished training it 260096/306969 of epoch 4, 49.85 ms/it, loss 0.425941
Finished training it 260096/306969 of epoch 4, 49.75 ms/it, loss 0.427438
Finished training it 260096/306969 of epoch 4, 49.87 ms/it, loss 0.431033
Finished training it 260096/306969 of epoch 4, 49.76 ms/it, loss 0.427461
Finished training it 261120/306969 of epoch 4, 49.22 ms/it, loss 0.432233
Finished training it 261120/306969 of epoch 4, 49.08 ms/it, loss 0.424166
Finished training it 261120/306969 of epoch 4, 49.20 ms/it, loss 0.431180
Finished training it 261120/306969 of epoch 4, 49.21 ms/it, loss 0.434233
Finished training it 262144/306969 of epoch 4, 49.13 ms/it, loss 0.424680
Finished training it 262144/306969 of epoch 4, 49.08 ms/it, loss 0.432561
Finished training it 262144/306969 of epoch 4, 49.05 ms/it, loss 0.433010
Finished training it 262144/306969 of epoch 4, 49.03 ms/it, loss 0.430021
Finished training it 263168/306969 of epoch 4, 51.96 ms/it, loss 0.431656
Finished training it 263168/306969 of epoch 4, 51.89 ms/it, loss 0.429099
Finished training it 263168/306969 of epoch 4, 51.92 ms/it, loss 0.432357
Finished training it 263168/306969 of epoch 4, 51.83 ms/it, loss 0.432920
Finished training it 264192/306969 of epoch 4, 49.64 ms/it, loss 0.434243
Finished training it 264192/306969 of epoch 4, 49.58 ms/it, loss 0.432834
Finished training it 264192/306969 of epoch 4, 49.59 ms/it, loss 0.427861
Finished training it 264192/306969 of epoch 4, 49.59 ms/it, loss 0.429408
Finished training it 265216/306969 of epoch 4, 52.43 ms/it, loss 0.433262
Finished training it 265216/306969 of epoch 4, 52.33 ms/it, loss 0.429890
Finished training it 265216/306969 of epoch 4, 52.43 ms/it, loss 0.429539
Finished training it 265216/306969 of epoch 4, 52.33 ms/it, loss 0.434576
Finished training it 266240/306969 of epoch 4, 49.30 ms/it, loss 0.430781
Finished training it 266240/306969 of epoch 4, 49.29 ms/it, loss 0.432998
Finished training it 266240/306969 of epoch 4, 49.29 ms/it, loss 0.428588
Finished training it 266240/306969 of epoch 4, 49.30 ms/it, loss 0.426424
Testing at - 266240/306969 of epoch 4,
Testing at - 266240/306969 of epoch 4,
Testing at - 266240/306969 of epoch 4,
Testing at - 266240/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577876.0
get out
3 has test check 2577876.0 and sample count 3273728
rank: 1 test_accu: 2577876.0
get out
1 has test check 2577876.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577876.0
get out
2 has test check 2577876.0 and sample count 3273728
rank: 0 test_accu: 2577876.0
get out
0 has test check 2577876.0 and sample count 3273728
 accuracy 78.744 %, best 78.922 %, roc auc score 0.8010, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 267264/306969 of epoch 4, 49.73 ms/it, loss 0.428698
Finished training it 267264/306969 of epoch 4, 49.79 ms/it, loss 0.431287
Finished training it 267264/306969 of epoch 4, 49.78 ms/it, loss 0.434272
Finished training it 267264/306969 of epoch 4, 49.64 ms/it, loss 0.421009
Finished training it 268288/306969 of epoch 4, 49.31 ms/it, loss 0.431220
Finished training it 268288/306969 of epoch 4, 49.33 ms/it, loss 0.425178
Finished training it 268288/306969 of epoch 4, 49.29 ms/it, loss 0.432152
Finished training it 268288/306969 of epoch 4, 49.32 ms/it, loss 0.428005
Finished training it 269312/306969 of epoch 4, 49.33 ms/it, loss 0.424812
Finished training it 269312/306969 of epoch 4, 49.37 ms/it, loss 0.429079
Finished training it 269312/306969 of epoch 4, 49.38 ms/it, loss 0.431789
Finished training it 269312/306969 of epoch 4, 49.33 ms/it, loss 0.430895
Finished training it 270336/306969 of epoch 4, 49.06 ms/it, loss 0.422075
Finished training it 270336/306969 of epoch 4, 49.11 ms/it, loss 0.427612
Finished training it 270336/306969 of epoch 4, 49.10 ms/it, loss 0.428352
Finished training it 270336/306969 of epoch 4, 49.12 ms/it, loss 0.431936
Finished training it 271360/306969 of epoch 4, 48.65 ms/it, loss 0.427808
Finished training it 271360/306969 of epoch 4, 48.64 ms/it, loss 0.420692
Finished training it 271360/306969 of epoch 4, 48.62 ms/it, loss 0.427713
Finished training it 271360/306969 of epoch 4, 48.64 ms/it, loss 0.427988
Finished training it 272384/306969 of epoch 4, 48.78 ms/it, loss 0.428969
Finished training it 272384/306969 of epoch 4, 48.79 ms/it, loss 0.432700
Finished training it 272384/306969 of epoch 4, 48.73 ms/it, loss 0.428587
Finished training it 272384/306969 of epoch 4, 48.62 ms/it, loss 0.432103
Finished training it 273408/306969 of epoch 4, 49.36 ms/it, loss 0.427264
Finished training it 273408/306969 of epoch 4, 49.37 ms/it, loss 0.429568
Finished training it 273408/306969 of epoch 4, 49.42 ms/it, loss 0.429371
Finished training it 273408/306969 of epoch 4, 49.40 ms/it, loss 0.433683
Finished training it 274432/306969 of epoch 4, 49.24 ms/it, loss 0.426582
Finished training it 274432/306969 of epoch 4, 49.30 ms/it, loss 0.432368
Finished training it 274432/306969 of epoch 4, 49.34 ms/it, loss 0.426629
Finished training it 274432/306969 of epoch 4, 49.28 ms/it, loss 0.431698
Finished training it 275456/306969 of epoch 4, 49.67 ms/it, loss 0.434327
Finished training it 275456/306969 of epoch 4, 49.56 ms/it, loss 0.427666
Finished training it 275456/306969 of epoch 4, 49.65 ms/it, loss 0.429778
Finished training it 275456/306969 of epoch 4, 49.68 ms/it, loss 0.429666
Finished training it 276480/306969 of epoch 4, 49.09 ms/it, loss 0.429364
Finished training it 276480/306969 of epoch 4, 49.04 ms/it, loss 0.431413
Finished training it 276480/306969 of epoch 4, 49.06 ms/it, loss 0.428000
Finished training it 276480/306969 of epoch 4, 49.09 ms/it, loss 0.431344
Testing at - 276480/306969 of epoch 4,
Testing at - 276480/306969 of epoch 4,
Testing at - 276480/306969 of epoch 4,
Testing at - 276480/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579526.0
get out
1 has test check 2579526.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2579526.0
get out
0 has test check 2579526.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2579526.0
get out
3 has test check 2579526.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579526.0
get out
2 has test check 2579526.0 and sample count 3273728
 accuracy 78.795 %, best 78.922 %, roc auc score 0.8024, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 277504/306969 of epoch 4, 49.32 ms/it, loss 0.428176
Finished training it 277504/306969 of epoch 4, 49.22 ms/it, loss 0.431811
Finished training it 277504/306969 of epoch 4, 49.30 ms/it, loss 0.432249
Finished training it 277504/306969 of epoch 4, 49.24 ms/it, loss 0.432287
Finished training it 278528/306969 of epoch 4, 52.85 ms/it, loss 0.431668
Finished training it 278528/306969 of epoch 4, 52.76 ms/it, loss 0.432051
Finished training it 278528/306969 of epoch 4, 52.77 ms/it, loss 0.431683
Finished training it 278528/306969 of epoch 4, 52.77 ms/it, loss 0.427271
Finished training it 279552/306969 of epoch 4, 49.16 ms/it, loss 0.433851
Finished training it 279552/306969 of epoch 4, 49.15 ms/it, loss 0.428421
Finished training it 279552/306969 of epoch 4, 49.21 ms/it, loss 0.431072
Finished training it 279552/306969 of epoch 4, 49.16 ms/it, loss 0.427448
Finished training it 280576/306969 of epoch 4, 49.04 ms/it, loss 0.428061
Finished training it 280576/306969 of epoch 4, 49.01 ms/it, loss 0.428483
Finished training it 280576/306969 of epoch 4, 48.97 ms/it, loss 0.428561
Finished training it 280576/306969 of epoch 4, 49.06 ms/it, loss 0.425126
Finished training it 281600/306969 of epoch 4, 49.11 ms/it, loss 0.428037
Finished training it 281600/306969 of epoch 4, 49.09 ms/it, loss 0.433622
Finished training it 281600/306969 of epoch 4, 49.14 ms/it, loss 0.429513
Finished training it 281600/306969 of epoch 4, 49.10 ms/it, loss 0.430510
Finished training it 282624/306969 of epoch 4, 48.60 ms/it, loss 0.426467
Finished training it 282624/306969 of epoch 4, 48.66 ms/it, loss 0.430764
Finished training it 282624/306969 of epoch 4, 48.61 ms/it, loss 0.428911
Finished training it 282624/306969 of epoch 4, 48.59 ms/it, loss 0.427870
Finished training it 283648/306969 of epoch 4, 52.46 ms/it, loss 0.433019
Finished training it 283648/306969 of epoch 4, 52.41 ms/it, loss 0.429423
Finished training it 283648/306969 of epoch 4, 52.40 ms/it, loss 0.426136
Finished training it 283648/306969 of epoch 4, 52.46 ms/it, loss 0.425950
Finished training it 284672/306969 of epoch 4, 49.12 ms/it, loss 0.427912
Finished training it 284672/306969 of epoch 4, 49.08 ms/it, loss 0.425002
Finished training it 284672/306969 of epoch 4, 49.12 ms/it, loss 0.428158
Finished training it 284672/306969 of epoch 4, 49.10 ms/it, loss 0.432219
Finished training it 285696/306969 of epoch 4, 49.56 ms/it, loss 0.427027
Finished training it 285696/306969 of epoch 4, 49.56 ms/it, loss 0.426669
Finished training it 285696/306969 of epoch 4, 49.52 ms/it, loss 0.427952
Finished training it 285696/306969 of epoch 4, 49.55 ms/it, loss 0.432386
Finished training it 286720/306969 of epoch 4, 52.73 ms/it, loss 0.429359
Finished training it 286720/306969 of epoch 4, 52.70 ms/it, loss 0.427440
Finished training it 286720/306969 of epoch 4, 52.77 ms/it, loss 0.427281
Finished training it 286720/306969 of epoch 4, 52.78 ms/it, loss 0.429294
Testing at - 286720/306969 of epoch 4,
Testing at - 286720/306969 of epoch 4,
Testing at - 286720/306969 of epoch 4,
Testing at - 286720/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577358.0
Warning: Skipping the batch 3197 with size 602
get out
rank: 2 test_accu: 2577358.0
get out
3 has test check 2577358.0 and sample count 3273728
2 has test check 2577358.0 and sample count 3273728
rank: 1 test_accu: 2577358.0
get out
1 has test check 2577358.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577358.0
get out
0 has test check 2577358.0 and sample count 3273728
 accuracy 78.729 %, best 78.922 %, roc auc score 0.8021, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 287744/306969 of epoch 4, 49.22 ms/it, loss 0.426647
Finished training it 287744/306969 of epoch 4, 49.18 ms/it, loss 0.433769
Finished training it 287744/306969 of epoch 4, 49.24 ms/it, loss 0.428265
Finished training it 287744/306969 of epoch 4, 49.19 ms/it, loss 0.429621
Finished training it 288768/306969 of epoch 4, 49.32 ms/it, loss 0.429362
Finished training it 288768/306969 of epoch 4, 49.29 ms/it, loss 0.432287
Finished training it 288768/306969 of epoch 4, 49.36 ms/it, loss 0.430356
Finished training it 288768/306969 of epoch 4, 49.32 ms/it, loss 0.430705
Finished training it 289792/306969 of epoch 4, 49.12 ms/it, loss 0.431569
Finished training it 289792/306969 of epoch 4, 49.10 ms/it, loss 0.425570
Finished training it 289792/306969 of epoch 4, 49.14 ms/it, loss 0.429586
Finished training it 289792/306969 of epoch 4, 49.16 ms/it, loss 0.430467
Finished training it 290816/306969 of epoch 4, 49.02 ms/it, loss 0.431075
Finished training it 290816/306969 of epoch 4, 49.03 ms/it, loss 0.426119
Finished training it 290816/306969 of epoch 4, 49.11 ms/it, loss 0.426796
Finished training it 290816/306969 of epoch 4, 49.02 ms/it, loss 0.426509
Finished training it 291840/306969 of epoch 4, 49.13 ms/it, loss 0.426265
Finished training it 291840/306969 of epoch 4, 49.16 ms/it, loss 0.435130
Finished training it 291840/306969 of epoch 4, 49.17 ms/it, loss 0.427937
Finished training it 291840/306969 of epoch 4, 49.18 ms/it, loss 0.431258
Finished training it 292864/306969 of epoch 4, 49.56 ms/it, loss 0.427990
Finished training it 292864/306969 of epoch 4, 49.49 ms/it, loss 0.429283
Finished training it 292864/306969 of epoch 4, 49.51 ms/it, loss 0.430968
Finished training it 292864/306969 of epoch 4, 49.52 ms/it, loss 0.434483
Finished training it 293888/306969 of epoch 4, 48.86 ms/it, loss 0.431429
Finished training it 293888/306969 of epoch 4, 48.85 ms/it, loss 0.431858
Finished training it 293888/306969 of epoch 4, 48.84 ms/it, loss 0.432176
Finished training it 293888/306969 of epoch 4, 48.88 ms/it, loss 0.430515
Finished training it 294912/306969 of epoch 4, 49.08 ms/it, loss 0.428936
Finished training it 294912/306969 of epoch 4, 49.11 ms/it, loss 0.434348
Finished training it 294912/306969 of epoch 4, 49.16 ms/it, loss 0.427991
Finished training it 294912/306969 of epoch 4, 49.15 ms/it, loss 0.430375
Finished training it 295936/306969 of epoch 4, 49.47 ms/it, loss 0.428813
Finished training it 295936/306969 of epoch 4, 49.45 ms/it, loss 0.429606
Finished training it 295936/306969 of epoch 4, 49.44 ms/it, loss 0.429029
Finished training it 295936/306969 of epoch 4, 49.46 ms/it, loss 0.428627
Finished training it 296960/306969 of epoch 4, 49.14 ms/it, loss 0.424716
Finished training it 296960/306969 of epoch 4, 49.14 ms/it, loss 0.429328
Finished training it 296960/306969 of epoch 4, 49.16 ms/it, loss 0.435872
Finished training it 296960/306969 of epoch 4, 49.13 ms/it, loss 0.428492
Testing at - 296960/306969 of epoch 4,
Testing at - 296960/306969 of epoch 4,
Testing at - 296960/306969 of epoch 4,
Testing at - 296960/306969 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575963.0
Warning: Skipping the batch 3197 with size 602
get out
3 has test check 2575963.0 and sample count 3273728
rank: 0 test_accu: 2575963.0
get out
0 has test check 2575963.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575963.0
get out
1 has test check 2575963.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575963.0
get out
2 has test check 2575963.0 and sample count 3273728
 accuracy 78.686 %, best 78.922 %, roc auc score 0.8011, best 0.8044
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 297984/306969 of epoch 4, 49.19 ms/it, loss 0.424582
Finished training it 297984/306969 of epoch 4, 49.22 ms/it, loss 0.429028
Finished training it 297984/306969 of epoch 4, 49.21 ms/it, loss 0.426313
Finished training it 297984/306969 of epoch 4, 49.19 ms/it, loss 0.425719
Finished training it 299008/306969 of epoch 4, 51.96 ms/it, loss 0.433796
Finished training it 299008/306969 of epoch 4, 51.89 ms/it, loss 0.429212
Finished training it 299008/306969 of epoch 4, 51.94 ms/it, loss 0.424135
Finished training it 299008/306969 of epoch 4, 51.99 ms/it, loss 0.430888
Finished training it 300032/306969 of epoch 4, 49.58 ms/it, loss 0.428294
Finished training it 300032/306969 of epoch 4, 49.51 ms/it, loss 0.427744
Finished training it 300032/306969 of epoch 4, 49.51 ms/it, loss 0.428778
Finished training it 300032/306969 of epoch 4, 49.49 ms/it, loss 0.428079
Finished training it 301056/306969 of epoch 4, 49.82 ms/it, loss 0.428527
Finished training it 301056/306969 of epoch 4, 49.82 ms/it, loss 0.430954
Finished training it 301056/306969 of epoch 4, 49.84 ms/it, loss 0.432134
Finished training it 301056/306969 of epoch 4, 49.82 ms/it, loss 0.434505
Finished training it 302080/306969 of epoch 4, 49.32 ms/it, loss 0.427564
Finished training it 302080/306969 of epoch 4, 49.37 ms/it, loss 0.426161
Finished training it 302080/306969 of epoch 4, 49.33 ms/it, loss 0.432837
Finished training it 302080/306969 of epoch 4, 49.33 ms/it, loss 0.428412
Finished training it 303104/306969 of epoch 4, 49.46 ms/it, loss 0.431655
Finished training it 303104/306969 of epoch 4, 49.57 ms/it, loss 0.433709
Finished training it 303104/306969 of epoch 4, 49.49 ms/it, loss 0.436770
Finished training it 303104/306969 of epoch 4, 49.49 ms/it, loss 0.429826
Finished training it 304128/306969 of epoch 4, 49.47 ms/it, loss 0.436475
Finished training it 304128/306969 of epoch 4, 49.50 ms/it, loss 0.434560
Finished training it 304128/306969 of epoch 4, 49.51 ms/it, loss 0.430942
Finished training it 304128/306969 of epoch 4, 49.50 ms/it, loss 0.431181
Finished training it 305152/306969 of epoch 4, 54.02 ms/it, loss 0.430305
Finished training it 305152/306969 of epoch 4, 54.00 ms/it, loss 0.428734
Finished training it 305152/306969 of epoch 4, 53.99 ms/it, loss 0.427937
Finished training it 305152/306969 of epoch 4, 53.91 ms/it, loss 0.428770
Finished training it 306176/306969 of epoch 4, 50.00 ms/it, loss 0.426861
Finished training it 306176/306969 of epoch 4, 50.01 ms/it, loss 0.423803
Finished training it 306176/306969 of epoch 4, 49.95 ms/it, loss 0.424910
Finished training it 306176/306969 of epoch 4, 49.96 ms/it, loss 0.430357
Warning: Skipping the batch 306968 with size 54
Testing at - 306969/306969 of epoch 5,
Warning: Skipping the batch 306968 with size 54
Warning: Skipping the batch 306968 with size 54
Testing at - 306969/306969 of epoch 5,
Testing at - 306969/306969 of epoch 5,
Warning: Skipping the batch 306968 with size 54
Testing at - 306969/306969 of epoch 5,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2576997.0
Warning: Skipping the batch 3197 with size 602
get out
1 has test check 2576997.0 and sample count 3273728
rank: 0 test_accu: 2576997.0
rank: 3 test_accu: 2576997.0
get out
get out
0 has test check 2576997.0 and sample count 3273728
3 has test check 2576997.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576997.0
get out
2 has test check 2576997.0 and sample count 3273728
 accuracy 78.718 %, best 78.922 %, roc auc score 0.8007, best 0.8044
(base) yzhou@johnson:~/Deep_Quantized_Recommendation_Model_DQRM/bash_scripts/Kaggle$
