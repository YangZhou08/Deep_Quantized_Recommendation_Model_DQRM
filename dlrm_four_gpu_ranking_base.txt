Unable to import mlperf_logging,  No module named 'mlperf_logging'
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([-0.0104,  0.0184,  0.0105,  0.0058,  0.0115, -0.0187, -0.0091,  0.0024,
         0.0005,  0.0011,  0.0116, -0.0036,  0.0248,  0.0146,  0.0098,  0.0223])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 115.16 ms/it, loss 0.547047
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([ 0.0140,  0.0224,  0.0198,  0.0010,  0.0210,  0.0013, -0.0159,  0.0108,
        -0.0120,  0.0262,  0.0255, -0.0144, -0.0241,  0.0034, -0.0127, -0.0038])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 114.93 ms/it, loss 0.549004
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([-0.0104,  0.0014, -0.0171, -0.0250,  0.0175, -0.0026, -0.0012,  0.0172,
        -0.0004, -0.0259, -0.0206, -0.0169,  0.0007, -0.0024,  0.0069,  0.0130])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
ranking from least wide range to the widest range [17  2 11 25  1  9  6 24 18  0 20 10 22 15 12  4 14  7  3 23  5 19 16 13
  8 21]
Finished training it 1024/76743 of epoch 0, 111.34 ms/it, loss 0.546478
Unable to import mlperf_logging,  No module named 'mlperf_logging'
Warning: local_rank gpu mismatch
4 out of -1 (GPU)
---------- embedding bag gradient quantized in 4 bits
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined train indices...
Randomized indices across days ...
Split data according to indices...
Reading pre-processed data=/home/yzhou/dlrm_criteo_kaggle/kaggleAdDisplayChallenge_processed.npz
Sparse fea = 26, Dense fea = 13
Defined test indices...
Randomized indices across days ...
Split data according to indices...
number of devices 1
world size found is -1
---------- Embedding Table 0, quantization used, n = 1460, m = 16, quantization bit set to 4
---------- Embedding Table 1, quantization used, n = 583, m = 16, quantization bit set to 4
---------- Embedding Table 2, quantization used, n = 10131227, m = 16, quantization bit set to 4
---------- Embedding Table 3, quantization used, n = 2202608, m = 16, quantization bit set to 4
---------- Embedding Table 4, quantization used, n = 305, m = 16, quantization bit set to 4
---------- Embedding Table 5, quantization used, n = 24, m = 16, quantization bit set to 4
---------- Embedding Table 6, quantization used, n = 12517, m = 16, quantization bit set to 4
---------- Embedding Table 7, quantization used, n = 633, m = 16, quantization bit set to 4
---------- Embedding Table 8, quantization used, n = 3, m = 16, quantization bit set to 4
---------- Embedding Table 9, quantization used, n = 93145, m = 16, quantization bit set to 4
---------- Embedding Table 10, quantization used, n = 5683, m = 16, quantization bit set to 4
---------- Embedding Table 11, quantization used, n = 8351593, m = 16, quantization bit set to 4
---------- Embedding Table 12, quantization used, n = 3194, m = 16, quantization bit set to 4
---------- Embedding Table 13, quantization used, n = 27, m = 16, quantization bit set to 4
---------- Embedding Table 14, quantization used, n = 14992, m = 16, quantization bit set to 4
---------- Embedding Table 15, quantization used, n = 5461306, m = 16, quantization bit set to 4
---------- Embedding Table 16, quantization used, n = 10, m = 16, quantization bit set to 4
---------- Embedding Table 17, quantization used, n = 5652, m = 16, quantization bit set to 4
---------- Embedding Table 18, quantization used, n = 2173, m = 16, quantization bit set to 4
---------- Embedding Table 19, quantization used, n = 4, m = 16, quantization bit set to 4
---------- Embedding Table 20, quantization used, n = 7046547, m = 16, quantization bit set to 4
---------- Embedding Table 21, quantization used, n = 18, m = 16, quantization bit set to 4
---------- Embedding Table 22, quantization used, n = 15, m = 16, quantization bit set to 4
---------- Embedding Table 23, quantization used, n = 286181, m = 16, quantization bit set to 4
---------- Embedding Table 24, quantization used, n = 105, m = 16, quantization bit set to 4
---------- Embedding Table 25, quantization used, n = 142572, m = 16, quantization bit set to 4
use quant linear, input 13, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 64, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 64, output 16, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 367, output 512, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 512, output 256, quantization bit width 4, use full precision quantized and channelwise status channelwise
use quant linear, input 256, output 1, quantization bit width 4, use full precision quantized and channelwise status channelwise
not quantize activations, quantize weights
before training, checking models
tensor([-0.0147, -0.0219,  0.0110, -0.0159, -0.0115, -0.0124,  0.0057,  0.0217,
        -0.0125, -0.0109, -0.0212,  0.0196, -0.0154,  0.0118, -0.0032, -0.0228])
log path is written: /home/yzhou/dlrm_criteo_kaggle/
optimizer selected is  sgd
Finished training it 1024/76743 of epoch 0, 114.72 ms/it, loss 0.549543
ranking from least wide range to the widest range [17 11  6 10  9  2  1 18  3  0 25  7  4 15 20 24 12 14 23  5 19 21 16  8
 13 22]
Finished training it 2048/76743 of epoch 0, 109.76 ms/it, loss 0.520387
Finished training it 2048/76743 of epoch 0, 111.53 ms/it, loss 0.519855
Finished training it 2048/76743 of epoch 0, 111.73 ms/it, loss 0.520310
Finished training it 2048/76743 of epoch 0, 111.74 ms/it, loss 0.520278
Finished training it 3072/76743 of epoch 0, 110.29 ms/it, loss 0.509492
Finished training it 3072/76743 of epoch 0, 110.14 ms/it, loss 0.510613
Finished training it 3072/76743 of epoch 0, 110.39 ms/it, loss 0.508198
ranking from least wide range to the widest range [17  9  0  6 11  2  1 10 18 25  7  4  3 12 24 14 20 15 23  5 16  8 21 19
 22 13]
Finished training it 3072/76743 of epoch 0, 108.78 ms/it, loss 0.511186
ranking from least wide range to the widest range [17 11  9  2  6  7 10  0  4  1 18  3 12 25 24 14 20 15 23 16  5  8 19 21
 22 13]
Finished training it 4096/76743 of epoch 0, 109.29 ms/it, loss 0.504558
Finished training it 4096/76743 of epoch 0, 110.53 ms/it, loss 0.501917
Finished training it 4096/76743 of epoch 0, 110.41 ms/it, loss 0.506141
Finished training it 4096/76743 of epoch 0, 110.23 ms/it, loss 0.502256
ranking from least wide range to the widest range [11  2 17  0 18  4  9  6  7 25 10  1  3 24 14 20 12 15 21  8 19 16  5 22
 23 13]
Finished training it 5120/76743 of epoch 0, 109.28 ms/it, loss 0.499381
Finished training it 5120/76743 of epoch 0, 110.25 ms/it, loss 0.500631
Finished training it 5120/76743 of epoch 0, 110.49 ms/it, loss 0.503577
Finished training it 5120/76743 of epoch 0, 110.48 ms/it, loss 0.499443
ranking from least wide range to the widest range [11  2 17  6 18  9  7  0  4 10  1 25  3 24 20 14 21 19 12 15  8  5 16 23
 22 13]
Finished training it 6144/76743 of epoch 0, 108.52 ms/it, loss 0.495256
Finished training it 6144/76743 of epoch 0, 109.63 ms/it, loss 0.496802
Finished training it 6144/76743 of epoch 0, 109.50 ms/it, loss 0.496324
Finished training it 6144/76743 of epoch 0, 109.72 ms/it, loss 0.497633
ranking from least wide range to the widest range [11  2  6 17  9  0 18  7  4 10  1  3 25 24 21 19  5 20  8 14 22 16 15 12
 23 13]
Finished training it 7168/76743 of epoch 0, 108.88 ms/it, loss 0.487559
Finished training it 7168/76743 of epoch 0, 109.87 ms/it, loss 0.488593
Finished training it 7168/76743 of epoch 0, 109.89 ms/it, loss 0.490173
Finished training it 7168/76743 of epoch 0, 109.69 ms/it, loss 0.489615
ranking from least wide range to the widest range [ 9  2 18  6 11  0 17  7 10  4 25  3  1 24 19 21  8  5 20 16 15 14 12 22
 23 13]
Finished training it 8192/76743 of epoch 0, 109.41 ms/it, loss 0.484434
Finished training it 8192/76743 of epoch 0, 110.32 ms/it, loss 0.485463
Finished training it 8192/76743 of epoch 0, 110.09 ms/it, loss 0.484550
Finished training it 8192/76743 of epoch 0, 110.29 ms/it, loss 0.484275
Finished training it 9216/76743 of epoch 0, 109.59 ms/it, loss 0.478889
ranking from least wide range to the widest range [ 9  2 11  6 18  0 17  7 10  4  1  3 25 21 24  8  5 19 16 20 15 22 13 12
 14 23]
Finished training it 9216/76743 of epoch 0, 108.77 ms/it, loss 0.480046
Finished training it 9216/76743 of epoch 0, 109.45 ms/it, loss 0.482220
Finished training it 9216/76743 of epoch 0, 109.52 ms/it, loss 0.483256
ranking from least wide range to the widest range [17  9  6 11  2  4  0 18  7 10  1  3 25 24 21  8 22 19  5 16 20 13 15 23
 14 12]
Finished training it 10240/76743 of epoch 0, 108.99 ms/it, loss 0.478875
Finished training it 10240/76743 of epoch 0, 109.50 ms/it, loss 0.480341
Finished training it 10240/76743 of epoch 0, 109.69 ms/it, loss 0.477127
Finished training it 10240/76743 of epoch 0, 109.69 ms/it, loss 0.477784
Testing at - 10240/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2531880.0
get out
0 has test check 2531880.0 and sample count 3273728
 accuracy 77.339 %, best 77.339 %, roc auc score 0.7697, best 0.7697
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11 17  0  6  2  7 10  9 18  4  1 25  3 21 24  8  5 19 16 22 20 13 12 15
 14 23]
Finished training it 11264/76743 of epoch 0, 110.27 ms/it, loss 0.476007
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2532195.0
get out
2 has test check 2532195.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 110.56 ms/it, loss 0.477034
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2532351.0
get out
3 has test check 2532351.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 110.58 ms/it, loss 0.476007
Testing at - 10240/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2532374.0
get out
1 has test check 2532374.0 and sample count 3273728
Finished training it 11264/76743 of epoch 0, 110.69 ms/it, loss 0.475263
ranking from least wide range to the widest range [11  2 17 10  6  7  0  4  9  1 18  3 25 24  8  5 19 21 16 22 20 12 15 13
 14 23]
Finished training it 12288/76743 of epoch 0, 109.49 ms/it, loss 0.475029
Finished training it 12288/76743 of epoch 0, 109.86 ms/it, loss 0.478464
Finished training it 12288/76743 of epoch 0, 109.69 ms/it, loss 0.474063
Finished training it 12288/76743 of epoch 0, 109.84 ms/it, loss 0.473872
Finished training it 13312/76743 of epoch 0, 110.36 ms/it, loss 0.472962
ranking from least wide range to the widest range [ 2  9  6 11  0 10 17  7  1  4 18 25  3 21 24  8  5 19 22 16 20 13 15 12
 14 23]
Finished training it 13312/76743 of epoch 0, 110.08 ms/it, loss 0.473957
Finished training it 13312/76743 of epoch 0, 110.29 ms/it, loss 0.473295
Finished training it 13312/76743 of epoch 0, 110.25 ms/it, loss 0.473641
ranking from least wide range to the widest range [ 2 10  9  6 11 17  4  0  1  7 18 25  3 21  5 19  8 24 16 22 20 13 15 12
 23 14]
Finished training it 14336/76743 of epoch 0, 110.10 ms/it, loss 0.474567
Finished training it 14336/76743 of epoch 0, 110.41 ms/it, loss 0.472179
Finished training it 14336/76743 of epoch 0, 110.45 ms/it, loss 0.474241
Finished training it 14336/76743 of epoch 0, 110.40 ms/it, loss 0.473321
Finished training it 15360/76743 of epoch 0, 109.90 ms/it, loss 0.472259
ranking from least wide range to the widest range [ 2 11 10  9  6 17  1  4  0 18  7  3 25 19 21  8 24 22 16  5 20 13 15 14
 12 23]
Finished training it 15360/76743 of epoch 0, 109.63 ms/it, loss 0.472742
Finished training it 15360/76743 of epoch 0, 109.98 ms/it, loss 0.473255
Finished training it 15360/76743 of epoch 0, 110.04 ms/it, loss 0.474365
ranking from least wide range to the widest range [10 17  2  9  6  0  4 11  1  7 18  3 25 19  8 16 21  5 24 20 22 13 15 14
 12 23]
Finished training it 16384/76743 of epoch 0, 110.35 ms/it, loss 0.473468
Finished training it 16384/76743 of epoch 0, 110.58 ms/it, loss 0.470102
Finished training it 16384/76743 of epoch 0, 110.65 ms/it, loss 0.471058
Finished training it 16384/76743 of epoch 0, 110.56 ms/it, loss 0.469954
ranking from least wide range to the widest range [ 2 10  9 17 11  6  0  4  1 18 25  7  3 21 24 16 19  8  5 22 20 13 15 12
 23 14]
Finished training it 17408/76743 of epoch 0, 109.55 ms/it, loss 0.471919
Finished training it 17408/76743 of epoch 0, 109.83 ms/it, loss 0.468429
Finished training it 17408/76743 of epoch 0, 109.78 ms/it, loss 0.470969
Finished training it 17408/76743 of epoch 0, 109.78 ms/it, loss 0.472016
ranking from least wide range to the widest range [ 2 17 10  0  6  9 11 18  1  4 25  7  3 21 19  8 24  5 16 22 20 13 15 14
 12 23]
Finished training it 18432/76743 of epoch 0, 110.51 ms/it, loss 0.471036
Finished training it 18432/76743 of epoch 0, 110.69 ms/it, loss 0.471294
Finished training it 18432/76743 of epoch 0, 110.76 ms/it, loss 0.472427
Finished training it 18432/76743 of epoch 0, 110.64 ms/it, loss 0.472930
ranking from least wide range to the widest range [ 2  9 10 11  6 17  0  4 18  7  1  3 25 21 19 24  8  5 16 13 22 20 23 14
 15 12]
Finished training it 19456/76743 of epoch 0, 109.81 ms/it, loss 0.471843
Finished training it 19456/76743 of epoch 0, 110.10 ms/it, loss 0.469626
Finished training it 19456/76743 of epoch 0, 110.10 ms/it, loss 0.470508
Finished training it 19456/76743 of epoch 0, 109.92 ms/it, loss 0.468438
ranking from least wide range to the widest range [ 2 11 17 10  9  6  0  4  7  1  3 18 25 19  5 21  8 24 20 16 22 13 15 14
 23 12]
Finished training it 20480/76743 of epoch 0, 109.41 ms/it, loss 0.471998
Finished training it 20480/76743 of epoch 0, 109.67 ms/it, loss 0.468074
Finished training it 20480/76743 of epoch 0, 109.58 ms/it, loss 0.470821
Finished training it 20480/76743 of epoch 0, 109.62 ms/it, loss 0.468308
Testing at - 20480/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2535073.0
get out
0 has test check 2535073.0 and sample count 3273728
 accuracy 77.437 %, best 77.437 %, roc auc score 0.7782, best 0.7782
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [ 9  2 11 10  6 17  4  0  1 18  7 25  3 21 19 24  8 22 16 13  5 20 14 15
 12 23]
Finished training it 21504/76743 of epoch 0, 109.78 ms/it, loss 0.469846
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2535627.0
get out
3 has test check 2535627.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 110.03 ms/it, loss 0.469297
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2535288.0
get out
2 has test check 2535288.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 110.06 ms/it, loss 0.466689
Testing at - 20480/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2536036.0
get out
1 has test check 2536036.0 and sample count 3273728
Finished training it 21504/76743 of epoch 0, 110.12 ms/it, loss 0.468101
ranking from least wide range to the widest range [11  2 10 17  9  4  6  0  7 18  1  3 25 21 19  8 16  5 24 22 13 20 15 14
 12 23]
Finished training it 22528/76743 of epoch 0, 109.66 ms/it, loss 0.469215
Finished training it 22528/76743 of epoch 0, 109.88 ms/it, loss 0.469808
Finished training it 22528/76743 of epoch 0, 109.83 ms/it, loss 0.468065
Finished training it 22528/76743 of epoch 0, 109.94 ms/it, loss 0.467952
ranking from least wide range to the widest range [ 2 11 17  6  9 10  4  0 18 25  7  1  3 19 21  8  5 16 22 24 13 20 23 15
 14 12]
Finished training it 23552/76743 of epoch 0, 109.68 ms/it, loss 0.471093
Finished training it 23552/76743 of epoch 0, 109.83 ms/it, loss 0.467919
Finished training it 23552/76743 of epoch 0, 109.89 ms/it, loss 0.467980
Finished training it 23552/76743 of epoch 0, 109.92 ms/it, loss 0.468938
ranking from least wide range to the widest range [ 2 11 17 10  6  9  4  0  7  1 18 25  3  8 21 19 16 24  5 22 13 20 14 12
 15 23]
Finished training it 24576/76743 of epoch 0, 109.77 ms/it, loss 0.469629
Finished training it 24576/76743 of epoch 0, 110.01 ms/it, loss 0.468556
Finished training it 24576/76743 of epoch 0, 109.96 ms/it, loss 0.468602
Finished training it 24576/76743 of epoch 0, 110.04 ms/it, loss 0.467833
ranking from least wide range to the widest range [17  2 11  4  9  6 10  1  0  3 25  7 18 19  5  8 21 16 24 22 20 13 15 14
 23 12]
Finished training it 25600/76743 of epoch 0, 110.21 ms/it, loss 0.468506
Finished training it 25600/76743 of epoch 0, 110.46 ms/it, loss 0.468155
Finished training it 25600/76743 of epoch 0, 110.44 ms/it, loss 0.467405
Finished training it 25600/76743 of epoch 0, 110.48 ms/it, loss 0.467937
ranking from least wide range to the widest range [11 17  2 10  9  6  4  0  1  7  3 18 25 21 19  5 24  8 22 16 20 12 13 15
 23 14]
Finished training it 26624/76743 of epoch 0, 110.08 ms/it, loss 0.470399
Finished training it 26624/76743 of epoch 0, 110.23 ms/it, loss 0.467443
Finished training it 26624/76743 of epoch 0, 110.28 ms/it, loss 0.467379
Finished training it 26624/76743 of epoch 0, 110.19 ms/it, loss 0.465445
ranking from least wide range to the widest range [11  2 17 10  0  6  9  4 18  1  3  7 25 21 16  8 19  5 22 24 20 13 14 12
 15 23]
Finished training it 27648/76743 of epoch 0, 110.34 ms/it, loss 0.467987
Finished training it 27648/76743 of epoch 0, 110.50 ms/it, loss 0.466835
Finished training it 27648/76743 of epoch 0, 110.49 ms/it, loss 0.468357
Finished training it 27648/76743 of epoch 0, 110.49 ms/it, loss 0.465606
Finished training it 28672/76743 of epoch 0, 110.66 ms/it, loss 0.470278
ranking from least wide range to the widest range [11  2 10  6 17  4  9  0 18  7  3 25  1 21 19 24  8 16 13 22  5 20 12 23
 15 14]
Finished training it 28672/76743 of epoch 0, 110.51 ms/it, loss 0.466877
Finished training it 28672/76743 of epoch 0, 110.72 ms/it, loss 0.467031
Finished training it 28672/76743 of epoch 0, 110.68 ms/it, loss 0.465296
Finished training it 29696/76743 of epoch 0, 110.08 ms/it, loss 0.465590
Finished training it 29696/76743 of epoch 0, 109.99 ms/it, loss 0.467292
ranking from least wide range to the widest range [11  2  9 17  0 10  6  4 18  3  7  1 25 21  5  8 19 13 24 16 22 20 15 14
 23 12]
Finished training it 29696/76743 of epoch 0, 109.83 ms/it, loss 0.466495
Finished training it 29696/76743 of epoch 0, 110.01 ms/it, loss 0.466814
Finished training it 30720/76743 of epoch 0, 110.25 ms/it, loss 0.465842
ranking from least wide range to the widest range [17  9  2 10 11  0  6  7  4  3  1 18 25 19 21  5  8 16 24 13 22 20 12 15
 14 23]
Finished training it 30720/76743 of epoch 0, 110.06 ms/it, loss 0.465554
Finished training it 30720/76743 of epoch 0, 110.29 ms/it, loss 0.466589
Finished training it 30720/76743 of epoch 0, 110.38 ms/it, loss 0.465365
Testing at - 30720/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2549488.0
get out
0 has test check 2549488.0 and sample count 3273728
 accuracy 77.877 %, best 77.877 %, roc auc score 0.7806, best 0.7806
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11  2 17  9 10  6  0  4 25  3  1  7 18 21 19  5 16 24 13  8 22 20 23 14
 15 12]
Finished training it 31744/76743 of epoch 0, 109.46 ms/it, loss 0.464691
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2549152.0
get out
3 has test check 2549152.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 109.79 ms/it, loss 0.464995
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2549879.0
get out
2 has test check 2549879.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 109.64 ms/it, loss 0.467257
Testing at - 30720/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2549757.0
get out
1 has test check 2549757.0 and sample count 3273728
Finished training it 31744/76743 of epoch 0, 109.66 ms/it, loss 0.467535
ranking from least wide range to the widest range [11  2 10  9 17  6  0  4 25  7  3  1 18 21  5 24  8 19 16 22 13 20 12 23
 14 15]
Finished training it 32768/76743 of epoch 0, 109.42 ms/it, loss 0.466345
Finished training it 32768/76743 of epoch 0, 109.61 ms/it, loss 0.465500
Finished training it 32768/76743 of epoch 0, 109.56 ms/it, loss 0.468780
Finished training it 32768/76743 of epoch 0, 109.62 ms/it, loss 0.465850
ranking from least wide range to the widest range [11 17  2 10  9  6  4  0  7  3 18  1 25 21  8 19 16  5 22 24 13 20 12 14
 15 23]
Finished training it 33792/76743 of epoch 0, 110.26 ms/it, loss 0.465138
Finished training it 33792/76743 of epoch 0, 110.39 ms/it, loss 0.466048
Finished training it 33792/76743 of epoch 0, 110.36 ms/it, loss 0.463028
Finished training it 33792/76743 of epoch 0, 110.49 ms/it, loss 0.466453
ranking from least wide range to the widest range [11  9 17  2 10  6  0  4 25  7 18  1  3 21 19  5  8 24 16 22 13 20 23 15
 14 12]
Finished training it 34816/76743 of epoch 0, 110.13 ms/it, loss 0.463577
Finished training it 34816/76743 of epoch 0, 110.28 ms/it, loss 0.465791
Finished training it 34816/76743 of epoch 0, 110.24 ms/it, loss 0.465940
Finished training it 34816/76743 of epoch 0, 110.45 ms/it, loss 0.463552
ranking from least wide range to the widest range [11  2 10  9  6 17  4  0  7  3 18  1 25 21  5 19  8 22 24 16 13 20 12 23
 14 15]
Finished training it 35840/76743 of epoch 0, 109.55 ms/it, loss 0.462984
Finished training it 35840/76743 of epoch 0, 109.81 ms/it, loss 0.463533
Finished training it 35840/76743 of epoch 0, 109.75 ms/it, loss 0.465183
Finished training it 35840/76743 of epoch 0, 109.63 ms/it, loss 0.465721
ranking from least wide range to the widest range [11  2 17  9 10  6  0  4  7  3 25  1 18  5 21 19 22  8 24 16 13 20 14 12
 15 23]
Finished training it 36864/76743 of epoch 0, 109.51 ms/it, loss 0.464396
Finished training it 36864/76743 of epoch 0, 109.72 ms/it, loss 0.463334
Finished training it 36864/76743 of epoch 0, 109.57 ms/it, loss 0.466642
Finished training it 36864/76743 of epoch 0, 109.71 ms/it, loss 0.463363
Finished training it 37888/76743 of epoch 0, 110.52 ms/it, loss 0.462759
ranking from least wide range to the widest range [11  9 17  2  6  4 10  0  1  3  7 18 25 21 22 16  5  8 19 24 13 20 14 23
 12 15]
Finished training it 37888/76743 of epoch 0, 110.26 ms/it, loss 0.465366
Finished training it 37888/76743 of epoch 0, 110.41 ms/it, loss 0.465198
Finished training it 37888/76743 of epoch 0, 110.47 ms/it, loss 0.466779
ranking from least wide range to the widest range [11  2 17  6 10  9  0  7  4 25  3 18  1 19 21  5 24  8 16 22 20 13 23 12
 15 14]
Finished training it 38912/76743 of epoch 0, 110.40 ms/it, loss 0.465639
Finished training it 38912/76743 of epoch 0, 110.68 ms/it, loss 0.467373
Finished training it 38912/76743 of epoch 0, 110.63 ms/it, loss 0.464401
Finished training it 38912/76743 of epoch 0, 110.68 ms/it, loss 0.466102
ranking from least wide range to the widest range [ 2 11 17 10  0  4  9  6  7 18 25  3  1 21 19  8 24 16 22  5 13 20 14 23
 12 15]
Finished training it 39936/76743 of epoch 0, 109.88 ms/it, loss 0.463304
Finished training it 39936/76743 of epoch 0, 110.11 ms/it, loss 0.465749
Finished training it 39936/76743 of epoch 0, 110.10 ms/it, loss 0.465514
Finished training it 39936/76743 of epoch 0, 110.14 ms/it, loss 0.463955
ranking from least wide range to the widest range [11  2  9 10 17  6  7  4  0  3  1 18 25 19 16 24 13  8  5 22 21 20 12 23
 14 15]
Finished training it 40960/76743 of epoch 0, 110.05 ms/it, loss 0.464211
Finished training it 40960/76743 of epoch 0, 110.32 ms/it, loss 0.463591
Finished training it 40960/76743 of epoch 0, 110.28 ms/it, loss 0.462583
Finished training it 40960/76743 of epoch 0, 110.35 ms/it, loss 0.466146
Testing at - 40960/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2545531.0
get out
0 has test check 2545531.0 and sample count 3273728
 accuracy 77.756 %, best 77.877 %, roc auc score 0.7831, best 0.7831
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11 17  2 10  9  6  0  4  7  3 25 18  1 21 19  5 16 22  8 13 24 20 23 12
 14 15]
Finished training it 41984/76743 of epoch 0, 109.33 ms/it, loss 0.464041
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2545112.0
get out
3 has test check 2545112.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 109.62 ms/it, loss 0.463266
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2543745.0
get out
2 has test check 2543745.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 109.56 ms/it, loss 0.463954
Testing at - 40960/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2544707.0
get out
1 has test check 2544707.0 and sample count 3273728
Finished training it 41984/76743 of epoch 0, 109.64 ms/it, loss 0.465804
ranking from least wide range to the widest range [11  2 17 10  4  6  9  0  7  3  1 18 25 21 19  5  8 24 16 22 13 20 23 12
 14 15]
Finished training it 43008/76743 of epoch 0, 109.52 ms/it, loss 0.463738
Finished training it 43008/76743 of epoch 0, 109.81 ms/it, loss 0.464116
Finished training it 43008/76743 of epoch 0, 109.79 ms/it, loss 0.464871
Finished training it 43008/76743 of epoch 0, 109.84 ms/it, loss 0.462241
ranking from least wide range to the widest range [11 17  2  9 10  6  0  4  7 18 25  3  1 19 21 24  5 22 16  8 13 20 23 14
 12 15]
Finished training it 44032/76743 of epoch 0, 109.94 ms/it, loss 0.464521
Finished training it 44032/76743 of epoch 0, 110.11 ms/it, loss 0.463903
Finished training it 44032/76743 of epoch 0, 110.18 ms/it, loss 0.463735
Finished training it 44032/76743 of epoch 0, 110.08 ms/it, loss 0.466653
ranking from least wide range to the widest range [11  2 17 10  4  6  9  0  7  3  1 25 18  5 21 19 13 24 22 16  8 20 12 14
 23 15]
Finished training it 45056/76743 of epoch 0, 109.27 ms/it, loss 0.462945
Finished training it 45056/76743 of epoch 0, 109.52 ms/it, loss 0.461474
Finished training it 45056/76743 of epoch 0, 109.49 ms/it, loss 0.465857
Finished training it 45056/76743 of epoch 0, 109.39 ms/it, loss 0.462512
ranking from least wide range to the widest range [11  2 17  0  9  6 10  4 25  7  3  1 18 21  5 16 24 19 13  8 22 20 14 12
 23 15]
Finished training it 46080/76743 of epoch 0, 110.29 ms/it, loss 0.465350
Finished training it 46080/76743 of epoch 0, 110.53 ms/it, loss 0.465250
Finished training it 46080/76743 of epoch 0, 110.45 ms/it, loss 0.462878
Finished training it 46080/76743 of epoch 0, 110.48 ms/it, loss 0.465042
Finished training it 47104/76743 of epoch 0, 109.19 ms/it, loss 0.464193
ranking from least wide range to the widest range [11  2 17  9  4  0 10  6 25  7 18  3  1 21 19 24  5 16 22  8 13 20 23 14
 12 15]
Finished training it 47104/76743 of epoch 0, 109.01 ms/it, loss 0.461738
Finished training it 47104/76743 of epoch 0, 109.07 ms/it, loss 0.465305
Finished training it 47104/76743 of epoch 0, 109.19 ms/it, loss 0.462996
Finished training it 48128/76743 of epoch 0, 109.63 ms/it, loss 0.464706
ranking from least wide range to the widest range [17 11  2  9  4 10  6  7  0  3  1 25 18  5 21 19 22 20 13  8 24 16 23 14
 15 12]
Finished training it 48128/76743 of epoch 0, 109.32 ms/it, loss 0.461861
Finished training it 48128/76743 of epoch 0, 109.58 ms/it, loss 0.461488
Finished training it 48128/76743 of epoch 0, 109.55 ms/it, loss 0.464871
ranking from least wide range to the widest range [11 17  2  6 10  9  7  4  0  3  1 18 25 21 19  5 24  8 16 22 20 13 23 14
 12 15]
Finished training it 49152/76743 of epoch 0, 109.79 ms/it, loss 0.462027
Finished training it 49152/76743 of epoch 0, 109.95 ms/it, loss 0.464155
Finished training it 49152/76743 of epoch 0, 109.95 ms/it, loss 0.464552
Finished training it 49152/76743 of epoch 0, 109.99 ms/it, loss 0.463380
ranking from least wide range to the widest range [11  2 17  9  4 10  6  7  0 25  1  3 18 21 19 16  5  8 24 22 20 13 23 14
 12 15]
Finished training it 50176/76743 of epoch 0, 109.88 ms/it, loss 0.464638
Finished training it 50176/76743 of epoch 0, 110.09 ms/it, loss 0.464626
Finished training it 50176/76743 of epoch 0, 110.05 ms/it, loss 0.463210
Finished training it 50176/76743 of epoch 0, 110.04 ms/it, loss 0.460505
ranking from least wide range to the widest range [11 17  2 10  6  9  4  0  7 25  3 18  1 19  5 21 16 22 24  8 13 20 23 12
 14 15]
Finished training it 51200/76743 of epoch 0, 110.45 ms/it, loss 0.459651
Finished training it 51200/76743 of epoch 0, 110.66 ms/it, loss 0.466682
Finished training it 51200/76743 of epoch 0, 110.57 ms/it, loss 0.462940
Finished training it 51200/76743 of epoch 0, 110.68 ms/it, loss 0.464553
Testing at - 51200/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2554742.0
get out
0 has test check 2554742.0 and sample count 3273728
 accuracy 78.038 %, best 78.038 %, roc auc score 0.7847, best 0.7847
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11  2 17 10  4  6  9  0  7 25 18  1  3 21 19 24  5  8 22 16 13 20 23 12
 14 15]
Finished training it 52224/76743 of epoch 0, 110.01 ms/it, loss 0.463688
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2554801.0
get out
3 has test check 2554801.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 110.30 ms/it, loss 0.464020
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2554706.0
get out
1 has test check 2554706.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 110.12 ms/it, loss 0.463918
Testing at - 51200/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2554820.0
get out
2 has test check 2554820.0 and sample count 3273728
Finished training it 52224/76743 of epoch 0, 110.13 ms/it, loss 0.460994
ranking from least wide range to the widest range [11 17  2 10  4  0  9  6  7  1 18  3 25 21 19 13  8 16 24 22  5 20 12 23
 14 15]
Finished training it 53248/76743 of epoch 0, 109.54 ms/it, loss 0.462717
Finished training it 53248/76743 of epoch 0, 109.71 ms/it, loss 0.464294
Finished training it 53248/76743 of epoch 0, 109.70 ms/it, loss 0.464829
Finished training it 53248/76743 of epoch 0, 109.80 ms/it, loss 0.464658
ranking from least wide range to the widest range [17 11  2  9  0  6  7 10  4 25 18  3  1 21 19 24  8  5 16 20 13 22 23 14
 12 15]
Finished training it 54272/76743 of epoch 0, 109.37 ms/it, loss 0.464202
Finished training it 54272/76743 of epoch 0, 109.58 ms/it, loss 0.463440
Finished training it 54272/76743 of epoch 0, 109.56 ms/it, loss 0.462779
Finished training it 54272/76743 of epoch 0, 109.62 ms/it, loss 0.462393
ranking from least wide range to the widest range [11  2 17 10  4  9  0  6  7 25  3  1 18 21  5 19 24 16  8 22 20 13 23 14
 15 12]
Finished training it 55296/76743 of epoch 0, 109.63 ms/it, loss 0.458760
Finished training it 55296/76743 of epoch 0, 109.82 ms/it, loss 0.464291
Finished training it 55296/76743 of epoch 0, 109.85 ms/it, loss 0.464261
Finished training it 55296/76743 of epoch 0, 109.75 ms/it, loss 0.462245
ranking from least wide range to the widest range [11  2 17 10  6  7  0  4  9  3 18  1 25 19  5 21 20 24 13 22  8 16 23 12
 14 15]
Finished training it 56320/76743 of epoch 0, 109.56 ms/it, loss 0.463280
Finished training it 56320/76743 of epoch 0, 109.74 ms/it, loss 0.461130
Finished training it 56320/76743 of epoch 0, 109.77 ms/it, loss 0.462327
Finished training it 56320/76743 of epoch 0, 109.80 ms/it, loss 0.459834
ranking from least wide range to the widest range [ 2 17 11 10  0  9  6  4 25  1  7 18  3 21 24 19  5 16  8 22 20 13 23 12
 14 15]
Finished training it 57344/76743 of epoch 0, 109.99 ms/it, loss 0.463088
Finished training it 57344/76743 of epoch 0, 110.21 ms/it, loss 0.462248
Finished training it 57344/76743 of epoch 0, 110.21 ms/it, loss 0.462454
Finished training it 57344/76743 of epoch 0, 110.25 ms/it, loss 0.461796
ranking from least wide range to the widest range [ 2 11 17  9  0  4  6 10  7 18  3 25  1 19 24  5 22  8 20 16 21 13 23 14
 15 12]
Finished training it 58368/76743 of epoch 0, 109.56 ms/it, loss 0.461103
Finished training it 58368/76743 of epoch 0, 109.82 ms/it, loss 0.463459
Finished training it 58368/76743 of epoch 0, 109.67 ms/it, loss 0.462854
Finished training it 58368/76743 of epoch 0, 109.82 ms/it, loss 0.460988
Finished training it 59392/76743 of epoch 0, 109.37 ms/it, loss 0.461828
ranking from least wide range to the widest range [17 11  2 10  6  7  4  0  9 18  1  3 25 21  5 22 24  8 16 19 20 13 12 23
 14 15]
Finished training it 59392/76743 of epoch 0, 109.16 ms/it, loss 0.460457
Finished training it 59392/76743 of epoch 0, 109.36 ms/it, loss 0.461850
Finished training it 59392/76743 of epoch 0, 109.35 ms/it, loss 0.462581
ranking from least wide range to the widest range [11 17  2  4  6 10  9  0  7 25  3 18  1 19 21 22 24  5  8 13 16 20 23 12
 14 15]
Finished training it 60416/76743 of epoch 0, 110.33 ms/it, loss 0.462537
Finished training it 60416/76743 of epoch 0, 110.54 ms/it, loss 0.461471
Finished training it 60416/76743 of epoch 0, 110.50 ms/it, loss 0.465046
Finished training it 60416/76743 of epoch 0, 110.46 ms/it, loss 0.460043
ranking from least wide range to the widest range [11  2 17  4  0 10  7  6  9  3 18  1 25 21  5 24 22  8 19 16 13 20 23 12
 14 15]
Finished training it 61440/76743 of epoch 0, 110.07 ms/it, loss 0.463102
Finished training it 61440/76743 of epoch 0, 110.26 ms/it, loss 0.462007
Finished training it 61440/76743 of epoch 0, 110.30 ms/it, loss 0.459667
Finished training it 61440/76743 of epoch 0, 110.10 ms/it, loss 0.462198
Testing at - 61440/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2557085.0
get out
0 has test check 2557085.0 and sample count 3273728
 accuracy 78.109 %, best 78.109 %, roc auc score 0.7865, best 0.7865
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2557055.0
get out
3 has test check 2557055.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 114.19 ms/it, loss 0.457978
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2557252.0
get out
1 has test check 2557252.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 114.22 ms/it, loss 0.462905
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [ 2 11 17  4  0  6  9 10  7 25  3 18  1 16  5  8 19 24 21 22 13 20 23 12
 14 15]
Finished training it 62464/76743 of epoch 0, 109.81 ms/it, loss 0.462516
Testing at - 61440/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2557367.0
get out
2 has test check 2557367.0 and sample count 3273728
Finished training it 62464/76743 of epoch 0, 114.23 ms/it, loss 0.460226
ranking from least wide range to the widest range [11 17  2 10  6  7  4  0  9 18  3 25  1 21 24 16  8 19 13 20  5 22 12 23
 14 15]
Finished training it 63488/76743 of epoch 0, 110.02 ms/it, loss 0.461235
Finished training it 63488/76743 of epoch 0, 110.23 ms/it, loss 0.462236
Finished training it 63488/76743 of epoch 0, 110.24 ms/it, loss 0.460875
Finished training it 63488/76743 of epoch 0, 110.19 ms/it, loss 0.461331
Finished training it 64512/76743 of epoch 0, 109.09 ms/it, loss 0.462869
ranking from least wide range to the widest range [11 17  2 10  6  4  7  0  9  3 18  1 25 21  5 16 22 24  8 13 19 20 23 12
 14 15]
Finished training it 64512/76743 of epoch 0, 108.86 ms/it, loss 0.456076
Finished training it 64512/76743 of epoch 0, 109.06 ms/it, loss 0.460924
Finished training it 64512/76743 of epoch 0, 109.16 ms/it, loss 0.460811
ranking from least wide range to the widest range [11 17  2  9  7 10  6  4  0 18 25  3  1  5 19 21  8 13 16 22 24 20 23 12
 14 15]
Finished training it 65536/76743 of epoch 0, 109.92 ms/it, loss 0.461820
Finished training it 65536/76743 of epoch 0, 110.17 ms/it, loss 0.461128
Finished training it 65536/76743 of epoch 0, 110.10 ms/it, loss 0.462703
Finished training it 65536/76743 of epoch 0, 110.16 ms/it, loss 0.463128
Finished training it 66560/76743 of epoch 0, 110.30 ms/it, loss 0.462090
Finished training it 66560/76743 of epoch 0, 110.35 ms/it, loss 0.460226
ranking from least wide range to the widest range [11 17  2  0  6 10  7  9 18  4  3  1 25 21 24 19  5  8 22 13 16 20 23 14
 12 15]
Finished training it 66560/76743 of epoch 0, 110.17 ms/it, loss 0.462419
Finished training it 66560/76743 of epoch 0, 110.36 ms/it, loss 0.460965
ranking from least wide range to the widest range [11 17  2  0  4  7 10  6  9  3 18 25  1 21  5 24 19 13 16 20  8 22 23 14
 12 15]
Finished training it 67584/76743 of epoch 0, 109.97 ms/it, loss 0.459208
Finished training it 67584/76743 of epoch 0, 110.25 ms/it, loss 0.464570
Finished training it 67584/76743 of epoch 0, 110.09 ms/it, loss 0.464010
Finished training it 67584/76743 of epoch 0, 110.19 ms/it, loss 0.460086
ranking from least wide range to the widest range [11 17  2 10  0  9  6  7  4 18 25  3  1  5 24 21 16 22 19 13  8 20 23 12
 14 15]
Finished training it 68608/76743 of epoch 0, 109.20 ms/it, loss 0.460726
Finished training it 68608/76743 of epoch 0, 109.41 ms/it, loss 0.458684
Finished training it 68608/76743 of epoch 0, 109.47 ms/it, loss 0.460384
Finished training it 68608/76743 of epoch 0, 109.48 ms/it, loss 0.459382
ranking from least wide range to the widest range [11 17  2  0  4  6  7 10  3  9 18 25  1 21  5 19 22 24  8 20 16 13 23 14
 15 12]
Finished training it 69632/76743 of epoch 0, 109.70 ms/it, loss 0.461729
Finished training it 69632/76743 of epoch 0, 109.88 ms/it, loss 0.460100
Finished training it 69632/76743 of epoch 0, 109.86 ms/it, loss 0.459807
Finished training it 69632/76743 of epoch 0, 109.80 ms/it, loss 0.460912
ranking from least wide range to the widest range [11 17  2  7  4  0  6  9 10  3 25  1 18 21  5 19 24 22  8 16 20 13 23 14
 12 15]
Finished training it 70656/76743 of epoch 0, 109.51 ms/it, loss 0.460449
Finished training it 70656/76743 of epoch 0, 109.80 ms/it, loss 0.459938
Finished training it 70656/76743 of epoch 0, 109.66 ms/it, loss 0.459397
Finished training it 70656/76743 of epoch 0, 109.83 ms/it, loss 0.460815
Finished training it 71680/76743 of epoch 0, 110.10 ms/it, loss 0.460111
ranking from least wide range to the widest range [11 17  2 10  6  4  0  7  9  3 25 18  1  5 24 19 21 22 13 16 20  8 23 14
 12 15]
Finished training it 71680/76743 of epoch 0, 109.89 ms/it, loss 0.460204
Finished training it 71680/76743 of epoch 0, 110.04 ms/it, loss 0.460690
Finished training it 71680/76743 of epoch 0, 110.02 ms/it, loss 0.462164
Testing at - 71680/76743 of epoch 0,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2558113.0
get out
0 has test check 2558113.0 and sample count 3273728
 accuracy 78.141 %, best 78.141 %, roc auc score 0.7874, best 0.7874
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2557675.0
get out
3 has test check 2557675.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 109.74 ms/it, loss 0.461224
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [17 11  2 10  6  4  0  7  9  3 18  1 25 21  5 22 13 16 24  8 20 19 23 14
 12 15]
Finished training it 72704/76743 of epoch 0, 109.54 ms/it, loss 0.459941
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2557964.0
get out
2 has test check 2557964.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 109.83 ms/it, loss 0.462857
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2557975.0
get out
1 has test check 2557975.0 and sample count 3273728
Finished training it 72704/76743 of epoch 0, 109.81 ms/it, loss 0.461575
ranking from least wide range to the widest range [11 17  2 10  6  9  0  4  3  7 18 25  1 19  5 21 24  8 22 13 20 16 23 12
 14 15]
Finished training it 73728/76743 of epoch 0, 109.72 ms/it, loss 0.462364
Finished training it 73728/76743 of epoch 0, 109.97 ms/it, loss 0.459194
Finished training it 73728/76743 of epoch 0, 109.93 ms/it, loss 0.461781
Finished training it 73728/76743 of epoch 0, 109.97 ms/it, loss 0.461206
ranking from least wide range to the widest range [11 17  2 10  6  7  0  3  9  4 25 18  1 21  5 24 22  8 19 13 16 20 23 14
 12 15]
Finished training it 74752/76743 of epoch 0, 109.53 ms/it, loss 0.459288
Finished training it 74752/76743 of epoch 0, 109.81 ms/it, loss 0.459915
Finished training it 74752/76743 of epoch 0, 109.81 ms/it, loss 0.458268
Finished training it 74752/76743 of epoch 0, 109.73 ms/it, loss 0.462329
ranking from least wide range to the widest range [11  2 17  0  6 10  3  7  9 25  4  1 18 21  5 24 22 19 13 20  8 16 23 12
 14 15]
Finished training it 75776/76743 of epoch 0, 110.63 ms/it, loss 0.460706
Finished training it 75776/76743 of epoch 0, 110.76 ms/it, loss 0.459149
Finished training it 75776/76743 of epoch 0, 110.87 ms/it, loss 0.456772
Finished training it 75776/76743 of epoch 0, 110.80 ms/it, loss 0.459716
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 110.81 ms/it, loss 0.458615
Warning: Skipping the batch 76742 with size 14
ranking from least wide range to the widest range [ 2 11 17 10  6  3  7  0  4 18 25  9  1  5 21 19 22 13 16 24  8 20 23 14
 12 15]
Finished training it 1024/76743 of epoch 1, 110.15 ms/it, loss 0.460678
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 110.62 ms/it, loss 0.458310
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 110.59 ms/it, loss 0.460234
Finished training it 2048/76743 of epoch 1, 109.55 ms/it, loss 0.460720
ranking from least wide range to the widest range [11  2 17  4  6  9  7 10 18  0 25  3  1 24  5 21  8 19 22 13 20 16 23 14
 12 15]
Finished training it 2048/76743 of epoch 1, 109.31 ms/it, loss 0.461074
Finished training it 2048/76743 of epoch 1, 109.61 ms/it, loss 0.460431
Finished training it 2048/76743 of epoch 1, 109.51 ms/it, loss 0.462297
ranking from least wide range to the widest range [11  2 17 10  6  9  3  0  4 18  7 25  1 21 24  5 19 22  8 13 16 20 23 12
 14 15]
Finished training it 3072/76743 of epoch 1, 110.60 ms/it, loss 0.462171
Finished training it 3072/76743 of epoch 1, 110.86 ms/it, loss 0.459212
Finished training it 3072/76743 of epoch 1, 110.78 ms/it, loss 0.458223
Finished training it 3072/76743 of epoch 1, 110.76 ms/it, loss 0.460177
ranking from least wide range to the widest range [11  2 17  4  6 10  9  7  3  0 25 18  1 21 24 16  5 19  8 22 20 13 23 12
 14 15]
Finished training it 4096/76743 of epoch 1, 109.98 ms/it, loss 0.460113
Finished training it 4096/76743 of epoch 1, 110.22 ms/it, loss 0.462233
Finished training it 4096/76743 of epoch 1, 110.18 ms/it, loss 0.458940
Finished training it 4096/76743 of epoch 1, 110.24 ms/it, loss 0.459225
ranking from least wide range to the widest range [11 17  2  4  6  3 10  7  0 18  9 25 21  1 24  5 22 19 16  8 13 20 23 14
 12 15]
Finished training it 5120/76743 of epoch 1, 110.27 ms/it, loss 0.458807
Finished training it 5120/76743 of epoch 1, 110.59 ms/it, loss 0.463618
Finished training it 5120/76743 of epoch 1, 110.48 ms/it, loss 0.458605
Finished training it 5120/76743 of epoch 1, 110.54 ms/it, loss 0.459390
ranking from least wide range to the widest range [11 17  2  7 10  6  4  0  3 25  9 18  1 19 21 24  5 13 22  8 16 20 23 14
 12 15]
Finished training it 6144/76743 of epoch 1, 110.15 ms/it, loss 0.458546
Finished training it 6144/76743 of epoch 1, 110.29 ms/it, loss 0.459589
Finished training it 6144/76743 of epoch 1, 110.33 ms/it, loss 0.459523
Finished training it 6144/76743 of epoch 1, 110.38 ms/it, loss 0.460543
ranking from least wide range to the widest range [11 17  2 10  6  4  7  3  9  0 18 25  1 21 24 19  5  8 13 22 16 20 12 23
 14 15]
Finished training it 7168/76743 of epoch 1, 109.84 ms/it, loss 0.456703
Finished training it 7168/76743 of epoch 1, 109.99 ms/it, loss 0.458167
Finished training it 7168/76743 of epoch 1, 110.04 ms/it, loss 0.459048
Finished training it 7168/76743 of epoch 1, 110.08 ms/it, loss 0.457981
ranking from least wide range to the widest range [11  2 10 17  4  6  3 18  9  0  7 25  1 21  5 24  8 19 16 13 20 22 23 12
 14 15]
Finished training it 8192/76743 of epoch 1, 110.36 ms/it, loss 0.458414
Finished training it 8192/76743 of epoch 1, 110.58 ms/it, loss 0.459503
Finished training it 8192/76743 of epoch 1, 110.44 ms/it, loss 0.459121
Finished training it 8192/76743 of epoch 1, 110.48 ms/it, loss 0.458684
ranking from least wide range to the widest range [11 17 10  6  2  3  0 18  4  9 25  7  1 21  5 24 22 19 16  8 20 13 23 12
 14 15]
Finished training it 9216/76743 of epoch 1, 110.43 ms/it, loss 0.458677
Finished training it 9216/76743 of epoch 1, 110.66 ms/it, loss 0.460280
Finished training it 9216/76743 of epoch 1, 110.61 ms/it, loss 0.457887
Finished training it 9216/76743 of epoch 1, 110.69 ms/it, loss 0.462187
ranking from least wide range to the widest range [11  2 17 10  6  0  9  4  7  3 18  1 25 21 13 24 22  8 16 19  5 20 23 12
 14 15]
Finished training it 10240/76743 of epoch 1, 110.32 ms/it, loss 0.459000
Finished training it 10240/76743 of epoch 1, 110.44 ms/it, loss 0.459172
Finished training it 10240/76743 of epoch 1, 110.37 ms/it, loss 0.461183
Finished training it 10240/76743 of epoch 1, 110.46 ms/it, loss 0.457986
Testing at - 10240/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2561512.0
get out
0 has test check 2561512.0 and sample count 3273728
 accuracy 78.244 %, best 78.244 %, roc auc score 0.7886, best 0.7886
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11 17 10  0  6  4  2  9 18  7  3 25  1 24 21 19  5 22  8 16 13 20 12 23
 14 15]
Finished training it 11264/76743 of epoch 1, 109.09 ms/it, loss 0.459175
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2561396.0
get out
3 has test check 2561396.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 109.24 ms/it, loss 0.458961
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2561136.0
get out
2 has test check 2561136.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 109.25 ms/it, loss 0.459609
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2561589.0
get out
1 has test check 2561589.0 and sample count 3273728
Finished training it 11264/76743 of epoch 1, 109.32 ms/it, loss 0.458502
ranking from least wide range to the widest range [11 17  2 10  6  7  4  3  0 25 18  9  1  5 24  8 19 21 16 20 13 22 23 12
 14 15]
Finished training it 12288/76743 of epoch 1, 110.29 ms/it, loss 0.457157
Finished training it 12288/76743 of epoch 1, 110.50 ms/it, loss 0.457296
Finished training it 12288/76743 of epoch 1, 110.37 ms/it, loss 0.458298
Finished training it 12288/76743 of epoch 1, 110.44 ms/it, loss 0.461201
Finished training it 13312/76743 of epoch 1, 110.16 ms/it, loss 0.457625
ranking from least wide range to the widest range [11 17  2 10  6  9  4  3  0 18  7 25  1 21 24  5 22  8 16 13 19 20 12 23
 14 15]
Finished training it 13312/76743 of epoch 1, 109.92 ms/it, loss 0.459465
Finished training it 13312/76743 of epoch 1, 110.03 ms/it, loss 0.458023
Finished training it 13312/76743 of epoch 1, 110.15 ms/it, loss 0.458518
ranking from least wide range to the widest range [11 17  2 10  6  4  7  3  9  0 25 18  1  5 22 21  8 24 13 16 19 20 23 12
 14 15]
Finished training it 14336/76743 of epoch 1, 109.39 ms/it, loss 0.459793
Finished training it 14336/76743 of epoch 1, 109.71 ms/it, loss 0.457978
Finished training it 14336/76743 of epoch 1, 109.58 ms/it, loss 0.458584
Finished training it 14336/76743 of epoch 1, 109.63 ms/it, loss 0.459877
ranking from least wide range to the widest range [11 17  2  3 10  0  6  7  4  9 18 25  1  5 24 21 16 19 13 22  8 20 23 14
 12 15]
Finished training it 15360/76743 of epoch 1, 113.15 ms/it, loss 0.459099
Finished training it 15360/76743 of epoch 1, 113.08 ms/it, loss 0.458520
Finished training it 15360/76743 of epoch 1, 113.15 ms/it, loss 0.460227
Finished training it 15360/76743 of epoch 1, 113.14 ms/it, loss 0.459536
ranking from least wide range to the widest range [11  2 17 10  6  4 25  3  0  7  9 18  1  5 19  8 21 24 16 13 22 20 23 12
 14 15]
Finished training it 16384/76743 of epoch 1, 110.27 ms/it, loss 0.460214
Finished training it 16384/76743 of epoch 1, 110.38 ms/it, loss 0.457832
Finished training it 16384/76743 of epoch 1, 110.45 ms/it, loss 0.457753
Finished training it 16384/76743 of epoch 1, 110.42 ms/it, loss 0.456602
ranking from least wide range to the widest range [11 17 10  2  4  6  0  3 25  7 18  9  1 24  5 21 13 16 22 19  8 20 23 12
 14 15]
Finished training it 17408/76743 of epoch 1, 113.43 ms/it, loss 0.459752
Finished training it 17408/76743 of epoch 1, 113.78 ms/it, loss 0.458490
Finished training it 17408/76743 of epoch 1, 113.77 ms/it, loss 0.459926
Finished training it 17408/76743 of epoch 1, 113.78 ms/it, loss 0.456496
ranking from least wide range to the widest range [17 11  2  4 10  6  3  9  0  7 18 25  1 21 19 24  5 22  8 16 20 13 23 14
 12 15]
Finished training it 18432/76743 of epoch 1, 109.79 ms/it, loss 0.459551
Finished training it 18432/76743 of epoch 1, 110.01 ms/it, loss 0.460895
Finished training it 18432/76743 of epoch 1, 110.01 ms/it, loss 0.459639
Finished training it 18432/76743 of epoch 1, 110.00 ms/it, loss 0.460679
Finished training it 19456/76743 of epoch 1, 110.10 ms/it, loss 0.458270
Finished training it 19456/76743 of epoch 1, 109.98 ms/it, loss 0.456752
ranking from least wide range to the widest range [11 17 10  9  6  2  3  4  7 18  0 25  1 21  5 19 24  8 13 22 16 20 23 14
 12 15]
Finished training it 19456/76743 of epoch 1, 109.83 ms/it, loss 0.461001
Finished training it 19456/76743 of epoch 1, 110.06 ms/it, loss 0.459184
Finished training it 20480/76743 of epoch 1, 109.62 ms/it, loss 0.457722
Finished training it 20480/76743 of epoch 1, 109.57 ms/it, loss 0.459009
Finished training it 20480/76743 of epoch 1, 109.65 ms/it, loss 0.456316
ranking from least wide range to the widest range [11 17  2 10  6  3  4  0  9  7 25 18 21  1  5 19 24 22 20 13  8 16 23 14
 12 15]
Finished training it 20480/76743 of epoch 1, 109.40 ms/it, loss 0.460793
Testing at - 20480/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2561657.0
get out
0 has test check 2561657.0 and sample count 3273728
 accuracy 78.249 %, best 78.249 %, roc auc score 0.7896, best 0.7896
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11 17  2 10  6  4  0  3  9 18  7 25  1 21 22 24 19 13 16  8 20  5 23 14
 12 15]
Finished training it 21504/76743 of epoch 1, 109.51 ms/it, loss 0.458491
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2561467.0
get out
3 has test check 2561467.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 109.55 ms/it, loss 0.458804
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2561658.0
get out
2 has test check 2561658.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 109.55 ms/it, loss 0.455847
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2561491.0
get out
1 has test check 2561491.0 and sample count 3273728
Finished training it 21504/76743 of epoch 1, 109.57 ms/it, loss 0.457176
Finished training it 22528/76743 of epoch 1, 109.85 ms/it, loss 0.459197
ranking from least wide range to the widest range [11 17  2  4 10  6  0  7  9  3 25 18  1 24 21  5 22 16 13  8 19 20 23 14
 12 15]
Finished training it 22528/76743 of epoch 1, 109.67 ms/it, loss 0.458168
Finished training it 22528/76743 of epoch 1, 109.93 ms/it, loss 0.457113
Finished training it 22528/76743 of epoch 1, 109.86 ms/it, loss 0.457236
ranking from least wide range to the widest range [11 17  2 10  0  6  9  3 25 18  4  7 21  1  8  5 24 13 19 16 22 20 23 14
 12 15]
Finished training it 23552/76743 of epoch 1, 110.47 ms/it, loss 0.460448
Finished training it 23552/76743 of epoch 1, 110.54 ms/it, loss 0.458334
Finished training it 23552/76743 of epoch 1, 110.69 ms/it, loss 0.457642
Finished training it 23552/76743 of epoch 1, 110.54 ms/it, loss 0.458788
ranking from least wide range to the widest range [11  2 17 10  6  9  0  7  3 25  4 18  1  5 13 19  8 24 22 16 20 21 23 14
 12 15]
Finished training it 24576/76743 of epoch 1, 109.43 ms/it, loss 0.460158
Finished training it 24576/76743 of epoch 1, 109.68 ms/it, loss 0.459051
Finished training it 24576/76743 of epoch 1, 109.72 ms/it, loss 0.458404
Finished training it 24576/76743 of epoch 1, 109.59 ms/it, loss 0.458930
ranking from least wide range to the widest range [11 17  2 10  6  0  3  4 25  7  1  9 18  5 24 22 21 13 19 20  8 16 23 14
 12 15]
Finished training it 25600/76743 of epoch 1, 110.02 ms/it, loss 0.458880
Finished training it 25600/76743 of epoch 1, 110.31 ms/it, loss 0.458137
Finished training it 25600/76743 of epoch 1, 110.29 ms/it, loss 0.457769
Finished training it 25600/76743 of epoch 1, 110.29 ms/it, loss 0.457869
ranking from least wide range to the widest range [11  2 17 10  6  3  9  0  4  7  1 18 25 21 19 24 22  5 13  8 20 16 12 23
 14 15]
Finished training it 26624/76743 of epoch 1, 109.89 ms/it, loss 0.460964
Finished training it 26624/76743 of epoch 1, 110.10 ms/it, loss 0.457503
Finished training it 26624/76743 of epoch 1, 110.01 ms/it, loss 0.456178
Finished training it 26624/76743 of epoch 1, 110.09 ms/it, loss 0.458360
ranking from least wide range to the widest range [11 17  0  2 10  6  3  9  7  4  1 18 25 21 16 24 22  8  5 19 13 20 12 23
 14 15]
Finished training it 27648/76743 of epoch 1, 110.37 ms/it, loss 0.458960
Finished training it 27648/76743 of epoch 1, 110.67 ms/it, loss 0.457049
Finished training it 27648/76743 of epoch 1, 110.63 ms/it, loss 0.456269
Finished training it 27648/76743 of epoch 1, 110.57 ms/it, loss 0.459680
ranking from least wide range to the widest range [11 17 10  2  6  0  4  3  9  7 25 18  1 21 24  5 13  8 16 19 22 20 23 12
 14 15]
Finished training it 28672/76743 of epoch 1, 110.24 ms/it, loss 0.457976
Finished training it 28672/76743 of epoch 1, 110.42 ms/it, loss 0.457603
Finished training it 28672/76743 of epoch 1, 110.46 ms/it, loss 0.456513
Finished training it 28672/76743 of epoch 1, 110.44 ms/it, loss 0.461403
ranking from least wide range to the widest range [ 2 17 11 10  6  9  0  3  4  7 18 25  1 22  5 13 21 19 24  8 16 20 23 12
 14 15]
Finished training it 29696/76743 of epoch 1, 110.27 ms/it, loss 0.457720
Finished training it 29696/76743 of epoch 1, 110.48 ms/it, loss 0.458848
Finished training it 29696/76743 of epoch 1, 110.61 ms/it, loss 0.456633
Finished training it 29696/76743 of epoch 1, 110.57 ms/it, loss 0.457923
ranking from least wide range to the widest range [11  2 17  0 10  6  9  7  3  4 25 18  1  5 21 24 19 22 13 16 20  8 23 12
 14 15]
Finished training it 30720/76743 of epoch 1, 109.71 ms/it, loss 0.457364
Finished training it 30720/76743 of epoch 1, 109.91 ms/it, loss 0.457221
Finished training it 30720/76743 of epoch 1, 109.94 ms/it, loss 0.457802
Finished training it 30720/76743 of epoch 1, 109.97 ms/it, loss 0.456738
Testing at - 30720/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2562643.0
get out
0 has test check 2562643.0 and sample count 3273728
 accuracy 78.279 %, best 78.279 %, roc auc score 0.7898, best 0.7898
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11 17  2 10  0  3  4  6  7  9 25  1 18 13  5 24 21 16  8 19 22 20 23 14
 12 15]
Finished training it 31744/76743 of epoch 1, 110.21 ms/it, loss 0.456352
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2562563.0
get out
3 has test check 2562563.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 110.43 ms/it, loss 0.456481
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2562688.0
get out
2 has test check 2562688.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 110.33 ms/it, loss 0.457857
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2562647.0
get out
1 has test check 2562647.0 and sample count 3273728
Finished training it 31744/76743 of epoch 1, 110.39 ms/it, loss 0.458732
ranking from least wide range to the widest range [17 11 10  2  6  9  3  0  7 25  4  1 18 21  5 22 24 13  8 19 20 16 23 12
 14 15]
Finished training it 32768/76743 of epoch 1, 110.37 ms/it, loss 0.457938
Finished training it 32768/76743 of epoch 1, 110.59 ms/it, loss 0.457533
Finished training it 32768/76743 of epoch 1, 110.52 ms/it, loss 0.460357
Finished training it 32768/76743 of epoch 1, 110.54 ms/it, loss 0.457398
ranking from least wide range to the widest range [11 17 10  2  6  3  0  4  7  9 25 18  1 21  5 22  8 16 24 19 13 20 23 12
 14 15]
Finished training it 33792/76743 of epoch 1, 110.56 ms/it, loss 0.457230
Finished training it 33792/76743 of epoch 1, 110.78 ms/it, loss 0.457693
Finished training it 33792/76743 of epoch 1, 110.71 ms/it, loss 0.458667
Finished training it 33792/76743 of epoch 1, 110.64 ms/it, loss 0.454754
ranking from least wide range to the widest range [11  2 17  0 10  9  6  3  7 25  4  1 18 24 21 22  5  8 19 13 16 20 23 14
 12 15]
Finished training it 34816/76743 of epoch 1, 109.92 ms/it, loss 0.455355
Finished training it 34816/76743 of epoch 1, 110.17 ms/it, loss 0.455614
Finished training it 34816/76743 of epoch 1, 110.18 ms/it, loss 0.458466
Finished training it 34816/76743 of epoch 1, 110.26 ms/it, loss 0.457635
ranking from least wide range to the widest range [11  2 17 10  6  9  0  3  4  7 25 18  1  5 21  8 22 24 13 19 16 20 23 12
 14 15]
Finished training it 35840/76743 of epoch 1, 109.77 ms/it, loss 0.455152
Finished training it 35840/76743 of epoch 1, 110.11 ms/it, loss 0.455570
Finished training it 35840/76743 of epoch 1, 110.00 ms/it, loss 0.458175
Finished training it 35840/76743 of epoch 1, 110.11 ms/it, loss 0.457113
Finished training it 36864/76743 of epoch 1, 109.99 ms/it, loss 0.455942
ranking from least wide range to the widest range [11 17  2 10  6  0  9  3  7  4 25 18  1  5 21 19 22 24 13 16  8 20 12 14
 23 15]
Finished training it 36864/76743 of epoch 1, 109.84 ms/it, loss 0.457005
Finished training it 36864/76743 of epoch 1, 110.01 ms/it, loss 0.459732
Finished training it 36864/76743 of epoch 1, 110.04 ms/it, loss 0.456833
ranking from least wide range to the widest range [ 2 17 11 10  0  3  6  9  4  7  1 25 18 21  5 22 24  8 20 16 13 19 23 14
 12 15]
Finished training it 37888/76743 of epoch 1, 108.98 ms/it, loss 0.458319
Finished training it 37888/76743 of epoch 1, 109.24 ms/it, loss 0.458433
Finished training it 37888/76743 of epoch 1, 109.30 ms/it, loss 0.459412
Finished training it 37888/76743 of epoch 1, 109.29 ms/it, loss 0.455836
ranking from least wide range to the widest range [17  2 11 10  0  7  6  3  4  9 25 18  1 21  5 19 24 22  8 13 16 20 23 12
 14 15]
Finished training it 38912/76743 of epoch 1, 110.49 ms/it, loss 0.458175
Finished training it 38912/76743 of epoch 1, 110.82 ms/it, loss 0.460039
Finished training it 38912/76743 of epoch 1, 110.66 ms/it, loss 0.456883
Finished training it 38912/76743 of epoch 1, 110.80 ms/it, loss 0.458689
ranking from least wide range to the widest range [ 2 17 11 10  0  6  4  3  9  7 18 25  1 21 22 24  5  8 16 19 20 13 23 12
 14 15]
Finished training it 39936/76743 of epoch 1, 109.92 ms/it, loss 0.456179
Finished training it 39936/76743 of epoch 1, 109.95 ms/it, loss 0.458644
Finished training it 39936/76743 of epoch 1, 110.10 ms/it, loss 0.458531
Finished training it 39936/76743 of epoch 1, 110.21 ms/it, loss 0.456532
ranking from least wide range to the widest range [11 17 10  2  6  9  3  4  0  7 25  1 18  5 19 22 24 21  8 13 16 20 23 12
 14 15]
Finished training it 40960/76743 of epoch 1, 109.63 ms/it, loss 0.456818
Finished training it 40960/76743 of epoch 1, 109.75 ms/it, loss 0.455594
Finished training it 40960/76743 of epoch 1, 109.81 ms/it, loss 0.456494
Finished training it 40960/76743 of epoch 1, 109.88 ms/it, loss 0.458709
Testing at - 40960/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2559789.0
get out
0 has test check 2559789.0 and sample count 3273728
 accuracy 78.192 %, best 78.279 %, roc auc score 0.7904, best 0.7904
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11 17 10  2  0  6  3  4  9  7 18 25  1 22 13 21  5 24 19  8 16 20 23 12
 14 15]
Finished training it 41984/76743 of epoch 1, 110.72 ms/it, loss 0.456827
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2558912.0
get out
3 has test check 2558912.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 110.93 ms/it, loss 0.455816
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2558883.0
get out
2 has test check 2558883.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 110.93 ms/it, loss 0.456871
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2558878.0
get out
1 has test check 2558878.0 and sample count 3273728
Finished training it 41984/76743 of epoch 1, 110.77 ms/it, loss 0.458679
ranking from least wide range to the widest range [11 17 10  2  3  6  0  9  7  4  1 25 18  5 21 24 19 22  8 13 16 20 14 12
 23 15]
Finished training it 43008/76743 of epoch 1, 109.42 ms/it, loss 0.456744
Finished training it 43008/76743 of epoch 1, 109.73 ms/it, loss 0.456967
Finished training it 43008/76743 of epoch 1, 109.69 ms/it, loss 0.455100
Finished training it 43008/76743 of epoch 1, 109.65 ms/it, loss 0.458026
ranking from least wide range to the widest range [ 2 11 17 10  0  6  9  3 25  4  7 18  1 24 22 21 19  5  8 13 16 20 23 12
 14 15]
Finished training it 44032/76743 of epoch 1, 109.09 ms/it, loss 0.457631
Finished training it 44032/76743 of epoch 1, 109.36 ms/it, loss 0.456449
Finished training it 44032/76743 of epoch 1, 109.42 ms/it, loss 0.456937
Finished training it 44032/76743 of epoch 1, 109.27 ms/it, loss 0.460251
ranking from least wide range to the widest range [11 17  2  0 10  4  6  3  9  7 25  1 18  5 21 24 19 13 22  8 16 20 23 12
 14 15]
Finished training it 45056/76743 of epoch 1, 109.59 ms/it, loss 0.456205
Finished training it 45056/76743 of epoch 1, 109.88 ms/it, loss 0.458988
Finished training it 45056/76743 of epoch 1, 109.86 ms/it, loss 0.455483
Finished training it 45056/76743 of epoch 1, 109.84 ms/it, loss 0.454618
ranking from least wide range to the widest range [11  2 17 10  6  0  9  4  3  7 25 18  1 24 22  5 21 13 16  8 19 20 23 14
 12 15]
Finished training it 46080/76743 of epoch 1, 109.93 ms/it, loss 0.459428
Finished training it 46080/76743 of epoch 1, 110.08 ms/it, loss 0.458652
Finished training it 46080/76743 of epoch 1, 110.05 ms/it, loss 0.456716
Finished training it 46080/76743 of epoch 1, 110.08 ms/it, loss 0.457866
ranking from least wide range to the widest range [11 17  2  4 10  3  6  0 25  7  9 18  1 22 24 19  5 16  8 21 20 13 23 14
 12 15]
Finished training it 47104/76743 of epoch 1, 109.77 ms/it, loss 0.455428
Finished training it 47104/76743 of epoch 1, 110.01 ms/it, loss 0.456382
Finished training it 47104/76743 of epoch 1, 109.99 ms/it, loss 0.457972
Finished training it 47104/76743 of epoch 1, 109.95 ms/it, loss 0.459050
ranking from least wide range to the widest range [17 11  2 10  3  0  6  9  4  7  1 25 18  5 22 24 21 19 13 20  8 16 23 14
 12 15]
Finished training it 48128/76743 of epoch 1, 109.99 ms/it, loss 0.455219
Finished training it 48128/76743 of epoch 1, 110.21 ms/it, loss 0.458081
Finished training it 48128/76743 of epoch 1, 110.18 ms/it, loss 0.454886
Finished training it 48128/76743 of epoch 1, 110.16 ms/it, loss 0.458194
Finished training it 49152/76743 of epoch 1, 110.10 ms/it, loss 0.457171
ranking from least wide range to the widest range [11  2 17 10  6  3  0  7  4 25  9 18  1 21  5 24 19  8 22 13 16 20 12 23
 14 15]
Finished training it 49152/76743 of epoch 1, 109.89 ms/it, loss 0.455241
Finished training it 49152/76743 of epoch 1, 110.05 ms/it, loss 0.457268
Finished training it 49152/76743 of epoch 1, 110.04 ms/it, loss 0.457771
ranking from least wide range to the widest range [11 17  2 10  6  7  3  9  0  4 25  1 18 24  5  8 16 19 22 21 13 20 23 12
 14 15]
Finished training it 50176/76743 of epoch 1, 110.38 ms/it, loss 0.458315
Finished training it 50176/76743 of epoch 1, 110.64 ms/it, loss 0.458358
Finished training it 50176/76743 of epoch 1, 110.67 ms/it, loss 0.457009
Finished training it 50176/76743 of epoch 1, 110.61 ms/it, loss 0.454534
ranking from least wide range to the widest range [ 2 10 11 17  6  0  3  9  7  4 25 18  1 21 24 19  5 22  8 16 20 13 23 14
 12 15]
Finished training it 51200/76743 of epoch 1, 109.88 ms/it, loss 0.453900
Finished training it 51200/76743 of epoch 1, 110.14 ms/it, loss 0.458083
Finished training it 51200/76743 of epoch 1, 110.08 ms/it, loss 0.456351
Finished training it 51200/76743 of epoch 1, 110.09 ms/it, loss 0.460571
Testing at - 51200/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2565006.0
get out
0 has test check 2565006.0 and sample count 3273728
 accuracy 78.351 %, best 78.351 %, roc auc score 0.7914, best 0.7914
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 17 11 10  6  0  9  4  3  7 25 18  5  1 21 24 13 22  8 19 16 20 23 12
 14 15]
Finished training it 52224/76743 of epoch 1, 110.14 ms/it, loss 0.458051
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2564934.0
get out
3 has test check 2564934.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 110.26 ms/it, loss 0.457464
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2565207.0
get out
2 has test check 2565207.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 110.33 ms/it, loss 0.454303
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2565196.0
get out
1 has test check 2565196.0 and sample count 3273728
Finished training it 52224/76743 of epoch 1, 110.28 ms/it, loss 0.457787
Finished training it 53248/76743 of epoch 1, 114.17 ms/it, loss 0.457802
ranking from least wide range to the widest range [11 17  2 10  3  4  0  7  6  9  1 25 18 21 13  5 19  8 22 24 16 20 23 12
 14 15]
Finished training it 53248/76743 of epoch 1, 114.17 ms/it, loss 0.456369
Finished training it 53248/76743 of epoch 1, 114.07 ms/it, loss 0.458016
Finished training it 53248/76743 of epoch 1, 114.05 ms/it, loss 0.458146
Finished training it 54272/76743 of epoch 1, 110.11 ms/it, loss 0.457153
Finished training it 54272/76743 of epoch 1, 110.08 ms/it, loss 0.456310
Finished training it 54272/76743 of epoch 1, 110.01 ms/it, loss 0.456533
ranking from least wide range to the widest range [11  2 17 10  6  9  3  0  7  4 25 18 24 19 21  1  5  8 22 13 16 20 12 23
 14 15]
Finished training it 54272/76743 of epoch 1, 109.87 ms/it, loss 0.457513
Finished training it 55296/76743 of epoch 1, 109.76 ms/it, loss 0.458166
Finished training it 55296/76743 of epoch 1, 109.81 ms/it, loss 0.455550
ranking from least wide range to the widest range [11  2 17 10  6  3  4  0  7  9 25  1 18  5 22 19 21 24 16  8 13 20 23 14
 12 15]
Finished training it 55296/76743 of epoch 1, 109.61 ms/it, loss 0.452530
Finished training it 55296/76743 of epoch 1, 109.81 ms/it, loss 0.458464
Finished training it 56320/76743 of epoch 1, 113.87 ms/it, loss 0.455162
Finished training it 56320/76743 of epoch 1, 113.77 ms/it, loss 0.454076
ranking from least wide range to the widest range [11  2 17 10  6  3  0  7  9  4 25 18  1 19  5 22 13  8 24 21 20 16 23 14
 12 15]
Finished training it 56320/76743 of epoch 1, 113.40 ms/it, loss 0.457722
Finished training it 56320/76743 of epoch 1, 113.67 ms/it, loss 0.456352
ranking from least wide range to the widest range [11 17  2 10  0  6  3 25  4  7  9 18  1  5 24 19 22 21 16  8 13 20 12 23
 14 15]
Finished training it 57344/76743 of epoch 1, 109.20 ms/it, loss 0.457206
Finished training it 57344/76743 of epoch 1, 109.37 ms/it, loss 0.455921
Finished training it 57344/76743 of epoch 1, 109.37 ms/it, loss 0.456696
Finished training it 57344/76743 of epoch 1, 109.38 ms/it, loss 0.456389
ranking from least wide range to the widest range [ 2 11 17 10  3  0  6  7  4  9 25 18 24  1  5 19 21 22 13  8 16 20 23 14
 12 15]
Finished training it 58368/76743 of epoch 1, 110.09 ms/it, loss 0.455607
Finished training it 58368/76743 of epoch 1, 110.32 ms/it, loss 0.457471
Finished training it 58368/76743 of epoch 1, 110.30 ms/it, loss 0.457377
Finished training it 58368/76743 of epoch 1, 110.31 ms/it, loss 0.455590
ranking from least wide range to the widest range [11  2 17 10  6  3  7  0  4 25  9 21  1  5 18 19 22 24 16 20 13  8 12 23
 14 15]
Finished training it 59392/76743 of epoch 1, 109.93 ms/it, loss 0.455142
Finished training it 59392/76743 of epoch 1, 110.18 ms/it, loss 0.456649
Finished training it 59392/76743 of epoch 1, 110.13 ms/it, loss 0.456878
Finished training it 59392/76743 of epoch 1, 110.21 ms/it, loss 0.456063
ranking from least wide range to the widest range [11  2  3 17 10  6  0  4 25  7  9 18  1 22 19  5 13 21 24 16  8 20 23 12
 14 15]
Finished training it 60416/76743 of epoch 1, 109.63 ms/it, loss 0.457181
Finished training it 60416/76743 of epoch 1, 109.78 ms/it, loss 0.454849
Finished training it 60416/76743 of epoch 1, 109.89 ms/it, loss 0.456520
Finished training it 60416/76743 of epoch 1, 109.87 ms/it, loss 0.459174
ranking from least wide range to the widest range [17 11  2 10  0  6  3  7  4  9 25 18  5  1 24 22 19 16 13 21  8 20 23 12
 14 15]
Finished training it 61440/76743 of epoch 1, 109.34 ms/it, loss 0.458189
Finished training it 61440/76743 of epoch 1, 109.45 ms/it, loss 0.456861
Finished training it 61440/76743 of epoch 1, 109.57 ms/it, loss 0.456345
Finished training it 61440/76743 of epoch 1, 109.59 ms/it, loss 0.454206
Testing at - 61440/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2565562.0
get out
0 has test check 2565562.0 and sample count 3273728
 accuracy 78.368 %, best 78.368 %, roc auc score 0.7918, best 0.7918
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 10 17  3  6  7  0  4 25  9 18  1  5 21 19 16 24  8 22 13 20 23 12
 14 15]
Finished training it 62464/76743 of epoch 1, 109.87 ms/it, loss 0.457221
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2565481.0
get out
3 has test check 2565481.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 110.14 ms/it, loss 0.452600
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2565485.0
get out
1 has test check 2565485.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 110.10 ms/it, loss 0.457746
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2565455.0
get out
2 has test check 2565455.0 and sample count 3273728
Finished training it 62464/76743 of epoch 1, 110.05 ms/it, loss 0.455134
ranking from least wide range to the widest range [11  2 17 10  7  0  3  6  4 25  9 18 21  1  5 24 16 13 22 19  8 20 23 12
 14 15]
Finished training it 63488/76743 of epoch 1, 110.23 ms/it, loss 0.456247
Finished training it 63488/76743 of epoch 1, 110.58 ms/it, loss 0.456620
Finished training it 63488/76743 of epoch 1, 110.45 ms/it, loss 0.457648
Finished training it 63488/76743 of epoch 1, 110.50 ms/it, loss 0.455591
ranking from least wide range to the widest range [11 10 17  2  6  3  4  0  7  9 25  1 21  5 18 24 13 22 19 16  8 20 12 23
 14 15]
Finished training it 64512/76743 of epoch 1, 110.19 ms/it, loss 0.451458
Finished training it 64512/76743 of epoch 1, 110.46 ms/it, loss 0.457704
Finished training it 64512/76743 of epoch 1, 110.41 ms/it, loss 0.455639
Finished training it 64512/76743 of epoch 1, 110.34 ms/it, loss 0.455732
ranking from least wide range to the widest range [11  2 17 10  0  6  3  4  9  7 25 18 21  1  5 19 13 16 22 24  8 20 23 12
 14 15]
Finished training it 65536/76743 of epoch 1, 109.87 ms/it, loss 0.456995
Finished training it 65536/76743 of epoch 1, 109.96 ms/it, loss 0.456076
Finished training it 65536/76743 of epoch 1, 109.97 ms/it, loss 0.457370
Finished training it 65536/76743 of epoch 1, 109.94 ms/it, loss 0.457815
ranking from least wide range to the widest range [ 2 11 17 10  3  6  4  0  7 25  9  1 18 21 13  5 19 24 22  8 16 20 23 14
 12 15]
Finished training it 66560/76743 of epoch 1, 109.78 ms/it, loss 0.457313
Finished training it 66560/76743 of epoch 1, 109.91 ms/it, loss 0.456264
Finished training it 66560/76743 of epoch 1, 109.91 ms/it, loss 0.456091
Finished training it 66560/76743 of epoch 1, 109.93 ms/it, loss 0.455253
ranking from least wide range to the widest range [17 11  2 10  3  4  6  0  9  7 25  1 18 21  5 24 19 13 20  8 22 16 23 14
 12 15]
Finished training it 67584/76743 of epoch 1, 109.62 ms/it, loss 0.454393
Finished training it 67584/76743 of epoch 1, 109.79 ms/it, loss 0.459971
Finished training it 67584/76743 of epoch 1, 109.88 ms/it, loss 0.455416
Finished training it 67584/76743 of epoch 1, 109.81 ms/it, loss 0.459035
ranking from least wide range to the widest range [17 10  2 11  6  4  3  0  7  9 25 18  1 21 24  5 22 19 16 13  8 20 12 23
 14 15]
Finished training it 68608/76743 of epoch 1, 109.46 ms/it, loss 0.455481
Finished training it 68608/76743 of epoch 1, 109.69 ms/it, loss 0.453453
Finished training it 68608/76743 of epoch 1, 109.73 ms/it, loss 0.454689
Finished training it 68608/76743 of epoch 1, 109.79 ms/it, loss 0.455769
ranking from least wide range to the widest range [ 2 11 17 10  3  6  4  7  0 25  9 18  1 19 21  5 22 24  8 16 13 20 23 14
 12 15]
Finished training it 69632/76743 of epoch 1, 110.38 ms/it, loss 0.456921
Finished training it 69632/76743 of epoch 1, 110.64 ms/it, loss 0.455518
Finished training it 69632/76743 of epoch 1, 110.59 ms/it, loss 0.455900
Finished training it 69632/76743 of epoch 1, 110.61 ms/it, loss 0.454870
ranking from least wide range to the widest range [11  2 17 10  4  0  6  3  7  9 25  1 21 18  5 24 19 22  8 16 13 20 23 14
 12 15]
Finished training it 70656/76743 of epoch 1, 109.39 ms/it, loss 0.455642
Finished training it 70656/76743 of epoch 1, 109.65 ms/it, loss 0.454205
Finished training it 70656/76743 of epoch 1, 109.59 ms/it, loss 0.455103
Finished training it 70656/76743 of epoch 1, 109.65 ms/it, loss 0.455988
ranking from least wide range to the widest range [11  2 10  0 17  6  3  4  7  9 25  1 18  5 19 24 22 21  8 13 16 20 23 12
 14 15]
Finished training it 71680/76743 of epoch 1, 109.76 ms/it, loss 0.455359
Finished training it 71680/76743 of epoch 1, 109.93 ms/it, loss 0.455498
Finished training it 71680/76743 of epoch 1, 109.93 ms/it, loss 0.456235
Finished training it 71680/76743 of epoch 1, 110.03 ms/it, loss 0.457111
Testing at - 71680/76743 of epoch 1,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2564810.0
get out
0 has test check 2564810.0 and sample count 3273728
 accuracy 78.345 %, best 78.368 %, roc auc score 0.7921, best 0.7921
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2564633.0
get out
3 has test check 2564633.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 110.04 ms/it, loss 0.455687
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2564816.0
get out
2 has test check 2564816.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 110.04 ms/it, loss 0.457661
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2564807.0
get out
1 has test check 2564807.0 and sample count 3273728
Finished training it 72704/76743 of epoch 1, 110.06 ms/it, loss 0.456681
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 17 11 10  3  6  0  4  7  9 25  1 18 21 22  5 13 19  8 24 16 20 23 14
 12 15]
Finished training it 72704/76743 of epoch 1, 109.83 ms/it, loss 0.454848
ranking from least wide range to the widest range [ 2 11 17 10  3  0  6  9  7  4 25 18 21  1  5 24 22 19  8 13 16 20 23 12
 14 15]
Finished training it 73728/76743 of epoch 1, 109.97 ms/it, loss 0.458186
Finished training it 73728/76743 of epoch 1, 110.10 ms/it, loss 0.457220
Finished training it 73728/76743 of epoch 1, 110.28 ms/it, loss 0.454477
Finished training it 73728/76743 of epoch 1, 110.18 ms/it, loss 0.456782
ranking from least wide range to the widest range [11  2 17 10  3  0  6  4  7  9 25  1 18 19 21  5 24  8 13 22 16 20 23 12
 14 15]
Finished training it 74752/76743 of epoch 1, 110.64 ms/it, loss 0.454286
Finished training it 74752/76743 of epoch 1, 110.88 ms/it, loss 0.457776
Finished training it 74752/76743 of epoch 1, 110.93 ms/it, loss 0.455553
Finished training it 74752/76743 of epoch 1, 110.85 ms/it, loss 0.453615
ranking from least wide range to the widest range [ 2 11 17 10  3  6  7  4 25  0  9  1 18 24 19  5 21 22 13 16  8 20 12 23
 14 15]
Finished training it 75776/76743 of epoch 1, 109.56 ms/it, loss 0.456275
Finished training it 75776/76743 of epoch 1, 109.84 ms/it, loss 0.452481
Finished training it 75776/76743 of epoch 1, 109.84 ms/it, loss 0.454998
Finished training it 75776/76743 of epoch 1, 109.86 ms/it, loss 0.454940
Warning: Skipping the batch 76742 with size 14
ranking from least wide range to the widest range [ 2 11 10 17  3  6  0  4 25  7  9 18  1 22  5 19 21 24 13 16  8 20 23 12
 14 15]
Finished training it 1024/76743 of epoch 2, 109.91 ms/it, loss 0.456222
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 110.70 ms/it, loss 0.454217
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 110.48 ms/it, loss 0.453553
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 110.44 ms/it, loss 0.455731
ranking from least wide range to the widest range [11  2 10 17  3  0  6  7 25  9  4  1 18 24 19  5 22  8 21 13 20 16 23 12
 14 15]
Finished training it 2048/76743 of epoch 2, 109.75 ms/it, loss 0.456675
Finished training it 2048/76743 of epoch 2, 109.98 ms/it, loss 0.456276
Finished training it 2048/76743 of epoch 2, 109.92 ms/it, loss 0.457979
Finished training it 2048/76743 of epoch 2, 110.02 ms/it, loss 0.456144
Finished training it 3072/76743 of epoch 2, 110.19 ms/it, loss 0.455116
Finished training it 3072/76743 of epoch 2, 110.25 ms/it, loss 0.453282
ranking from least wide range to the widest range [ 2 11 10 17  0  3  6  7  9  4 25 18  1 24 21  5 19 22  8 13 16 20 23 14
 12 15]
Finished training it 3072/76743 of epoch 2, 110.04 ms/it, loss 0.457719
Finished training it 3072/76743 of epoch 2, 110.15 ms/it, loss 0.455820
ranking from least wide range to the widest range [11  2 10  3 17  0  6  7  4  9 25 21  1 18 24  5 16 22 19  8 20 13 23 12
 14 15]
Finished training it 4096/76743 of epoch 2, 110.25 ms/it, loss 0.455823
Finished training it 4096/76743 of epoch 2, 110.26 ms/it, loss 0.454968
Finished training it 4096/76743 of epoch 2, 110.42 ms/it, loss 0.458094
Finished training it 4096/76743 of epoch 2, 110.32 ms/it, loss 0.454754
ranking from least wide range to the widest range [11  2 17 10  3  0  6  4  7 25 18  1  9 21  5 22 24 19 16  8 13 20 23 14
 12 15]
Finished training it 5120/76743 of epoch 2, 109.77 ms/it, loss 0.454256
Finished training it 5120/76743 of epoch 2, 109.93 ms/it, loss 0.459321
Finished training it 5120/76743 of epoch 2, 109.89 ms/it, loss 0.454525
Finished training it 5120/76743 of epoch 2, 109.88 ms/it, loss 0.454725
ranking from least wide range to the widest range [11  2 17 10  3  6  0  7 25  4  9  1 18 19 21 24  5 13  8 22 16 20 23 12
 14 15]
Finished training it 6144/76743 of epoch 2, 110.45 ms/it, loss 0.453981
Finished training it 6144/76743 of epoch 2, 110.63 ms/it, loss 0.455469
Finished training it 6144/76743 of epoch 2, 110.54 ms/it, loss 0.454878
Finished training it 6144/76743 of epoch 2, 110.62 ms/it, loss 0.456103
Finished training it 7168/76743 of epoch 2, 110.77 ms/it, loss 0.453700
ranking from least wide range to the widest range [11 10  2 17  6  3  7  4  0  9 25  1 18  5 22  8 21 24 19 13 16 20 12 23
 14 15]
Finished training it 7168/76743 of epoch 2, 110.56 ms/it, loss 0.452458
Finished training it 7168/76743 of epoch 2, 110.58 ms/it, loss 0.453746
Finished training it 7168/76743 of epoch 2, 110.70 ms/it, loss 0.454686
ranking from least wide range to the widest range [ 2 11 10  3  0 17  6  7  4 25 18  9  5  1 21  8 24 19 16 13 22 20 23 12
 14 15]
Finished training it 8192/76743 of epoch 2, 109.63 ms/it, loss 0.454381
Finished training it 8192/76743 of epoch 2, 109.77 ms/it, loss 0.455290
Finished training it 8192/76743 of epoch 2, 109.80 ms/it, loss 0.454349
Finished training it 8192/76743 of epoch 2, 109.83 ms/it, loss 0.454629
ranking from least wide range to the widest range [11  2 17 10  6  3  4  7  0 25  9  1 18 21  5 22 16 24 19  8 13 20 23 12
 14 15]
Finished training it 9216/76743 of epoch 2, 110.04 ms/it, loss 0.454195
Finished training it 9216/76743 of epoch 2, 110.35 ms/it, loss 0.458368
Finished training it 9216/76743 of epoch 2, 110.27 ms/it, loss 0.453374
Finished training it 9216/76743 of epoch 2, 110.19 ms/it, loss 0.455992
ranking from least wide range to the widest range [11  2 10 17  6  3  7  0  9  4  1 25 18 21  5 22 13  8 24 16 19 20 23 14
 12 15]
Finished training it 10240/76743 of epoch 2, 109.80 ms/it, loss 0.454371
Finished training it 10240/76743 of epoch 2, 109.94 ms/it, loss 0.454546
Finished training it 10240/76743 of epoch 2, 109.94 ms/it, loss 0.456719
Finished training it 10240/76743 of epoch 2, 110.07 ms/it, loss 0.453077
Testing at - 10240/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2566874.0
get out
0 has test check 2566874.0 and sample count 3273728
 accuracy 78.408 %, best 78.408 %, roc auc score 0.7928, best 0.7928
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567247.0
get out
2 has test check 2567247.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 110.49 ms/it, loss 0.455616
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567013.0
get out
3 has test check 2567013.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 110.60 ms/it, loss 0.454817
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567033.0
get out
1 has test check 2567033.0 and sample count 3273728
Finished training it 11264/76743 of epoch 2, 110.50 ms/it, loss 0.453803
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 10 17 11  6  7  0  3  9 25  4  1 18 24 19  5 21 22  8 13 16 20 23 12
 14 15]
Finished training it 11264/76743 of epoch 2, 110.23 ms/it, loss 0.455155
ranking from least wide range to the widest range [ 2 17 11 10  0  6  3  7  4 25  1  9 18  5 24 19 22 21  8 13 16 20 23 12
 14 15]
Finished training it 12288/76743 of epoch 2, 109.59 ms/it, loss 0.453015
Finished training it 12288/76743 of epoch 2, 109.84 ms/it, loss 0.456754
Finished training it 12288/76743 of epoch 2, 109.76 ms/it, loss 0.453066
Finished training it 12288/76743 of epoch 2, 109.73 ms/it, loss 0.454348
ranking from least wide range to the widest range [11  2 10 17  6  3  0  7  9  4 25 18  1 21 24  5  8 13 22 16 19 20 23 12
 14 15]
Finished training it 13312/76743 of epoch 2, 109.92 ms/it, loss 0.454718
Finished training it 13312/76743 of epoch 2, 110.03 ms/it, loss 0.453873
Finished training it 13312/76743 of epoch 2, 110.11 ms/it, loss 0.454114
Finished training it 13312/76743 of epoch 2, 110.02 ms/it, loss 0.454074
Finished training it 14336/76743 of epoch 2, 110.02 ms/it, loss 0.453926
ranking from least wide range to the widest range [ 2 11 10 17  6  3  4  7  0  9 25 18  1  5 21 22  8 19 24 13 16 20 23 12
 14 15]
Finished training it 14336/76743 of epoch 2, 109.82 ms/it, loss 0.455316
Finished training it 14336/76743 of epoch 2, 109.92 ms/it, loss 0.454402
Finished training it 14336/76743 of epoch 2, 110.04 ms/it, loss 0.456042
ranking from least wide range to the widest range [ 2 11  3 17 10  0  7  6  4 25  9  1 18  5 24 21 16  8 19 22 13 20 23 14
 12 15]
Finished training it 15360/76743 of epoch 2, 110.46 ms/it, loss 0.455186
Finished training it 15360/76743 of epoch 2, 110.62 ms/it, loss 0.454610
Finished training it 15360/76743 of epoch 2, 110.62 ms/it, loss 0.456299
Finished training it 15360/76743 of epoch 2, 110.56 ms/it, loss 0.455623
ranking from least wide range to the widest range [ 2 11 17 10  3  6  0  7  4 25  9  1 18  5 19 21 24 16 13 22  8 20 12 23
 14 15]
Finished training it 16384/76743 of epoch 2, 109.93 ms/it, loss 0.456021
Finished training it 16384/76743 of epoch 2, 110.03 ms/it, loss 0.452316
Finished training it 16384/76743 of epoch 2, 110.17 ms/it, loss 0.454243
Finished training it 16384/76743 of epoch 2, 110.06 ms/it, loss 0.453778
ranking from least wide range to the widest range [ 2 11  0 17 10  3  6  7 25  4 18  1  9 24  5 13 19 21 22 16  8 20 23 12
 14 15]
Finished training it 17408/76743 of epoch 2, 109.88 ms/it, loss 0.455540
Finished training it 17408/76743 of epoch 2, 110.08 ms/it, loss 0.454573
Finished training it 17408/76743 of epoch 2, 110.00 ms/it, loss 0.452648
Finished training it 17408/76743 of epoch 2, 109.97 ms/it, loss 0.455967
ranking from least wide range to the widest range [ 2 11 17 10  3  6  0  9  4  7 18 25  1 21  5 24 19  8 16 22 13 20 23 14
 12 15]
Finished training it 18432/76743 of epoch 2, 110.65 ms/it, loss 0.455551
Finished training it 18432/76743 of epoch 2, 110.83 ms/it, loss 0.456766
Finished training it 18432/76743 of epoch 2, 110.81 ms/it, loss 0.456411
Finished training it 18432/76743 of epoch 2, 110.84 ms/it, loss 0.455653
ranking from least wide range to the widest range [11  2 10  3 17  6  7  9  0  4 25  1 18 21  5 24 22  8 19 13 16 20 23 14
 12 15]
Finished training it 19456/76743 of epoch 2, 109.46 ms/it, loss 0.457045
Finished training it 19456/76743 of epoch 2, 109.53 ms/it, loss 0.455048
Finished training it 19456/76743 of epoch 2, 109.54 ms/it, loss 0.453104
Finished training it 19456/76743 of epoch 2, 109.67 ms/it, loss 0.454259
ranking from least wide range to the widest range [ 2 11 17  3  6 10  4  0  7  9 18 25  1 21  5 19 24 13 22  8 16 20 23 14
 12 15]
Finished training it 20480/76743 of epoch 2, 110.41 ms/it, loss 0.456862
Finished training it 20480/76743 of epoch 2, 110.58 ms/it, loss 0.454050
Finished training it 20480/76743 of epoch 2, 110.57 ms/it, loss 0.454931
Finished training it 20480/76743 of epoch 2, 110.57 ms/it, loss 0.452615
Testing at - 20480/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567133.0
get out
0 has test check 2567133.0 and sample count 3273728
 accuracy 78.416 %, best 78.416 %, roc auc score 0.7935, best 0.7935
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [ 2 11 10  3  6 17  4  0  7 25  9  1 18 24 21 19  5 13 22 16  8 20 23 14
 12 15]
Finished training it 21504/76743 of epoch 2, 110.20 ms/it, loss 0.454638
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567226.0
get out
3 has test check 2567226.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 110.47 ms/it, loss 0.455153
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2566958.0
get out
1 has test check 2566958.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 110.53 ms/it, loss 0.453514
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2566676.0
get out
2 has test check 2566676.0 and sample count 3273728
Finished training it 21504/76743 of epoch 2, 110.29 ms/it, loss 0.452433
ranking from least wide range to the widest range [11  2 10 17  3  6  7  0  4  9 25 18  1  5 24 21 22 19 16  8 13 20 23 12
 14 15]
Finished training it 22528/76743 of epoch 2, 110.73 ms/it, loss 0.454336
Finished training it 22528/76743 of epoch 2, 110.91 ms/it, loss 0.455540
Finished training it 22528/76743 of epoch 2, 110.75 ms/it, loss 0.453391
Finished training it 22528/76743 of epoch 2, 110.80 ms/it, loss 0.452891
ranking from least wide range to the widest range [ 2 11 10  3  6  4 17  0 25  9 18  7  1 21 19 24  5 13  8 16 22 20 23 12
 14 15]
Finished training it 23552/76743 of epoch 2, 109.52 ms/it, loss 0.456792
Finished training it 23552/76743 of epoch 2, 109.64 ms/it, loss 0.453723
Finished training it 23552/76743 of epoch 2, 109.66 ms/it, loss 0.454235
Finished training it 23552/76743 of epoch 2, 109.72 ms/it, loss 0.454898
ranking from least wide range to the widest range [10 11  2 17  6  3  0  7 25  1  4 18  9  5 13 21  8 22 19 24 16 20 23 14
 12 15]
Finished training it 24576/76743 of epoch 2, 109.86 ms/it, loss 0.456466
Finished training it 24576/76743 of epoch 2, 110.09 ms/it, loss 0.454894
Finished training it 24576/76743 of epoch 2, 110.06 ms/it, loss 0.455109
Finished training it 24576/76743 of epoch 2, 110.11 ms/it, loss 0.455824
ranking from least wide range to the widest range [11  2 17  3 10 25  6  0  1  4  7 18  9 24 22 21 19  5 13 16 20  8 23 12
 14 15]
Finished training it 25600/76743 of epoch 2, 109.43 ms/it, loss 0.454949
Finished training it 25600/76743 of epoch 2, 109.62 ms/it, loss 0.454091
Finished training it 25600/76743 of epoch 2, 109.71 ms/it, loss 0.454529
Finished training it 25600/76743 of epoch 2, 109.75 ms/it, loss 0.453829
ranking from least wide range to the widest range [11 10  2  3 17  6  0  4  7  9 18  1 21 25 24 19  5  8 13 22 16 20 12 23
 14 15]
Finished training it 26624/76743 of epoch 2, 110.58 ms/it, loss 0.457631
Finished training it 26624/76743 of epoch 2, 110.72 ms/it, loss 0.452249
Finished training it 26624/76743 of epoch 2, 110.75 ms/it, loss 0.453785
Finished training it 26624/76743 of epoch 2, 110.83 ms/it, loss 0.454690
ranking from least wide range to the widest range [11  2 10 17  3  0  4  6  7 25  1 18  9 24 16 19 21  8 13  5 22 20 23 12
 14 15]
Finished training it 27648/76743 of epoch 2, 109.88 ms/it, loss 0.455239
Finished training it 27648/76743 of epoch 2, 110.14 ms/it, loss 0.453135
Finished training it 27648/76743 of epoch 2, 110.09 ms/it, loss 0.455821
Finished training it 27648/76743 of epoch 2, 110.04 ms/it, loss 0.452935
ranking from least wide range to the widest range [10 11  2 17  6  3  0  7 25 18  9  4  1 21 24  5 22 13 16 19  8 20 23 12
 14 15]
Finished training it 28672/76743 of epoch 2, 110.11 ms/it, loss 0.453750
Finished training it 28672/76743 of epoch 2, 110.39 ms/it, loss 0.457253
Finished training it 28672/76743 of epoch 2, 110.42 ms/it, loss 0.453713
Finished training it 28672/76743 of epoch 2, 110.40 ms/it, loss 0.452335
ranking from least wide range to the widest range [ 2 11 10  3  6  4 17  9  0  7 25  1 18  5 22 19 21 13 24 16  8 20 23 12
 14 15]
Finished training it 29696/76743 of epoch 2, 110.08 ms/it, loss 0.453679
Finished training it 29696/76743 of epoch 2, 110.25 ms/it, loss 0.452929
Finished training it 29696/76743 of epoch 2, 110.14 ms/it, loss 0.454334
Finished training it 29696/76743 of epoch 2, 110.19 ms/it, loss 0.455481
ranking from least wide range to the widest range [ 2 11 10  3 17  6  0  4  7  9 25  1  5 18 19 21 24 22 16 13  8 20 23 12
 14 15]
Finished training it 30720/76743 of epoch 2, 109.21 ms/it, loss 0.454414
Finished training it 30720/76743 of epoch 2, 109.46 ms/it, loss 0.453515
Finished training it 30720/76743 of epoch 2, 109.43 ms/it, loss 0.454635
Finished training it 30720/76743 of epoch 2, 109.51 ms/it, loss 0.453348
Testing at - 30720/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2564840.0
get out
0 has test check 2564840.0 and sample count 3273728
 accuracy 78.346 %, best 78.416 %, roc auc score 0.7925, best 0.7935
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2564822.0
get out
2 has test check 2564822.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 109.46 ms/it, loss 0.454441
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2564801.0
get out
3 has test check 2564801.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 109.53 ms/it, loss 0.452614
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 11 17 10  3  4 25  6  7  0  1  9 18 24 13 21  5 16 19  8 22 20 12 23
 14 15]
Finished training it 31744/76743 of epoch 2, 109.13 ms/it, loss 0.452751
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2564966.0
get out
1 has test check 2564966.0 and sample count 3273728
Finished training it 31744/76743 of epoch 2, 109.42 ms/it, loss 0.454997
ranking from least wide range to the widest range [10 17 11  2  0  6  3  7  4 25  9  1 18 21  5 24 22 13 19 16  8 20 12 23
 14 15]
Finished training it 32768/76743 of epoch 2, 109.89 ms/it, loss 0.454625
Finished training it 32768/76743 of epoch 2, 110.15 ms/it, loss 0.454488
Finished training it 32768/76743 of epoch 2, 109.99 ms/it, loss 0.453764
Finished training it 32768/76743 of epoch 2, 109.97 ms/it, loss 0.457142
ranking from least wide range to the widest range [ 2 11 10  3  6 17  4  7  0 25  1  9 18  5 21 19 22 24 16  8 13 20 23 12
 14 15]
Finished training it 33792/76743 of epoch 2, 109.54 ms/it, loss 0.454362
Finished training it 33792/76743 of epoch 2, 109.82 ms/it, loss 0.454435
Finished training it 33792/76743 of epoch 2, 109.81 ms/it, loss 0.451329
Finished training it 33792/76743 of epoch 2, 109.82 ms/it, loss 0.455651
ranking from least wide range to the widest range [ 2 11 17 10  0  3  6  7  9 25  1  4 18 24  5 21 22 19 13  8 16 20 23 12
 14 15]
Finished training it 34816/76743 of epoch 2, 110.19 ms/it, loss 0.452141
Finished training it 34816/76743 of epoch 2, 110.41 ms/it, loss 0.454663
Finished training it 34816/76743 of epoch 2, 110.43 ms/it, loss 0.452687
Finished training it 34816/76743 of epoch 2, 110.43 ms/it, loss 0.455499
ranking from least wide range to the widest range [11  2 17 10  3  6  0  4  9 25  7 18  1 21  5 24 19 22 13  8 16 20 23 12
 14 15]
Finished training it 35840/76743 of epoch 2, 109.69 ms/it, loss 0.451868
Finished training it 35840/76743 of epoch 2, 109.96 ms/it, loss 0.454701
Finished training it 35840/76743 of epoch 2, 109.97 ms/it, loss 0.451742
Finished training it 35840/76743 of epoch 2, 110.03 ms/it, loss 0.453606
ranking from least wide range to the widest range [ 2 17 11 10  3  6  0  7  9 25 18  4  1 21 24  5 19 22 16 13  8 20 12 14
 23 15]
Finished training it 36864/76743 of epoch 2, 109.79 ms/it, loss 0.452697
Finished training it 36864/76743 of epoch 2, 110.08 ms/it, loss 0.451881
Finished training it 36864/76743 of epoch 2, 109.99 ms/it, loss 0.455988
Finished training it 36864/76743 of epoch 2, 110.07 ms/it, loss 0.452828
ranking from least wide range to the widest range [ 2 10 11  0 17  3  6  9  7  4  1 25 18  5 24 22 21 16 13  8 19 20 23 12
 14 15]
Finished training it 37888/76743 of epoch 2, 109.86 ms/it, loss 0.454493
Finished training it 37888/76743 of epoch 2, 110.02 ms/it, loss 0.455079
Finished training it 37888/76743 of epoch 2, 110.10 ms/it, loss 0.451988
Finished training it 37888/76743 of epoch 2, 110.09 ms/it, loss 0.455747
Finished training it 38912/76743 of epoch 2, 110.17 ms/it, loss 0.454869
Finished training it 38912/76743 of epoch 2, 110.17 ms/it, loss 0.453399
ranking from least wide range to the widest range [11  2 10 17  3  0  7  4  6 25 18  1  9 21  5 19 24 22 13  8 16 20 12 23
 14 15]
Finished training it 38912/76743 of epoch 2, 110.04 ms/it, loss 0.454611
Finished training it 38912/76743 of epoch 2, 110.25 ms/it, loss 0.456142
ranking from least wide range to the widest range [ 2 17 10 11  3  0  6  7 25 18  4  9  1 21 22 24 19  5 16  8 13 20 23 12
 14 15]
Finished training it 39936/76743 of epoch 2, 109.80 ms/it, loss 0.452796
Finished training it 39936/76743 of epoch 2, 110.02 ms/it, loss 0.455195
Finished training it 39936/76743 of epoch 2, 109.99 ms/it, loss 0.455069
Finished training it 39936/76743 of epoch 2, 110.00 ms/it, loss 0.453180
ranking from least wide range to the widest range [10 11 17  2  0  6  4  3  9  7 25 18  1 21 24 19  5 22  8 13 16 20 23 12
 14 15]
Finished training it 40960/76743 of epoch 2, 109.98 ms/it, loss 0.453773
Finished training it 40960/76743 of epoch 2, 110.15 ms/it, loss 0.455061
Finished training it 40960/76743 of epoch 2, 110.22 ms/it, loss 0.453180
Finished training it 40960/76743 of epoch 2, 110.23 ms/it, loss 0.452483
Testing at - 40960/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2564462.0
get out
0 has test check 2564462.0 and sample count 3273728
 accuracy 78.335 %, best 78.416 %, roc auc score 0.7938, best 0.7938
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 10 17  3  0  6  4  7  9 25  1 18 19 21 13 24 22  5  8 16 20 23 12
 14 15]
Finished training it 41984/76743 of epoch 2, 109.66 ms/it, loss 0.453091
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2565087.0
get out
3 has test check 2565087.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 109.93 ms/it, loss 0.452607
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2564926.0
get out
2 has test check 2564926.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 109.84 ms/it, loss 0.453422
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2565680.0
get out
1 has test check 2565680.0 and sample count 3273728
Finished training it 41984/76743 of epoch 2, 109.82 ms/it, loss 0.455202
ranking from least wide range to the widest range [11 17  2 10  3  6  0  7  4 25  1 18  9 21  5 19 22 24 13  8 16 20 12 23
 14 15]
Finished training it 43008/76743 of epoch 2, 110.13 ms/it, loss 0.453398
Finished training it 43008/76743 of epoch 2, 110.33 ms/it, loss 0.451600
Finished training it 43008/76743 of epoch 2, 110.32 ms/it, loss 0.453412
Finished training it 43008/76743 of epoch 2, 110.26 ms/it, loss 0.454462
ranking from least wide range to the widest range [17  2 11 10  0  6  3 25  7  4 18  9  1 24 22  5 19 21 13  8 16 20 23 12
 14 15]
Finished training it 44032/76743 of epoch 2, 109.80 ms/it, loss 0.454141
Finished training it 44032/76743 of epoch 2, 109.90 ms/it, loss 0.453352
Finished training it 44032/76743 of epoch 2, 109.95 ms/it, loss 0.456849
Finished training it 44032/76743 of epoch 2, 110.01 ms/it, loss 0.453584
ranking from least wide range to the widest range [ 2 11 10 17  3  0  6  4  7  1 25  9 18 21 24 19  5 22 13 16 20  8 23 12
 14 15]
Finished training it 45056/76743 of epoch 2, 109.00 ms/it, loss 0.452836
Finished training it 45056/76743 of epoch 2, 109.09 ms/it, loss 0.452415
Finished training it 45056/76743 of epoch 2, 109.22 ms/it, loss 0.451327
Finished training it 45056/76743 of epoch 2, 109.24 ms/it, loss 0.455852
ranking from least wide range to the widest range [11  2 10 17  4  0  7  6  3  9  1 25 18 24  5 13  8 21 16 19 22 20 23 12
 14 15]
Finished training it 46080/76743 of epoch 2, 109.86 ms/it, loss 0.455992
Finished training it 46080/76743 of epoch 2, 109.93 ms/it, loss 0.455024
Finished training it 46080/76743 of epoch 2, 110.08 ms/it, loss 0.455559
Finished training it 46080/76743 of epoch 2, 109.91 ms/it, loss 0.453415
ranking from least wide range to the widest range [11  2 17 10  3  6  7  0  4 25 18  9  1 19 22 16  5 24  8 21 13 20 23 14
 12 15]
Finished training it 47104/76743 of epoch 2, 109.86 ms/it, loss 0.452333
Finished training it 47104/76743 of epoch 2, 110.09 ms/it, loss 0.455955
Finished training it 47104/76743 of epoch 2, 110.16 ms/it, loss 0.454702
Finished training it 47104/76743 of epoch 2, 110.07 ms/it, loss 0.452973
ranking from least wide range to the widest range [11  2 10 17  3  0  6  4  7  1 18  9 25  5 19 22 24 21 13 20  8 16 23 14
 12 15]
Finished training it 48128/76743 of epoch 2, 109.72 ms/it, loss 0.452305
Finished training it 48128/76743 of epoch 2, 109.96 ms/it, loss 0.454863
Finished training it 48128/76743 of epoch 2, 109.93 ms/it, loss 0.451692
Finished training it 48128/76743 of epoch 2, 109.86 ms/it, loss 0.455023
ranking from least wide range to the widest range [ 2 11 17 10  3  6  0  7  4 25 18  1 21  9 24  5 19 22  8 16 13 20 12 23
 14 15]
Finished training it 49152/76743 of epoch 2, 109.59 ms/it, loss 0.452158
Finished training it 49152/76743 of epoch 2, 109.77 ms/it, loss 0.453603
Finished training it 49152/76743 of epoch 2, 109.73 ms/it, loss 0.454222
Finished training it 49152/76743 of epoch 2, 109.73 ms/it, loss 0.454946
Finished training it 50176/76743 of epoch 2, 109.65 ms/it, loss 0.455251
ranking from least wide range to the widest range [11  2 17 10  3  0  7  4  6 25  9  1 18 24 19  5 16 22 21  8 13 20 23 12
 14 15]
Finished training it 50176/76743 of epoch 2, 109.37 ms/it, loss 0.455057
Finished training it 50176/76743 of epoch 2, 109.58 ms/it, loss 0.453762
Finished training it 50176/76743 of epoch 2, 109.47 ms/it, loss 0.451289
ranking from least wide range to the widest range [11  2 10 17  3  6  7  0  4  9  1 25 18 21  5 24  8 22 19 16 13 20 12 23
 14 15]
Finished training it 51200/76743 of epoch 2, 109.84 ms/it, loss 0.450699
Finished training it 51200/76743 of epoch 2, 110.04 ms/it, loss 0.457307
Finished training it 51200/76743 of epoch 2, 109.97 ms/it, loss 0.453555
Finished training it 51200/76743 of epoch 2, 110.00 ms/it, loss 0.455129
Testing at - 51200/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2569532.0
get out
0 has test check 2569532.0 and sample count 3273728
 accuracy 78.489 %, best 78.489 %, roc auc score 0.7947, best 0.7947
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2569806.0
get out
3 has test check 2569806.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 109.76 ms/it, loss 0.454779
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11  2 17 10  6  3  7  0  4  9 25  1 18 21 24  5 19 13 22 16  8 20 12 23
 14 15]
Finished training it 52224/76743 of epoch 2, 109.50 ms/it, loss 0.454960
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570077.0
get out
1 has test check 2570077.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 109.76 ms/it, loss 0.454939
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2569897.0
get out
2 has test check 2569897.0 and sample count 3273728
Finished training it 52224/76743 of epoch 2, 109.70 ms/it, loss 0.451858
ranking from least wide range to the widest range [11  2 17 10  3  0  6  7  4  9  1 25 18 21  8 13  5 24 22 19 16 20 23 12
 14 15]
Finished training it 53248/76743 of epoch 2, 109.72 ms/it, loss 0.453173
Finished training it 53248/76743 of epoch 2, 109.94 ms/it, loss 0.454869
Finished training it 53248/76743 of epoch 2, 109.92 ms/it, loss 0.454863
Finished training it 53248/76743 of epoch 2, 109.90 ms/it, loss 0.455138
ranking from least wide range to the widest range [11 17  2 10  6  3  0  7  4  9 25 18 19  1 21 24  8 13  5 22 16 20 23 12
 14 15]
Finished training it 54272/76743 of epoch 2, 109.79 ms/it, loss 0.454288
Finished training it 54272/76743 of epoch 2, 110.06 ms/it, loss 0.454216
Finished training it 54272/76743 of epoch 2, 110.05 ms/it, loss 0.453671
Finished training it 54272/76743 of epoch 2, 110.01 ms/it, loss 0.453565
ranking from least wide range to the widest range [11  2 10 17  0  7 25  3  4  6  9 18  1  5 21 19 22 24 16  8 13 20 23 12
 14 15]
Finished training it 55296/76743 of epoch 2, 109.97 ms/it, loss 0.449658
Finished training it 55296/76743 of epoch 2, 110.15 ms/it, loss 0.452506
Finished training it 55296/76743 of epoch 2, 110.10 ms/it, loss 0.455421
Finished training it 55296/76743 of epoch 2, 110.19 ms/it, loss 0.455673
ranking from least wide range to the widest range [11  2 10  6  3 17  7  4 25  0 18  1  9 19  5 22 13 21 16 24  8 20 23 14
 12 15]
Finished training it 56320/76743 of epoch 2, 109.42 ms/it, loss 0.454613
Finished training it 56320/76743 of epoch 2, 109.66 ms/it, loss 0.451911
Finished training it 56320/76743 of epoch 2, 109.67 ms/it, loss 0.450990
Finished training it 56320/76743 of epoch 2, 109.58 ms/it, loss 0.452945
ranking from least wide range to the widest range [11 10 17  2  0  6  3  7 25  4 18  1  9 24  5 22 21 16 19  8 13 20 12 23
 14 15]
Finished training it 57344/76743 of epoch 2, 109.46 ms/it, loss 0.454251
Finished training it 57344/76743 of epoch 2, 109.70 ms/it, loss 0.453370
Finished training it 57344/76743 of epoch 2, 109.69 ms/it, loss 0.453028
Finished training it 57344/76743 of epoch 2, 109.54 ms/it, loss 0.453105
ranking from least wide range to the widest range [11  2 10 17  3  4  0  6  7 18  9 25  1 19 24  5 21 22 13 16  8 20 23 14
 12 15]
Finished training it 58368/76743 of epoch 2, 109.53 ms/it, loss 0.452569
Finished training it 58368/76743 of epoch 2, 109.83 ms/it, loss 0.454143
Finished training it 58368/76743 of epoch 2, 109.77 ms/it, loss 0.454402
Finished training it 58368/76743 of epoch 2, 109.86 ms/it, loss 0.452922
ranking from least wide range to the widest range [11  2 17 10  3  0  6  7  4 25  1 18 21  5  9 19 22 16 24  8 13 20 23 12
 14 15]
Finished training it 59392/76743 of epoch 2, 110.10 ms/it, loss 0.451938
Finished training it 59392/76743 of epoch 2, 110.27 ms/it, loss 0.453485
Finished training it 59392/76743 of epoch 2, 110.29 ms/it, loss 0.453995
Finished training it 59392/76743 of epoch 2, 110.30 ms/it, loss 0.452972
Finished training it 60416/76743 of epoch 2, 110.28 ms/it, loss 0.451698
Finished training it 60416/76743 of epoch 2, 110.33 ms/it, loss 0.454206
ranking from least wide range to the widest range [11  2 17 10  3  0  4  6  7 25 18  1  9 19 22  5 21 13 24  8 16 20 23 12
 14 15]
Finished training it 60416/76743 of epoch 2, 110.04 ms/it, loss 0.454291
Finished training it 60416/76743 of epoch 2, 110.26 ms/it, loss 0.456636
ranking from least wide range to the widest range [11  2 10 17  3  4  6  0  7  9 25 18 24  1 19 22  5 13 16 21  8 20 12 23
 14 15]
Finished training it 61440/76743 of epoch 2, 109.81 ms/it, loss 0.454900
Finished training it 61440/76743 of epoch 2, 109.99 ms/it, loss 0.453555
Finished training it 61440/76743 of epoch 2, 109.90 ms/it, loss 0.451440
Finished training it 61440/76743 of epoch 2, 109.90 ms/it, loss 0.453913
Testing at - 61440/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2568994.0
get out
0 has test check 2568994.0 and sample count 3273728
 accuracy 78.473 %, best 78.489 %, roc auc score 0.7942, best 0.7947
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2569092.0
get out
3 has test check 2569092.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 110.73 ms/it, loss 0.449673
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2  4  3  0 10 17  7  6 25  9  1 18 21  5 16  8 13 19 22 24 20 23 12
 14 15]
Finished training it 62464/76743 of epoch 2, 110.46 ms/it, loss 0.454263
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2568885.0
get out
1 has test check 2568885.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 110.70 ms/it, loss 0.454838
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2568861.0
get out
2 has test check 2568861.0 and sample count 3273728
Finished training it 62464/76743 of epoch 2, 110.62 ms/it, loss 0.452211
ranking from least wide range to the widest range [11  2 17 10  3  0  7  4  6 25 18  1 21  9 16  5  8 22 19 13 24 20 23 12
 14 15]
Finished training it 63488/76743 of epoch 2, 109.40 ms/it, loss 0.453398
Finished training it 63488/76743 of epoch 2, 109.55 ms/it, loss 0.454418
Finished training it 63488/76743 of epoch 2, 109.60 ms/it, loss 0.453508
Finished training it 63488/76743 of epoch 2, 109.59 ms/it, loss 0.452564
Finished training it 64512/76743 of epoch 2, 110.54 ms/it, loss 0.454668
ranking from least wide range to the widest range [11 17 10  2  3  6  4  0  7  1  9 18 25 21  5 24 22 13 19 16  8 20 23 12
 14 15]
Finished training it 64512/76743 of epoch 2, 110.37 ms/it, loss 0.448527
Finished training it 64512/76743 of epoch 2, 110.41 ms/it, loss 0.452728
Finished training it 64512/76743 of epoch 2, 110.48 ms/it, loss 0.452573
ranking from least wide range to the widest range [11  2 17 10  3  0  6  7  4 25 21 18  9  1  5 24 22 19  8 13 16 20 23 12
 14 15]
Finished training it 65536/76743 of epoch 2, 109.49 ms/it, loss 0.454309
Finished training it 65536/76743 of epoch 2, 109.68 ms/it, loss 0.453971
Finished training it 65536/76743 of epoch 2, 109.64 ms/it, loss 0.454937
Finished training it 65536/76743 of epoch 2, 109.66 ms/it, loss 0.453191
ranking from least wide range to the widest range [11 10  2 17  3  6  4  0  7 18 25  1 24 21  9 13 22  5 19  8 16 20 23 14
 12 15]
Finished training it 66560/76743 of epoch 2, 109.15 ms/it, loss 0.454363
Finished training it 66560/76743 of epoch 2, 109.44 ms/it, loss 0.453652
Finished training it 66560/76743 of epoch 2, 109.46 ms/it, loss 0.453385
Finished training it 66560/76743 of epoch 2, 109.42 ms/it, loss 0.452640
ranking from least wide range to the widest range [11 17  2 10  3  0  4  6  7  1 18  9 25 21  5 24 19 13 22  8 16 20 23 14
 12 15]
Finished training it 67584/76743 of epoch 2, 109.60 ms/it, loss 0.451534
Finished training it 67584/76743 of epoch 2, 109.90 ms/it, loss 0.457196
Finished training it 67584/76743 of epoch 2, 109.92 ms/it, loss 0.452576
Finished training it 67584/76743 of epoch 2, 109.85 ms/it, loss 0.456517
Finished training it 68608/76743 of epoch 2, 109.78 ms/it, loss 0.452918
ranking from least wide range to the widest range [17 11 10  2  0  4  3  6  7 25 18  9 24  5  1 22 16 21 13 19  8 20 12 23
 14 15]
Finished training it 68608/76743 of epoch 2, 109.51 ms/it, loss 0.452850
Finished training it 68608/76743 of epoch 2, 109.75 ms/it, loss 0.451496
Finished training it 68608/76743 of epoch 2, 109.72 ms/it, loss 0.451021
ranking from least wide range to the widest range [ 2 11 17 10  0  3  7  6  4 25 18  1 24  5 21  9 19 22 16 13  8 20 23 14
 12 15]
Finished training it 69632/76743 of epoch 2, 110.94 ms/it, loss 0.454305
Finished training it 69632/76743 of epoch 2, 111.05 ms/it, loss 0.452916
Finished training it 69632/76743 of epoch 2, 111.12 ms/it, loss 0.453133
Finished training it 69632/76743 of epoch 2, 111.10 ms/it, loss 0.452534
ranking from least wide range to the widest range [11  2 10  0  3  6 17  7  4  1 25  9 18 21  5 24 22  8 19 16 13 20 23 14
 12 15]
Finished training it 70656/76743 of epoch 2, 109.76 ms/it, loss 0.452683
Finished training it 70656/76743 of epoch 2, 109.82 ms/it, loss 0.451836
Finished training it 70656/76743 of epoch 2, 109.93 ms/it, loss 0.452994
Finished training it 70656/76743 of epoch 2, 109.88 ms/it, loss 0.453406
ranking from least wide range to the widest range [11 10  2  0 17  3  4  7  6 25  1 18  9 19  5 24 22 16 21  8 13 20 23 12
 14 15]
Finished training it 71680/76743 of epoch 2, 110.64 ms/it, loss 0.452877
Finished training it 71680/76743 of epoch 2, 110.91 ms/it, loss 0.453096
Finished training it 71680/76743 of epoch 2, 110.78 ms/it, loss 0.453578
Finished training it 71680/76743 of epoch 2, 110.82 ms/it, loss 0.454426
Testing at - 71680/76743 of epoch 2,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2568321.0
get out
0 has test check 2568321.0 and sample count 3273728
 accuracy 78.452 %, best 78.489 %, roc auc score 0.7946, best 0.7947
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 17 11 10  3  4  0  6  7 18  1  9 25 22  5 21 24 19 13 16  8 20 23 12
 14 15]
Finished training it 72704/76743 of epoch 2, 109.64 ms/it, loss 0.452400
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2568295.0
get out
3 has test check 2568295.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 109.82 ms/it, loss 0.453605
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2568199.0
get out
2 has test check 2568199.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 109.85 ms/it, loss 0.455368
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2568119.0
get out
1 has test check 2568119.0 and sample count 3273728
Finished training it 72704/76743 of epoch 2, 109.88 ms/it, loss 0.454409
Finished training it 73728/76743 of epoch 2, 110.00 ms/it, loss 0.454748
ranking from least wide range to the widest range [ 2 11 17  3 10  0  6  7  4 18 25 21  9  1 24 13 22  5  8 19 16 20 12 23
 14 15]
Finished training it 73728/76743 of epoch 2, 109.85 ms/it, loss 0.455333
Finished training it 73728/76743 of epoch 2, 110.05 ms/it, loss 0.452280
Finished training it 73728/76743 of epoch 2, 110.04 ms/it, loss 0.454220
ranking from least wide range to the widest range [11  2 17 10  3  6  7  0  4 18  1 25 24 21  9  8  5 19 22 16 13 20 23 12
 14 15]
Finished training it 74752/76743 of epoch 2, 110.35 ms/it, loss 0.451869
Finished training it 74752/76743 of epoch 2, 110.51 ms/it, loss 0.453167
Finished training it 74752/76743 of epoch 2, 110.58 ms/it, loss 0.451486
Finished training it 74752/76743 of epoch 2, 110.46 ms/it, loss 0.455211
ranking from least wide range to the widest range [11  2 17  3 10  7  0  6 25  4  1 18 24  9 21  5 19 22  8 13 16 20 23 12
 14 15]
Finished training it 75776/76743 of epoch 2, 109.82 ms/it, loss 0.453595
Finished training it 75776/76743 of epoch 2, 109.97 ms/it, loss 0.452540
Finished training it 75776/76743 of epoch 2, 110.04 ms/it, loss 0.450039
Finished training it 75776/76743 of epoch 2, 110.01 ms/it, loss 0.452566
Warning: Skipping the batch 76742 with size 14
ranking from least wide range to the widest range [11  2 10 17  3  4  0  6  7 18 25  1 21 22 24  5 13  9 19 16  8 20 23 12
 14 15]
Finished training it 1024/76743 of epoch 3, 110.90 ms/it, loss 0.453611
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 111.40 ms/it, loss 0.453377
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 111.67 ms/it, loss 0.451545
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 111.41 ms/it, loss 0.451409
ranking from least wide range to the widest range [11  2 17 10  3  6  4  0  7 25 18  1  9 19  8 22 24 13  5 21 16 20 23 14
 12 15]
Finished training it 2048/76743 of epoch 3, 109.97 ms/it, loss 0.454005
Finished training it 2048/76743 of epoch 3, 110.16 ms/it, loss 0.453831
Finished training it 2048/76743 of epoch 3, 110.11 ms/it, loss 0.453817
Finished training it 2048/76743 of epoch 3, 110.10 ms/it, loss 0.455273
ranking from least wide range to the widest range [11  2 10  7 17  0  4  3  6 25 18  1 24  9 21 22  5 16 19  8 13 20 23 12
 14 15]
Finished training it 3072/76743 of epoch 3, 109.87 ms/it, loss 0.455024
Finished training it 3072/76743 of epoch 3, 110.00 ms/it, loss 0.453182
Finished training it 3072/76743 of epoch 3, 110.12 ms/it, loss 0.452806
Finished training it 3072/76743 of epoch 3, 110.08 ms/it, loss 0.450614
ranking from least wide range to the widest range [11  2  3 17  6  7 10  0  4 18 25 21  1 24 16  9 22  5  8 19 20 13 23 12
 14 15]
Finished training it 4096/76743 of epoch 3, 110.22 ms/it, loss 0.453085
Finished training it 4096/76743 of epoch 3, 110.35 ms/it, loss 0.455603
Finished training it 4096/76743 of epoch 3, 110.32 ms/it, loss 0.452364
Finished training it 4096/76743 of epoch 3, 110.34 ms/it, loss 0.452279
ranking from least wide range to the widest range [11  2 17 10  3  4  0  7  6 25 18  1 21  5 22 19 24 16 13  8  9 20 23 14
 12 15]
Finished training it 5120/76743 of epoch 3, 110.24 ms/it, loss 0.451984
Finished training it 5120/76743 of epoch 3, 110.44 ms/it, loss 0.457289
Finished training it 5120/76743 of epoch 3, 110.43 ms/it, loss 0.452051
Finished training it 5120/76743 of epoch 3, 110.33 ms/it, loss 0.452580
ranking from least wide range to the widest range [11  2 17  3 10  0  7  4  6 25  1 18 21 24 19  5  9 13  8 16 22 20 23 12
 14 15]
Finished training it 6144/76743 of epoch 3, 110.00 ms/it, loss 0.451360
Finished training it 6144/76743 of epoch 3, 110.36 ms/it, loss 0.453161
Finished training it 6144/76743 of epoch 3, 110.34 ms/it, loss 0.453444
Finished training it 6144/76743 of epoch 3, 110.21 ms/it, loss 0.452444
ranking from least wide range to the widest range [11 17 10  4  2  3  7  0  6 25 18  1 21 19  8 24 22 13  5 16  9 20 12 23
 14 15]
Finished training it 7168/76743 of epoch 3, 110.21 ms/it, loss 0.450266
Finished training it 7168/76743 of epoch 3, 110.37 ms/it, loss 0.451584
Finished training it 7168/76743 of epoch 3, 110.36 ms/it, loss 0.451552
Finished training it 7168/76743 of epoch 3, 110.45 ms/it, loss 0.452519
ranking from least wide range to the widest range [11  2 10  0  3 17  7  6  4 18 25  1 21  5  9  8 24 19 16 13 22 20 23 12
 14 15]
Finished training it 8192/76743 of epoch 3, 110.04 ms/it, loss 0.451966
Finished training it 8192/76743 of epoch 3, 110.19 ms/it, loss 0.452318
Finished training it 8192/76743 of epoch 3, 110.27 ms/it, loss 0.453101
Finished training it 8192/76743 of epoch 3, 110.20 ms/it, loss 0.451982
ranking from least wide range to the widest range [11  2 10 17  4  3  6  7  0 18  1 25  5 21 22 16 19 24  8  9 13 20 12 23
 14 15]
Finished training it 9216/76743 of epoch 3, 109.27 ms/it, loss 0.451478
Finished training it 9216/76743 of epoch 3, 109.54 ms/it, loss 0.451332
Finished training it 9216/76743 of epoch 3, 109.51 ms/it, loss 0.453428
Finished training it 9216/76743 of epoch 3, 109.57 ms/it, loss 0.455973
Finished training it 10240/76743 of epoch 3, 110.57 ms/it, loss 0.450755
Finished training it 10240/76743 of epoch 3, 110.59 ms/it, loss 0.454452
ranking from least wide range to the widest range [11  2 10 17  6  3  4  7  0  1 18 25 22 21  9  5 24 16 13  8 19 20 23 12
 14 15]
Finished training it 10240/76743 of epoch 3, 110.42 ms/it, loss 0.452100
Finished training it 10240/76743 of epoch 3, 110.65 ms/it, loss 0.452065
Testing at - 10240/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570411.0
get out
0 has test check 2570411.0 and sample count 3273728
 accuracy 78.516 %, best 78.516 %, roc auc score 0.7953, best 0.7953
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570765.0
get out
3 has test check 2570765.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 110.16 ms/it, loss 0.452520
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [10 17 11  7  2  6  0  3  4 25  1 18 24 19 13  5  8 22 16  9 21 20 23 12
 14 15]
Finished training it 11264/76743 of epoch 3, 109.92 ms/it, loss 0.452941
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2571126.0
get out
1 has test check 2571126.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 110.16 ms/it, loss 0.451530
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570866.0
get out
2 has test check 2570866.0 and sample count 3273728
Finished training it 11264/76743 of epoch 3, 110.04 ms/it, loss 0.453268
ranking from least wide range to the widest range [11  2 17 10  4  3  6  7  0 25  1 18 24  5 22 19 21 16 13  8  9 20 23 12
 14 15]
Finished training it 12288/76743 of epoch 3, 109.92 ms/it, loss 0.450988
Finished training it 12288/76743 of epoch 3, 110.25 ms/it, loss 0.454271
Finished training it 12288/76743 of epoch 3, 110.27 ms/it, loss 0.450726
Finished training it 12288/76743 of epoch 3, 110.24 ms/it, loss 0.451992
ranking from least wide range to the widest range [11  2 10  3 17  0  7  4  6 25 18  1 21  5  8 24  9 13 16 22 19 20 23 12
 14 15]
Finished training it 13312/76743 of epoch 3, 109.63 ms/it, loss 0.452412
Finished training it 13312/76743 of epoch 3, 109.80 ms/it, loss 0.451703
Finished training it 13312/76743 of epoch 3, 109.88 ms/it, loss 0.452159
Finished training it 13312/76743 of epoch 3, 109.84 ms/it, loss 0.451898
ranking from least wide range to the widest range [11  2 17 10  4  3  6  0  7 25 18  1  5 24 22 19 21 13 16  8  9 20 23 12
 14 15]
Finished training it 14336/76743 of epoch 3, 109.80 ms/it, loss 0.453530
Finished training it 14336/76743 of epoch 3, 110.04 ms/it, loss 0.452327
Finished training it 14336/76743 of epoch 3, 110.04 ms/it, loss 0.452088
Finished training it 14336/76743 of epoch 3, 110.04 ms/it, loss 0.453925
ranking from least wide range to the widest range [11  2  3  4 17 10  7  0  6 25  1 18  5 24 22 21 16  8 13 19  9 20 23 12
 14 15]
Finished training it 15360/76743 of epoch 3, 109.67 ms/it, loss 0.453257
Finished training it 15360/76743 of epoch 3, 109.91 ms/it, loss 0.453571
Finished training it 15360/76743 of epoch 3, 109.95 ms/it, loss 0.452530
Finished training it 15360/76743 of epoch 3, 109.94 ms/it, loss 0.454077
Finished training it 16384/76743 of epoch 3, 109.66 ms/it, loss 0.452469
ranking from least wide range to the widest range [11  2 17  0 10  3  7  4  6 25  1 18  5 19 22  8 13 16 24 21  9 20 12 14
 23 15]
Finished training it 16384/76743 of epoch 3, 109.44 ms/it, loss 0.454295
Finished training it 16384/76743 of epoch 3, 109.62 ms/it, loss 0.450714
Finished training it 16384/76743 of epoch 3, 109.69 ms/it, loss 0.452091
ranking from least wide range to the widest range [11  2 10 17  3  0  4  6 25  7 18  1 24 19  5 21 13 16 22  8 20 23 14 12
  9 15]
Finished training it 17408/76743 of epoch 3, 109.94 ms/it, loss 0.453476
Finished training it 17408/76743 of epoch 3, 110.17 ms/it, loss 0.450362
Finished training it 17408/76743 of epoch 3, 110.17 ms/it, loss 0.453574
Finished training it 17408/76743 of epoch 3, 110.20 ms/it, loss 0.452185
Finished training it 18432/76743 of epoch 3, 110.31 ms/it, loss 0.453986
ranking from least wide range to the widest range [ 2 11 17 10  3  4  6  7  0 25 18  1 21 24 19  5 16 22  8  9 13 20 23 12
 14 15]
Finished training it 18432/76743 of epoch 3, 110.08 ms/it, loss 0.453426
Finished training it 18432/76743 of epoch 3, 110.20 ms/it, loss 0.454362
Finished training it 18432/76743 of epoch 3, 110.28 ms/it, loss 0.453280
ranking from least wide range to the widest range [11 17  2 10  3  0  7  6  4 21 25  1 24 18  5 16  8 22 13 19  9 20 12 23
 14 15]
Finished training it 19456/76743 of epoch 3, 109.65 ms/it, loss 0.454674
Finished training it 19456/76743 of epoch 3, 109.83 ms/it, loss 0.450833
Finished training it 19456/76743 of epoch 3, 109.89 ms/it, loss 0.451921
Finished training it 19456/76743 of epoch 3, 109.90 ms/it, loss 0.452699
Finished training it 20480/76743 of epoch 3, 110.67 ms/it, loss 0.452635
Finished training it 20480/76743 of epoch 3, 110.61 ms/it, loss 0.450061
ranking from least wide range to the widest range [11  2 17  3 10  0  6  7  4 18 21  1 25  5 22 24 19 13 16  8 20  9 23 14
 12 15]
Finished training it 20480/76743 of epoch 3, 110.44 ms/it, loss 0.454894
Finished training it 20480/76743 of epoch 3, 110.53 ms/it, loss 0.451366
Testing at - 20480/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570746.0
get out
0 has test check 2570746.0 and sample count 3273728
 accuracy 78.527 %, best 78.527 %, roc auc score 0.7958, best 0.7958
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 17  3 10  0  6  7  4  1 25 18 21 24 19 13 16 22  5  8 20  9 23 12
 14 15]
Finished training it 21504/76743 of epoch 3, 109.58 ms/it, loss 0.452182
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570704.0
get out
1 has test check 2570704.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 110.00 ms/it, loss 0.451704
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570785.0
get out
3 has test check 2570785.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 109.87 ms/it, loss 0.452824
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570760.0
get out
2 has test check 2570760.0 and sample count 3273728
Finished training it 21504/76743 of epoch 3, 109.92 ms/it, loss 0.450072
ranking from least wide range to the widest range [11  2 17 10  4  3  7  6  0  1 24 25 18 21  5 22 19 16  8 13 20  9 23 12
 14 15]
Finished training it 22528/76743 of epoch 3, 110.27 ms/it, loss 0.452490
Finished training it 22528/76743 of epoch 3, 110.57 ms/it, loss 0.453558
Finished training it 22528/76743 of epoch 3, 110.56 ms/it, loss 0.450782
Finished training it 22528/76743 of epoch 3, 110.53 ms/it, loss 0.451299
ranking from least wide range to the widest range [11  2 10  3  0  6 17  7  4 25 18  1  8 21 16 19 24  5 13 22  9 20 23 12
 14 15]
Finished training it 23552/76743 of epoch 3, 109.72 ms/it, loss 0.454495
Finished training it 23552/76743 of epoch 3, 109.84 ms/it, loss 0.451615
Finished training it 23552/76743 of epoch 3, 109.86 ms/it, loss 0.451754
Finished training it 23552/76743 of epoch 3, 109.88 ms/it, loss 0.452715
ranking from least wide range to the widest range [ 2 10 11 17  0  3  6  1  4 25  7 18  5  8 24 13 16 21 22 19  9 20 23 12
 14 15]
Finished training it 24576/76743 of epoch 3, 114.46 ms/it, loss 0.454225
Finished training it 24576/76743 of epoch 3, 114.58 ms/it, loss 0.453607
Finished training it 24576/76743 of epoch 3, 114.51 ms/it, loss 0.452775
Finished training it 24576/76743 of epoch 3, 114.63 ms/it, loss 0.452839
Finished training it 25600/76743 of epoch 3, 109.93 ms/it, loss 0.451708
ranking from least wide range to the widest range [11  2 10  3 17  0  4  6  1  7 25 18 22 24  5 13 21 19 16 20  8 23 12 14
  9 15]
Finished training it 25600/76743 of epoch 3, 109.87 ms/it, loss 0.452309
Finished training it 25600/76743 of epoch 3, 109.99 ms/it, loss 0.452058
Finished training it 25600/76743 of epoch 3, 109.88 ms/it, loss 0.451519
ranking from least wide range to the widest range [11  2 10  3 17  6  4  0  7  1 18 21 24 25 19  8  5 16 22 13  9 20 12 23
 14 15]
Finished training it 26624/76743 of epoch 3, 110.64 ms/it, loss 0.455862
Finished training it 26624/76743 of epoch 3, 110.88 ms/it, loss 0.451880
Finished training it 26624/76743 of epoch 3, 110.81 ms/it, loss 0.452455
Finished training it 26624/76743 of epoch 3, 110.71 ms/it, loss 0.450322
ranking from least wide range to the widest range [11  2 17  3 10  4  0  7  6  1 25 18 21 24 16 19  8  5 13 22 20  9 12 23
 14 15]
Finished training it 27648/76743 of epoch 3, 110.02 ms/it, loss 0.452963
Finished training it 27648/76743 of epoch 3, 110.23 ms/it, loss 0.451378
Finished training it 27648/76743 of epoch 3, 110.20 ms/it, loss 0.451004
Finished training it 27648/76743 of epoch 3, 110.08 ms/it, loss 0.453418
Finished training it 28672/76743 of epoch 3, 109.44 ms/it, loss 0.451485
Finished training it 28672/76743 of epoch 3, 109.40 ms/it, loss 0.455050
Finished training it 28672/76743 of epoch 3, 109.50 ms/it, loss 0.450894
ranking from least wide range to the widest range [ 2 11 10 17  6  3  7  0  4 25  1 18 22 24  5 21 16 13  8 19 20 23  9 12
 14 15]
Finished training it 28672/76743 of epoch 3, 109.24 ms/it, loss 0.451752
ranking from least wide range to the widest range [11  2 10  3  0 17  6  4  7  1 18 25 21  5 22 24 16 19 13  8 20  9 23 12
 14 15]
Finished training it 29696/76743 of epoch 3, 112.86 ms/it, loss 0.451788
Finished training it 29696/76743 of epoch 3, 113.18 ms/it, loss 0.450514
Finished training it 29696/76743 of epoch 3, 113.22 ms/it, loss 0.453054
Finished training it 29696/76743 of epoch 3, 113.21 ms/it, loss 0.452067
ranking from least wide range to the widest range [11  2  3 10 17  6  0  7  4 25  1  5 18 21 22 19 24 16 13  8 20 23 12  9
 14 15]
Finished training it 30720/76743 of epoch 3, 109.74 ms/it, loss 0.451639
Finished training it 30720/76743 of epoch 3, 109.97 ms/it, loss 0.451298
Finished training it 30720/76743 of epoch 3, 109.97 ms/it, loss 0.451004
Finished training it 30720/76743 of epoch 3, 109.86 ms/it, loss 0.451943
Testing at - 30720/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2565473.0
get out
0 has test check 2565473.0 and sample count 3273728
 accuracy 78.365 %, best 78.527 %, roc auc score 0.7955, best 0.7958
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 11  3 17 10  6  0  4  7 25  1 18 24 16  8 19 13  5 22 21 20 23  9 12
 14 15]
Finished training it 31744/76743 of epoch 3, 109.55 ms/it, loss 0.450546
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2565440.0
get out
3 has test check 2565440.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 109.69 ms/it, loss 0.450482
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2564973.0
get out
1 has test check 2564973.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 109.79 ms/it, loss 0.452705
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2565255.0
get out
2 has test check 2565255.0 and sample count 3273728
Finished training it 31744/76743 of epoch 3, 109.72 ms/it, loss 0.451935
ranking from least wide range to the widest range [11 10 17  2  6  7  3  0  4 25  1 18 24 22 21  5 16 13  8 19 20  9 12 23
 14 15]
Finished training it 32768/76743 of epoch 3, 110.04 ms/it, loss 0.452318
Finished training it 32768/76743 of epoch 3, 110.25 ms/it, loss 0.451952
Finished training it 32768/76743 of epoch 3, 110.19 ms/it, loss 0.451399
Finished training it 32768/76743 of epoch 3, 110.17 ms/it, loss 0.454807
ranking from least wide range to the widest range [ 2 11 17 10  3  6  0  7  4  1 25 18 24 22 19  5 16 21  8 13 20 23 12 14
  9 15]
Finished training it 33792/76743 of epoch 3, 109.87 ms/it, loss 0.451877
Finished training it 33792/76743 of epoch 3, 110.04 ms/it, loss 0.449071
Finished training it 33792/76743 of epoch 3, 110.11 ms/it, loss 0.453102
Finished training it 33792/76743 of epoch 3, 110.16 ms/it, loss 0.451560
ranking from least wide range to the widest range [11  2 17  3 10  0  6  7  4 25  1 18 21  5 24 19 22  8 13 16 20  9 23 12
 14 15]
Finished training it 34816/76743 of epoch 3, 109.84 ms/it, loss 0.449614
Finished training it 34816/76743 of epoch 3, 110.01 ms/it, loss 0.452927
Finished training it 34816/76743 of epoch 3, 110.13 ms/it, loss 0.449979
Finished training it 34816/76743 of epoch 3, 110.15 ms/it, loss 0.451610
Finished training it 35840/76743 of epoch 3, 110.40 ms/it, loss 0.449776
ranking from least wide range to the widest range [ 2 11 10 17  3  0  6  7  4 25 21  1 18  5 24 19 22  8 13 16 20  9 23 12
 14 15]
Finished training it 35840/76743 of epoch 3, 110.23 ms/it, loss 0.449371
Finished training it 35840/76743 of epoch 3, 110.45 ms/it, loss 0.452372
Finished training it 35840/76743 of epoch 3, 110.41 ms/it, loss 0.451519
ranking from least wide range to the widest range [11  2 17  0 10  6  3  7  4 25 18  1 24 21  5 22 16 19  8 13 20  9 12 14
 23 15]
Finished training it 36864/76743 of epoch 3, 110.18 ms/it, loss 0.450552
Finished training it 36864/76743 of epoch 3, 110.37 ms/it, loss 0.450185
Finished training it 36864/76743 of epoch 3, 110.29 ms/it, loss 0.453467
Finished training it 36864/76743 of epoch 3, 110.42 ms/it, loss 0.449248
ranking from least wide range to the widest range [11  2 17 10  3  6  0  4  1  7 25 18  5 24 21 16 22 19  8 13 20  9 23 12
 14 15]
Finished training it 37888/76743 of epoch 3, 110.36 ms/it, loss 0.452303
Finished training it 37888/76743 of epoch 3, 110.67 ms/it, loss 0.449781
Finished training it 37888/76743 of epoch 3, 110.53 ms/it, loss 0.453068
Finished training it 37888/76743 of epoch 3, 110.55 ms/it, loss 0.453610
ranking from least wide range to the widest range [11  2  7  3 10  0 17  6 25  4  1 18 21  5 24 22 19 16 13  8 20 23 12  9
 14 15]
Finished training it 38912/76743 of epoch 3, 109.92 ms/it, loss 0.452258
Finished training it 38912/76743 of epoch 3, 110.07 ms/it, loss 0.452448
Finished training it 38912/76743 of epoch 3, 110.11 ms/it, loss 0.453533
Finished training it 38912/76743 of epoch 3, 110.07 ms/it, loss 0.450863
ranking from least wide range to the widest range [ 2 11 17 10  0  3  6  4  7 25 18  1 21 24 16 22 19  5  8 13 20 12 23  9
 14 15]
Finished training it 39936/76743 of epoch 3, 109.97 ms/it, loss 0.450039
Finished training it 39936/76743 of epoch 3, 110.33 ms/it, loss 0.452599
Finished training it 39936/76743 of epoch 3, 110.15 ms/it, loss 0.452640
Finished training it 39936/76743 of epoch 3, 110.24 ms/it, loss 0.450205
ranking from least wide range to the widest range [11  2 17  4  6 10  0  3  7  1 18 25 21 22  8  5 19 16 24 13 20  9 23 12
 14 15]
Finished training it 40960/76743 of epoch 3, 109.46 ms/it, loss 0.451575
Finished training it 40960/76743 of epoch 3, 109.69 ms/it, loss 0.450066
Finished training it 40960/76743 of epoch 3, 109.67 ms/it, loss 0.452914
Finished training it 40960/76743 of epoch 3, 109.56 ms/it, loss 0.450858
Testing at - 40960/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2569942.0
get out
0 has test check 2569942.0 and sample count 3273728
 accuracy 78.502 %, best 78.527 %, roc auc score 0.7957, best 0.7958
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2  0 17  3 10  6  7  4  1 25 18 19 13 22 24 21  5 16  8 20 23 12 14
  9 15]
Finished training it 41984/76743 of epoch 3, 110.05 ms/it, loss 0.450836
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2569969.0
get out
3 has test check 2569969.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 110.24 ms/it, loss 0.450110
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2569805.0
get out
1 has test check 2569805.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 110.24 ms/it, loss 0.452989
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2569619.0
get out
2 has test check 2569619.0 and sample count 3273728
Finished training it 41984/76743 of epoch 3, 110.20 ms/it, loss 0.451024
ranking from least wide range to the widest range [11  2 17 10  0  3  6  4  7  1 21 18 25 22  5  8 19 24 16 13 20 12 23 14
  9 15]
Finished training it 43008/76743 of epoch 3, 109.92 ms/it, loss 0.451071
Finished training it 43008/76743 of epoch 3, 110.14 ms/it, loss 0.450897
Finished training it 43008/76743 of epoch 3, 110.10 ms/it, loss 0.452154
Finished training it 43008/76743 of epoch 3, 110.24 ms/it, loss 0.449083
ranking from least wide range to the widest range [ 2 11 17  0 10  3  7  4  6 25 18  1 24 22  5 19  8 16 13 21 20 23 12  9
 14 15]
Finished training it 44032/76743 of epoch 3, 110.46 ms/it, loss 0.452101
Finished training it 44032/76743 of epoch 3, 110.63 ms/it, loss 0.454297
Finished training it 44032/76743 of epoch 3, 110.67 ms/it, loss 0.451306
Finished training it 44032/76743 of epoch 3, 110.71 ms/it, loss 0.451394
ranking from least wide range to the widest range [ 2 11  0  3 17 10  6  1  4  7 25 21 24 18  5 19 22 16 13  8 20 23 12 14
  9 15]
Finished training it 45056/76743 of epoch 3, 110.01 ms/it, loss 0.450664
Finished training it 45056/76743 of epoch 3, 110.20 ms/it, loss 0.449928
Finished training it 45056/76743 of epoch 3, 110.24 ms/it, loss 0.453561
Finished training it 45056/76743 of epoch 3, 110.32 ms/it, loss 0.448642
ranking from least wide range to the widest range [11  2  0 10 17  3  4  6  7  1 25  5 18 24  8 16 19 13 22 21 20  9 23 12
 14 15]
Finished training it 46080/76743 of epoch 3, 110.65 ms/it, loss 0.453310
Finished training it 46080/76743 of epoch 3, 110.81 ms/it, loss 0.452904
Finished training it 46080/76743 of epoch 3, 110.86 ms/it, loss 0.451432
Finished training it 46080/76743 of epoch 3, 110.91 ms/it, loss 0.452968
Finished training it 47104/76743 of epoch 3, 110.70 ms/it, loss 0.452459
ranking from least wide range to the widest range [11 17  2 10  3  4  0  6  7 18 25  1 24 16 22  5 19 13  8 21 20 23 14 12
  9 15]
Finished training it 47104/76743 of epoch 3, 110.53 ms/it, loss 0.449706
Finished training it 47104/76743 of epoch 3, 110.77 ms/it, loss 0.450652
Finished training it 47104/76743 of epoch 3, 110.77 ms/it, loss 0.453289
ranking from least wide range to the widest range [11  2 17 10  3  0  6  4  7  1 18 25  5 19 24 22 13 21 20  8 16 23 14  9
 12 15]
Finished training it 48128/76743 of epoch 3, 109.36 ms/it, loss 0.449838
Finished training it 48128/76743 of epoch 3, 109.67 ms/it, loss 0.452493
Finished training it 48128/76743 of epoch 3, 109.56 ms/it, loss 0.449438
Finished training it 48128/76743 of epoch 3, 109.67 ms/it, loss 0.452630
ranking from least wide range to the widest range [11  2  0  3 17  7  4  6 10 25 18  1 21  5 24 19 22  8 16 13 20 12 23 14
  9 15]
Finished training it 49152/76743 of epoch 3, 110.22 ms/it, loss 0.449583
Finished training it 49152/76743 of epoch 3, 110.43 ms/it, loss 0.451033
Finished training it 49152/76743 of epoch 3, 110.40 ms/it, loss 0.451776
Finished training it 49152/76743 of epoch 3, 110.43 ms/it, loss 0.452508
ranking from least wide range to the widest range [11  2 17 10  3  4  0  7  6 25  1 18 24  5 16  8 22 19 13 21 20 12  9 23
 14 15]
Finished training it 50176/76743 of epoch 3, 109.64 ms/it, loss 0.452301
Finished training it 50176/76743 of epoch 3, 110.00 ms/it, loss 0.452575
Finished training it 50176/76743 of epoch 3, 109.91 ms/it, loss 0.451168
Finished training it 50176/76743 of epoch 3, 109.92 ms/it, loss 0.448838
ranking from least wide range to the widest range [11  2 10  7  3 17  0  6  4  1 18 25  5 24 22 21 16  8 19 20 13 23 12  9
 14 15]
Finished training it 51200/76743 of epoch 3, 109.71 ms/it, loss 0.448366
Finished training it 51200/76743 of epoch 3, 109.92 ms/it, loss 0.454960
Finished training it 51200/76743 of epoch 3, 109.95 ms/it, loss 0.452298
Finished training it 51200/76743 of epoch 3, 109.93 ms/it, loss 0.450774
Testing at - 51200/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572730.0
get out
0 has test check 2572730.0 and sample count 3273728
 accuracy 78.587 %, best 78.587 %, roc auc score 0.7964, best 0.7964
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 11 10 17  6  3  4  7  0 25  1 24 18  5 21 22  8 19 13 16 20 12  9 23
 14 15]
Finished training it 52224/76743 of epoch 3, 110.50 ms/it, loss 0.452647
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2572653.0
get out
3 has test check 2572653.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 110.72 ms/it, loss 0.452248
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2572930.0
get out
2 has test check 2572930.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 110.64 ms/it, loss 0.449236
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2572720.0
get out
1 has test check 2572720.0 and sample count 3273728
Finished training it 52224/76743 of epoch 3, 110.74 ms/it, loss 0.452091
ranking from least wide range to the widest range [11  2 17  0  3  6 10  7  1  4 21 18 25 22  8 13 24 19  5 16 20 23 12  9
 14 15]
Finished training it 53248/76743 of epoch 3, 109.51 ms/it, loss 0.450343
Finished training it 53248/76743 of epoch 3, 109.81 ms/it, loss 0.452402
Finished training it 53248/76743 of epoch 3, 109.81 ms/it, loss 0.452844
Finished training it 53248/76743 of epoch 3, 109.94 ms/it, loss 0.451994
ranking from least wide range to the widest range [11  2 17 10  0  7  4  3  6 18 25  1 24 19  8 22 13  5 21 16 20  9 23 12
 14 15]
Finished training it 54272/76743 of epoch 3, 110.25 ms/it, loss 0.451645
Finished training it 54272/76743 of epoch 3, 110.49 ms/it, loss 0.451590
Finished training it 54272/76743 of epoch 3, 110.44 ms/it, loss 0.450851
Finished training it 54272/76743 of epoch 3, 110.45 ms/it, loss 0.451361
ranking from least wide range to the widest range [11  2 17  0 10  4  7  3  6 25 18  1 21 24 22 19  5 16  8 13 20  9 23 12
 14 15]
Finished training it 55296/76743 of epoch 3, 110.25 ms/it, loss 0.447331
Finished training it 55296/76743 of epoch 3, 110.52 ms/it, loss 0.453127
Finished training it 55296/76743 of epoch 3, 110.49 ms/it, loss 0.452849
Finished training it 55296/76743 of epoch 3, 110.46 ms/it, loss 0.450132
ranking from least wide range to the widest range [ 2 11 10  3  6 17  0  7  4 18 25  1 19 22  5 13  8 24 21 16 20 23 12 14
  9 15]
Finished training it 56320/76743 of epoch 3, 109.90 ms/it, loss 0.452146
Finished training it 56320/76743 of epoch 3, 110.04 ms/it, loss 0.450663
Finished training it 56320/76743 of epoch 3, 110.04 ms/it, loss 0.448518
Finished training it 56320/76743 of epoch 3, 110.06 ms/it, loss 0.449206
ranking from least wide range to the widest range [ 2 11 10 17  6  3  0  4  7 25  1 18 24  5 19 22 16 21  8 13 20 12 23  9
 14 15]
Finished training it 57344/76743 of epoch 3, 109.73 ms/it, loss 0.451542
Finished training it 57344/76743 of epoch 3, 110.00 ms/it, loss 0.450531
Finished training it 57344/76743 of epoch 3, 109.96 ms/it, loss 0.450812
Finished training it 57344/76743 of epoch 3, 109.97 ms/it, loss 0.450811
Finished training it 58368/76743 of epoch 3, 109.95 ms/it, loss 0.451646
Finished training it 58368/76743 of epoch 3, 110.04 ms/it, loss 0.450475
Finished training it 58368/76743 of epoch 3, 110.00 ms/it, loss 0.451655
ranking from least wide range to the widest range [11  2 17  3 10  7  6  0  4 18  1 19 25 22 24 21 16  5 13  8 20 23  9 14
 12 15]
Finished training it 58368/76743 of epoch 3, 109.76 ms/it, loss 0.450125
ranking from least wide range to the widest range [11  2 10  3  0 17  4  7  6  1 25 18 21  5 19 16 22 13 24  8 20 12 23 14
  9 15]
Finished training it 59392/76743 of epoch 3, 109.97 ms/it, loss 0.449282
Finished training it 59392/76743 of epoch 3, 110.20 ms/it, loss 0.450321
Finished training it 59392/76743 of epoch 3, 110.19 ms/it, loss 0.451416
Finished training it 59392/76743 of epoch 3, 110.20 ms/it, loss 0.451112
ranking from least wide range to the widest range [11  2  3 10  0 17  7  4  6 25  1 18 22 19  5 13 24 21  8 16 20 23 12  9
 14 15]
Finished training it 60416/76743 of epoch 3, 109.40 ms/it, loss 0.451199
Finished training it 60416/76743 of epoch 3, 109.60 ms/it, loss 0.449175
Finished training it 60416/76743 of epoch 3, 109.64 ms/it, loss 0.454062
Finished training it 60416/76743 of epoch 3, 109.60 ms/it, loss 0.451421
ranking from least wide range to the widest range [11  2 10 17  3  0  4  7  6 25 24 19  1 18 22 21 13  5 16  8 20 12  9 23
 14 15]
Finished training it 61440/76743 of epoch 3, 110.05 ms/it, loss 0.452527
Finished training it 61440/76743 of epoch 3, 110.23 ms/it, loss 0.450948
Finished training it 61440/76743 of epoch 3, 110.15 ms/it, loss 0.448923
Finished training it 61440/76743 of epoch 3, 110.05 ms/it, loss 0.451738
Testing at - 61440/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573457.0
get out
0 has test check 2573457.0 and sample count 3273728
 accuracy 78.609 %, best 78.609 %, roc auc score 0.7969, best 0.7969
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 10  0  3  4  6 17  7 25  1 18 21 13 16 22  8 19  5 24 20 23  9 12
 14 15]
Finished training it 62464/76743 of epoch 3, 109.65 ms/it, loss 0.451621
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573488.0
get out
3 has test check 2573488.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 109.84 ms/it, loss 0.446986
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573582.0
get out
1 has test check 2573582.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 109.76 ms/it, loss 0.452118
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573478.0
get out
2 has test check 2573478.0 and sample count 3273728
Finished training it 62464/76743 of epoch 3, 109.81 ms/it, loss 0.449478
ranking from least wide range to the widest range [11  2 10  7  3 17  4  6  0 25  1 18 16 21  5 22  8 19 13 24 20 12 23 14
  9 15]
Finished training it 63488/76743 of epoch 3, 113.91 ms/it, loss 0.450651
Finished training it 63488/76743 of epoch 3, 114.03 ms/it, loss 0.451622
Finished training it 63488/76743 of epoch 3, 114.07 ms/it, loss 0.450656
Finished training it 63488/76743 of epoch 3, 114.10 ms/it, loss 0.449873
ranking from least wide range to the widest range [11  2 17 10  3  0  6  7  4  1 18 25 21  5 24 22 16 13  8 19 20 12 23 14
  9 15]
Finished training it 64512/76743 of epoch 3, 110.25 ms/it, loss 0.446207
Finished training it 64512/76743 of epoch 3, 110.43 ms/it, loss 0.452054
Finished training it 64512/76743 of epoch 3, 110.29 ms/it, loss 0.450513
Finished training it 64512/76743 of epoch 3, 110.37 ms/it, loss 0.450299
ranking from least wide range to the widest range [11  2  3  0 17 10  6  4  7 25 18 21  1 13  5  8 22 19 24 16 20 12  9 23
 14 15]
Finished training it 65536/76743 of epoch 3, 109.97 ms/it, loss 0.451727
Finished training it 65536/76743 of epoch 3, 110.15 ms/it, loss 0.452360
Finished training it 65536/76743 of epoch 3, 110.15 ms/it, loss 0.451404
Finished training it 65536/76743 of epoch 3, 110.18 ms/it, loss 0.450840
Finished training it 66560/76743 of epoch 3, 113.64 ms/it, loss 0.450797
ranking from least wide range to the widest range [11  2 17  4  3 10  6  7  0 25 18  1 13 22 24 21  5  8 19 16 20 23 12 14
  9 15]
Finished training it 66560/76743 of epoch 3, 113.37 ms/it, loss 0.451792
Finished training it 66560/76743 of epoch 3, 113.64 ms/it, loss 0.449938
Finished training it 66560/76743 of epoch 3, 113.67 ms/it, loss 0.451023
Finished training it 67584/76743 of epoch 3, 110.48 ms/it, loss 0.454560
Finished training it 67584/76743 of epoch 3, 110.43 ms/it, loss 0.454033
Finished training it 67584/76743 of epoch 3, 110.45 ms/it, loss 0.450328
ranking from least wide range to the widest range [11  2 17 10  3  6  7  4  0  1 18  5 25 21 24 19 13  8 22 16 20 23 12  9
 14 15]
Finished training it 67584/76743 of epoch 3, 110.27 ms/it, loss 0.448884
ranking from least wide range to the widest range [11  2 10 17  3  6  7  4  0 18 25 21  5 24 22  1 16 13 19  8 20 12  9 23
 14 15]
Finished training it 68608/76743 of epoch 3, 109.82 ms/it, loss 0.450278
Finished training it 68608/76743 of epoch 3, 110.00 ms/it, loss 0.448424
Finished training it 68608/76743 of epoch 3, 110.09 ms/it, loss 0.450587
Finished training it 68608/76743 of epoch 3, 110.08 ms/it, loss 0.449221
ranking from least wide range to the widest range [ 2 11 10  3  4 17  0  6  7  1 25 18  5 21 19 22 16 24 13  8 20 23 14 12
  9 15]
Finished training it 69632/76743 of epoch 3, 110.30 ms/it, loss 0.451937
Finished training it 69632/76743 of epoch 3, 110.55 ms/it, loss 0.450792
Finished training it 69632/76743 of epoch 3, 110.46 ms/it, loss 0.450576
Finished training it 69632/76743 of epoch 3, 110.48 ms/it, loss 0.450140
ranking from least wide range to the widest range [11  2 10 17  7  3  0  4  6 25  1 18 21 22 24  5 19  8 16 13 20 23  9 12
 14 15]
Finished training it 70656/76743 of epoch 3, 109.88 ms/it, loss 0.450635
Finished training it 70656/76743 of epoch 3, 110.16 ms/it, loss 0.450413
Finished training it 70656/76743 of epoch 3, 110.12 ms/it, loss 0.449138
Finished training it 70656/76743 of epoch 3, 110.14 ms/it, loss 0.451110
ranking from least wide range to the widest range [11  2 10 17  3  4  6  0  7  1 25 18 19 22 16  5 24  8 21 13 20 23 12 14
  9 15]
Finished training it 71680/76743 of epoch 3, 110.31 ms/it, loss 0.450689
Finished training it 71680/76743 of epoch 3, 110.55 ms/it, loss 0.451982
Finished training it 71680/76743 of epoch 3, 110.69 ms/it, loss 0.450188
Finished training it 71680/76743 of epoch 3, 110.59 ms/it, loss 0.451070
Testing at - 71680/76743 of epoch 3,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572072.0
get out
0 has test check 2572072.0 and sample count 3273728
 accuracy 78.567 %, best 78.609 %, roc auc score 0.7967, best 0.7969
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2571912.0
get out
3 has test check 2571912.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 109.56 ms/it, loss 0.451002
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2571970.0
get out
2 has test check 2571970.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 109.55 ms/it, loss 0.453004
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2572069.0
get out
1 has test check 2572069.0 and sample count 3273728
Finished training it 72704/76743 of epoch 3, 109.43 ms/it, loss 0.451788
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11  2 17 10  3  4  7  0  6 18  1  5 22 21 25 19 24 13  8 16 20 23 12 14
  9 15]
Finished training it 72704/76743 of epoch 3, 109.28 ms/it, loss 0.450378
ranking from least wide range to the widest range [11  2 10 17  0  3  6  7  4 18  1 21 25 19 22 24 16 13  5  8 20 12  9 23
 14 15]
Finished training it 73728/76743 of epoch 3, 110.15 ms/it, loss 0.453284
Finished training it 73728/76743 of epoch 3, 110.32 ms/it, loss 0.449924
Finished training it 73728/76743 of epoch 3, 110.26 ms/it, loss 0.451982
Finished training it 73728/76743 of epoch 3, 110.22 ms/it, loss 0.451873
ranking from least wide range to the widest range [ 2 11 10  3 17  0  6  7  4  1 18 25 21 24 19  8 22  5 16 13 20 23 12  9
 14 15]
Finished training it 74752/76743 of epoch 3, 109.04 ms/it, loss 0.449215
Finished training it 74752/76743 of epoch 3, 109.33 ms/it, loss 0.450516
Finished training it 74752/76743 of epoch 3, 109.25 ms/it, loss 0.452363
Finished training it 74752/76743 of epoch 3, 109.28 ms/it, loss 0.448876
ranking from least wide range to the widest range [11  2  3 10 17  0  7  6  4 25 18  1 19 24  5 21 22  8 13 16 20 12 23  9
 14 15]
Finished training it 75776/76743 of epoch 3, 110.02 ms/it, loss 0.451312
Finished training it 75776/76743 of epoch 3, 110.21 ms/it, loss 0.447257
Finished training it 75776/76743 of epoch 3, 110.17 ms/it, loss 0.449957
Finished training it 75776/76743 of epoch 3, 110.19 ms/it, loss 0.450027
Warning: Skipping the batch 76742 with size 14
ranking from least wide range to the widest range [11  2 10  3 17  0  4  7  6 25 18  1 22  5 24 13 19 16  8 21 20 23 12 14
  9 15]
Finished training it 1024/76743 of epoch 4, 112.20 ms/it, loss 0.451079
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 112.99 ms/it, loss 0.449522
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 112.27 ms/it, loss 0.450817
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 112.49 ms/it, loss 0.448570
Finished training it 2048/76743 of epoch 4, 109.97 ms/it, loss 0.451774
Finished training it 2048/76743 of epoch 4, 109.95 ms/it, loss 0.451495
ranking from least wide range to the widest range [11  2 10 17  3  7  6  0 25  4 18  1 19 22 13  5  8 24 21 16 20 23  9 12
 14 15]
Finished training it 2048/76743 of epoch 4, 109.76 ms/it, loss 0.451904
Finished training it 2048/76743 of epoch 4, 109.91 ms/it, loss 0.453036
ranking from least wide range to the widest range [11  2 10  3 17  7  4  6  0  1 18 25 24 21 22  5 13 19  8 16 20  9 12 23
 14 15]
Finished training it 3072/76743 of epoch 4, 110.21 ms/it, loss 0.452929
Finished training it 3072/76743 of epoch 4, 110.26 ms/it, loss 0.450806
Finished training it 3072/76743 of epoch 4, 110.41 ms/it, loss 0.450201
Finished training it 3072/76743 of epoch 4, 110.37 ms/it, loss 0.448480
ranking from least wide range to the widest range [11  2 17 10  7  3  6  4  0 18 21 24 25  1 16 22  5 19  8 13 20 12 23 14
  9 15]
Finished training it 4096/76743 of epoch 4, 110.70 ms/it, loss 0.450585
Finished training it 4096/76743 of epoch 4, 110.92 ms/it, loss 0.449941
Finished training it 4096/76743 of epoch 4, 110.96 ms/it, loss 0.453422
Finished training it 4096/76743 of epoch 4, 110.93 ms/it, loss 0.449759
ranking from least wide range to the widest range [11  2 10  3 17  0  4  6  7  1 25 18 22 21  5 19  8 24 16 13 20 23 14 12
  9 15]
Finished training it 5120/76743 of epoch 4, 109.48 ms/it, loss 0.449917
Finished training it 5120/76743 of epoch 4, 109.63 ms/it, loss 0.450257
Finished training it 5120/76743 of epoch 4, 109.69 ms/it, loss 0.454863
Finished training it 5120/76743 of epoch 4, 109.72 ms/it, loss 0.449647
ranking from least wide range to the widest range [11  2 17 10  3  0  7  6  4  1 18 25 19 24 21  5 13 16  8 22 20 12 23  9
 14 15]
Finished training it 6144/76743 of epoch 4, 109.45 ms/it, loss 0.449328
Finished training it 6144/76743 of epoch 4, 109.75 ms/it, loss 0.451266
Finished training it 6144/76743 of epoch 4, 109.78 ms/it, loss 0.451075
Finished training it 6144/76743 of epoch 4, 109.74 ms/it, loss 0.450271
Finished training it 7168/76743 of epoch 4, 109.92 ms/it, loss 0.449313
Finished training it 7168/76743 of epoch 4, 109.92 ms/it, loss 0.449055
Finished training it 7168/76743 of epoch 4, 109.91 ms/it, loss 0.449850
ranking from least wide range to the widest range [11 10  2 17  4  7  3  6  0 25  1 21 18 19  8 22 24  5 13 16 20 23 12  9
 14 15]
Finished training it 7168/76743 of epoch 4, 109.67 ms/it, loss 0.447997
ranking from least wide range to the widest range [11  2 10  3  0  7  4  6 17 18  1 25 21  5 19  8 22 16 24 13 20 12 23  9
 14 15]
Finished training it 8192/76743 of epoch 4, 110.10 ms/it, loss 0.449723
Finished training it 8192/76743 of epoch 4, 110.35 ms/it, loss 0.449902
Finished training it 8192/76743 of epoch 4, 110.36 ms/it, loss 0.450050
Finished training it 8192/76743 of epoch 4, 110.39 ms/it, loss 0.450926
ranking from least wide range to the widest range [11  2 10  3 17  6  4  0  7 18 21  5 25  1 16 22 19 24  8 13 20 12 23 14
  9 15]
Finished training it 9216/76743 of epoch 4, 110.42 ms/it, loss 0.449309
Finished training it 9216/76743 of epoch 4, 110.65 ms/it, loss 0.449415
Finished training it 9216/76743 of epoch 4, 110.62 ms/it, loss 0.453777
Finished training it 9216/76743 of epoch 4, 110.70 ms/it, loss 0.451325
ranking from least wide range to the widest range [11  2 10 17  3  0  6  4  7  1 18 21 22  5 25 13 16 24  8 19 20  9 12 23
 14 15]
Finished training it 10240/76743 of epoch 4, 109.46 ms/it, loss 0.449575
Finished training it 10240/76743 of epoch 4, 109.72 ms/it, loss 0.449941
Finished training it 10240/76743 of epoch 4, 109.72 ms/it, loss 0.448698
Finished training it 10240/76743 of epoch 4, 109.61 ms/it, loss 0.452157
Testing at - 10240/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573662.0
get out
0 has test check 2573662.0 and sample count 3273728
 accuracy 78.616 %, best 78.616 %, roc auc score 0.7968, best 0.7969
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [17 10 11  2  7  0  3  4  6  1 25 18 24 19 21 16  5 13 22  8 20 23 12  9
 14 15]
Finished training it 11264/76743 of epoch 4, 109.92 ms/it, loss 0.450464
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573539.0
get out
1 has test check 2573539.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 110.10 ms/it, loss 0.449789
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573567.0
get out
2 has test check 2573567.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 110.09 ms/it, loss 0.451074
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573470.0
get out
3 has test check 2573470.0 and sample count 3273728
Finished training it 11264/76743 of epoch 4, 110.15 ms/it, loss 0.450093
Finished training it 12288/76743 of epoch 4, 110.51 ms/it, loss 0.449682
ranking from least wide range to the widest range [ 2 11 17 10  3  7  0  4  6  1 25  5 18 19 24 22 13  8 16 21 20 23 12 14
  9 15]
Finished training it 12288/76743 of epoch 4, 110.23 ms/it, loss 0.448494
Finished training it 12288/76743 of epoch 4, 110.51 ms/it, loss 0.451773
Finished training it 12288/76743 of epoch 4, 110.48 ms/it, loss 0.448612
ranking from least wide range to the widest range [11  2 10 17  3  0  4  7  6 25 18  1  5 21 13 19 24  8 16 22 20 12 23  9
 14 15]
Finished training it 13312/76743 of epoch 4, 110.54 ms/it, loss 0.450254
Finished training it 13312/76743 of epoch 4, 110.72 ms/it, loss 0.449675
Finished training it 13312/76743 of epoch 4, 110.74 ms/it, loss 0.449621
Finished training it 13312/76743 of epoch 4, 110.76 ms/it, loss 0.449923
ranking from least wide range to the widest range [11  2  4 17 10  3  7  6  0 21 25  5 24 19 18  1  8 13 16 22 20 23 12  9
 14 15]
Finished training it 14336/76743 of epoch 4, 109.52 ms/it, loss 0.450984
Finished training it 14336/76743 of epoch 4, 109.81 ms/it, loss 0.450024
Finished training it 14336/76743 of epoch 4, 109.79 ms/it, loss 0.449826
Finished training it 14336/76743 of epoch 4, 109.86 ms/it, loss 0.451407
ranking from least wide range to the widest range [11 17  2  3  0  4 10  7  6 25 18  1 24  5 21 22 16  8 19 13 20 23 12  9
 14 15]
Finished training it 15360/76743 of epoch 4, 109.75 ms/it, loss 0.450814
Finished training it 15360/76743 of epoch 4, 110.03 ms/it, loss 0.451393
Finished training it 15360/76743 of epoch 4, 109.97 ms/it, loss 0.449798
Finished training it 15360/76743 of epoch 4, 109.93 ms/it, loss 0.451130
ranking from least wide range to the widest range [11  2 10  3 17  7  4  0  6 25 18  1 19  5 13  8 22 16 21 24 20 12 23 14
  9 15]
Finished training it 16384/76743 of epoch 4, 110.51 ms/it, loss 0.451982
Finished training it 16384/76743 of epoch 4, 110.76 ms/it, loss 0.449440
Finished training it 16384/76743 of epoch 4, 110.71 ms/it, loss 0.448412
Finished training it 16384/76743 of epoch 4, 110.74 ms/it, loss 0.449240
ranking from least wide range to the widest range [11  2  3 17  0 10  7  4  6 25 18 24  1 19  5 13 16 21  8 22 20 23 12 14
  9 15]
Finished training it 17408/76743 of epoch 4, 109.85 ms/it, loss 0.451091
Finished training it 17408/76743 of epoch 4, 109.95 ms/it, loss 0.451150
Finished training it 17408/76743 of epoch 4, 110.04 ms/it, loss 0.450041
Finished training it 17408/76743 of epoch 4, 110.08 ms/it, loss 0.447609
ranking from least wide range to the widest range [11  2 10 17  3  7  0  4  6 18 25 21  1 19  5 22  8 24 13 16 20  9 23 12
 14 15]
Finished training it 18432/76743 of epoch 4, 109.88 ms/it, loss 0.451705
Finished training it 18432/76743 of epoch 4, 110.12 ms/it, loss 0.451711
Finished training it 18432/76743 of epoch 4, 110.05 ms/it, loss 0.451140
Finished training it 18432/76743 of epoch 4, 110.00 ms/it, loss 0.452252
Finished training it 19456/76743 of epoch 4, 109.69 ms/it, loss 0.449862
ranking from least wide range to the widest range [11  2 17  3 10  0  4  7  6  1 24 18 21 25 22 13 19  5 16  8 20  9 23 12
 14 15]
Finished training it 19456/76743 of epoch 4, 109.49 ms/it, loss 0.452564
Finished training it 19456/76743 of epoch 4, 109.72 ms/it, loss 0.448356
Finished training it 19456/76743 of epoch 4, 109.77 ms/it, loss 0.450392
ranking from least wide range to the widest range [11  2 17  3  0 10  6  7  4  1 18 25 21  5 24 16 22 19 13  8 20 23 12 14
  9 15]
Finished training it 20480/76743 of epoch 4, 110.03 ms/it, loss 0.452541
Finished training it 20480/76743 of epoch 4, 110.27 ms/it, loss 0.448479
Finished training it 20480/76743 of epoch 4, 110.21 ms/it, loss 0.450274
Finished training it 20480/76743 of epoch 4, 110.22 ms/it, loss 0.449185
Testing at - 20480/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2574060.0
get out
0 has test check 2574060.0 and sample count 3273728
 accuracy 78.628 %, best 78.628 %, roc auc score 0.7974, best 0.7974
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 17  3  0 10  6  7  4  1 25 18 19 21 13 16 24 22  5  8 20 12 23 14
  9 15]
Finished training it 21504/76743 of epoch 4, 110.16 ms/it, loss 0.449638
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2574223.0
get out
3 has test check 2574223.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 110.37 ms/it, loss 0.450135
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574011.0
get out
1 has test check 2574011.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 110.45 ms/it, loss 0.449579
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574014.0
get out
2 has test check 2574014.0 and sample count 3273728
Finished training it 21504/76743 of epoch 4, 110.33 ms/it, loss 0.447841
ranking from least wide range to the widest range [11 17  2 10  3  0  4  6  7  1 18 25 21 24 19  5 22 13  8 16 20 23  9 12
 14 15]
Finished training it 22528/76743 of epoch 4, 109.77 ms/it, loss 0.449794
Finished training it 22528/76743 of epoch 4, 110.04 ms/it, loss 0.450845
Finished training it 22528/76743 of epoch 4, 110.12 ms/it, loss 0.448283
Finished training it 22528/76743 of epoch 4, 110.07 ms/it, loss 0.449204
ranking from least wide range to the widest range [ 2 11 10  3  0 17  7  6  4 18 25  8 21  1 19 24 13  5 16 22 20  9 12 23
 14 15]
Finished training it 23552/76743 of epoch 4, 109.57 ms/it, loss 0.452335
Finished training it 23552/76743 of epoch 4, 109.80 ms/it, loss 0.449679
Finished training it 23552/76743 of epoch 4, 109.85 ms/it, loss 0.449697
Finished training it 23552/76743 of epoch 4, 109.84 ms/it, loss 0.450442
ranking from least wide range to the widest range [11  2 10 17  3  7  4  0  6 25  1 18  5 21  8 16 24 19 13 22 20  9 23 14
 12 15]
Finished training it 24576/76743 of epoch 4, 110.13 ms/it, loss 0.451839
Finished training it 24576/76743 of epoch 4, 110.45 ms/it, loss 0.451463
Finished training it 24576/76743 of epoch 4, 110.39 ms/it, loss 0.450438
Finished training it 24576/76743 of epoch 4, 110.36 ms/it, loss 0.450886
ranking from least wide range to the widest range [11  2 10 17  3  0  4  6  7  1 25 18 19 13 22 21 24  5 16 20  8 23 12 14
  9 15]
Finished training it 25600/76743 of epoch 4, 109.86 ms/it, loss 0.450082
Finished training it 25600/76743 of epoch 4, 110.04 ms/it, loss 0.449357
Finished training it 25600/76743 of epoch 4, 110.20 ms/it, loss 0.449754
Finished training it 25600/76743 of epoch 4, 110.10 ms/it, loss 0.449787
ranking from least wide range to the widest range [11  3 10  2 17  4  6  7  0  1 18 21 25 19 24  8 13 16  5 22  9 20 12 23
 14 15]
Finished training it 26624/76743 of epoch 4, 110.28 ms/it, loss 0.453752
Finished training it 26624/76743 of epoch 4, 110.49 ms/it, loss 0.449057
Finished training it 26624/76743 of epoch 4, 110.34 ms/it, loss 0.449890
Finished training it 26624/76743 of epoch 4, 110.40 ms/it, loss 0.447880
ranking from least wide range to the widest range [ 2 11  3 17 10  7  4  0  6 18  1 16 21 24 25 19  8 13  5 22 20 12  9 23
 14 15]
Finished training it 27648/76743 of epoch 4, 110.60 ms/it, loss 0.450836
Finished training it 27648/76743 of epoch 4, 110.73 ms/it, loss 0.451205
Finished training it 27648/76743 of epoch 4, 110.85 ms/it, loss 0.449009
Finished training it 27648/76743 of epoch 4, 110.82 ms/it, loss 0.449035
ranking from least wide range to the widest range [11  2 17 10  3  4  6  0  7 25 18  1 24 22 21 16  5 13 19  8 20 12 23 14
  9 15]
Finished training it 28672/76743 of epoch 4, 110.14 ms/it, loss 0.449423
Finished training it 28672/76743 of epoch 4, 110.20 ms/it, loss 0.453075
Finished training it 28672/76743 of epoch 4, 110.33 ms/it, loss 0.448495
Finished training it 28672/76743 of epoch 4, 110.34 ms/it, loss 0.449447
ranking from least wide range to the widest range [11  2 10  3 17  4  0  6  7  1 21 18  5 25 19  8 22 24 13 16 20  9 12 23
 14 15]
Finished training it 29696/76743 of epoch 4, 109.88 ms/it, loss 0.449549
Finished training it 29696/76743 of epoch 4, 110.15 ms/it, loss 0.448410
Finished training it 29696/76743 of epoch 4, 110.12 ms/it, loss 0.449515
Finished training it 29696/76743 of epoch 4, 110.07 ms/it, loss 0.450542
ranking from least wide range to the widest range [11  2  3 10 17  7  0  6  4  1 18 25  5 21 13 19 22 16 24 20  8 23 12 14
  9 15]
Finished training it 30720/76743 of epoch 4, 110.29 ms/it, loss 0.449235
Finished training it 30720/76743 of epoch 4, 110.55 ms/it, loss 0.449273
Finished training it 30720/76743 of epoch 4, 110.49 ms/it, loss 0.450155
Finished training it 30720/76743 of epoch 4, 110.57 ms/it, loss 0.448987
Testing at - 30720/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2571508.0
get out
0 has test check 2571508.0 and sample count 3273728
 accuracy 78.550 %, best 78.628 %, roc auc score 0.7970, best 0.7974
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11 17  2  3  0 10  6  4  7 25  1 18 24 16  8 13  5 19 22 21 20 23 12  9
 14 15]
Finished training it 31744/76743 of epoch 4, 110.16 ms/it, loss 0.448661
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2571526.0
get out
3 has test check 2571526.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 110.47 ms/it, loss 0.448530
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2571530.0
get out
2 has test check 2571530.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 110.30 ms/it, loss 0.449726
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2571286.0
get out
1 has test check 2571286.0 and sample count 3273728
Finished training it 31744/76743 of epoch 4, 110.32 ms/it, loss 0.450530
ranking from least wide range to the widest range [11 17 10  2  7  0  4  6  3  1 18 25 24  5 21 13 16 22 19  8 20 12 23  9
 14 15]
Finished training it 32768/76743 of epoch 4, 109.87 ms/it, loss 0.450264
Finished training it 32768/76743 of epoch 4, 110.08 ms/it, loss 0.450066
Finished training it 32768/76743 of epoch 4, 110.04 ms/it, loss 0.452359
Finished training it 32768/76743 of epoch 4, 110.07 ms/it, loss 0.449818
ranking from least wide range to the widest range [11  2 10 17  3  7  0  6  4 18  1 25 24 22  5 16 21 19 13  8 20 12 23 14
  9 15]
Finished training it 33792/76743 of epoch 4, 109.97 ms/it, loss 0.449724
Finished training it 33792/76743 of epoch 4, 110.26 ms/it, loss 0.451217
Finished training it 33792/76743 of epoch 4, 110.18 ms/it, loss 0.449448
Finished training it 33792/76743 of epoch 4, 110.19 ms/it, loss 0.446640
ranking from least wide range to the widest range [11  2 17 10  3  0  7  6  4 21  1 18 24 25  5  8 13 22 19 16 20 23 12  9
 14 15]
Finished training it 34816/76743 of epoch 4, 110.45 ms/it, loss 0.447772
Finished training it 34816/76743 of epoch 4, 110.58 ms/it, loss 0.447791
Finished training it 34816/76743 of epoch 4, 110.59 ms/it, loss 0.450963
Finished training it 34816/76743 of epoch 4, 110.59 ms/it, loss 0.449496
ranking from least wide range to the widest range [11  2 17  3 10  0  6  7  4 21  1 25 19 18  8 24  5 16 22 13 20  9 23 12
 14 15]
Finished training it 35840/76743 of epoch 4, 109.79 ms/it, loss 0.447444
Finished training it 35840/76743 of epoch 4, 109.95 ms/it, loss 0.447712
Finished training it 35840/76743 of epoch 4, 109.92 ms/it, loss 0.449617
Finished training it 35840/76743 of epoch 4, 109.90 ms/it, loss 0.450655
Finished training it 36864/76743 of epoch 4, 110.17 ms/it, loss 0.447583
ranking from least wide range to the widest range [11  2 17 10  3  0  6  7  4 25  1 18 21  5 24 13 19 22 16  8 20 12 14 23
  9 15]
Finished training it 36864/76743 of epoch 4, 109.83 ms/it, loss 0.449039
Finished training it 36864/76743 of epoch 4, 110.19 ms/it, loss 0.451792
Finished training it 36864/76743 of epoch 4, 110.22 ms/it, loss 0.448274
ranking from least wide range to the widest range [11  2 10  3 17  0  6  7  4  1 25 18  5 24  8 16 22 19 21 13 20  9 12 23
 14 15]
Finished training it 37888/76743 of epoch 4, 109.76 ms/it, loss 0.450684
Finished training it 37888/76743 of epoch 4, 109.98 ms/it, loss 0.447864
Finished training it 37888/76743 of epoch 4, 109.86 ms/it, loss 0.451488
Finished training it 37888/76743 of epoch 4, 109.94 ms/it, loss 0.452191
Finished training it 38912/76743 of epoch 4, 109.98 ms/it, loss 0.452090
ranking from least wide range to the widest range [11  2  7 10  3  0 17  6  4 25  1 21 18  5 24  8 22 13 19 16 20 23 12  9
 14 15]
Finished training it 38912/76743 of epoch 4, 109.63 ms/it, loss 0.450316
Finished training it 38912/76743 of epoch 4, 109.92 ms/it, loss 0.449376
Finished training it 38912/76743 of epoch 4, 109.91 ms/it, loss 0.450893
Finished training it 39936/76743 of epoch 4, 110.51 ms/it, loss 0.451092
ranking from least wide range to the widest range [11  2 10 17  0  3  7  6  4  1 18 25 21 24 22 16 19 13  8  5 20 12 23 14
  9 15]
Finished training it 39936/76743 of epoch 4, 110.30 ms/it, loss 0.448392
Finished training it 39936/76743 of epoch 4, 110.39 ms/it, loss 0.451323
Finished training it 39936/76743 of epoch 4, 110.40 ms/it, loss 0.448510
ranking from least wide range to the widest range [11  2 10 17  6  3  4  0  7 21 18  1 25 19 22  8 16  5 24 20 13 23  9 12
 14 15]
Finished training it 40960/76743 of epoch 4, 109.60 ms/it, loss 0.450153
Finished training it 40960/76743 of epoch 4, 109.85 ms/it, loss 0.448458
Finished training it 40960/76743 of epoch 4, 109.88 ms/it, loss 0.449515
Finished training it 40960/76743 of epoch 4, 109.85 ms/it, loss 0.451334
Testing at - 40960/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2567754.0
get out
0 has test check 2567754.0 and sample count 3273728
 accuracy 78.435 %, best 78.628 %, roc auc score 0.7973, best 0.7974
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2567312.0
get out
1 has test check 2567312.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 110.50 ms/it, loss 0.451605
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 10 17  3  7  0  6  4 13  1 18 25 19 21 24 22  8  5 16 20 23 12 14
  9 15]
Finished training it 41984/76743 of epoch 4, 110.30 ms/it, loss 0.449504
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2567178.0
get out
2 has test check 2567178.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 110.51 ms/it, loss 0.449289
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2567911.0
get out
3 has test check 2567911.0 and sample count 3273728
Finished training it 41984/76743 of epoch 4, 110.36 ms/it, loss 0.448716
ranking from least wide range to the widest range [11  2 17 10  3  0  7  6  4  1 18  5 25 19 21 13 24 16  8 22 20 12 23 14
  9 15]
Finished training it 43008/76743 of epoch 4, 110.44 ms/it, loss 0.449941
Finished training it 43008/76743 of epoch 4, 110.59 ms/it, loss 0.449568
Finished training it 43008/76743 of epoch 4, 110.64 ms/it, loss 0.447386
Finished training it 43008/76743 of epoch 4, 110.66 ms/it, loss 0.450630
ranking from least wide range to the widest range [11  2 10 17  7  3  0  4  6  1 25 18 24 22 19  5 13  8 16 21 20 12 23  9
 14 15]
Finished training it 44032/76743 of epoch 4, 110.07 ms/it, loss 0.451024
Finished training it 44032/76743 of epoch 4, 110.32 ms/it, loss 0.452896
Finished training it 44032/76743 of epoch 4, 110.33 ms/it, loss 0.449804
Finished training it 44032/76743 of epoch 4, 110.29 ms/it, loss 0.449810
Finished training it 45056/76743 of epoch 4, 109.78 ms/it, loss 0.452227
Finished training it 45056/76743 of epoch 4, 109.89 ms/it, loss 0.448642
Finished training it 45056/76743 of epoch 4, 109.89 ms/it, loss 0.447528
ranking from least wide range to the widest range [11  2 10  3  0 17  7  6  4  1 25 21 16 22 13 19 18 24  5  8 20 12 23 14
  9 15]
Finished training it 45056/76743 of epoch 4, 109.65 ms/it, loss 0.449447
ranking from least wide range to the widest range [11  2 10 17  0  7  3  6  4  1 25  5 24 18 13  8 16 22 19 21 20  9 12 23
 14 15]
Finished training it 46080/76743 of epoch 4, 110.33 ms/it, loss 0.452255
Finished training it 46080/76743 of epoch 4, 110.64 ms/it, loss 0.451654
Finished training it 46080/76743 of epoch 4, 110.46 ms/it, loss 0.452037
Finished training it 46080/76743 of epoch 4, 110.48 ms/it, loss 0.450166
ranking from least wide range to the widest range [11 17  2 10  0  3  4  7  6  1 25 18 16 22 24 19  5 13 21  8 20 23 14 12
  9 15]
Finished training it 47104/76743 of epoch 4, 110.36 ms/it, loss 0.448594
Finished training it 47104/76743 of epoch 4, 110.62 ms/it, loss 0.451777
Finished training it 47104/76743 of epoch 4, 110.60 ms/it, loss 0.451003
Finished training it 47104/76743 of epoch 4, 110.60 ms/it, loss 0.449088
ranking from least wide range to the widest range [11  2 17 10  0  3  4  7  6  1 18 25  5 13 24 19 22  8 20 16 21 23 14  9
 12 15]
Finished training it 48128/76743 of epoch 4, 109.53 ms/it, loss 0.448715
Finished training it 48128/76743 of epoch 4, 109.81 ms/it, loss 0.451038
Finished training it 48128/76743 of epoch 4, 109.78 ms/it, loss 0.448124
Finished training it 48128/76743 of epoch 4, 109.70 ms/it, loss 0.451496
ranking from least wide range to the widest range [ 2 11  3  0 17  7 10  6  4 25  1 18  5 24 21  8 19 16 22 13 20 12 23 14
  9 15]
Finished training it 49152/76743 of epoch 4, 109.66 ms/it, loss 0.448397
Finished training it 49152/76743 of epoch 4, 109.94 ms/it, loss 0.449847
Finished training it 49152/76743 of epoch 4, 109.84 ms/it, loss 0.451157
Finished training it 49152/76743 of epoch 4, 109.92 ms/it, loss 0.450461
ranking from least wide range to the widest range [11  2  0 10 17  3  4  7  6 25  1 18 16 24  5 13 22  8 19 21 20  9 12 23
 14 15]
Finished training it 50176/76743 of epoch 4, 110.50 ms/it, loss 0.451039
Finished training it 50176/76743 of epoch 4, 110.61 ms/it, loss 0.447458
Finished training it 50176/76743 of epoch 4, 110.64 ms/it, loss 0.450158
Finished training it 50176/76743 of epoch 4, 110.62 ms/it, loss 0.451512
ranking from least wide range to the widest range [11  2  3 10 17  0  7  6  4  1 25 18 21  5 22  8 24 16 19 13 20 12  9 23
 14 15]
Finished training it 51200/76743 of epoch 4, 110.13 ms/it, loss 0.446693
Finished training it 51200/76743 of epoch 4, 110.28 ms/it, loss 0.449934
Finished training it 51200/76743 of epoch 4, 110.31 ms/it, loss 0.453648
Finished training it 51200/76743 of epoch 4, 110.31 ms/it, loss 0.451369
Testing at - 51200/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575322.0
get out
0 has test check 2575322.0 and sample count 3273728
 accuracy 78.666 %, best 78.666 %, roc auc score 0.7979, best 0.7979
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2575214.0
get out
3 has test check 2575214.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 109.73 ms/it, loss 0.450905
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [11  2 10  3  0 17  6  7  4 25 24 21 13 18 22  5  1 19 16  8 20 12  9 23
 14 15]
Finished training it 52224/76743 of epoch 4, 109.55 ms/it, loss 0.451100
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574949.0
get out
1 has test check 2574949.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 109.84 ms/it, loss 0.451111
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575089.0
get out
2 has test check 2575089.0 and sample count 3273728
Finished training it 52224/76743 of epoch 4, 109.81 ms/it, loss 0.448342
ranking from least wide range to the widest range [11  2 17  0  3 10  7  6  4 21  1 25 22 18 13  8 19 24  5 16 20  9 12 23
 14 15]
Finished training it 53248/76743 of epoch 4, 109.85 ms/it, loss 0.448971
Finished training it 53248/76743 of epoch 4, 110.12 ms/it, loss 0.450951
Finished training it 53248/76743 of epoch 4, 110.06 ms/it, loss 0.450893
Finished training it 53248/76743 of epoch 4, 110.02 ms/it, loss 0.451581
ranking from least wide range to the widest range [11  2 10 17  3  7  6  4  0 25 19  1 13 18 24 21 22  8  5 16 20  9 12 23
 14 15]
Finished training it 54272/76743 of epoch 4, 109.41 ms/it, loss 0.450247
Finished training it 54272/76743 of epoch 4, 109.65 ms/it, loss 0.450258
Finished training it 54272/76743 of epoch 4, 109.68 ms/it, loss 0.449459
Finished training it 54272/76743 of epoch 4, 109.55 ms/it, loss 0.449306
Finished training it 55296/76743 of epoch 4, 110.14 ms/it, loss 0.451978
Finished training it 55296/76743 of epoch 4, 110.08 ms/it, loss 0.451314
Finished training it 55296/76743 of epoch 4, 110.12 ms/it, loss 0.448771
ranking from least wide range to the widest range [11  2 17  0 10  3  7  4  6 25 18 21  5 19  1 22 16 24  8 13 20  9 23 12
 14 15]
Finished training it 55296/76743 of epoch 4, 109.85 ms/it, loss 0.445568
Finished training it 56320/76743 of epoch 4, 110.53 ms/it, loss 0.447936
ranking from least wide range to the widest range [11  2  3 10  6 17  0  7 25  4  1 19 18 22 13  5  8 16 21 24 20 23 12 14
  9 15]
Finished training it 56320/76743 of epoch 4, 110.33 ms/it, loss 0.450699
Finished training it 56320/76743 of epoch 4, 110.50 ms/it, loss 0.447316
Finished training it 56320/76743 of epoch 4, 110.48 ms/it, loss 0.449131
ranking from least wide range to the widest range [11  2  7 17 10  3  6  4  0 25  1 18 24 19  5 16 21 22 13  8 20 12 23  9
 14 15]
Finished training it 57344/76743 of epoch 4, 110.22 ms/it, loss 0.450312
Finished training it 57344/76743 of epoch 4, 110.37 ms/it, loss 0.449727
Finished training it 57344/76743 of epoch 4, 110.38 ms/it, loss 0.449358
Finished training it 57344/76743 of epoch 4, 110.43 ms/it, loss 0.449261
Finished training it 58368/76743 of epoch 4, 109.81 ms/it, loss 0.450011
ranking from least wide range to the widest range [ 2 11 17  3 10  0  7  6  4 18  1 22 25 24 16 19 21  5 13  8 20  9 23 12
 14 15]
Finished training it 58368/76743 of epoch 4, 109.59 ms/it, loss 0.448850
Finished training it 58368/76743 of epoch 4, 109.77 ms/it, loss 0.450306
Finished training it 58368/76743 of epoch 4, 109.72 ms/it, loss 0.449225
ranking from least wide range to the widest range [11  2  3 10 17  7  0  4  6  1 21 25 22  5 19 18 16 24  8 13 20 12 23 14
  9 15]
Finished training it 59392/76743 of epoch 4, 110.02 ms/it, loss 0.447809
Finished training it 59392/76743 of epoch 4, 110.17 ms/it, loss 0.449641
Finished training it 59392/76743 of epoch 4, 110.29 ms/it, loss 0.449968
Finished training it 59392/76743 of epoch 4, 110.22 ms/it, loss 0.448904
ranking from least wide range to the widest range [11  2 10  3  7  0 17  6  4 25  1 21 22 18 13 19  5 24  8 16 20 12  9 23
 14 15]
Finished training it 60416/76743 of epoch 4, 110.01 ms/it, loss 0.449569
Finished training it 60416/76743 of epoch 4, 110.23 ms/it, loss 0.450226
Finished training it 60416/76743 of epoch 4, 110.10 ms/it, loss 0.452739
Finished training it 60416/76743 of epoch 4, 110.07 ms/it, loss 0.447897
ranking from least wide range to the widest range [11  2 10 17  3  0  4  6  7 25 24  1 16 22 18 21  5 19 13  8 20 12  9 23
 14 15]
Finished training it 61440/76743 of epoch 4, 109.91 ms/it, loss 0.450774
Finished training it 61440/76743 of epoch 4, 110.15 ms/it, loss 0.449341
Finished training it 61440/76743 of epoch 4, 110.15 ms/it, loss 0.447475
Finished training it 61440/76743 of epoch 4, 110.05 ms/it, loss 0.450420
Testing at - 61440/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573749.0
get out
0 has test check 2573749.0 and sample count 3273728
 accuracy 78.618 %, best 78.666 %, roc auc score 0.7974, best 0.7979
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
ranking from least wide range to the widest range [11  2 10  0  4  3  7 17  6 25  1 16 18 21 13 19  5  8 22 24 20 12  9 23
 14 15]
Finished training it 62464/76743 of epoch 4, 110.05 ms/it, loss 0.450126
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573692.0
get out
2 has test check 2573692.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 110.12 ms/it, loss 0.448169
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573635.0
get out
3 has test check 2573635.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 110.21 ms/it, loss 0.445642
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573645.0
get out
1 has test check 2573645.0 and sample count 3273728
Finished training it 62464/76743 of epoch 4, 110.10 ms/it, loss 0.450754
ranking from least wide range to the widest range [11  2  0 10 17  7  3  4  6 25 16  1 18 21  5 19  8 13 22 24 20 12 23 14
  9 15]
Finished training it 63488/76743 of epoch 4, 110.19 ms/it, loss 0.449657
Finished training it 63488/76743 of epoch 4, 110.39 ms/it, loss 0.450390
Finished training it 63488/76743 of epoch 4, 110.39 ms/it, loss 0.448463
Finished training it 63488/76743 of epoch 4, 110.50 ms/it, loss 0.449657
ranking from least wide range to the widest range [11  2 17 10  3  7  6  4  0  1 18 25  5 21 13 22 16 24  8 19 20 23 12  9
 14 15]
Finished training it 64512/76743 of epoch 4, 110.40 ms/it, loss 0.444561
Finished training it 64512/76743 of epoch 4, 110.56 ms/it, loss 0.450671
Finished training it 64512/76743 of epoch 4, 110.59 ms/it, loss 0.448804
Finished training it 64512/76743 of epoch 4, 110.51 ms/it, loss 0.449372
ranking from least wide range to the widest range [11  2  3 17 10  0  4  7  6 25  1 21 18 13  5 22 19  8 16 24 20  9 12 23
 14 15]
Finished training it 65536/76743 of epoch 4, 109.96 ms/it, loss 0.450276
Finished training it 65536/76743 of epoch 4, 110.14 ms/it, loss 0.449978
Finished training it 65536/76743 of epoch 4, 110.16 ms/it, loss 0.450488
Finished training it 65536/76743 of epoch 4, 110.12 ms/it, loss 0.451206
Finished training it 66560/76743 of epoch 4, 110.34 ms/it, loss 0.448842
ranking from least wide range to the widest range [11  2 17  3  0 10  4  6  7 25  1 24 18 13  5 22 16  8 21 19 20 12 23 14
  9 15]
Finished training it 66560/76743 of epoch 4, 110.21 ms/it, loss 0.450708
Finished training it 66560/76743 of epoch 4, 110.33 ms/it, loss 0.449709
Finished training it 66560/76743 of epoch 4, 110.44 ms/it, loss 0.449864
Finished training it 67584/76743 of epoch 4, 109.85 ms/it, loss 0.453478
ranking from least wide range to the widest range [11 17  2 10  3  0  4  6  7  1 18 25 19  5 13 24 21  8 22 20 16 23  9 12
 14 15]
Finished training it 67584/76743 of epoch 4, 109.59 ms/it, loss 0.447286
Finished training it 67584/76743 of epoch 4, 109.87 ms/it, loss 0.448832
Finished training it 67584/76743 of epoch 4, 109.77 ms/it, loss 0.452444
ranking from least wide range to the widest range [ 2 17 11 10  3  7  0  4  6 25 22 18 16  5 24  1 21 19 13  8 20 12  9 23
 14 15]
Finished training it 68608/76743 of epoch 4, 110.86 ms/it, loss 0.449108
Finished training it 68608/76743 of epoch 4, 111.13 ms/it, loss 0.449061
Finished training it 68608/76743 of epoch 4, 111.01 ms/it, loss 0.447816
Finished training it 68608/76743 of epoch 4, 111.00 ms/it, loss 0.447332
ranking from least wide range to the widest range [11  2 10  4  0  3 17  7  6 25  1 18  5 22 19 16 24 21 13  8 20 23 12 14
  9 15]
Finished training it 69632/76743 of epoch 4, 110.35 ms/it, loss 0.450847
Finished training it 69632/76743 of epoch 4, 110.57 ms/it, loss 0.449329
Finished training it 69632/76743 of epoch 4, 110.47 ms/it, loss 0.449357
Finished training it 69632/76743 of epoch 4, 110.54 ms/it, loss 0.448756
ranking from least wide range to the widest range [ 2 11 10 17  7  0  3  6  4 25  1 21 22 18  5 16 19  8 24 13 20 23 12  9
 14 15]
Finished training it 70656/76743 of epoch 4, 110.52 ms/it, loss 0.448811
Finished training it 70656/76743 of epoch 4, 110.59 ms/it, loss 0.447592
Finished training it 70656/76743 of epoch 4, 110.81 ms/it, loss 0.449308
Finished training it 70656/76743 of epoch 4, 110.71 ms/it, loss 0.449647
ranking from least wide range to the widest range [11  2 10  4 17  3  7  0  6  1 25 19 22 16 18  5  8 24 21 13 20 23 12 14
  9 15]
Finished training it 71680/76743 of epoch 4, 110.41 ms/it, loss 0.449026
Finished training it 71680/76743 of epoch 4, 110.66 ms/it, loss 0.449317
Finished training it 71680/76743 of epoch 4, 110.66 ms/it, loss 0.450691
Finished training it 71680/76743 of epoch 4, 110.67 ms/it, loss 0.449672
Testing at - 71680/76743 of epoch 4,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573830.0
get out
0 has test check 2573830.0 and sample count 3273728
 accuracy 78.621 %, best 78.666 %, roc auc score 0.7980, best 0.7980
Saving model to /home/yzhou/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
ranking from least wide range to the widest range [ 2 11 10 17  3  4  7  0  6  1 18  5 22 13 25 24 19 21 16  8 20 23 12 14
  9 15]
Finished training it 72704/76743 of epoch 4, 110.19 ms/it, loss 0.449090
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573602.0
get out
2 has test check 2573602.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 110.21 ms/it, loss 0.451600
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2573824.0
get out
3 has test check 2573824.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 110.54 ms/it, loss 0.449479
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573849.0
get out
1 has test check 2573849.0 and sample count 3273728
Finished training it 72704/76743 of epoch 4, 110.30 ms/it, loss 0.450448
ranking from least wide range to the widest range [11  2 10  3 17  0  7  6  4  1 21 18 22 13 25 16  5 24 19  8 20 23  9 12
 14 15]
Finished training it 73728/76743 of epoch 4, 109.76 ms/it, loss 0.452117
Finished training it 73728/76743 of epoch 4, 110.02 ms/it, loss 0.448665
Finished training it 73728/76743 of epoch 4, 110.05 ms/it, loss 0.450969
Finished training it 73728/76743 of epoch 4, 110.06 ms/it, loss 0.450483
Finished training it 74752/76743 of epoch 4, 109.73 ms/it, loss 0.449075
Finished training it 74752/76743 of epoch 4, 109.78 ms/it, loss 0.451382
ranking from least wide range to the widest range [ 2 11  3 10 17  0  7  6  4  1 24 25 22  5 19 21  8 18 16 13 20 23 12  9
 14 15]
Finished training it 74752/76743 of epoch 4, 109.60 ms/it, loss 0.447801
Finished training it 74752/76743 of epoch 4, 109.76 ms/it, loss 0.447723
ranking from least wide range to the widest range [11  2 17 10  3  0  7  6  4  1 25 18 24 19  5 22 13 16  8 21 20  9 12 23
 14 15]
Finished training it 75776/76743 of epoch 4, 110.50 ms/it, loss 0.450077
Finished training it 75776/76743 of epoch 4, 110.70 ms/it, loss 0.449001
Finished training it 75776/76743 of epoch 4, 110.76 ms/it, loss 0.446149
Finished training it 75776/76743 of epoch 4, 110.75 ms/it, loss 0.448690
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
steps testing: 0.0steps testing: 0.06253908692933083steps testing: 0.12507817385866166steps testing: 0.18761726078799248steps testing: 0.2501563477173233steps testing: 0.31269543464665417steps testing: 0.37523452157598497steps testing: 0.4377736085053158steps testing: 0.5003126954346466steps testing: 0.5628517823639775steps testing: 0.6253908692933083steps testing: 0.6879299562226392steps testing: 0.7504690431519699steps testing: 0.8130081300813008steps testing: 0.8755472170106317steps testing: 0.9380863039399625Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573986.0
get out
0 has test check 2573986.0 and sample count 3273728
 accuracy 78.626 %, best 78.666 %, roc auc score 0.7971, best 0.7980
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574582.0
get out
1 has test check 2574582.0 and sample count 3273728
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574465.0
get out
2 has test check 2574465.0 and sample count 3273728
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2574761.0
get out
3 has test check 2574761.0 and sample count 3273728
