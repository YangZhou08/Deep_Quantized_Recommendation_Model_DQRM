Finished training it 70656/76743 of epoch 0, 114.53 ms/it, loss 0.454801
Finished training it 70656/76743 of epoch 0, 115.40 ms/it, loss 0.455544
Finished training it 70656/76743 of epoch 0, 113.48 ms/it, loss 0.458488
Finished training it 71680/76743 of epoch 0, 109.01 ms/it, loss 0.457134
Finished training it 71680/76743 of epoch 0, 109.64 ms/it, loss 0.454413
Finished training it 71680/76743 of epoch 0, 110.04 ms/it, loss 0.455509
Finished training it 71680/76743 of epoch 0, 109.23 ms/it, loss 0.455206
Testing at - 71680/76743 of epoch 0,
Testing at - 71680/76743 of epoch 0,
Testing at - 71680/76743 of epoch 0,
Testing at - 71680/76743 of epoch 0,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2561689.0
get out
0 has test check 2561689.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2561689.0
get out
1 has test check 2561689.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2561689.0
get out
2 has test check 2561689.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2561689.0
get out
3 has test check 2561689.0 and sample count 3273728
 accuracy 78.250 %, best 78.345 %, roc auc score 0.7924, best 0.7924
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 72704/76743 of epoch 0, 116.71 ms/it, loss 0.454417
Finished training it 72704/76743 of epoch 0, 116.11 ms/it, loss 0.452909
Finished training it 72704/76743 of epoch 0, 110.65 ms/it, loss 0.453897
Finished training it 72704/76743 of epoch 0, 114.01 ms/it, loss 0.456105
Finished training it 73728/76743 of epoch 0, 113.20 ms/it, loss 0.454549
Finished training it 73728/76743 of epoch 0, 113.15 ms/it, loss 0.454393
Finished training it 73728/76743 of epoch 0, 113.57 ms/it, loss 0.453380
Finished training it 73728/76743 of epoch 0, 112.17 ms/it, loss 0.454446
Finished training it 74752/76743 of epoch 0, 116.43 ms/it, loss 0.457122
Finished training it 74752/76743 of epoch 0, 116.92 ms/it, loss 0.458803
Finished training it 74752/76743 of epoch 0, 115.91 ms/it, loss 0.456241
Finished training it 74752/76743 of epoch 0, 115.46 ms/it, loss 0.458018
Finished training it 75776/76743 of epoch 0, 113.54 ms/it, loss 0.453578
Finished training it 75776/76743 of epoch 0, 112.97 ms/it, loss 0.455377
Finished training it 75776/76743 of epoch 0, 112.74 ms/it, loss 0.454141
Finished training it 75776/76743 of epoch 0, 112.78 ms/it, loss 0.455547
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 1, 116.41 ms/it, loss 0.453115
Finished training it 1024/76743 of epoch 1, 118.32 ms/it, loss 0.452257
Finished training it 1024/76743 of epoch 1, 117.19 ms/it, loss 0.454923
Finished training it 1024/76743 of epoch 1, 118.58 ms/it, loss 0.456857
Finished training it 2048/76743 of epoch 1, 116.68 ms/it, loss 0.458050
Finished training it 2048/76743 of epoch 1, 115.10 ms/it, loss 0.455436
Finished training it 2048/76743 of epoch 1, 116.43 ms/it, loss 0.456027
Finished training it 2048/76743 of epoch 1, 115.83 ms/it, loss 0.453946
Finished training it 3072/76743 of epoch 1, 112.15 ms/it, loss 0.455280
Finished training it 3072/76743 of epoch 1, 112.57 ms/it, loss 0.456060
Finished training it 3072/76743 of epoch 1, 111.77 ms/it, loss 0.455118
Finished training it 3072/76743 of epoch 1, 111.45 ms/it, loss 0.453023
Finished training it 4096/76743 of epoch 1, 116.07 ms/it, loss 0.453564
Finished training it 4096/76743 of epoch 1, 116.28 ms/it, loss 0.453880
Finished training it 4096/76743 of epoch 1, 115.05 ms/it, loss 0.456301
Finished training it 4096/76743 of epoch 1, 115.43 ms/it, loss 0.457216
Finished training it 5120/76743 of epoch 1, 114.80 ms/it, loss 0.454316
Finished training it 5120/76743 of epoch 1, 114.24 ms/it, loss 0.454881
Finished training it 5120/76743 of epoch 1, 113.91 ms/it, loss 0.455748
Finished training it 5120/76743 of epoch 1, 113.97 ms/it, loss 0.454513
Finished training it 6144/76743 of epoch 1, 120.05 ms/it, loss 0.455023
Finished training it 6144/76743 of epoch 1, 117.88 ms/it, loss 0.456171
Finished training it 6144/76743 of epoch 1, 119.92 ms/it, loss 0.453351
Finished training it 6144/76743 of epoch 1, 119.55 ms/it, loss 0.455029
Finished training it 7168/76743 of epoch 1, 114.61 ms/it, loss 0.453529
Finished training it 7168/76743 of epoch 1, 114.96 ms/it, loss 0.449900
Finished training it 7168/76743 of epoch 1, 114.33 ms/it, loss 0.455056
Finished training it 7168/76743 of epoch 1, 115.32 ms/it, loss 0.454330
Finished training it 8192/76743 of epoch 1, 116.25 ms/it, loss 0.450510
Finished training it 8192/76743 of epoch 1, 115.75 ms/it, loss 0.453079
Finished training it 8192/76743 of epoch 1, 115.20 ms/it, loss 0.454971
Finished training it 8192/76743 of epoch 1, 115.58 ms/it, loss 0.454481
Finished training it 9216/76743 of epoch 1, 117.85 ms/it, loss 0.452890
Finished training it 9216/76743 of epoch 1, 118.16 ms/it, loss 0.453920
Finished training it 9216/76743 of epoch 1, 116.89 ms/it, loss 0.457247
Finished training it 9216/76743 of epoch 1, 117.54 ms/it, loss 0.451733
Finished training it 10240/76743 of epoch 1, 109.85 ms/it, loss 0.452365
Finished training it 10240/76743 of epoch 1, 109.31 ms/it, loss 0.453974
Finished training it 10240/76743 of epoch 1, 109.17 ms/it, loss 0.451696
Finished training it 10240/76743 of epoch 1, 107.82 ms/it, loss 0.453385
Testing at - 10240/76743 of epoch 1,
Testing at - 10240/76743 of epoch 1,
Testing at - 10240/76743 of epoch 1,
Testing at - 10240/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2569747.0
get out
2 has test check 2569747.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2569747.0
get out
3 has test check 2569747.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2569747.0
get out
1 has test check 2569747.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2569747.0
get out
0 has test check 2569747.0 and sample count 3273728
 accuracy 78.496 %, best 78.496 %, roc auc score 0.7946, best 0.7946
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 11264/76743 of epoch 1, 119.34 ms/it, loss 0.453043
Finished training it 11264/76743 of epoch 1, 116.21 ms/it, loss 0.453536
Finished training it 11264/76743 of epoch 1, 119.55 ms/it, loss 0.452745
Finished training it 11264/76743 of epoch 1, 120.41 ms/it, loss 0.453073
Finished training it 12288/76743 of epoch 1, 113.83 ms/it, loss 0.454053
Finished training it 12288/76743 of epoch 1, 114.80 ms/it, loss 0.452292
Finished training it 12288/76743 of epoch 1, 112.76 ms/it, loss 0.452997
Finished training it 12288/76743 of epoch 1, 112.58 ms/it, loss 0.453652
Finished training it 13312/76743 of epoch 1, 119.21 ms/it, loss 0.453488
Finished training it 13312/76743 of epoch 1, 118.73 ms/it, loss 0.452264
Finished training it 13312/76743 of epoch 1, 119.70 ms/it, loss 0.455065
Finished training it 13312/76743 of epoch 1, 114.54 ms/it, loss 0.452833
Finished training it 14336/76743 of epoch 1, 121.64 ms/it, loss 0.452816
Finished training it 14336/76743 of epoch 1, 121.96 ms/it, loss 0.455462
Finished training it 14336/76743 of epoch 1, 119.35 ms/it, loss 0.453451
Finished training it 14336/76743 of epoch 1, 122.08 ms/it, loss 0.454566
Finished training it 15360/76743 of epoch 1, 115.66 ms/it, loss 0.456216
Finished training it 15360/76743 of epoch 1, 116.05 ms/it, loss 0.455388
Finished training it 15360/76743 of epoch 1, 117.10 ms/it, loss 0.453876
Finished training it 15360/76743 of epoch 1, 116.68 ms/it, loss 0.455390
Finished training it 16384/76743 of epoch 1, 117.71 ms/it, loss 0.451949
Finished training it 16384/76743 of epoch 1, 117.98 ms/it, loss 0.455281
Finished training it 16384/76743 of epoch 1, 118.03 ms/it, loss 0.454180
Finished training it 16384/76743 of epoch 1, 116.78 ms/it, loss 0.454731
Finished training it 17408/76743 of epoch 1, 120.81 ms/it, loss 0.454817
Finished training it 17408/76743 of epoch 1, 119.44 ms/it, loss 0.454754
Finished training it 17408/76743 of epoch 1, 120.70 ms/it, loss 0.453793
Finished training it 17408/76743 of epoch 1, 121.35 ms/it, loss 0.454481
Finished training it 18432/76743 of epoch 1, 107.07 ms/it, loss 0.451814
Finished training it 18432/76743 of epoch 1, 107.61 ms/it, loss 0.454861
Finished training it 18432/76743 of epoch 1, 108.57 ms/it, loss 0.455344
Finished training it 18432/76743 of epoch 1, 108.94 ms/it, loss 0.455060
Finished training it 19456/76743 of epoch 1, 115.56 ms/it, loss 0.450695
Finished training it 19456/76743 of epoch 1, 116.18 ms/it, loss 0.453055
Finished training it 19456/76743 of epoch 1, 115.74 ms/it, loss 0.449511
Finished training it 19456/76743 of epoch 1, 116.06 ms/it, loss 0.452376
Finished training it 20480/76743 of epoch 1, 113.20 ms/it, loss 0.451739
Finished training it 20480/76743 of epoch 1, 113.61 ms/it, loss 0.451096
Finished training it 20480/76743 of epoch 1, 113.63 ms/it, loss 0.449888
Finished training it 20480/76743 of epoch 1, 113.53 ms/it, loss 0.452126
Testing at - 20480/76743 of epoch 1,
Testing at - 20480/76743 of epoch 1,
Testing at - 20480/76743 of epoch 1,
Testing at - 20480/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570750.0
get out
3 has test check 2570750.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570750.0
get out
2 has test check 2570750.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2570750.0
get out
0 has test check 2570750.0 and sample count 3273728
rank: 1 test_accu: 2570750.0
get out
1 has test check 2570750.0 and sample count 3273728
 accuracy 78.527 %, best 78.527 %, roc auc score 0.7951, best 0.7951
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 21504/76743 of epoch 1, 120.75 ms/it, loss 0.452884
Finished training it 21504/76743 of epoch 1, 122.59 ms/it, loss 0.453263
Finished training it 21504/76743 of epoch 1, 115.43 ms/it, loss 0.451520
Finished training it 21504/76743 of epoch 1, 122.12 ms/it, loss 0.455285
Finished training it 22528/76743 of epoch 1, 117.83 ms/it, loss 0.454633
Finished training it 22528/76743 of epoch 1, 122.29 ms/it, loss 0.454962
Finished training it 22528/76743 of epoch 1, 120.93 ms/it, loss 0.453479
Finished training it 22528/76743 of epoch 1, 121.81 ms/it, loss 0.453973
Finished training it 23552/76743 of epoch 1, 117.11 ms/it, loss 0.456121
Finished training it 23552/76743 of epoch 1, 115.66 ms/it, loss 0.453739
Finished training it 23552/76743 of epoch 1, 118.53 ms/it, loss 0.454039
Finished training it 23552/76743 of epoch 1, 118.22 ms/it, loss 0.454001
Finished training it 24576/76743 of epoch 1, 115.43 ms/it, loss 0.449172
Finished training it 24576/76743 of epoch 1, 117.75 ms/it, loss 0.451600
Finished training it 24576/76743 of epoch 1, 117.21 ms/it, loss 0.452674
Finished training it 24576/76743 of epoch 1, 116.13 ms/it, loss 0.453863
Finished training it 25600/76743 of epoch 1, 112.95 ms/it, loss 0.454298
Finished training it 25600/76743 of epoch 1, 116.28 ms/it, loss 0.453341
Finished training it 25600/76743 of epoch 1, 113.79 ms/it, loss 0.450357
Finished training it 25600/76743 of epoch 1, 115.74 ms/it, loss 0.452555
Finished training it 26624/76743 of epoch 1, 118.98 ms/it, loss 0.452427
Finished training it 26624/76743 of epoch 1, 121.19 ms/it, loss 0.450509
Finished training it 26624/76743 of epoch 1, 122.13 ms/it, loss 0.450532
Finished training it 26624/76743 of epoch 1, 119.59 ms/it, loss 0.452907
Finished training it 27648/76743 of epoch 1, 116.12 ms/it, loss 0.452325
Finished training it 27648/76743 of epoch 1, 116.39 ms/it, loss 0.452269
Finished training it 27648/76743 of epoch 1, 114.87 ms/it, loss 0.451104
Finished training it 27648/76743 of epoch 1, 116.47 ms/it, loss 0.453169
Finished training it 28672/76743 of epoch 1, 118.34 ms/it, loss 0.453090
Finished training it 28672/76743 of epoch 1, 118.50 ms/it, loss 0.455991
Finished training it 28672/76743 of epoch 1, 120.12 ms/it, loss 0.452733
Finished training it 28672/76743 of epoch 1, 120.07 ms/it, loss 0.450232
Finished training it 29696/76743 of epoch 1, 115.75 ms/it, loss 0.454113
Finished training it 29696/76743 of epoch 1, 117.46 ms/it, loss 0.451319
Finished training it 29696/76743 of epoch 1, 118.04 ms/it, loss 0.451254
Finished training it 29696/76743 of epoch 1, 115.99 ms/it, loss 0.452568
Finished training it 30720/76743 of epoch 1, 112.92 ms/it, loss 0.450257
Finished training it 30720/76743 of epoch 1, 110.61 ms/it, loss 0.450733
Finished training it 30720/76743 of epoch 1, 113.77 ms/it, loss 0.450833
Finished training it 30720/76743 of epoch 1, 110.74 ms/it, loss 0.450851
Testing at - 30720/76743 of epoch 1,
Testing at - 30720/76743 of epoch 1,
Testing at - 30720/76743 of epoch 1,
Testing at - 30720/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2570048.0
get out
1 has test check 2570048.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2570048.0
Warning: Skipping the batch 3197 with size 602
get out
2 has test check 2570048.0 and sample count 3273728
rank: 0 test_accu: 2570048.0
get out
0 has test check 2570048.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2570048.0
get out
3 has test check 2570048.0 and sample count 3273728
 accuracy 78.505 %, best 78.527 %, roc auc score 0.7950, best 0.7951
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 31744/76743 of epoch 1, 114.39 ms/it, loss 0.453252
Finished training it 31744/76743 of epoch 1, 115.39 ms/it, loss 0.450927
Finished training it 31744/76743 of epoch 1, 113.87 ms/it, loss 0.454735
Finished training it 31744/76743 of epoch 1, 115.01 ms/it, loss 0.453017
Finished training it 32768/76743 of epoch 1, 116.37 ms/it, loss 0.453734
Finished training it 32768/76743 of epoch 1, 117.20 ms/it, loss 0.450778
Finished training it 32768/76743 of epoch 1, 116.67 ms/it, loss 0.453351
Finished training it 32768/76743 of epoch 1, 117.70 ms/it, loss 0.453527
Finished training it 33792/76743 of epoch 1, 116.05 ms/it, loss 0.452890
Finished training it 33792/76743 of epoch 1, 117.04 ms/it, loss 0.452044
Finished training it 33792/76743 of epoch 1, 117.03 ms/it, loss 0.453021
Finished training it 33792/76743 of epoch 1, 117.23 ms/it, loss 0.451828
Finished training it 34816/76743 of epoch 1, 116.46 ms/it, loss 0.452534
Finished training it 34816/76743 of epoch 1, 116.09 ms/it, loss 0.450870
Finished training it 34816/76743 of epoch 1, 118.39 ms/it, loss 0.454376
Finished training it 34816/76743 of epoch 1, 118.56 ms/it, loss 0.453921
Finished training it 35840/76743 of epoch 1, 120.78 ms/it, loss 0.453607
Finished training it 35840/76743 of epoch 1, 118.13 ms/it, loss 0.450820
Finished training it 35840/76743 of epoch 1, 119.22 ms/it, loss 0.454876
Finished training it 35840/76743 of epoch 1, 118.14 ms/it, loss 0.451442
Finished training it 36864/76743 of epoch 1, 119.60 ms/it, loss 0.452515
Finished training it 36864/76743 of epoch 1, 121.95 ms/it, loss 0.453092
Finished training it 36864/76743 of epoch 1, 120.87 ms/it, loss 0.451042
Finished training it 36864/76743 of epoch 1, 119.78 ms/it, loss 0.450055
Finished training it 37888/76743 of epoch 1, 120.00 ms/it, loss 0.454395
Finished training it 37888/76743 of epoch 1, 120.33 ms/it, loss 0.453567
Finished training it 37888/76743 of epoch 1, 121.08 ms/it, loss 0.453110
Finished training it 37888/76743 of epoch 1, 121.46 ms/it, loss 0.453138
Finished training it 38912/76743 of epoch 1, 120.77 ms/it, loss 0.453522
Finished training it 38912/76743 of epoch 1, 122.23 ms/it, loss 0.454224
Finished training it 38912/76743 of epoch 1, 120.94 ms/it, loss 0.452066
Finished training it 38912/76743 of epoch 1, 121.63 ms/it, loss 0.451979
Finished training it 39936/76743 of epoch 1, 117.13 ms/it, loss 0.454073
Finished training it 39936/76743 of epoch 1, 116.91 ms/it, loss 0.451138
Finished training it 39936/76743 of epoch 1, 118.44 ms/it, loss 0.453754
Finished training it 39936/76743 of epoch 1, 118.91 ms/it, loss 0.451832
Finished training it 40960/76743 of epoch 1, 118.21 ms/it, loss 0.451430
Finished training it 40960/76743 of epoch 1, 120.28 ms/it, loss 0.452434
Finished training it 40960/76743 of epoch 1, 118.16 ms/it, loss 0.450768
Finished training it 40960/76743 of epoch 1, 119.46 ms/it, loss 0.452829
Testing at - 40960/76743 of epoch 1,
Testing at - 40960/76743 of epoch 1,
Testing at - 40960/76743 of epoch 1,
Testing at - 40960/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2572517.0
get out
0 has test check 2572517.0 and sample count 3273728
rank: 2 test_accu: 2572517.0
get out
2 has test check 2572517.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2572517.0
Warning: Skipping the batch 3197 with size 602
get out
1 has test check 2572517.0 and sample count 3273728
rank: 3 test_accu: 2572517.0
get out
3 has test check 2572517.0 and sample count 3273728
 accuracy 78.581 %, best 78.581 %, roc auc score 0.7962, best 0.7962
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 41984/76743 of epoch 1, 121.15 ms/it, loss 0.451391
Finished training it 41984/76743 of epoch 1, 120.57 ms/it, loss 0.449604
Finished training it 41984/76743 of epoch 1, 120.78 ms/it, loss 0.453977
Finished training it 41984/76743 of epoch 1, 121.10 ms/it, loss 0.450726
Finished training it 43008/76743 of epoch 1, 119.91 ms/it, loss 0.451301
Finished training it 43008/76743 of epoch 1, 119.21 ms/it, loss 0.454555
Finished training it 43008/76743 of epoch 1, 119.90 ms/it, loss 0.450549
Finished training it 43008/76743 of epoch 1, 120.40 ms/it, loss 0.451599
Finished training it 44032/76743 of epoch 1, 112.48 ms/it, loss 0.450765
Finished training it 44032/76743 of epoch 1, 114.57 ms/it, loss 0.453401
Finished training it 44032/76743 of epoch 1, 113.10 ms/it, loss 0.450868
Finished training it 44032/76743 of epoch 1, 114.35 ms/it, loss 0.452696
Finished training it 45056/76743 of epoch 1, 119.41 ms/it, loss 0.450798
Finished training it 45056/76743 of epoch 1, 118.15 ms/it, loss 0.450409
Finished training it 45056/76743 of epoch 1, 119.09 ms/it, loss 0.450318
Finished training it 45056/76743 of epoch 1, 119.05 ms/it, loss 0.453657
Finished training it 46080/76743 of epoch 1, 117.00 ms/it, loss 0.455021
Finished training it 46080/76743 of epoch 1, 118.33 ms/it, loss 0.450971
Finished training it 46080/76743 of epoch 1, 117.02 ms/it, loss 0.449733
Finished training it 46080/76743 of epoch 1, 118.04 ms/it, loss 0.451705
Finished training it 47104/76743 of epoch 1, 116.61 ms/it, loss 0.450035
Finished training it 47104/76743 of epoch 1, 117.65 ms/it, loss 0.449646
Finished training it 47104/76743 of epoch 1, 117.28 ms/it, loss 0.450513
Finished training it 47104/76743 of epoch 1, 116.38 ms/it, loss 0.452223
Finished training it 48128/76743 of epoch 1, 114.68 ms/it, loss 0.450879
Finished training it 48128/76743 of epoch 1, 113.42 ms/it, loss 0.453807
Finished training it 48128/76743 of epoch 1, 115.21 ms/it, loss 0.450829
Finished training it 48128/76743 of epoch 1, 112.84 ms/it, loss 0.451987
Finished training it 49152/76743 of epoch 1, 116.72 ms/it, loss 0.450804
Finished training it 49152/76743 of epoch 1, 117.54 ms/it, loss 0.452514
Finished training it 49152/76743 of epoch 1, 118.61 ms/it, loss 0.452865
Finished training it 49152/76743 of epoch 1, 116.45 ms/it, loss 0.450975
Finished training it 50176/76743 of epoch 1, 113.54 ms/it, loss 0.449162
Finished training it 50176/76743 of epoch 1, 113.23 ms/it, loss 0.450445
Finished training it 50176/76743 of epoch 1, 114.11 ms/it, loss 0.450765
Finished training it 50176/76743 of epoch 1, 114.54 ms/it, loss 0.450775
Finished training it 51200/76743 of epoch 1, 115.70 ms/it, loss 0.447508
Finished training it 51200/76743 of epoch 1, 115.62 ms/it, loss 0.450399
Finished training it 51200/76743 of epoch 1, 116.82 ms/it, loss 0.452232
Finished training it 51200/76743 of epoch 1, 117.80 ms/it, loss 0.450826
Testing at - 51200/76743 of epoch 1,
Testing at - 51200/76743 of epoch 1,
Testing at - 51200/76743 of epoch 1,
Testing at - 51200/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2573506.0
get out
0 has test check 2573506.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2573506.0
get out
2 has test check 2573506.0 and sample count 3273728
rank: 3 test_accu: 2573506.0
get out
3 has test check 2573506.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2573506.0
get out
1 has test check 2573506.0 and sample count 3273728
 accuracy 78.611 %, best 78.611 %, roc auc score 0.7968, best 0.7968
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 52224/76743 of epoch 1, 111.43 ms/it, loss 0.451020
Finished training it 52224/76743 of epoch 1, 113.45 ms/it, loss 0.451052
Finished training it 52224/76743 of epoch 1, 111.85 ms/it, loss 0.447623
Finished training it 52224/76743 of epoch 1, 113.01 ms/it, loss 0.449297
Finished training it 53248/76743 of epoch 1, 113.89 ms/it, loss 0.448871
Finished training it 53248/76743 of epoch 1, 115.39 ms/it, loss 0.452841
Finished training it 53248/76743 of epoch 1, 114.02 ms/it, loss 0.449230
Finished training it 53248/76743 of epoch 1, 115.00 ms/it, loss 0.451314
Finished training it 54272/76743 of epoch 1, 117.20 ms/it, loss 0.450236
Finished training it 54272/76743 of epoch 1, 115.60 ms/it, loss 0.451147
Finished training it 54272/76743 of epoch 1, 115.78 ms/it, loss 0.451722
Finished training it 54272/76743 of epoch 1, 116.46 ms/it, loss 0.452619
Finished training it 55296/76743 of epoch 1, 115.06 ms/it, loss 0.450918
Finished training it 55296/76743 of epoch 1, 115.28 ms/it, loss 0.451639
Finished training it 55296/76743 of epoch 1, 115.92 ms/it, loss 0.450639
Finished training it 55296/76743 of epoch 1, 115.89 ms/it, loss 0.449391
Finished training it 56320/76743 of epoch 1, 117.69 ms/it, loss 0.450639
Finished training it 56320/76743 of epoch 1, 118.62 ms/it, loss 0.453453
Finished training it 56320/76743 of epoch 1, 119.01 ms/it, loss 0.449228
Finished training it 56320/76743 of epoch 1, 118.08 ms/it, loss 0.449431
Finished training it 57344/76743 of epoch 1, 114.35 ms/it, loss 0.450434
Finished training it 57344/76743 of epoch 1, 114.27 ms/it, loss 0.451144
Finished training it 57344/76743 of epoch 1, 112.69 ms/it, loss 0.452397
Finished training it 57344/76743 of epoch 1, 112.85 ms/it, loss 0.449496
Finished training it 58368/76743 of epoch 1, 113.98 ms/it, loss 0.451641
Finished training it 58368/76743 of epoch 1, 116.77 ms/it, loss 0.450938
Finished training it 58368/76743 of epoch 1, 114.10 ms/it, loss 0.449478
Finished training it 58368/76743 of epoch 1, 115.01 ms/it, loss 0.447648
Finished training it 59392/76743 of epoch 1, 117.91 ms/it, loss 0.448556
Finished training it 59392/76743 of epoch 1, 119.97 ms/it, loss 0.450665
Finished training it 59392/76743 of epoch 1, 118.95 ms/it, loss 0.448821
Finished training it 59392/76743 of epoch 1, 118.20 ms/it, loss 0.449264
Finished training it 60416/76743 of epoch 1, 115.01 ms/it, loss 0.450729
Finished training it 60416/76743 of epoch 1, 116.19 ms/it, loss 0.450676
Finished training it 60416/76743 of epoch 1, 116.09 ms/it, loss 0.450679
Finished training it 60416/76743 of epoch 1, 115.59 ms/it, loss 0.451192
Finished training it 61440/76743 of epoch 1, 118.42 ms/it, loss 0.449942
Finished training it 61440/76743 of epoch 1, 119.18 ms/it, loss 0.451400
Finished training it 61440/76743 of epoch 1, 118.46 ms/it, loss 0.452532
Finished training it 61440/76743 of epoch 1, 119.76 ms/it, loss 0.450318
Testing at - 61440/76743 of epoch 1,
Testing at - 61440/76743 of epoch 1,
Testing at - 61440/76743 of epoch 1,
Testing at - 61440/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574198.0
get out
2 has test check 2574198.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2574198.0
get out
0 has test check 2574198.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2574198.0
get out
1 has test check 2574198.0 and sample count 3273728
rank: 3 test_accu: 2574198.0
get out
3 has test check 2574198.0 and sample count 3273728
 accuracy 78.632 %, best 78.632 %, roc auc score 0.7973, best 0.7973
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 62464/76743 of epoch 1, 119.42 ms/it, loss 0.450879
Finished training it 62464/76743 of epoch 1, 119.41 ms/it, loss 0.453725
Finished training it 62464/76743 of epoch 1, 120.24 ms/it, loss 0.451197
Finished training it 62464/76743 of epoch 1, 120.14 ms/it, loss 0.449528
Finished training it 63488/76743 of epoch 1, 115.43 ms/it, loss 0.447560
Finished training it 63488/76743 of epoch 1, 115.43 ms/it, loss 0.449628
Finished training it 63488/76743 of epoch 1, 116.10 ms/it, loss 0.449652
Finished training it 63488/76743 of epoch 1, 116.07 ms/it, loss 0.451249
Finished training it 64512/76743 of epoch 1, 115.82 ms/it, loss 0.452222
Finished training it 64512/76743 of epoch 1, 116.65 ms/it, loss 0.451375
Finished training it 64512/76743 of epoch 1, 115.84 ms/it, loss 0.452556
Finished training it 64512/76743 of epoch 1, 117.26 ms/it, loss 0.449786
Finished training it 65536/76743 of epoch 1, 114.36 ms/it, loss 0.451938
Finished training it 65536/76743 of epoch 1, 115.82 ms/it, loss 0.453501
Finished training it 65536/76743 of epoch 1, 115.52 ms/it, loss 0.448203
Finished training it 65536/76743 of epoch 1, 114.61 ms/it, loss 0.451802
Finished training it 66560/76743 of epoch 1, 116.21 ms/it, loss 0.450111
Finished training it 66560/76743 of epoch 1, 119.12 ms/it, loss 0.451092
Finished training it 66560/76743 of epoch 1, 116.88 ms/it, loss 0.451634
Finished training it 66560/76743 of epoch 1, 117.53 ms/it, loss 0.451548
Finished training it 67584/76743 of epoch 1, 118.19 ms/it, loss 0.451424
Finished training it 67584/76743 of epoch 1, 116.83 ms/it, loss 0.450467
Finished training it 67584/76743 of epoch 1, 116.82 ms/it, loss 0.448748
Finished training it 67584/76743 of epoch 1, 117.50 ms/it, loss 0.452598
Finished training it 68608/76743 of epoch 1, 114.84 ms/it, loss 0.451339
Finished training it 68608/76743 of epoch 1, 115.53 ms/it, loss 0.450615
Finished training it 68608/76743 of epoch 1, 115.44 ms/it, loss 0.451814
Finished training it 68608/76743 of epoch 1, 114.77 ms/it, loss 0.449711
Finished training it 69632/76743 of epoch 1, 114.39 ms/it, loss 0.449806
Finished training it 69632/76743 of epoch 1, 115.93 ms/it, loss 0.449492
Finished training it 69632/76743 of epoch 1, 115.36 ms/it, loss 0.451424
Finished training it 69632/76743 of epoch 1, 114.48 ms/it, loss 0.450823
Finished training it 70656/76743 of epoch 1, 114.56 ms/it, loss 0.449353
Finished training it 70656/76743 of epoch 1, 116.34 ms/it, loss 0.450608
Finished training it 70656/76743 of epoch 1, 114.49 ms/it, loss 0.452485
Finished training it 70656/76743 of epoch 1, 117.17 ms/it, loss 0.449842
Finished training it 71680/76743 of epoch 1, 120.36 ms/it, loss 0.451800
Finished training it 71680/76743 of epoch 1, 120.25 ms/it, loss 0.450324
Finished training it 71680/76743 of epoch 1, 121.38 ms/it, loss 0.449199
Finished training it 71680/76743 of epoch 1, 121.28 ms/it, loss 0.450127
Testing at - 71680/76743 of epoch 1,
Testing at - 71680/76743 of epoch 1,
Testing at - 71680/76743 of epoch 1,
Testing at - 71680/76743 of epoch 1,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2571211.0
get out
2 has test check 2571211.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2571211.0
get out
3 has test check 2571211.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2571211.0
get out
0 has test check 2571211.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2571211.0
get out
1 has test check 2571211.0 and sample count 3273728
 accuracy 78.541 %, best 78.632 %, roc auc score 0.7980, best 0.7980
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 72704/76743 of epoch 1, 116.79 ms/it, loss 0.449140
Finished training it 72704/76743 of epoch 1, 117.63 ms/it, loss 0.447668
Finished training it 72704/76743 of epoch 1, 116.14 ms/it, loss 0.450578
Finished training it 72704/76743 of epoch 1, 117.00 ms/it, loss 0.448841
Finished training it 73728/76743 of epoch 1, 117.22 ms/it, loss 0.449291
Finished training it 73728/76743 of epoch 1, 119.11 ms/it, loss 0.447913
Finished training it 73728/76743 of epoch 1, 118.90 ms/it, loss 0.448963
Finished training it 73728/76743 of epoch 1, 117.09 ms/it, loss 0.449495
Finished training it 74752/76743 of epoch 1, 113.65 ms/it, loss 0.452044
Finished training it 74752/76743 of epoch 1, 114.49 ms/it, loss 0.450901
Finished training it 74752/76743 of epoch 1, 113.09 ms/it, loss 0.453848
Finished training it 74752/76743 of epoch 1, 114.30 ms/it, loss 0.452921
Finished training it 75776/76743 of epoch 1, 115.81 ms/it, loss 0.449039
Finished training it 75776/76743 of epoch 1, 116.06 ms/it, loss 0.450063
Finished training it 75776/76743 of epoch 1, 116.93 ms/it, loss 0.448088
Finished training it 75776/76743 of epoch 1, 116.74 ms/it, loss 0.450649
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 2, 119.10 ms/it, loss 0.446811
Finished training it 1024/76743 of epoch 2, 119.41 ms/it, loss 0.448112
Finished training it 1024/76743 of epoch 2, 120.25 ms/it, loss 0.451844
Finished training it 1024/76743 of epoch 2, 120.42 ms/it, loss 0.449609
Finished training it 2048/76743 of epoch 2, 116.51 ms/it, loss 0.453128
Finished training it 2048/76743 of epoch 2, 118.20 ms/it, loss 0.450822
Finished training it 2048/76743 of epoch 2, 116.21 ms/it, loss 0.449861
Finished training it 2048/76743 of epoch 2, 117.95 ms/it, loss 0.448662
Finished training it 3072/76743 of epoch 2, 119.30 ms/it, loss 0.451165
Finished training it 3072/76743 of epoch 2, 120.41 ms/it, loss 0.450223
Finished training it 3072/76743 of epoch 2, 119.16 ms/it, loss 0.447907
Finished training it 3072/76743 of epoch 2, 120.22 ms/it, loss 0.449856
Finished training it 4096/76743 of epoch 2, 120.43 ms/it, loss 0.449085
Finished training it 4096/76743 of epoch 2, 120.69 ms/it, loss 0.451333
Finished training it 4096/76743 of epoch 2, 121.95 ms/it, loss 0.448508
Finished training it 4096/76743 of epoch 2, 121.64 ms/it, loss 0.452344
Finished training it 5120/76743 of epoch 2, 121.60 ms/it, loss 0.450018
Finished training it 5120/76743 of epoch 2, 122.19 ms/it, loss 0.450450
Finished training it 5120/76743 of epoch 2, 120.89 ms/it, loss 0.451306
Finished training it 5120/76743 of epoch 2, 120.59 ms/it, loss 0.450073
Finished training it 6144/76743 of epoch 2, 114.30 ms/it, loss 0.450080
Finished training it 6144/76743 of epoch 2, 115.31 ms/it, loss 0.448811
Finished training it 6144/76743 of epoch 2, 115.05 ms/it, loss 0.451458
Finished training it 6144/76743 of epoch 2, 115.63 ms/it, loss 0.450145
Finished training it 7168/76743 of epoch 2, 119.12 ms/it, loss 0.444905
Finished training it 7168/76743 of epoch 2, 119.57 ms/it, loss 0.448833
Finished training it 7168/76743 of epoch 2, 120.69 ms/it, loss 0.450142
Finished training it 7168/76743 of epoch 2, 120.82 ms/it, loss 0.450572
Finished training it 8192/76743 of epoch 2, 119.87 ms/it, loss 0.448500
Finished training it 8192/76743 of epoch 2, 119.81 ms/it, loss 0.450497
Finished training it 8192/76743 of epoch 2, 121.02 ms/it, loss 0.445549
Finished training it 8192/76743 of epoch 2, 121.14 ms/it, loss 0.450110
Finished training it 9216/76743 of epoch 2, 116.86 ms/it, loss 0.448388
Finished training it 9216/76743 of epoch 2, 117.14 ms/it, loss 0.452808
Finished training it 9216/76743 of epoch 2, 118.40 ms/it, loss 0.447477
Finished training it 9216/76743 of epoch 2, 117.86 ms/it, loss 0.449301
Finished training it 10240/76743 of epoch 2, 117.86 ms/it, loss 0.449507
Finished training it 10240/76743 of epoch 2, 118.85 ms/it, loss 0.447843
Finished training it 10240/76743 of epoch 2, 119.45 ms/it, loss 0.447020
Finished training it 10240/76743 of epoch 2, 117.75 ms/it, loss 0.448493
Testing at - 10240/76743 of epoch 2,
Testing at - 10240/76743 of epoch 2,
Testing at - 10240/76743 of epoch 2,
Testing at - 10240/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2575879.0
get out
1 has test check 2575879.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2575879.0
get out
0 has test check 2575879.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2575879.0
get out
2 has test check 2575879.0 and sample count 3273728
rank: 3 test_accu: 2575879.0
get out
3 has test check 2575879.0 and sample count 3273728
 accuracy 78.683 %, best 78.683 %, roc auc score 0.7986, best 0.7986
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 11264/76743 of epoch 2, 121.18 ms/it, loss 0.448641
Finished training it 11264/76743 of epoch 2, 122.74 ms/it, loss 0.448346
Finished training it 11264/76743 of epoch 2, 122.32 ms/it, loss 0.449646
Finished training it 11264/76743 of epoch 2, 121.20 ms/it, loss 0.448831
Finished training it 12288/76743 of epoch 2, 118.99 ms/it, loss 0.449306
Finished training it 12288/76743 of epoch 2, 120.03 ms/it, loss 0.448828
Finished training it 12288/76743 of epoch 2, 119.92 ms/it, loss 0.447806
Finished training it 12288/76743 of epoch 2, 118.77 ms/it, loss 0.449033
Finished training it 13312/76743 of epoch 2, 122.95 ms/it, loss 0.448831
Finished training it 13312/76743 of epoch 2, 124.09 ms/it, loss 0.447361
Finished training it 13312/76743 of epoch 2, 123.90 ms/it, loss 0.450123
Finished training it 13312/76743 of epoch 2, 122.73 ms/it, loss 0.448337
Finished training it 14336/76743 of epoch 2, 114.66 ms/it, loss 0.448591
Finished training it 14336/76743 of epoch 2, 114.99 ms/it, loss 0.449202
Finished training it 14336/76743 of epoch 2, 117.06 ms/it, loss 0.450796
Finished training it 14336/76743 of epoch 2, 116.47 ms/it, loss 0.450441
Finished training it 15360/76743 of epoch 2, 116.17 ms/it, loss 0.451131
Finished training it 15360/76743 of epoch 2, 116.26 ms/it, loss 0.452123
Finished training it 15360/76743 of epoch 2, 117.50 ms/it, loss 0.449262
Finished training it 15360/76743 of epoch 2, 116.87 ms/it, loss 0.450798
Finished training it 16384/76743 of epoch 2, 120.43 ms/it, loss 0.447646
Finished training it 16384/76743 of epoch 2, 121.62 ms/it, loss 0.451031
Finished training it 16384/76743 of epoch 2, 120.42 ms/it, loss 0.450238
Finished training it 16384/76743 of epoch 2, 121.23 ms/it, loss 0.449775
Finished training it 17408/76743 of epoch 2, 125.76 ms/it, loss 0.449248
Finished training it 17408/76743 of epoch 2, 125.34 ms/it, loss 0.450058
Finished training it 17408/76743 of epoch 2, 124.56 ms/it, loss 0.451092
Finished training it 17408/76743 of epoch 2, 124.18 ms/it, loss 0.450825
Finished training it 18432/76743 of epoch 2, 117.40 ms/it, loss 0.447052
Finished training it 18432/76743 of epoch 2, 117.37 ms/it, loss 0.450669
Finished training it 18432/76743 of epoch 2, 119.46 ms/it, loss 0.450883
Finished training it 18432/76743 of epoch 2, 119.47 ms/it, loss 0.450582
Finished training it 19456/76743 of epoch 2, 121.20 ms/it, loss 0.445356
Finished training it 19456/76743 of epoch 2, 120.59 ms/it, loss 0.446435
Finished training it 19456/76743 of epoch 2, 121.88 ms/it, loss 0.448708
Finished training it 19456/76743 of epoch 2, 121.84 ms/it, loss 0.448379
Finished training it 20480/76743 of epoch 2, 118.11 ms/it, loss 0.445710
Finished training it 20480/76743 of epoch 2, 116.99 ms/it, loss 0.447328
Finished training it 20480/76743 of epoch 2, 118.44 ms/it, loss 0.447526
Finished training it 20480/76743 of epoch 2, 118.21 ms/it, loss 0.448127
Testing at - 20480/76743 of epoch 2,
Testing at - 20480/76743 of epoch 2,
Testing at - 20480/76743 of epoch 2,
Testing at - 20480/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576554.0
get out
2 has test check 2576554.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576554.0
get out
0 has test check 2576554.0 and sample count 3273728
rank: 1 test_accu: 2576554.0
get out
1 has test check 2576554.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576554.0
get out
3 has test check 2576554.0 and sample count 3273728
 accuracy 78.704 %, best 78.704 %, roc auc score 0.7988, best 0.7988
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 21504/76743 of epoch 2, 117.31 ms/it, loss 0.447658
Finished training it 21504/76743 of epoch 2, 116.73 ms/it, loss 0.448686
Finished training it 21504/76743 of epoch 2, 118.98 ms/it, loss 0.451453
Finished training it 21504/76743 of epoch 2, 119.14 ms/it, loss 0.449018
Finished training it 22528/76743 of epoch 2, 119.12 ms/it, loss 0.450237
Finished training it 22528/76743 of epoch 2, 119.00 ms/it, loss 0.449098
Finished training it 22528/76743 of epoch 2, 120.11 ms/it, loss 0.450955
Finished training it 22528/76743 of epoch 2, 119.97 ms/it, loss 0.449674
Finished training it 23552/76743 of epoch 2, 120.56 ms/it, loss 0.450036
Finished training it 23552/76743 of epoch 2, 119.87 ms/it, loss 0.449913
Finished training it 23552/76743 of epoch 2, 120.38 ms/it, loss 0.450150
Finished training it 23552/76743 of epoch 2, 119.40 ms/it, loss 0.452058
Finished training it 24576/76743 of epoch 2, 116.46 ms/it, loss 0.445436
Finished training it 24576/76743 of epoch 2, 116.91 ms/it, loss 0.449997
Finished training it 24576/76743 of epoch 2, 117.74 ms/it, loss 0.447741
Finished training it 24576/76743 of epoch 2, 117.55 ms/it, loss 0.448351
Finished training it 25600/76743 of epoch 2, 113.84 ms/it, loss 0.448906
Finished training it 25600/76743 of epoch 2, 111.77 ms/it, loss 0.450090
Finished training it 25600/76743 of epoch 2, 111.75 ms/it, loss 0.446212
Finished training it 25600/76743 of epoch 2, 113.65 ms/it, loss 0.448880
Finished training it 26624/76743 of epoch 2, 119.75 ms/it, loss 0.448833
Finished training it 26624/76743 of epoch 2, 119.60 ms/it, loss 0.449343
Finished training it 26624/76743 of epoch 2, 121.24 ms/it, loss 0.446870
Finished training it 26624/76743 of epoch 2, 120.70 ms/it, loss 0.446575
Finished training it 27648/76743 of epoch 2, 120.29 ms/it, loss 0.448389
Finished training it 27648/76743 of epoch 2, 122.09 ms/it, loss 0.449348
Finished training it 27648/76743 of epoch 2, 120.34 ms/it, loss 0.447405
Finished training it 27648/76743 of epoch 2, 121.64 ms/it, loss 0.448606
Finished training it 28672/76743 of epoch 2, 116.92 ms/it, loss 0.449648
Finished training it 28672/76743 of epoch 2, 118.71 ms/it, loss 0.448846
Finished training it 28672/76743 of epoch 2, 118.24 ms/it, loss 0.446332
Finished training it 28672/76743 of epoch 2, 116.82 ms/it, loss 0.452723
Finished training it 29696/76743 of epoch 2, 124.37 ms/it, loss 0.447479
Finished training it 29696/76743 of epoch 2, 122.34 ms/it, loss 0.450096
Finished training it 29696/76743 of epoch 2, 123.02 ms/it, loss 0.448451
Finished training it 29696/76743 of epoch 2, 124.05 ms/it, loss 0.447142
Finished training it 30720/76743 of epoch 2, 118.22 ms/it, loss 0.446787
Finished training it 30720/76743 of epoch 2, 118.94 ms/it, loss 0.446937
Finished training it 30720/76743 of epoch 2, 119.47 ms/it, loss 0.446564
Finished training it 30720/76743 of epoch 2, 119.28 ms/it, loss 0.446943
Testing at - 30720/76743 of epoch 2,
Testing at - 30720/76743 of epoch 2,
Testing at - 30720/76743 of epoch 2,
Testing at - 30720/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576062.0
get out
2 has test check 2576062.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576062.0
get out
3 has test check 2576062.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576062.0
get out
0 has test check 2576062.0 and sample count 3273728
rank: 1 test_accu: 2576062.0
get out
1 has test check 2576062.0 and sample count 3273728
 accuracy 78.689 %, best 78.704 %, roc auc score 0.7990, best 0.7990
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 31744/76743 of epoch 2, 117.94 ms/it, loss 0.449157
Finished training it 31744/76743 of epoch 2, 119.75 ms/it, loss 0.449395
Finished training it 31744/76743 of epoch 2, 119.35 ms/it, loss 0.447380
Finished training it 31744/76743 of epoch 2, 118.14 ms/it, loss 0.451527
Finished training it 32768/76743 of epoch 2, 117.46 ms/it, loss 0.447394
Finished training it 32768/76743 of epoch 2, 116.33 ms/it, loss 0.449364
Finished training it 32768/76743 of epoch 2, 118.29 ms/it, loss 0.449954
Finished training it 32768/76743 of epoch 2, 116.38 ms/it, loss 0.449985
Finished training it 33792/76743 of epoch 2, 117.45 ms/it, loss 0.448997
Finished training it 33792/76743 of epoch 2, 118.36 ms/it, loss 0.448656
Finished training it 33792/76743 of epoch 2, 117.21 ms/it, loss 0.448687
Finished training it 33792/76743 of epoch 2, 118.95 ms/it, loss 0.447480
Finished training it 34816/76743 of epoch 2, 121.48 ms/it, loss 0.449096
Finished training it 34816/76743 of epoch 2, 121.54 ms/it, loss 0.447266
Finished training it 34816/76743 of epoch 2, 122.70 ms/it, loss 0.450883
Finished training it 34816/76743 of epoch 2, 122.78 ms/it, loss 0.449972
Finished training it 35840/76743 of epoch 2, 116.89 ms/it, loss 0.450247
Finished training it 35840/76743 of epoch 2, 115.75 ms/it, loss 0.447525
Finished training it 35840/76743 of epoch 2, 116.58 ms/it, loss 0.451426
Finished training it 35840/76743 of epoch 2, 115.79 ms/it, loss 0.447968
Finished training it 36864/76743 of epoch 2, 118.17 ms/it, loss 0.449302
Finished training it 36864/76743 of epoch 2, 116.90 ms/it, loss 0.446633
Finished training it 36864/76743 of epoch 2, 118.34 ms/it, loss 0.447473
Finished training it 36864/76743 of epoch 2, 117.05 ms/it, loss 0.448387
Finished training it 37888/76743 of epoch 2, 112.32 ms/it, loss 0.451049
Finished training it 37888/76743 of epoch 2, 114.71 ms/it, loss 0.449668
Finished training it 37888/76743 of epoch 2, 112.48 ms/it, loss 0.450285
Finished training it 37888/76743 of epoch 2, 114.47 ms/it, loss 0.450228
Finished training it 38912/76743 of epoch 2, 115.74 ms/it, loss 0.449641
Finished training it 38912/76743 of epoch 2, 116.24 ms/it, loss 0.448760
Finished training it 38912/76743 of epoch 2, 116.60 ms/it, loss 0.450193
Finished training it 38912/76743 of epoch 2, 116.71 ms/it, loss 0.448513
Finished training it 39936/76743 of epoch 2, 119.31 ms/it, loss 0.450072
Finished training it 39936/76743 of epoch 2, 120.33 ms/it, loss 0.448133
Finished training it 39936/76743 of epoch 2, 119.38 ms/it, loss 0.447757
Finished training it 39936/76743 of epoch 2, 120.76 ms/it, loss 0.449945
Finished training it 40960/76743 of epoch 2, 118.45 ms/it, loss 0.447199
Finished training it 40960/76743 of epoch 2, 118.75 ms/it, loss 0.447095
Finished training it 40960/76743 of epoch 2, 119.39 ms/it, loss 0.448433
Finished training it 40960/76743 of epoch 2, 119.42 ms/it, loss 0.449462
Testing at - 40960/76743 of epoch 2,
Testing at - 40960/76743 of epoch 2,
Testing at - 40960/76743 of epoch 2,
Testing at - 40960/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576120.0
get out
0 has test check 2576120.0 and sample count 3273728
rank: 2 test_accu: 2576120.0
Warning: Skipping the batch 3197 with size 602
get out
rank: 1 test_accu: 2576120.0
2 has test check 2576120.0 and sample count 3273728
get out
1 has test check 2576120.0 and sample count 3273728
rank: 3 test_accu: 2576120.0
get out
3 has test check 2576120.0 and sample count 3273728
 accuracy 78.691 %, best 78.704 %, roc auc score 0.7990, best 0.7990
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 41984/76743 of epoch 2, 121.96 ms/it, loss 0.447437
Finished training it 41984/76743 of epoch 2, 122.84 ms/it, loss 0.450016
Finished training it 41984/76743 of epoch 2, 122.82 ms/it, loss 0.446830
Finished training it 41984/76743 of epoch 2, 121.74 ms/it, loss 0.445921
Finished training it 43008/76743 of epoch 2, 118.45 ms/it, loss 0.450960
Finished training it 43008/76743 of epoch 2, 118.43 ms/it, loss 0.447557
Finished training it 43008/76743 of epoch 2, 119.05 ms/it, loss 0.447910
Finished training it 43008/76743 of epoch 2, 119.38 ms/it, loss 0.446780
Finished training it 44032/76743 of epoch 2, 119.96 ms/it, loss 0.447615
Finished training it 44032/76743 of epoch 2, 120.04 ms/it, loss 0.447498
Finished training it 44032/76743 of epoch 2, 121.17 ms/it, loss 0.449644
Finished training it 44032/76743 of epoch 2, 120.78 ms/it, loss 0.449203
Finished training it 45056/76743 of epoch 2, 117.49 ms/it, loss 0.447059
Finished training it 45056/76743 of epoch 2, 117.63 ms/it, loss 0.447079
Finished training it 45056/76743 of epoch 2, 119.07 ms/it, loss 0.447192
Finished training it 45056/76743 of epoch 2, 119.29 ms/it, loss 0.449921
Finished training it 46080/76743 of epoch 2, 120.99 ms/it, loss 0.451616
Finished training it 46080/76743 of epoch 2, 121.77 ms/it, loss 0.447338
Finished training it 46080/76743 of epoch 2, 118.80 ms/it, loss 0.448136
Finished training it 46080/76743 of epoch 2, 120.98 ms/it, loss 0.445906
Finished training it 47104/76743 of epoch 2, 123.83 ms/it, loss 0.446799
Finished training it 47104/76743 of epoch 2, 122.71 ms/it, loss 0.448908
Finished training it 47104/76743 of epoch 2, 122.92 ms/it, loss 0.446647
Finished training it 47104/76743 of epoch 2, 122.80 ms/it, loss 0.446241
Finished training it 48128/76743 of epoch 2, 119.61 ms/it, loss 0.450061
Finished training it 48128/76743 of epoch 2, 120.75 ms/it, loss 0.447168
Finished training it 48128/76743 of epoch 2, 120.31 ms/it, loss 0.447271
Finished training it 48128/76743 of epoch 2, 120.05 ms/it, loss 0.447955
Finished training it 49152/76743 of epoch 2, 119.92 ms/it, loss 0.447342
Finished training it 49152/76743 of epoch 2, 119.01 ms/it, loss 0.448625
Finished training it 49152/76743 of epoch 2, 120.06 ms/it, loss 0.447289
Finished training it 49152/76743 of epoch 2, 121.78 ms/it, loss 0.448610
Finished training it 50176/76743 of epoch 2, 126.34 ms/it, loss 0.446523
Finished training it 50176/76743 of epoch 2, 126.51 ms/it, loss 0.445458
Finished training it 50176/76743 of epoch 2, 128.94 ms/it, loss 0.447253
Finished training it 50176/76743 of epoch 2, 120.68 ms/it, loss 0.447440
Finished training it 51200/76743 of epoch 2, 119.75 ms/it, loss 0.446688
Finished training it 51200/76743 of epoch 2, 117.18 ms/it, loss 0.448536
Finished training it 51200/76743 of epoch 2, 122.53 ms/it, loss 0.447366
Finished training it 51200/76743 of epoch 2, 119.86 ms/it, loss 0.443956
Testing at - 51200/76743 of epoch 2,
Testing at - 51200/76743 of epoch 2,
Testing at - 51200/76743 of epoch 2,
Testing at - 51200/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577844.0
get out
0 has test check 2577844.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577844.0
get out
3 has test check 2577844.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2577844.0
get out
1 has test check 2577844.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577844.0
get out
2 has test check 2577844.0 and sample count 3273728
 accuracy 78.743 %, best 78.743 %, roc auc score 0.7998, best 0.7998
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 52224/76743 of epoch 2, 118.53 ms/it, loss 0.447488
Finished training it 52224/76743 of epoch 2, 120.14 ms/it, loss 0.445916
Finished training it 52224/76743 of epoch 2, 118.77 ms/it, loss 0.447693
Finished training it 52224/76743 of epoch 2, 118.69 ms/it, loss 0.443899
Finished training it 53248/76743 of epoch 2, 119.77 ms/it, loss 0.449734
Finished training it 53248/76743 of epoch 2, 119.46 ms/it, loss 0.445813
Finished training it 53248/76743 of epoch 2, 119.61 ms/it, loss 0.445622
Finished training it 53248/76743 of epoch 2, 120.85 ms/it, loss 0.447816
Finished training it 54272/76743 of epoch 2, 118.33 ms/it, loss 0.447439
Finished training it 54272/76743 of epoch 2, 119.82 ms/it, loss 0.449349
Finished training it 54272/76743 of epoch 2, 118.56 ms/it, loss 0.446937
Finished training it 54272/76743 of epoch 2, 118.42 ms/it, loss 0.448140
Finished training it 55296/76743 of epoch 2, 119.75 ms/it, loss 0.447167
Finished training it 55296/76743 of epoch 2, 121.71 ms/it, loss 0.445589
Finished training it 55296/76743 of epoch 2, 119.72 ms/it, loss 0.447268
Finished training it 55296/76743 of epoch 2, 119.49 ms/it, loss 0.448512
Finished training it 56320/76743 of epoch 2, 119.23 ms/it, loss 0.447311
Finished training it 56320/76743 of epoch 2, 119.44 ms/it, loss 0.450183
Finished training it 56320/76743 of epoch 2, 121.35 ms/it, loss 0.445979
Finished training it 56320/76743 of epoch 2, 119.31 ms/it, loss 0.445996
Finished training it 57344/76743 of epoch 2, 118.54 ms/it, loss 0.449108
Finished training it 57344/76743 of epoch 2, 118.94 ms/it, loss 0.447136
Finished training it 57344/76743 of epoch 2, 120.20 ms/it, loss 0.447958
Finished training it 57344/76743 of epoch 2, 118.28 ms/it, loss 0.446550
Finished training it 58368/76743 of epoch 2, 120.17 ms/it, loss 0.448420
Finished training it 58368/76743 of epoch 2, 120.17 ms/it, loss 0.447622
Finished training it 58368/76743 of epoch 2, 120.97 ms/it, loss 0.445954
Finished training it 58368/76743 of epoch 2, 121.32 ms/it, loss 0.444517
Finished training it 59392/76743 of epoch 2, 117.78 ms/it, loss 0.447588
Finished training it 59392/76743 of epoch 2, 117.70 ms/it, loss 0.445279
Finished training it 59392/76743 of epoch 2, 117.80 ms/it, loss 0.446093
Finished training it 59392/76743 of epoch 2, 119.14 ms/it, loss 0.445604
Finished training it 60416/76743 of epoch 2, 118.77 ms/it, loss 0.447468
Finished training it 60416/76743 of epoch 2, 118.87 ms/it, loss 0.447220
Finished training it 60416/76743 of epoch 2, 118.64 ms/it, loss 0.448123
Finished training it 60416/76743 of epoch 2, 121.03 ms/it, loss 0.447233
Finished training it 61440/76743 of epoch 2, 119.39 ms/it, loss 0.446676
Finished training it 61440/76743 of epoch 2, 119.46 ms/it, loss 0.447991
Finished training it 61440/76743 of epoch 2, 119.39 ms/it, loss 0.449006
Finished training it 61440/76743 of epoch 2, 121.41 ms/it, loss 0.446745
Testing at - 61440/76743 of epoch 2,
Testing at - 61440/76743 of epoch 2,
Testing at - 61440/76743 of epoch 2,
Testing at - 61440/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2577440.0
get out
0 has test check 2577440.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2577440.0
get out
2 has test check 2577440.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2577440.0
get out
1 has test check 2577440.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2577440.0
get out
3 has test check 2577440.0 and sample count 3273728
 accuracy 78.731 %, best 78.743 %, roc auc score 0.7997, best 0.7998
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 62464/76743 of epoch 2, 118.81 ms/it, loss 0.450782
Finished training it 62464/76743 of epoch 2, 116.60 ms/it, loss 0.447864
Finished training it 62464/76743 of epoch 2, 119.90 ms/it, loss 0.446373
Finished training it 62464/76743 of epoch 2, 119.31 ms/it, loss 0.447514
Finished training it 63488/76743 of epoch 2, 120.38 ms/it, loss 0.443913
Finished training it 63488/76743 of epoch 2, 120.64 ms/it, loss 0.446319
Finished training it 63488/76743 of epoch 2, 121.60 ms/it, loss 0.446788
Finished training it 63488/76743 of epoch 2, 118.02 ms/it, loss 0.447846
Finished training it 64512/76743 of epoch 2, 118.85 ms/it, loss 0.447995
Finished training it 64512/76743 of epoch 2, 119.65 ms/it, loss 0.449213
Finished training it 64512/76743 of epoch 2, 121.06 ms/it, loss 0.446292
Finished training it 64512/76743 of epoch 2, 119.76 ms/it, loss 0.449366
Finished training it 65536/76743 of epoch 2, 113.66 ms/it, loss 0.448253
Finished training it 65536/76743 of epoch 2, 116.28 ms/it, loss 0.450103
Finished training it 65536/76743 of epoch 2, 114.54 ms/it, loss 0.445135
Finished training it 65536/76743 of epoch 2, 113.56 ms/it, loss 0.448434
Finished training it 66560/76743 of epoch 2, 115.83 ms/it, loss 0.446700
Finished training it 66560/76743 of epoch 2, 116.03 ms/it, loss 0.448379
Finished training it 66560/76743 of epoch 2, 115.96 ms/it, loss 0.448516
Finished training it 66560/76743 of epoch 2, 117.98 ms/it, loss 0.447818
Finished training it 67584/76743 of epoch 2, 118.83 ms/it, loss 0.445352
Finished training it 67584/76743 of epoch 2, 119.65 ms/it, loss 0.449417
Finished training it 67584/76743 of epoch 2, 118.98 ms/it, loss 0.446808
Finished training it 67584/76743 of epoch 2, 120.22 ms/it, loss 0.447891
Finished training it 68608/76743 of epoch 2, 118.73 ms/it, loss 0.447719
Finished training it 68608/76743 of epoch 2, 118.64 ms/it, loss 0.448667
Finished training it 68608/76743 of epoch 2, 117.54 ms/it, loss 0.448313
Finished training it 68608/76743 of epoch 2, 118.06 ms/it, loss 0.446599
Finished training it 69632/76743 of epoch 2, 114.22 ms/it, loss 0.447158
Finished training it 69632/76743 of epoch 2, 115.20 ms/it, loss 0.448237
Finished training it 69632/76743 of epoch 2, 114.29 ms/it, loss 0.447822
Finished training it 69632/76743 of epoch 2, 115.90 ms/it, loss 0.446488
Finished training it 70656/76743 of epoch 2, 116.62 ms/it, loss 0.446408
Finished training it 70656/76743 of epoch 2, 118.27 ms/it, loss 0.447579
Finished training it 70656/76743 of epoch 2, 118.22 ms/it, loss 0.446597
Finished training it 70656/76743 of epoch 2, 116.56 ms/it, loss 0.449418
Finished training it 71680/76743 of epoch 2, 119.24 ms/it, loss 0.448972
Finished training it 71680/76743 of epoch 2, 119.25 ms/it, loss 0.447253
Finished training it 71680/76743 of epoch 2, 119.78 ms/it, loss 0.447488
Finished training it 71680/76743 of epoch 2, 120.22 ms/it, loss 0.446193
Testing at - 71680/76743 of epoch 2,
Testing at - 71680/76743 of epoch 2,
Testing at - 71680/76743 of epoch 2,
Testing at - 71680/76743 of epoch 2,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2574442.0
get out
2 has test check 2574442.0 and sample count 3273728
rank: 1 test_accu: 2574442.0
get out
1 has test check 2574442.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2574442.0
get out
3 has test check 2574442.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2574442.0
get out
0 has test check 2574442.0 and sample count 3273728
 accuracy 78.639 %, best 78.743 %, roc auc score 0.8000, best 0.8000
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 72704/76743 of epoch 2, 118.57 ms/it, loss 0.446666
Finished training it 72704/76743 of epoch 2, 119.65 ms/it, loss 0.445686
Finished training it 72704/76743 of epoch 2, 118.89 ms/it, loss 0.447769
Finished training it 72704/76743 of epoch 2, 119.40 ms/it, loss 0.444569
Finished training it 73728/76743 of epoch 2, 118.05 ms/it, loss 0.446200
Finished training it 73728/76743 of epoch 2, 118.62 ms/it, loss 0.445268
Finished training it 73728/76743 of epoch 2, 118.72 ms/it, loss 0.446619
Finished training it 73728/76743 of epoch 2, 119.51 ms/it, loss 0.445843
Finished training it 74752/76743 of epoch 2, 118.70 ms/it, loss 0.447820
Finished training it 74752/76743 of epoch 2, 116.57 ms/it, loss 0.449072
Finished training it 74752/76743 of epoch 2, 116.59 ms/it, loss 0.451125
Finished training it 74752/76743 of epoch 2, 118.85 ms/it, loss 0.449734
Finished training it 75776/76743 of epoch 2, 116.56 ms/it, loss 0.446098
Finished training it 75776/76743 of epoch 2, 117.60 ms/it, loss 0.445492
Finished training it 75776/76743 of epoch 2, 116.64 ms/it, loss 0.447516
Finished training it 75776/76743 of epoch 2, 117.71 ms/it, loss 0.447802
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 3, 118.21 ms/it, loss 0.443928
Finished training it 1024/76743 of epoch 3, 118.82 ms/it, loss 0.444999
Finished training it 1024/76743 of epoch 3, 120.00 ms/it, loss 0.448968
Finished training it 1024/76743 of epoch 3, 119.23 ms/it, loss 0.446531
Finished training it 2048/76743 of epoch 3, 124.02 ms/it, loss 0.449824
Finished training it 2048/76743 of epoch 3, 125.42 ms/it, loss 0.447990
Finished training it 2048/76743 of epoch 3, 123.79 ms/it, loss 0.447014
Finished training it 2048/76743 of epoch 3, 124.72 ms/it, loss 0.446063
Finished training it 3072/76743 of epoch 3, 117.27 ms/it, loss 0.445486
Finished training it 3072/76743 of epoch 3, 118.59 ms/it, loss 0.447401
Finished training it 3072/76743 of epoch 3, 118.74 ms/it, loss 0.447571
Finished training it 3072/76743 of epoch 3, 116.89 ms/it, loss 0.448300
Finished training it 4096/76743 of epoch 3, 119.97 ms/it, loss 0.446406
Finished training it 4096/76743 of epoch 3, 120.12 ms/it, loss 0.449070
Finished training it 4096/76743 of epoch 3, 121.78 ms/it, loss 0.445879
Finished training it 4096/76743 of epoch 3, 121.34 ms/it, loss 0.449876
Finished training it 5120/76743 of epoch 3, 117.37 ms/it, loss 0.447202
Finished training it 5120/76743 of epoch 3, 117.21 ms/it, loss 0.448237
Finished training it 5120/76743 of epoch 3, 118.38 ms/it, loss 0.447339
Finished training it 5120/76743 of epoch 3, 118.66 ms/it, loss 0.447103
Finished training it 6144/76743 of epoch 3, 120.25 ms/it, loss 0.445741
Finished training it 6144/76743 of epoch 3, 118.73 ms/it, loss 0.447557
Finished training it 6144/76743 of epoch 3, 118.80 ms/it, loss 0.448703
Finished training it 6144/76743 of epoch 3, 120.03 ms/it, loss 0.447293
Finished training it 7168/76743 of epoch 3, 119.25 ms/it, loss 0.442188
Finished training it 7168/76743 of epoch 3, 119.51 ms/it, loss 0.447459
Finished training it 7168/76743 of epoch 3, 119.90 ms/it, loss 0.447119
Finished training it 7168/76743 of epoch 3, 118.52 ms/it, loss 0.446439
Finished training it 8192/76743 of epoch 3, 114.46 ms/it, loss 0.443796
Finished training it 8192/76743 of epoch 3, 112.46 ms/it, loss 0.447540
Finished training it 8192/76743 of epoch 3, 112.77 ms/it, loss 0.446056
Finished training it 8192/76743 of epoch 3, 114.42 ms/it, loss 0.447757
Finished training it 9216/76743 of epoch 3, 116.33 ms/it, loss 0.445661
Finished training it 9216/76743 of epoch 3, 118.23 ms/it, loss 0.446730
Finished training it 9216/76743 of epoch 3, 116.54 ms/it, loss 0.450328
Finished training it 9216/76743 of epoch 3, 117.50 ms/it, loss 0.445223
Finished training it 10240/76743 of epoch 3, 114.40 ms/it, loss 0.445786
Finished training it 10240/76743 of epoch 3, 116.21 ms/it, loss 0.445335
Finished training it 10240/76743 of epoch 3, 114.53 ms/it, loss 0.446711
Finished training it 10240/76743 of epoch 3, 115.36 ms/it, loss 0.444441
Testing at - 10240/76743 of epoch 3,
Testing at - 10240/76743 of epoch 3,
Testing at - 10240/76743 of epoch 3,
Testing at - 10240/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2576906.0
get out
3 has test check 2576906.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2576906.0
get out
0 has test check 2576906.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2576906.0
get out
2 has test check 2576906.0 and sample count 3273728
rank: 1 test_accu: 2576906.0
get out
1 has test check 2576906.0 and sample count 3273728
 accuracy 78.715 %, best 78.743 %, roc auc score 0.8008, best 0.8008
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 11264/76743 of epoch 3, 121.44 ms/it, loss 0.446157
Finished training it 11264/76743 of epoch 3, 122.10 ms/it, loss 0.445917
Finished training it 11264/76743 of epoch 3, 123.31 ms/it, loss 0.446764
Finished training it 11264/76743 of epoch 3, 122.50 ms/it, loss 0.445204
Finished training it 12288/76743 of epoch 3, 118.00 ms/it, loss 0.446639
Finished training it 12288/76743 of epoch 3, 119.01 ms/it, loss 0.445887
Finished training it 12288/76743 of epoch 3, 118.98 ms/it, loss 0.445233
Finished training it 12288/76743 of epoch 3, 117.57 ms/it, loss 0.446210
Finished training it 13312/76743 of epoch 3, 120.29 ms/it, loss 0.444552
Finished training it 13312/76743 of epoch 3, 118.25 ms/it, loss 0.445778
Finished training it 13312/76743 of epoch 3, 120.41 ms/it, loss 0.447296
Finished training it 13312/76743 of epoch 3, 118.98 ms/it, loss 0.445699
Finished training it 14336/76743 of epoch 3, 119.49 ms/it, loss 0.448463
Finished training it 14336/76743 of epoch 3, 118.00 ms/it, loss 0.445563
Finished training it 14336/76743 of epoch 3, 118.32 ms/it, loss 0.446440
Finished training it 14336/76743 of epoch 3, 120.00 ms/it, loss 0.447670
Finished training it 15360/76743 of epoch 3, 121.04 ms/it, loss 0.446179
Finished training it 15360/76743 of epoch 3, 118.86 ms/it, loss 0.448219
Finished training it 15360/76743 of epoch 3, 118.54 ms/it, loss 0.449197
Finished training it 15360/76743 of epoch 3, 119.96 ms/it, loss 0.447945
Finished training it 16384/76743 of epoch 3, 117.60 ms/it, loss 0.448157
Finished training it 16384/76743 of epoch 3, 117.76 ms/it, loss 0.446626
Finished training it 16384/76743 of epoch 3, 117.27 ms/it, loss 0.444978
Finished training it 16384/76743 of epoch 3, 116.49 ms/it, loss 0.447442
Finished training it 17408/76743 of epoch 3, 119.39 ms/it, loss 0.448003
Finished training it 17408/76743 of epoch 3, 120.53 ms/it, loss 0.446287
Finished training it 17408/76743 of epoch 3, 118.81 ms/it, loss 0.448153
Finished training it 17408/76743 of epoch 3, 121.01 ms/it, loss 0.447158
Finished training it 18432/76743 of epoch 3, 115.59 ms/it, loss 0.444430
Finished training it 18432/76743 of epoch 3, 117.95 ms/it, loss 0.447440
Finished training it 18432/76743 of epoch 3, 115.40 ms/it, loss 0.447725
Finished training it 18432/76743 of epoch 3, 117.47 ms/it, loss 0.448076
Finished training it 19456/76743 of epoch 3, 116.85 ms/it, loss 0.443792
Finished training it 19456/76743 of epoch 3, 118.12 ms/it, loss 0.445944
Finished training it 19456/76743 of epoch 3, 117.22 ms/it, loss 0.442914
Finished training it 19456/76743 of epoch 3, 118.02 ms/it, loss 0.445797
Finished training it 20480/76743 of epoch 3, 118.21 ms/it, loss 0.444783
Finished training it 20480/76743 of epoch 3, 119.35 ms/it, loss 0.444930
Finished training it 20480/76743 of epoch 3, 118.60 ms/it, loss 0.442732
Finished training it 20480/76743 of epoch 3, 119.14 ms/it, loss 0.445576
Testing at - 20480/76743 of epoch 3,
Testing at - 20480/76743 of epoch 3,
Testing at - 20480/76743 of epoch 3,
Testing at - 20480/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2579774.0
get out
0 has test check 2579774.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579774.0
get out
1 has test check 2579774.0 and sample count 3273728
rank: 3 test_accu: 2579774.0
get out
3 has test check 2579774.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579774.0
get out
2 has test check 2579774.0 and sample count 3273728
 accuracy 78.802 %, best 78.802 %, roc auc score 0.8012, best 0.8012
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 21504/76743 of epoch 3, 118.15 ms/it, loss 0.444881
Finished training it 21504/76743 of epoch 3, 118.66 ms/it, loss 0.446154
Finished training it 21504/76743 of epoch 3, 117.67 ms/it, loss 0.445619
Finished training it 21504/76743 of epoch 3, 119.35 ms/it, loss 0.448558
Finished training it 22528/76743 of epoch 3, 116.60 ms/it, loss 0.447267
Finished training it 22528/76743 of epoch 3, 118.36 ms/it, loss 0.448232
Finished training it 22528/76743 of epoch 3, 116.43 ms/it, loss 0.446147
Finished training it 22528/76743 of epoch 3, 117.80 ms/it, loss 0.447040
Finished training it 23552/76743 of epoch 3, 117.35 ms/it, loss 0.447277
Finished training it 23552/76743 of epoch 3, 117.49 ms/it, loss 0.449052
Finished training it 23552/76743 of epoch 3, 118.87 ms/it, loss 0.447142
Finished training it 23552/76743 of epoch 3, 118.98 ms/it, loss 0.447196
Finished training it 24576/76743 of epoch 3, 117.43 ms/it, loss 0.442634
Finished training it 24576/76743 of epoch 3, 118.57 ms/it, loss 0.444869
Finished training it 24576/76743 of epoch 3, 117.27 ms/it, loss 0.447168
Finished training it 24576/76743 of epoch 3, 118.25 ms/it, loss 0.445607
Finished training it 25600/76743 of epoch 3, 119.46 ms/it, loss 0.447177
Finished training it 25600/76743 of epoch 3, 121.00 ms/it, loss 0.445716
Finished training it 25600/76743 of epoch 3, 120.39 ms/it, loss 0.446056
Finished training it 25600/76743 of epoch 3, 119.50 ms/it, loss 0.443585
Finished training it 26624/76743 of epoch 3, 117.58 ms/it, loss 0.445403
Finished training it 26624/76743 of epoch 3, 117.43 ms/it, loss 0.446366
Finished training it 26624/76743 of epoch 3, 118.84 ms/it, loss 0.443551
Finished training it 26624/76743 of epoch 3, 119.45 ms/it, loss 0.444006
Finished training it 27648/76743 of epoch 3, 115.01 ms/it, loss 0.445466
Finished training it 27648/76743 of epoch 3, 116.89 ms/it, loss 0.446655
Finished training it 27648/76743 of epoch 3, 115.30 ms/it, loss 0.444499
Finished training it 27648/76743 of epoch 3, 115.83 ms/it, loss 0.445798
Finished training it 28672/76743 of epoch 3, 117.47 ms/it, loss 0.443262
Finished training it 28672/76743 of epoch 3, 117.76 ms/it, loss 0.445716
Finished training it 28672/76743 of epoch 3, 115.02 ms/it, loss 0.446218
Finished training it 28672/76743 of epoch 3, 115.12 ms/it, loss 0.449446
Finished training it 29696/76743 of epoch 3, 116.60 ms/it, loss 0.447178
Finished training it 29696/76743 of epoch 3, 117.74 ms/it, loss 0.444340
Finished training it 29696/76743 of epoch 3, 116.19 ms/it, loss 0.445927
Finished training it 29696/76743 of epoch 3, 117.36 ms/it, loss 0.443941
Finished training it 30720/76743 of epoch 3, 115.96 ms/it, loss 0.444134
Finished training it 30720/76743 of epoch 3, 115.95 ms/it, loss 0.444019
Finished training it 30720/76743 of epoch 3, 118.04 ms/it, loss 0.443510
Finished training it 30720/76743 of epoch 3, 117.47 ms/it, loss 0.443983
Testing at - 30720/76743 of epoch 3,
Testing at - 30720/76743 of epoch 3,
Testing at - 30720/76743 of epoch 3,
Testing at - 30720/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2579137.0
get out
0 has test check 2579137.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2579137.0
get out
3 has test check 2579137.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579137.0
get out
2 has test check 2579137.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579137.0
get out
1 has test check 2579137.0 and sample count 3273728
 accuracy 78.783 %, best 78.802 %, roc auc score 0.8011, best 0.8012
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 31744/76743 of epoch 3, 120.66 ms/it, loss 0.444416
Finished training it 31744/76743 of epoch 3, 119.11 ms/it, loss 0.448531
Finished training it 31744/76743 of epoch 3, 119.05 ms/it, loss 0.446277
Finished training it 31744/76743 of epoch 3, 120.93 ms/it, loss 0.446383
Finished training it 32768/76743 of epoch 3, 119.26 ms/it, loss 0.446966
Finished training it 32768/76743 of epoch 3, 121.30 ms/it, loss 0.444703
Finished training it 32768/76743 of epoch 3, 119.74 ms/it, loss 0.446713
Finished training it 32768/76743 of epoch 3, 121.07 ms/it, loss 0.447153
Finished training it 33792/76743 of epoch 3, 118.52 ms/it, loss 0.446186
Finished training it 33792/76743 of epoch 3, 120.50 ms/it, loss 0.444547
Finished training it 33792/76743 of epoch 3, 120.25 ms/it, loss 0.445811
Finished training it 33792/76743 of epoch 3, 118.50 ms/it, loss 0.445752
Finished training it 34816/76743 of epoch 3, 117.67 ms/it, loss 0.444182
Finished training it 34816/76743 of epoch 3, 117.54 ms/it, loss 0.446171
Finished training it 34816/76743 of epoch 3, 119.48 ms/it, loss 0.447204
Finished training it 34816/76743 of epoch 3, 118.93 ms/it, loss 0.448137
Finished training it 35840/76743 of epoch 3, 119.56 ms/it, loss 0.448268
Finished training it 35840/76743 of epoch 3, 118.39 ms/it, loss 0.444579
Finished training it 35840/76743 of epoch 3, 118.09 ms/it, loss 0.444729
Finished training it 35840/76743 of epoch 3, 120.21 ms/it, loss 0.447146
Finished training it 36864/76743 of epoch 3, 121.82 ms/it, loss 0.444454
Finished training it 36864/76743 of epoch 3, 120.10 ms/it, loss 0.445676
Finished training it 36864/76743 of epoch 3, 119.98 ms/it, loss 0.443722
Finished training it 36864/76743 of epoch 3, 121.82 ms/it, loss 0.446086
Finished training it 37888/76743 of epoch 3, 118.02 ms/it, loss 0.448000
Finished training it 37888/76743 of epoch 3, 119.44 ms/it, loss 0.446517
Finished training it 37888/76743 of epoch 3, 117.12 ms/it, loss 0.447067
Finished training it 37888/76743 of epoch 3, 118.94 ms/it, loss 0.447346
Finished training it 38912/76743 of epoch 3, 120.95 ms/it, loss 0.446595
Finished training it 38912/76743 of epoch 3, 122.41 ms/it, loss 0.447639
Finished training it 38912/76743 of epoch 3, 121.02 ms/it, loss 0.446004
Finished training it 38912/76743 of epoch 3, 122.88 ms/it, loss 0.445488
Finished training it 39936/76743 of epoch 3, 118.13 ms/it, loss 0.447462
Finished training it 39936/76743 of epoch 3, 119.70 ms/it, loss 0.447709
Finished training it 39936/76743 of epoch 3, 120.27 ms/it, loss 0.444881
Finished training it 39936/76743 of epoch 3, 117.85 ms/it, loss 0.444804
Finished training it 40960/76743 of epoch 3, 117.83 ms/it, loss 0.445919
Finished training it 40960/76743 of epoch 3, 116.63 ms/it, loss 0.444423
Finished training it 40960/76743 of epoch 3, 116.55 ms/it, loss 0.444259
Finished training it 40960/76743 of epoch 3, 118.28 ms/it, loss 0.446554
Testing at - 40960/76743 of epoch 3,
Testing at - 40960/76743 of epoch 3,
Testing at - 40960/76743 of epoch 3,
Testing at - 40960/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579326.0
get out
2 has test check 2579326.0 and sample count 3273728
rank: 0 test_accu: 2579326.0
Warning: Skipping the batch 3197 with size 602
get out
0 has test check 2579326.0 and sample count 3273728
rank: 3 test_accu: 2579326.0
get out
3 has test check 2579326.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579326.0
get out
1 has test check 2579326.0 and sample count 3273728
 accuracy 78.789 %, best 78.802 %, roc auc score 0.8016, best 0.8016
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 41984/76743 of epoch 3, 117.23 ms/it, loss 0.442685
Finished training it 41984/76743 of epoch 3, 119.08 ms/it, loss 0.447122
Finished training it 41984/76743 of epoch 3, 117.04 ms/it, loss 0.444352
Finished training it 41984/76743 of epoch 3, 117.74 ms/it, loss 0.443946
Finished training it 43008/76743 of epoch 3, 117.98 ms/it, loss 0.448361
Finished training it 43008/76743 of epoch 3, 118.68 ms/it, loss 0.444710
Finished training it 43008/76743 of epoch 3, 119.46 ms/it, loss 0.445170
Finished training it 43008/76743 of epoch 3, 120.19 ms/it, loss 0.443972
Finished training it 44032/76743 of epoch 3, 115.85 ms/it, loss 0.444647
Finished training it 44032/76743 of epoch 3, 118.27 ms/it, loss 0.446749
Finished training it 44032/76743 of epoch 3, 116.11 ms/it, loss 0.444678
Finished training it 44032/76743 of epoch 3, 117.82 ms/it, loss 0.446090
Finished training it 45056/76743 of epoch 3, 116.80 ms/it, loss 0.444139
Finished training it 45056/76743 of epoch 3, 119.02 ms/it, loss 0.444565
Finished training it 45056/76743 of epoch 3, 119.53 ms/it, loss 0.447219
Finished training it 45056/76743 of epoch 3, 117.00 ms/it, loss 0.444361
Finished training it 46080/76743 of epoch 3, 117.28 ms/it, loss 0.448761
Finished training it 46080/76743 of epoch 3, 118.60 ms/it, loss 0.444674
Finished training it 46080/76743 of epoch 3, 120.31 ms/it, loss 0.445132
Finished training it 46080/76743 of epoch 3, 117.38 ms/it, loss 0.443227
Finished training it 47104/76743 of epoch 3, 119.11 ms/it, loss 0.443730
Finished training it 47104/76743 of epoch 3, 120.56 ms/it, loss 0.444062
Finished training it 47104/76743 of epoch 3, 119.28 ms/it, loss 0.446289
Finished training it 47104/76743 of epoch 3, 121.96 ms/it, loss 0.443544
Finished training it 48128/76743 of epoch 3, 116.90 ms/it, loss 0.447214
Finished training it 48128/76743 of epoch 3, 118.14 ms/it, loss 0.444566
Finished training it 48128/76743 of epoch 3, 117.61 ms/it, loss 0.445165
Finished training it 48128/76743 of epoch 3, 119.71 ms/it, loss 0.444680
Finished training it 49152/76743 of epoch 3, 121.16 ms/it, loss 0.444521
Finished training it 49152/76743 of epoch 3, 122.00 ms/it, loss 0.446269
Finished training it 49152/76743 of epoch 3, 121.29 ms/it, loss 0.444680
Finished training it 49152/76743 of epoch 3, 123.69 ms/it, loss 0.446814
Finished training it 50176/76743 of epoch 3, 121.19 ms/it, loss 0.444190
Finished training it 50176/76743 of epoch 3, 122.55 ms/it, loss 0.444935
Finished training it 50176/76743 of epoch 3, 121.31 ms/it, loss 0.443154
Finished training it 50176/76743 of epoch 3, 123.97 ms/it, loss 0.444740
Finished training it 51200/76743 of epoch 3, 121.41 ms/it, loss 0.446130
Finished training it 51200/76743 of epoch 3, 119.53 ms/it, loss 0.444021
Finished training it 51200/76743 of epoch 3, 119.68 ms/it, loss 0.441873
Finished training it 51200/76743 of epoch 3, 122.30 ms/it, loss 0.444678
Testing at - 51200/76743 of epoch 3,
Testing at - 51200/76743 of epoch 3,
Testing at - 51200/76743 of epoch 3,
Testing at - 51200/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2579392.0
get out
1 has test check 2579392.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2579392.0
get out
0 has test check 2579392.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579392.0
get out
2 has test check 2579392.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2579392.0
get out
3 has test check 2579392.0 and sample count 3273728
 accuracy 78.791 %, best 78.802 %, roc auc score 0.8016, best 0.8016
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 52224/76743 of epoch 3, 113.87 ms/it, loss 0.444744
Finished training it 52224/76743 of epoch 3, 113.67 ms/it, loss 0.441528
Finished training it 52224/76743 of epoch 3, 116.92 ms/it, loss 0.443781
Finished training it 52224/76743 of epoch 3, 115.27 ms/it, loss 0.445405
Finished training it 53248/76743 of epoch 3, 113.49 ms/it, loss 0.443929
Finished training it 53248/76743 of epoch 3, 115.32 ms/it, loss 0.447825
Finished training it 53248/76743 of epoch 3, 113.47 ms/it, loss 0.443378
Finished training it 53248/76743 of epoch 3, 116.27 ms/it, loss 0.445972
Finished training it 54272/76743 of epoch 3, 117.98 ms/it, loss 0.445238
Finished training it 54272/76743 of epoch 3, 118.14 ms/it, loss 0.445714
Finished training it 54272/76743 of epoch 3, 118.99 ms/it, loss 0.445094
Finished training it 54272/76743 of epoch 3, 120.75 ms/it, loss 0.447129
Finished training it 55296/76743 of epoch 3, 118.28 ms/it, loss 0.446530
Finished training it 55296/76743 of epoch 3, 118.20 ms/it, loss 0.445166
Finished training it 55296/76743 of epoch 3, 119.22 ms/it, loss 0.444996
Finished training it 55296/76743 of epoch 3, 121.27 ms/it, loss 0.443527
Finished training it 56320/76743 of epoch 3, 120.44 ms/it, loss 0.443678
Finished training it 56320/76743 of epoch 3, 120.13 ms/it, loss 0.445186
Finished training it 56320/76743 of epoch 3, 121.39 ms/it, loss 0.447770
Finished training it 56320/76743 of epoch 3, 123.76 ms/it, loss 0.443397
Finished training it 57344/76743 of epoch 3, 113.55 ms/it, loss 0.446192
Finished training it 57344/76743 of epoch 3, 114.34 ms/it, loss 0.444662
Finished training it 57344/76743 of epoch 3, 113.36 ms/it, loss 0.444060
Finished training it 57344/76743 of epoch 3, 116.58 ms/it, loss 0.445533
Finished training it 58368/76743 of epoch 3, 119.77 ms/it, loss 0.446236
Finished training it 58368/76743 of epoch 3, 123.47 ms/it, loss 0.442226
Finished training it 58368/76743 of epoch 3, 120.90 ms/it, loss 0.445335
Finished training it 58368/76743 of epoch 3, 119.80 ms/it, loss 0.443727
Finished training it 59392/76743 of epoch 3, 119.03 ms/it, loss 0.442990
Finished training it 59392/76743 of epoch 3, 120.28 ms/it, loss 0.445562
Finished training it 59392/76743 of epoch 3, 118.92 ms/it, loss 0.443492
Finished training it 59392/76743 of epoch 3, 122.84 ms/it, loss 0.443413
Finished training it 60416/76743 of epoch 3, 115.99 ms/it, loss 0.445363
Finished training it 60416/76743 of epoch 3, 115.46 ms/it, loss 0.445952
Finished training it 60416/76743 of epoch 3, 118.95 ms/it, loss 0.445168
Finished training it 60416/76743 of epoch 3, 116.53 ms/it, loss 0.444969
Finished training it 61440/76743 of epoch 3, 118.70 ms/it, loss 0.444591
Finished training it 61440/76743 of epoch 3, 118.59 ms/it, loss 0.447102
Finished training it 61440/76743 of epoch 3, 119.61 ms/it, loss 0.445642
Finished training it 61440/76743 of epoch 3, 122.10 ms/it, loss 0.444627
Testing at - 61440/76743 of epoch 3,
Testing at - 61440/76743 of epoch 3,
Testing at - 61440/76743 of epoch 3,
Testing at - 61440/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580506.0
get out
0 has test check 2580506.0 and sample count 3273728
rank: 3 test_accu: 2580506.0
get out
3 has test check 2580506.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2580506.0
get out
1 has test check 2580506.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580506.0
get out
2 has test check 2580506.0 and sample count 3273728
 accuracy 78.825 %, best 78.825 %, roc auc score 0.8019, best 0.8019
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 62464/76743 of epoch 3, 120.06 ms/it, loss 0.448798
Finished training it 62464/76743 of epoch 3, 119.92 ms/it, loss 0.445546
Finished training it 62464/76743 of epoch 3, 121.19 ms/it, loss 0.445538
Finished training it 62464/76743 of epoch 3, 123.09 ms/it, loss 0.443801
Finished training it 63488/76743 of epoch 3, 121.38 ms/it, loss 0.445300
Finished training it 63488/76743 of epoch 3, 120.07 ms/it, loss 0.441754
Finished training it 63488/76743 of epoch 3, 120.03 ms/it, loss 0.443881
Finished training it 63488/76743 of epoch 3, 123.10 ms/it, loss 0.444474
Finished training it 64512/76743 of epoch 3, 116.66 ms/it, loss 0.446869
Finished training it 64512/76743 of epoch 3, 118.63 ms/it, loss 0.445244
Finished training it 64512/76743 of epoch 3, 116.61 ms/it, loss 0.446977
Finished training it 64512/76743 of epoch 3, 120.39 ms/it, loss 0.443935
Finished training it 65536/76743 of epoch 3, 118.41 ms/it, loss 0.446168
Finished training it 65536/76743 of epoch 3, 121.92 ms/it, loss 0.447770
Finished training it 65536/76743 of epoch 3, 120.11 ms/it, loss 0.442979
Finished training it 65536/76743 of epoch 3, 118.62 ms/it, loss 0.446357
Finished training it 66560/76743 of epoch 3, 120.26 ms/it, loss 0.444529
Finished training it 66560/76743 of epoch 3, 121.68 ms/it, loss 0.446161
Finished training it 66560/76743 of epoch 3, 123.48 ms/it, loss 0.445336
Finished training it 66560/76743 of epoch 3, 120.24 ms/it, loss 0.446091
Finished training it 67584/76743 of epoch 3, 117.35 ms/it, loss 0.443170
Finished training it 67584/76743 of epoch 3, 118.64 ms/it, loss 0.447552
Finished training it 67584/76743 of epoch 3, 117.41 ms/it, loss 0.445055
Finished training it 67584/76743 of epoch 3, 120.32 ms/it, loss 0.445597
Finished training it 68608/76743 of epoch 3, 115.98 ms/it, loss 0.444844
Finished training it 68608/76743 of epoch 3, 114.00 ms/it, loss 0.445813
Finished training it 68608/76743 of epoch 3, 114.21 ms/it, loss 0.443852
Finished training it 68608/76743 of epoch 3, 117.03 ms/it, loss 0.446207
Finished training it 69632/76743 of epoch 3, 114.27 ms/it, loss 0.444995
Finished training it 69632/76743 of epoch 3, 114.46 ms/it, loss 0.445451
Finished training it 69632/76743 of epoch 3, 116.01 ms/it, loss 0.445738
Finished training it 69632/76743 of epoch 3, 117.06 ms/it, loss 0.443987
Finished training it 70656/76743 of epoch 3, 115.08 ms/it, loss 0.443733
Finished training it 70656/76743 of epoch 3, 115.07 ms/it, loss 0.446741
Finished training it 70656/76743 of epoch 3, 116.70 ms/it, loss 0.445124
Finished training it 70656/76743 of epoch 3, 117.87 ms/it, loss 0.444078
Finished training it 71680/76743 of epoch 3, 116.19 ms/it, loss 0.444585
Finished training it 71680/76743 of epoch 3, 115.90 ms/it, loss 0.446260
Finished training it 71680/76743 of epoch 3, 118.00 ms/it, loss 0.444950
Finished training it 71680/76743 of epoch 3, 118.76 ms/it, loss 0.443230
Testing at - 71680/76743 of epoch 3,
Testing at - 71680/76743 of epoch 3,
Testing at - 71680/76743 of epoch 3,
Testing at - 71680/76743 of epoch 3,
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2579838.0
get out
Warning: Skipping the batch 3197 with size 602
2 has test check 2579838.0 and sample count 3273728
rank: 0 test_accu: 2579838.0
get out
0 has test check 2579838.0 and sample count 3273728
rank: 1 test_accu: 2579838.0
get out
1 has test check 2579838.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2579838.0
get out
3 has test check 2579838.0 and sample count 3273728
 accuracy 78.804 %, best 78.825 %, roc auc score 0.8024, best 0.8024
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 72704/76743 of epoch 3, 118.98 ms/it, loss 0.444363
Finished training it 72704/76743 of epoch 3, 121.71 ms/it, loss 0.441976
Finished training it 72704/76743 of epoch 3, 122.18 ms/it, loss 0.443332
Finished training it 72704/76743 of epoch 3, 119.01 ms/it, loss 0.445410
Finished training it 73728/76743 of epoch 3, 118.28 ms/it, loss 0.443575
Finished training it 73728/76743 of epoch 3, 120.30 ms/it, loss 0.442376
Finished training it 73728/76743 of epoch 3, 118.35 ms/it, loss 0.444350
Finished training it 73728/76743 of epoch 3, 121.42 ms/it, loss 0.443151
Finished training it 74752/76743 of epoch 3, 119.54 ms/it, loss 0.446381
Finished training it 74752/76743 of epoch 3, 121.58 ms/it, loss 0.445414
Finished training it 74752/76743 of epoch 3, 119.60 ms/it, loss 0.448680
Finished training it 74752/76743 of epoch 3, 122.94 ms/it, loss 0.447370
Finished training it 75776/76743 of epoch 3, 119.59 ms/it, loss 0.445009
Finished training it 75776/76743 of epoch 3, 119.64 ms/it, loss 0.443878
Finished training it 75776/76743 of epoch 3, 121.51 ms/it, loss 0.443099
Finished training it 75776/76743 of epoch 3, 122.93 ms/it, loss 0.445782
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Warning: Skipping the batch 76742 with size 14
Finished training it 1024/76743 of epoch 4, 120.28 ms/it, loss 0.441267
Finished training it 1024/76743 of epoch 4, 123.99 ms/it, loss 0.443992
Finished training it 1024/76743 of epoch 4, 120.61 ms/it, loss 0.442516
Finished training it 1024/76743 of epoch 4, 122.14 ms/it, loss 0.446535
Finished training it 2048/76743 of epoch 4, 122.28 ms/it, loss 0.447172
Finished training it 2048/76743 of epoch 4, 121.67 ms/it, loss 0.444637
Finished training it 2048/76743 of epoch 4, 122.82 ms/it, loss 0.445800
Finished training it 2048/76743 of epoch 4, 124.74 ms/it, loss 0.443505
Finished training it 3072/76743 of epoch 4, 114.75 ms/it, loss 0.445940
Finished training it 3072/76743 of epoch 4, 114.60 ms/it, loss 0.443117
Finished training it 3072/76743 of epoch 4, 115.73 ms/it, loss 0.444916
Finished training it 3072/76743 of epoch 4, 117.65 ms/it, loss 0.444668
Finished training it 4096/76743 of epoch 4, 117.76 ms/it, loss 0.443931
Finished training it 4096/76743 of epoch 4, 117.78 ms/it, loss 0.446859
Finished training it 4096/76743 of epoch 4, 119.83 ms/it, loss 0.443446
Finished training it 4096/76743 of epoch 4, 121.03 ms/it, loss 0.447352
Finished training it 5120/76743 of epoch 4, 120.65 ms/it, loss 0.444641
Finished training it 5120/76743 of epoch 4, 118.74 ms/it, loss 0.444185
Finished training it 5120/76743 of epoch 4, 118.82 ms/it, loss 0.445982
Finished training it 5120/76743 of epoch 4, 122.04 ms/it, loss 0.444479
Finished training it 6144/76743 of epoch 4, 119.01 ms/it, loss 0.445043
Finished training it 6144/76743 of epoch 4, 119.90 ms/it, loss 0.443263
Finished training it 6144/76743 of epoch 4, 118.66 ms/it, loss 0.446681
Finished training it 6144/76743 of epoch 4, 121.81 ms/it, loss 0.444796
Finished training it 7168/76743 of epoch 4, 117.41 ms/it, loss 0.439991
Finished training it 7168/76743 of epoch 4, 117.43 ms/it, loss 0.444081
Finished training it 7168/76743 of epoch 4, 118.89 ms/it, loss 0.444482
Finished training it 7168/76743 of epoch 4, 120.84 ms/it, loss 0.444820
Finished training it 8192/76743 of epoch 4, 117.13 ms/it, loss 0.443420
Finished training it 8192/76743 of epoch 4, 119.83 ms/it, loss 0.441063
Finished training it 8192/76743 of epoch 4, 117.20 ms/it, loss 0.445026
Finished training it 8192/76743 of epoch 4, 120.27 ms/it, loss 0.444869
Finished training it 9216/76743 of epoch 4, 116.68 ms/it, loss 0.447895
Finished training it 9216/76743 of epoch 4, 118.69 ms/it, loss 0.444067
Finished training it 9216/76743 of epoch 4, 116.66 ms/it, loss 0.443028
Finished training it 9216/76743 of epoch 4, 119.74 ms/it, loss 0.442543
Finished training it 10240/76743 of epoch 4, 113.75 ms/it, loss 0.443210
Finished training it 10240/76743 of epoch 4, 112.78 ms/it, loss 0.443064
Finished training it 10240/76743 of epoch 4, 113.15 ms/it, loss 0.444407
Finished training it 10240/76743 of epoch 4, 115.78 ms/it, loss 0.442279
Testing at - 10240/76743 of epoch 4,
Testing at - 10240/76743 of epoch 4,
Testing at - 10240/76743 of epoch 4,
Testing at - 10240/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581537.0
get out
1 has test check 2581537.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581537.0
get out
0 has test check 2581537.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581537.0
get out
2 has test check 2581537.0 and sample count 3273728
rank: 3 test_accu: 2581537.0
get out
3 has test check 2581537.0 and sample count 3273728
 accuracy 78.856 %, best 78.856 %, roc auc score 0.8024, best 0.8024
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 11264/76743 of epoch 4, 119.17 ms/it, loss 0.444031
Finished training it 11264/76743 of epoch 4, 122.69 ms/it, loss 0.442933
Finished training it 11264/76743 of epoch 4, 119.40 ms/it, loss 0.443287
Finished training it 11264/76743 of epoch 4, 119.93 ms/it, loss 0.444212
Finished training it 12288/76743 of epoch 4, 113.03 ms/it, loss 0.444169
Finished training it 12288/76743 of epoch 4, 115.09 ms/it, loss 0.443390
Finished training it 12288/76743 of epoch 4, 113.55 ms/it, loss 0.443723
Finished training it 12288/76743 of epoch 4, 116.76 ms/it, loss 0.442400
Finished training it 13312/76743 of epoch 4, 123.50 ms/it, loss 0.442234
Finished training it 13312/76743 of epoch 4, 121.35 ms/it, loss 0.443480
Finished training it 13312/76743 of epoch 4, 121.51 ms/it, loss 0.443348
Finished training it 13312/76743 of epoch 4, 124.76 ms/it, loss 0.444838
Finished training it 14336/76743 of epoch 4, 118.38 ms/it, loss 0.443196
Finished training it 14336/76743 of epoch 4, 121.85 ms/it, loss 0.445550
Finished training it 14336/76743 of epoch 4, 119.90 ms/it, loss 0.446012
Finished training it 14336/76743 of epoch 4, 118.49 ms/it, loss 0.444039
Finished training it 15360/76743 of epoch 4, 116.35 ms/it, loss 0.446154
Finished training it 15360/76743 of epoch 4, 116.45 ms/it, loss 0.446923
Finished training it 15360/76743 of epoch 4, 117.00 ms/it, loss 0.444279
Finished training it 15360/76743 of epoch 4, 119.70 ms/it, loss 0.445831
Finished training it 16384/76743 of epoch 4, 118.48 ms/it, loss 0.442976
Finished training it 16384/76743 of epoch 4, 119.39 ms/it, loss 0.445949
Finished training it 16384/76743 of epoch 4, 118.53 ms/it, loss 0.445323
Finished training it 16384/76743 of epoch 4, 121.39 ms/it, loss 0.444997
Finished training it 17408/76743 of epoch 4, 120.94 ms/it, loss 0.446099
Finished training it 17408/76743 of epoch 4, 120.99 ms/it, loss 0.445933
Finished training it 17408/76743 of epoch 4, 121.81 ms/it, loss 0.444185
Finished training it 17408/76743 of epoch 4, 123.92 ms/it, loss 0.444702
Finished training it 18432/76743 of epoch 4, 112.71 ms/it, loss 0.442166
Finished training it 18432/76743 of epoch 4, 112.71 ms/it, loss 0.445809
Finished training it 18432/76743 of epoch 4, 113.95 ms/it, loss 0.445325
Finished training it 18432/76743 of epoch 4, 114.97 ms/it, loss 0.445773
Finished training it 19456/76743 of epoch 4, 115.13 ms/it, loss 0.441796
Finished training it 19456/76743 of epoch 4, 116.41 ms/it, loss 0.443899
Finished training it 19456/76743 of epoch 4, 115.00 ms/it, loss 0.440985
Finished training it 19456/76743 of epoch 4, 117.98 ms/it, loss 0.443778
Finished training it 20480/76743 of epoch 4, 123.46 ms/it, loss 0.442920
Finished training it 20480/76743 of epoch 4, 121.75 ms/it, loss 0.440686
Finished training it 20480/76743 of epoch 4, 124.93 ms/it, loss 0.443492
Finished training it 20480/76743 of epoch 4, 121.82 ms/it, loss 0.442583
Testing at - 20480/76743 of epoch 4,
Testing at - 20480/76743 of epoch 4,
Testing at - 20480/76743 of epoch 4,
Testing at - 20480/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2581724.0
get out
0 has test check 2581724.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2581724.0
get out
2 has test check 2581724.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2581724.0
get out
1 has test check 2581724.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2581724.0
get out
3 has test check 2581724.0 and sample count 3273728
 accuracy 78.862 %, best 78.862 %, roc auc score 0.8025, best 0.8025
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 21504/76743 of epoch 4, 117.17 ms/it, loss 0.442674
Finished training it 21504/76743 of epoch 4, 117.49 ms/it, loss 0.443898
Finished training it 21504/76743 of epoch 4, 119.94 ms/it, loss 0.446377
Finished training it 21504/76743 of epoch 4, 112.89 ms/it, loss 0.443670
Finished training it 22528/76743 of epoch 4, 117.01 ms/it, loss 0.444993
Finished training it 22528/76743 of epoch 4, 120.12 ms/it, loss 0.445036
Finished training it 22528/76743 of epoch 4, 117.76 ms/it, loss 0.445928
Finished training it 22528/76743 of epoch 4, 115.31 ms/it, loss 0.443953
Finished training it 23552/76743 of epoch 4, 116.53 ms/it, loss 0.445059
Finished training it 23552/76743 of epoch 4, 117.52 ms/it, loss 0.444907
Finished training it 23552/76743 of epoch 4, 115.93 ms/it, loss 0.447180
Finished training it 23552/76743 of epoch 4, 119.92 ms/it, loss 0.445132
Finished training it 24576/76743 of epoch 4, 113.59 ms/it, loss 0.444957
Finished training it 24576/76743 of epoch 4, 113.74 ms/it, loss 0.440643
Finished training it 24576/76743 of epoch 4, 113.98 ms/it, loss 0.442408
Finished training it 24576/76743 of epoch 4, 116.24 ms/it, loss 0.443416
Finished training it 25600/76743 of epoch 4, 119.21 ms/it, loss 0.445155
Finished training it 25600/76743 of epoch 4, 119.43 ms/it, loss 0.441094
Finished training it 25600/76743 of epoch 4, 122.63 ms/it, loss 0.444213
Finished training it 25600/76743 of epoch 4, 120.49 ms/it, loss 0.444063
Finished training it 26624/76743 of epoch 4, 120.81 ms/it, loss 0.443635
Finished training it 26624/76743 of epoch 4, 122.27 ms/it, loss 0.442280
Finished training it 26624/76743 of epoch 4, 120.81 ms/it, loss 0.444201
Finished training it 26624/76743 of epoch 4, 124.27 ms/it, loss 0.441548
Finished training it 27648/76743 of epoch 4, 118.30 ms/it, loss 0.443586
Finished training it 27648/76743 of epoch 4, 118.40 ms/it, loss 0.442595
Finished training it 27648/76743 of epoch 4, 119.62 ms/it, loss 0.444324
Finished training it 27648/76743 of epoch 4, 121.41 ms/it, loss 0.443842
Finished training it 28672/76743 of epoch 4, 120.39 ms/it, loss 0.443552
Finished training it 28672/76743 of epoch 4, 117.85 ms/it, loss 0.444257
Finished training it 28672/76743 of epoch 4, 117.70 ms/it, loss 0.447597
Finished training it 28672/76743 of epoch 4, 120.29 ms/it, loss 0.441445
Finished training it 29696/76743 of epoch 4, 119.06 ms/it, loss 0.445244
Finished training it 29696/76743 of epoch 4, 118.83 ms/it, loss 0.443828
Finished training it 29696/76743 of epoch 4, 122.06 ms/it, loss 0.442366
Finished training it 29696/76743 of epoch 4, 122.27 ms/it, loss 0.441665
Finished training it 30720/76743 of epoch 4, 115.94 ms/it, loss 0.441964
Finished training it 30720/76743 of epoch 4, 116.09 ms/it, loss 0.441891
Finished training it 30720/76743 of epoch 4, 117.85 ms/it, loss 0.441451
Finished training it 30720/76743 of epoch 4, 118.91 ms/it, loss 0.441916
Testing at - 30720/76743 of epoch 4,
Testing at - 30720/76743 of epoch 4,
Testing at - 30720/76743 of epoch 4,
Testing at - 30720/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580174.0
get out
0 has test check 2580174.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580174.0
get out
2 has test check 2580174.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2580174.0
get out
3 has test check 2580174.0 and sample count 3273728
rank: 1 test_accu: 2580174.0
get out
1 has test check 2580174.0 and sample count 3273728
 accuracy 78.815 %, best 78.862 %, roc auc score 0.8023, best 0.8025
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 31744/76743 of epoch 4, 117.59 ms/it, loss 0.446591
Finished training it 31744/76743 of epoch 4, 118.96 ms/it, loss 0.442013
Finished training it 31744/76743 of epoch 4, 117.74 ms/it, loss 0.444188
Finished training it 31744/76743 of epoch 4, 120.87 ms/it, loss 0.444394
Finished training it 32768/76743 of epoch 4, 117.82 ms/it, loss 0.445002
Finished training it 32768/76743 of epoch 4, 119.19 ms/it, loss 0.442736
Finished training it 32768/76743 of epoch 4, 120.87 ms/it, loss 0.445379
Finished training it 32768/76743 of epoch 4, 117.75 ms/it, loss 0.445267
Finished training it 33792/76743 of epoch 4, 113.80 ms/it, loss 0.443831
Finished training it 33792/76743 of epoch 4, 114.56 ms/it, loss 0.444000
Finished training it 33792/76743 of epoch 4, 117.10 ms/it, loss 0.442479
Finished training it 33792/76743 of epoch 4, 114.99 ms/it, loss 0.443633
Finished training it 34816/76743 of epoch 4, 122.13 ms/it, loss 0.441980
Finished training it 34816/76743 of epoch 4, 123.22 ms/it, loss 0.446290
Finished training it 34816/76743 of epoch 4, 125.66 ms/it, loss 0.445420
Finished training it 34816/76743 of epoch 4, 122.05 ms/it, loss 0.443825
Finished training it 35840/76743 of epoch 4, 116.19 ms/it, loss 0.442550
Finished training it 35840/76743 of epoch 4, 116.91 ms/it, loss 0.446359
Finished training it 35840/76743 of epoch 4, 116.19 ms/it, loss 0.442789
Finished training it 35840/76743 of epoch 4, 120.70 ms/it, loss 0.444944
Finished training it 36864/76743 of epoch 4, 117.69 ms/it, loss 0.443879
Finished training it 36864/76743 of epoch 4, 118.68 ms/it, loss 0.441934
Finished training it 36864/76743 of epoch 4, 119.12 ms/it, loss 0.442785
Finished training it 36864/76743 of epoch 4, 122.83 ms/it, loss 0.444154
Finished training it 37888/76743 of epoch 4, 123.79 ms/it, loss 0.445360
Finished training it 37888/76743 of epoch 4, 118.42 ms/it, loss 0.445918
Finished training it 37888/76743 of epoch 4, 120.08 ms/it, loss 0.444653
Finished training it 37888/76743 of epoch 4, 118.76 ms/it, loss 0.445029
Finished training it 38912/76743 of epoch 4, 116.26 ms/it, loss 0.444589
Finished training it 38912/76743 of epoch 4, 116.48 ms/it, loss 0.443963
Finished training it 38912/76743 of epoch 4, 117.70 ms/it, loss 0.445730
Finished training it 38912/76743 of epoch 4, 120.07 ms/it, loss 0.443686
Finished training it 39936/76743 of epoch 4, 115.14 ms/it, loss 0.445547
Finished training it 39936/76743 of epoch 4, 115.96 ms/it, loss 0.442714
Finished training it 39936/76743 of epoch 4, 115.43 ms/it, loss 0.442926
Finished training it 39936/76743 of epoch 4, 118.07 ms/it, loss 0.445394
Finished training it 40960/76743 of epoch 4, 115.47 ms/it, loss 0.442632
Finished training it 40960/76743 of epoch 4, 117.50 ms/it, loss 0.444071
Finished training it 40960/76743 of epoch 4, 115.64 ms/it, loss 0.442738
Finished training it 40960/76743 of epoch 4, 118.44 ms/it, loss 0.444669
Testing at - 40960/76743 of epoch 4,
Testing at - 40960/76743 of epoch 4,
Testing at - 40960/76743 of epoch 4,
Testing at - 40960/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2580432.0
get out
0 has test check 2580432.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2580432.0
get out
2 has test check 2580432.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2580432.0
get out
1 has test check 2580432.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2580432.0
get out
3 has test check 2580432.0 and sample count 3273728
 accuracy 78.822 %, best 78.862 %, roc auc score 0.8027, best 0.8027
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 41984/76743 of epoch 4, 114.08 ms/it, loss 0.442212
Finished training it 41984/76743 of epoch 4, 112.67 ms/it, loss 0.442556
Finished training it 41984/76743 of epoch 4, 112.92 ms/it, loss 0.440807
Finished training it 41984/76743 of epoch 4, 115.80 ms/it, loss 0.445491
Finished training it 43008/76743 of epoch 4, 120.39 ms/it, loss 0.446502
Finished training it 43008/76743 of epoch 4, 120.40 ms/it, loss 0.443128
Finished training it 43008/76743 of epoch 4, 123.64 ms/it, loss 0.441569
Finished training it 43008/76743 of epoch 4, 122.09 ms/it, loss 0.442930
Finished training it 44032/76743 of epoch 4, 116.42 ms/it, loss 0.442568
Finished training it 44032/76743 of epoch 4, 119.30 ms/it, loss 0.445333
Finished training it 44032/76743 of epoch 4, 116.73 ms/it, loss 0.443156
Finished training it 44032/76743 of epoch 4, 119.46 ms/it, loss 0.444208
Finished training it 45056/76743 of epoch 4, 113.68 ms/it, loss 0.442619
Finished training it 45056/76743 of epoch 4, 119.24 ms/it, loss 0.445227
Finished training it 45056/76743 of epoch 4, 116.05 ms/it, loss 0.442455
Finished training it 45056/76743 of epoch 4, 116.66 ms/it, loss 0.442345
Finished training it 46080/76743 of epoch 4, 116.15 ms/it, loss 0.447121
Finished training it 46080/76743 of epoch 4, 120.56 ms/it, loss 0.443743
Finished training it 46080/76743 of epoch 4, 118.73 ms/it, loss 0.442744
Finished training it 46080/76743 of epoch 4, 117.36 ms/it, loss 0.441426
Finished training it 47104/76743 of epoch 4, 115.65 ms/it, loss 0.442172
Finished training it 47104/76743 of epoch 4, 115.08 ms/it, loss 0.444264
Finished training it 47104/76743 of epoch 4, 117.34 ms/it, loss 0.441380
Finished training it 47104/76743 of epoch 4, 113.07 ms/it, loss 0.442071
Finished training it 48128/76743 of epoch 4, 117.30 ms/it, loss 0.445332
Finished training it 48128/76743 of epoch 4, 121.60 ms/it, loss 0.442664
Finished training it 48128/76743 of epoch 4, 124.03 ms/it, loss 0.442310
Finished training it 48128/76743 of epoch 4, 120.46 ms/it, loss 0.443137
Finished training it 49152/76743 of epoch 4, 117.87 ms/it, loss 0.442791
Finished training it 49152/76743 of epoch 4, 120.06 ms/it, loss 0.444447
Finished training it 49152/76743 of epoch 4, 118.85 ms/it, loss 0.442465
Finished training it 49152/76743 of epoch 4, 121.89 ms/it, loss 0.444818
Finished training it 50176/76743 of epoch 4, 119.40 ms/it, loss 0.441927
Finished training it 50176/76743 of epoch 4, 120.86 ms/it, loss 0.443017
Finished training it 50176/76743 of epoch 4, 119.64 ms/it, loss 0.441118
Finished training it 50176/76743 of epoch 4, 122.92 ms/it, loss 0.442916
Finished training it 51200/76743 of epoch 4, 115.05 ms/it, loss 0.442125
Finished training it 51200/76743 of epoch 4, 116.04 ms/it, loss 0.443933
Finished training it 51200/76743 of epoch 4, 115.10 ms/it, loss 0.440087
Finished training it 51200/76743 of epoch 4, 117.87 ms/it, loss 0.443004
Testing at - 51200/76743 of epoch 4,
Testing at - 51200/76743 of epoch 4,
Testing at - 51200/76743 of epoch 4,
Testing at - 51200/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2582541.0
get out
0 has test check 2582541.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2582541.0
get out
2 has test check 2582541.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2582541.0
get out
3 has test check 2582541.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2582541.0
get out
1 has test check 2582541.0 and sample count 3273728
 accuracy 78.887 %, best 78.887 %, roc auc score 0.8032, best 0.8032
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 52224/76743 of epoch 4, 118.18 ms/it, loss 0.442962
Finished training it 52224/76743 of epoch 4, 121.47 ms/it, loss 0.441621
Finished training it 52224/76743 of epoch 4, 121.22 ms/it, loss 0.443462
Finished training it 52224/76743 of epoch 4, 118.03 ms/it, loss 0.439565
Finished training it 53248/76743 of epoch 4, 117.43 ms/it, loss 0.441956
Finished training it 53248/76743 of epoch 4, 118.46 ms/it, loss 0.445400
Finished training it 53248/76743 of epoch 4, 117.58 ms/it, loss 0.441554
Finished training it 53248/76743 of epoch 4, 119.79 ms/it, loss 0.444153
Finished training it 54272/76743 of epoch 4, 118.48 ms/it, loss 0.443305
Finished training it 54272/76743 of epoch 4, 118.50 ms/it, loss 0.443608
Finished training it 54272/76743 of epoch 4, 119.68 ms/it, loss 0.443076
Finished training it 54272/76743 of epoch 4, 121.60 ms/it, loss 0.444997
Finished training it 55296/76743 of epoch 4, 118.24 ms/it, loss 0.442731
Finished training it 55296/76743 of epoch 4, 121.23 ms/it, loss 0.441505
Finished training it 55296/76743 of epoch 4, 118.26 ms/it, loss 0.444210
Finished training it 55296/76743 of epoch 4, 119.19 ms/it, loss 0.442872
Finished training it 56320/76743 of epoch 4, 112.59 ms/it, loss 0.443015
Finished training it 56320/76743 of epoch 4, 118.06 ms/it, loss 0.445541
Finished training it 56320/76743 of epoch 4, 117.40 ms/it, loss 0.441337
Finished training it 56320/76743 of epoch 4, 119.79 ms/it, loss 0.441190
Finished training it 57344/76743 of epoch 4, 114.43 ms/it, loss 0.443931
Finished training it 57344/76743 of epoch 4, 117.58 ms/it, loss 0.441921
Finished training it 57344/76743 of epoch 4, 118.98 ms/it, loss 0.442430
Finished training it 57344/76743 of epoch 4, 120.77 ms/it, loss 0.443218
Finished training it 58368/76743 of epoch 4, 113.65 ms/it, loss 0.443753
Finished training it 58368/76743 of epoch 4, 116.54 ms/it, loss 0.443216
Finished training it 58368/76743 of epoch 4, 114.99 ms/it, loss 0.441732
Finished training it 58368/76743 of epoch 4, 118.16 ms/it, loss 0.440291
Finished training it 59392/76743 of epoch 4, 115.41 ms/it, loss 0.441736
Finished training it 59392/76743 of epoch 4, 114.17 ms/it, loss 0.440906
Finished training it 59392/76743 of epoch 4, 118.09 ms/it, loss 0.441107
Finished training it 59392/76743 of epoch 4, 115.69 ms/it, loss 0.443565
Finished training it 60416/76743 of epoch 4, 114.82 ms/it, loss 0.443321
Finished training it 60416/76743 of epoch 4, 116.31 ms/it, loss 0.442844
Finished training it 60416/76743 of epoch 4, 115.32 ms/it, loss 0.443738
Finished training it 60416/76743 of epoch 4, 118.67 ms/it, loss 0.442777
Finished training it 61440/76743 of epoch 4, 115.64 ms/it, loss 0.442566
Finished training it 61440/76743 of epoch 4, 115.29 ms/it, loss 0.444915
Finished training it 61440/76743 of epoch 4, 116.44 ms/it, loss 0.443365
Finished training it 61440/76743 of epoch 4, 118.60 ms/it, loss 0.442578
Testing at - 61440/76743 of epoch 4,
Testing at - 61440/76743 of epoch 4,
Testing at - 61440/76743 of epoch 4,
Testing at - 61440/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2582414.0
get out
1 has test check 2582414.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2582414.0
get out
2 has test check 2582414.0 and sample count 3273728
rank: 3 test_accu: 2582414.0
get out
3 has test check 2582414.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2582414.0
get out
0 has test check 2582414.0 and sample count 3273728
 accuracy 78.883 %, best 78.887 %, roc auc score 0.8032, best 0.8032
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one0.0.pt
Finished training it 62464/76743 of epoch 4, 112.65 ms/it, loss 0.446741
Finished training it 62464/76743 of epoch 4, 111.11 ms/it, loss 0.443424
Finished training it 62464/76743 of epoch 4, 112.68 ms/it, loss 0.443422
Finished training it 62464/76743 of epoch 4, 114.07 ms/it, loss 0.441610
Finished training it 63488/76743 of epoch 4, 116.48 ms/it, loss 0.439817
Finished training it 63488/76743 of epoch 4, 118.55 ms/it, loss 0.442258
Finished training it 63488/76743 of epoch 4, 115.47 ms/it, loss 0.441818
Finished training it 63488/76743 of epoch 4, 117.08 ms/it, loss 0.443128
Finished training it 64512/76743 of epoch 4, 113.80 ms/it, loss 0.445146
Finished training it 64512/76743 of epoch 4, 114.92 ms/it, loss 0.444882
Finished training it 64512/76743 of epoch 4, 115.28 ms/it, loss 0.443445
Finished training it 64512/76743 of epoch 4, 116.94 ms/it, loss 0.442261
Finished training it 65536/76743 of epoch 4, 110.83 ms/it, loss 0.444176
Finished training it 65536/76743 of epoch 4, 112.59 ms/it, loss 0.446026
Finished training it 65536/76743 of epoch 4, 110.95 ms/it, loss 0.441015
Finished training it 65536/76743 of epoch 4, 110.22 ms/it, loss 0.444576
Finished training it 66560/76743 of epoch 4, 116.92 ms/it, loss 0.442313
Finished training it 66560/76743 of epoch 4, 116.65 ms/it, loss 0.444303
Finished training it 66560/76743 of epoch 4, 113.95 ms/it, loss 0.444185
Finished training it 66560/76743 of epoch 4, 117.27 ms/it, loss 0.443584
Finished training it 67584/76743 of epoch 4, 117.01 ms/it, loss 0.440938
Finished training it 67584/76743 of epoch 4, 114.46 ms/it, loss 0.442818
Finished training it 67584/76743 of epoch 4, 115.72 ms/it, loss 0.444981
Finished training it 67584/76743 of epoch 4, 117.83 ms/it, loss 0.443497
Finished training it 68608/76743 of epoch 4, 114.95 ms/it, loss 0.443820
Finished training it 68608/76743 of epoch 4, 113.32 ms/it, loss 0.441927
Finished training it 68608/76743 of epoch 4, 115.84 ms/it, loss 0.444142
Finished training it 68608/76743 of epoch 4, 114.11 ms/it, loss 0.443311
Finished training it 69632/76743 of epoch 4, 120.05 ms/it, loss 0.443022
Finished training it 69632/76743 of epoch 4, 117.78 ms/it, loss 0.443311
Finished training it 69632/76743 of epoch 4, 121.24 ms/it, loss 0.442019
Finished training it 69632/76743 of epoch 4, 119.04 ms/it, loss 0.444219
Finished training it 70656/76743 of epoch 4, 117.42 ms/it, loss 0.441891
Finished training it 70656/76743 of epoch 4, 118.85 ms/it, loss 0.442236
Finished training it 70656/76743 of epoch 4, 116.55 ms/it, loss 0.443185
Finished training it 70656/76743 of epoch 4, 115.63 ms/it, loss 0.444816
Finished training it 71680/76743 of epoch 4, 116.45 ms/it, loss 0.443106
Finished training it 71680/76743 of epoch 4, 115.11 ms/it, loss 0.442632
Finished training it 71680/76743 of epoch 4, 118.62 ms/it, loss 0.441152
Finished training it 71680/76743 of epoch 4, 117.19 ms/it, loss 0.444248
Testing at - 71680/76743 of epoch 4,
Testing at - 71680/76743 of epoch 4,
Testing at - 71680/76743 of epoch 4,
Testing at - 71680/76743 of epoch 4,
Warning: Skipping the batch 3197 with size 602
rank: 2 test_accu: 2578874.0
get out
2 has test check 2578874.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
rank: 3 test_accu: 2578874.0
get out
3 has test check 2578874.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2578874.0
get out
1 has test check 2578874.0 and sample count 3273728
rank: 0 test_accu: 2578874.0
get out
0 has test check 2578874.0 and sample count 3273728
 accuracy 78.775 %, best 78.887 %, roc auc score 0.8032, best 0.8032
Saving model to /home/yz25672/dlrm_criteo_kaggle/save_model_after_training_one1.0.pt
Finished training it 72704/76743 of epoch 4, 117.16 ms/it, loss 0.442371
Finished training it 72704/76743 of epoch 4, 117.36 ms/it, loss 0.440022
Finished training it 72704/76743 of epoch 4, 118.72 ms/it, loss 0.441098
Finished training it 72704/76743 of epoch 4, 116.28 ms/it, loss 0.443607
Finished training it 73728/76743 of epoch 4, 118.70 ms/it, loss 0.441379
Finished training it 73728/76743 of epoch 4, 116.49 ms/it, loss 0.442270
Finished training it 73728/76743 of epoch 4, 118.15 ms/it, loss 0.440226
Finished training it 73728/76743 of epoch 4, 120.65 ms/it, loss 0.441241
Finished training it 74752/76743 of epoch 4, 111.80 ms/it, loss 0.446498
Finished training it 74752/76743 of epoch 4, 112.82 ms/it, loss 0.443328
Finished training it 74752/76743 of epoch 4, 114.27 ms/it, loss 0.444613
Finished training it 74752/76743 of epoch 4, 114.84 ms/it, loss 0.445448
Finished training it 75776/76743 of epoch 4, 111.23 ms/it, loss 0.443183
Finished training it 75776/76743 of epoch 4, 110.31 ms/it, loss 0.441038
Finished training it 75776/76743 of epoch 4, 110.25 ms/it, loss 0.441838
Finished training it 75776/76743 of epoch 4, 112.69 ms/it, loss 0.443615
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 76742 with size 14
Testing at - 76743/76743 of epoch 5,
Warning: Skipping the batch 3197 with size 602
rank: 1 test_accu: 2582281.0
get out
1 has test check 2582281.0 and sample count 3273728
Warning: Skipping the batch 3197 with size 602
Warning: Skipping the batch 3197 with size 602
rank: 0 test_accu: 2582281.0
rank: 2 test_accu: 2582281.0
Warning: Skipping the batch 3197 with size 602
get out
get out
0 has test check 2582281.0 and sample count 3273728
2 has test check 2582281.0 and sample count 3273728
rank: 3 test_accu: 2582281.0
get out
3 has test check 2582281.0 and sample count 3273728
 accuracy 78.879 %, best 78.887 %, roc auc score 0.8024, best 0.8032
(base) yz25672@borg:~/Training_DLRM_fast$ ls
2022_7_7_running_script_one.sh     extend_distributed.py                      run_dlrm_kaggle_gpu_gtone.sh
cython                             files_title.txt                            run_dlrm_kaggle_gpu_onegpu.sh
data_loader_terabyte.py            kaggle_dac_loss_accuracy_plots.png         run_dlrm_kaggle_gpu_pretrain_and_quantize.sh
data_utils.py                      looking_into_tables_and_quantize.py        run_dlrm_kaggle_pseudo_gpus.sh
dlrm_3pochs.txt                    looking_into_tables_and_quantize_split.py  run_kaggle_pt
dlrm_data_pytorch.py               looking_into_tables.py                     run_para.sh
dlrm_grademb8bit.txt               mlperf_logger.py                           run_t.sh
dlrm_moving_bound_periter_300.txt  optim                                      run_t_two.sh
dlrm_s_pytorch_comm_grad.py        __pycache__                                sgd_quantized_gradients_parallel_comm.py
dlrm_s_pytorch_dp_only.py          quantization_supp                          sgd_quantized_gradients.py
dlrm_s_pytorch_one_gpu.py          README.md                                  terabyte_0875_loss_accuracy_plots.png
dlrm_s_pytorch_pseudo_multigpu.py  requirements.txt                           tools
dlrm_s_pytorch.py                  run_dist.sh                                training_imagenet_speedup.py
dlrm_training_16bit_2.txt          run_dlrm_kaggle_gpu_four.sh                tricks
(base) yz25672@borg:~/Training_DLRM_fast$ cd ..
(base) yz25672@borg:~$ ls
anaconda3  Anaconda3-2022.05-Linux-x86_64.sh  dlrm_criteo_kaggle  dlrm_four_gpus_baseline.txt  Training_DLRM_fast
(base) yz25672@borg:~$ cat dlrm_four_gpus_baseline.txt
(base) yz25672@borg:~/Training_DLRM_fast$
(base) yz25672@borg:~$ gpustat
borg                 Thu Sep 29 02:21:26 2022  515.65.01
[0] NVIDIA RTX A5000 | 28C,   0 % |   313 / 24564 MB | gdm(4M)
[1] NVIDIA RTX A5000 | 28C,   0 % |   313 / 24564 MB | gdm(4M)
[2] NVIDIA RTX A5000 | 28C,   0 % |   313 / 24564 MB | gdm(4M)
[3] NVIDIA RTX A5000 | 27C,   0 % |   313 / 24564 MB | gdm(4M)
[4] NVIDIA RTX A5000 | 28C,   0 % |   313 / 24564 MB | gdm(4M)
[5] NVIDIA RTX A5000 | 28C,   0 % |   313 / 24564 MB | gdm(4M)
[6] NVIDIA RTX A5000 | 27C,   0 % |   313 / 24564 MB | gdm(4M)
[7] NVIDIA RTX A5000 | 26C,   0 % |   313 / 24564 MB | gdm(4M)
(base) yz25672@borg:~$ tmux ls
0: 1 windows (created Mon Sep 26 17:22:47 2022)
dlrm_4bitembedding_unqg: 1 windows (created Wed Sep 28 05:37:22 2022)
dlrm_four_gpusbaseline: 1 windows (created Tue Sep 27 17:48:41 2022) (attached)
dlrm_kaggle: 1 windows (created Mon Sep 26 19:33:08 2022)
dlrm_unquantizedlin_3_epochs_stop: 1 windows (created Tue Sep 27 06:22:37 2022)
dlrm_unquantizedlin_grad8bitemb: 1 windows (created Tue Sep 27 06:34:00 2022)
(base) yz25672@borg:~$ tmux attach -t dlrm_four_gpusbaseline
sessions should be nested with care, unset $TMUX to force
(base) yz25672@borg:~$
